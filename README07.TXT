******************************************************************
** I言語 SERVER VER7 ソフトウェア説明書 (2010年10月19日改定)*****
******************************************************************
  ソフトウェア説明書は,製品の取り扱い,ご使用に際して特に注意
すべき事項,参考となる情報等を記したものです,必ずお読み下さい。
**************************************************************
☆ 注意事項
★SQL Serverの場合認証方式を混合モードに切り替えられます。
 ○混合モードとは。
    認証方法はSQL Server認証とWindows認証がありWindows認証のみか両者可能な
    混合モードがあります。
    当ツールはSQL Server認証を使用するため混合モードにする必要があります。
    Windows認証はOSの認証を使用しますがセキュリティ上は好ましくありません
    そこで、この認証をインストールで拒否する設定もできます。
★SQL Serverの場合インストールでデータベースが許可単位に4個作られますが
  本番用のマスタデータベースはログの自動切詰めをしない設定にするので,
  12:00に起動するデータベースバックアップを実施しないと,
  ログファイルが増え続けますので注意下さい。
 (ログの自動切詰めをした場合は,データベースが壊れた時ログを使って壊れる
  直前にまで戻す事が出来ません)
 (この設定は次のプロシジャーで実行しています
   sp_dboption データベース名,'trunc. log on chkpt.',false (切り詰めない)
   sp_dboption データベース名,'trunc. log on chkpt.',true  (切り詰める)
   この作業はログイン名"sa"で実行します
   この設定を変更した場合backupの方法が変わりますので注意下さい
  )
  ◎データベース名は以下のようになります
  ①本番用のマスタデータベース-----I_システム名_REAL_MAST_許可名  
  ②本番用のワークデータベース-----I_システム名_REAL_WORK_許可名  
  ③テスト用のマスタデータベース---I_システム名_TEST_MAST_許可名  
  ④テスト用のワークデータベース---I_システム名_TEST_WORK_許可名  
★SQL  Server以外はデータベース１個で運用します。
  ①PostgreSQLとIBM  DB2はスキーマ名を許可単位に４個作ります。
  ②Oracleはスキーマとユーザは分離できないのでユーザー名のまま
    利用します。
  （ワーク用はユーザがINPとOUTの２個有るので、スキーマもワーク用
    は２個となり、全部で許可単位に８個になります）
**************************************************************
1) 製品概要

I言語は完全なクライアント、サーバー方式のツールです、
誰でも即座にプログラムを作る事ができる超簡易言語と
それを実行するツールです。
データをデータベースにテーブルとして持ち、
プログラムはＳＱＬと呼ぶ言語で作ります。
プログラムを解析しながら実行するので高速で処理する物には向きません。

1．1)I言語には次の機能が有ります。
(1)メニューを表示し,プログラム(ジョブ)を実行できます。
   ◎最初のメニューはZAAAからZZZZまでの作れます。
    （インストール時点ではzzzz1個です、普通はこれで十分です）
   ◎全て3階層で1個のメニューで40項目まで表示します。
    （４０×４０×４０＝６４０００ジョブです）
   ◎メニューはサーバーのリレーショナルデータベースに記憶されます。
(2)プログラム(ジョブ)毎に認証が設定できます。
   ◎使用者とパスワードでチェックします。
   ①無条件で誰でも使用できる設定が出来ます。
   ②使用者を登録すれば使用出来る設定ができます。    
   ③使用者毎に認証指定が出来ます。
   ④管理者のみ使用できる設定ができます。
    使用者は許可と呼ぶ４文字の英字が設定され
      、許可の範囲のテーブルとプログラムのみ扱うことが出来ます。
    許可はインストール時点でZZZZ（全ての許可を利用可能な最高権限を持つ）
    とZZZY（通常の利用者）の設定がされています。
(3)開発支援ツールが完備しています。
   ◎開発支援ツールもI言語で作られています。（プログラム作りの参考になります）
   (メニュー,プログラム,テーブル(データベース)等の作成,修正,削除ができます)
   ◎プログラムもサーバーのリレーショナルデータベースに記憶されます。
(4)稼働日によりスケジュールさてた時間起動ジョブが動きます。

1．2)I言語は次の特徴があります。
（難しいロジックはツール側で対応しているので誰でも簡単に作れます）
(1)SQLを基本とし不足の部分をI言語でサポートします。
(2)出力用(OUTPUT)と入力用(INPUT)のロジックを標準で提供します。
(3)画面操作のロジックは組み込まれているので作成不要です。
(4)入力用はテーブルの削除(1),作成(2),修正(3)を標準で組み込ます。
(5)画面表示データから1つを選択(0)して次のプログラム実行できます。
(6)テーブルデータをＣＳＶ形式等のファイルに落とすことができます。
(7)EXCEL等のプログラムを別プロセスとして起動できます。
(8)サーバーのファイルを送受信できます。(ただし,ディレクトリ限定)
(9)サーバーのバッチファイルを実行できます。
(10)結局ほどのことが実現可能です。
**************************************************************
2)インストールの条件

(1)OSがWindows7,Vista,XP,2008(R2),2003のどれかである。
(2)コンピュータ名がI1"または"I2"である。(インストールファイルを作らない場合)
(3).NET Framework 2.0以上がインストールされている。(Vista,2008はインストール済)
(4)MSSQL2008(R2),2005、PostgreSQL9.0,8.4,8.3,IBM DB2 9.7,9.5,Oracle11G,10Gのどれか一個がインストールされている。
(5)SQL  Serverの場合SQL SERVER認証(混合モード）を有効にしても良い。
   逆にWINDOWS認証は使用しません、インストールで拒否出来ます。
(6)時間起動処理のためのスケジュールサービスが開始されても良い。
(7)全ドライブのフォルダー名"\I"以下を他のソフトで使用していない。
(8)サービス名"I７SRVC"を他のソフトで使用していない。
(9)共有名が"I","システム名.I"を他のソフトで使用していない。
(10)TCP/IPが設定されソケットのポート番号"65432"を使用していない。
  ◎UDP/IPが設定されソケットのポート番号"65499"を使用していない。
★クライアントから使用する場合はファイアーウオールを無効にするか
このポートを例外に設定下さい。
(11)インストールファイルの"コンピュータ名.TXT"ファイルがインストールフォルダ上にある
          または"セットアップ名_コンピュータ名.TXT"ファイルがある。
   ★初期は"I_I1.TXT"またはI_I2.TXT”がインストールフォルダ上にあります。
(12)SQL Serverは標準でインストールすると英字は大文字,小文字,全角,半角を問わず
   同じ文字として扱います。
   これを確実に区別したい場合はカスタムで並び替え順を「バイナリ」に設定して
   SQL Serverをインストールして下さい。（あまり推奨は出来ません）
(13)I言語の別バージョンがインストールされていない事。（共存はできません）
**************************************************************
3)使用許諾契約書はインストール時点で表示されます。
**************************************************************
4) 再インストールする場合の注意。
(1)システム提供プログラムが消されて全て再インストールされます。
   (%は以下全ての文字を意味します)
   (メニューはZZZZ0101%,ZZZZ0102%,ZZZZ0103%,ZZZZ0104%,ZZZZ0105%,ZZZZ0107%,Z40%です)
   (時間起動はZZZZ99985%,ZZZZ99986%,ZZZZ99995%,ZZZZ99996%です)
(2)朝の立上げ処理は起動しないで下さい。（2重に起動されてしまいます）
**************************************************************
5)インストール方法

インストールソフトもI言語で作られています、
従って画面の操作方法はI言語の勉強にもなります。
◎SETUP_JA.BATを実行し指示に従って操作下さい。
◎インストール時以下の入力が要求されます。
==============================================================
(2-1)システム名
   1サーバーにシステムを複数個インストールできます。
   8文字以内で英大文字,数字,"_"(アンダーライン)の組み合わせです。
   英字以外を先頭につける事は出来ません。
(2-2)セットアップ名
    無償版は”I"です。
(2-3)データベース名
(2-4)実行
   表示された使用条件を承認する人のみYESを入れて[Enter]して下さい。
==============================================================
(3-1)インスタンス名
    通常は空白ですがインスタンス名を陽に指定してある場合は入力下さい。
    （ただし、SQL ServerExpressEditionの場合はSQLEXPRESSがデフォルト値です。）
(3-2)システム名称
    デスクトップ上のアイコンの表示文字として使用します。
(3-3)管理者パスワード
   RDBMSのインストールで設定した内容を入れます。
(3-4)リンクパスワード
   リンクサーバー用パスワードです、２回入れて下さい。
    絶対に公開しないで下さい、インストール後変更は出来ません。
    リンクサーバー設定時のみ知っている必要があります。
    ★都合により「"」と「'」は入力できません。
(3-5)テストパスワード
   テスト用パスワードです、２回入れて下さい。
    絶対に公開しないで下さい、インストール後変更は出来ません。
    プログラム開発者も、知らなくても、支障は有りません。
    ★都合により「"」と「'」は入力できません。
(3-6)本番パスワード
   本番パスワードです、２回入れて下さい。
    絶対に公開しないで下さい、インストール後変更は出来ません。
    知らなくても、I言語は利用できます。
    ★都合により「"」と「'」は入力できません。
(3-7)本番DB本体ドライブ名
   本番データベース用のドライブ名です。
(3-8)本番DBログドライブ名<MSSQL>
   本番データベースログ用のドライブ名です。
   可能であれば(3-7)のドライブ名とは別の装置にして下さい。
(3-9)本番DBバックアップ<MSSQL>
   本番データベースバックアップ用のドライブ名です。
   可能であれば(3-7)のドライブ名とは別の装置にして下さい。
(3-10)テストDB本体ドライブ名
   テストデータベース本体用ドライブ名です。
(3-11)テストログドライブ名(データベースと別装置推奨)<MSSQLのみ>
    テストデータベースログ用ドライブ名です。
    可能であれば(3-10)のドライブ名とは別の装置にして下さい。
(3-12)テストDBバックアップ<MSSQLのみ>
   テストデータベースバックアップ用のドライブ名です。
   可能であれば(3-10)のドライブ名とは別の装置にして下さい。
(3-13)administratorsのSQLへのログインを禁止する<MSSQLのみ>
    MSSQLはデフォルトではOSのadministrators権限があるとMSSQLにも
    管理者(sa)と同じ権限が与えられます,この状態はセキュリティ上問題なので
    ここで"YES"で禁止できます。
    尚,SQL  Serverの場合で禁止した時はEnterprise Managerの登録
    情報を削除し(左窓該当サーバー上で右ボタンを押し「SQL Serverの登録情報の
    削除」をし「操作」で「SQL Serverの新規登録」で「システム管理者が割り当てた
    SQL Serverログイン情報(SQL Server 認証)」を使って登録して下さい。
    尚,”NO"とした場合は何もしません,再インストール時使用下さい。
(3-14)隠し共有(ADMIN$,C$等)を排除をする
      セキュリティ確保のため隠し共有(ADMIN$,C$等)を排除します"YES"で排除下さい
      実際にはレジストリーのHKEY_LOCAL_MACHINEの2個所を設定します
      Key="\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters"
      DataType=REG_DWORD,Value="AutoShareServer"及び"AutoShareWks"
      Data=0X00000000
      尚,”NO"とした場合は何もしません,再インストール時使用下さい。
     (復活したい場合は該当の値2個を"regedt32"で削除します)
(3-15)Guest 無効化の解除を実施
     どのクライアントからも接続可能にするため「Guestの無効化」を解除します
     "YES"で解除下さい。隠し共有を排除するのでセキュリティ上の問題は回避できます。
     (クライアントからの接続にOSの認証を使いません)
      尚,"NO"とした場合は何もしません,再インストール時使用下さい。
(3-16)入力データの再表示後YESでインストールを開始します。
==============================================================
(4-1)YESで指示に従って管理者パスワードを２個設定してください。
    注意：ここで設定しておかないと最初の認証でパスワード変更が要求されます。
 ==============================================================
(5-1)YESで指示に従って混在テーブルを更新して下さい。
==============================================================
(6-1)YESで指示に従ってカレンダー既定祭日を更新して下さい。
(6-2)YESで朝の立ち上げ処理を実行して下さい。
カレンダーの次の稼働日で立ち上げ処理の実行予約が設定されます。
該当日が休日の場合はカレンダー修正と起動予約の変更が必要になります。
(6-3)共有２箇所のEVERYONEのアクセス権をウイールスに感染しないように
      変更下さい。
(6-4)"YES"でI言語のメニューを表示してインストール完了です。
メニュー表示で88と入力してヘルプ情報をお読み下さい。
==============================================================
７）（参考）openSUSEの場合smbを使用するのでファイヤーウォールで許可する必要があります。
[Start]－[Configer Desktop]-[Advanced]-[YaST]-[Network Services]-[Samb Server]
の[Start-Up]で[Open Port in Firewall]にチェックを入れて下さい。




提供者：原沢信道

以上。
