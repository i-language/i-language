==========================================================
=== I言語 Ver5.11 バージョンアップ情報 (2009-09-27現在)===
==========================================================
★注意★：V5.8でI5SRVCW.EXEも修正しました。
  V5.7以前に再インストールする場合は必ずC:\I\FILE\SERVICEのREMOVE.BATを実行し。
  サービスを削除してからインストールして下さい。
  （★=非互換発生、■＝バグ対応、▲＝支援プログラム修正、●＝新機能追加）
=======================================================
◎************( I520090927提供 )*********
★VER5.11-8(2009-09-30)WRITE1_OPENではエンコード指定なしでもバイト順マーク (BOM)付きでファイルが作成されていました。
エンコード指定無しの場合バイト順マーク (BOM)無しでファイルが作られるように変更しました。
▲VER5.11-7(2009-09-26)ZZZZ010225がDB2でLISTBOX1等を指定するとエラーになる問題に対応しました。
23300  =+'?_C??_SUBSTR?(~~_NAME,5,30)'
を
23300  =+'?_C??_SUBSTR?(~~_NAME,5,26)'
に変更しました。
▲VER5.11-6(2009-09-18)本番テーブル複写リンクサーバーからの場合PUBLICは見えますがLINKが見えない問題を対応しました。
  ZZZZ010228を修正しました。
  5600 ={WHERE X2.~~_GRANT IN('LNK_ZZ','PUBLIC')
  のLINK_ZZをLINK_ZZZZに変更し
  5600 ={WHERE X2.~~_GRANT IN('LNK_ZZZZ','PUBLIC')
  としました。
▲VER5.11-5(2009-09-18)本番テーブル更新で公開を変更した時でテストテーブルが存在しない場合エラーとなる問題を対応しました。
  ZZZZ010226を修正しました。
  8220  %~~_TEST-=DBO_GRANT{?W_TEST?}{TABLE}{?X1.~~_PUBLIC?};
  の最後にNOP{}を付け
  8220  %~~_TEST-=DBO_GRANT{?W_TEST?}{TABLE}{?X1.~~_PUBLIC?}NOP{};
  としました。
▲VER5.11-4(2009-09-18)リンクサーバーのログイン情報が不足していました。
  ZZZZ010539を修正しました。
  7700  =IF{W_PERM!='ZZZZ'}JUMP{JUMP};
  をコメント化で
  7700  *IF{W_PERM!='ZZZZ'}JUMP{JUMP};
  としました。
◎************( I520090906提供 )*********
■5.11-3(2009-09-05)---SQL=での命令群でスクロール中にエラーが発生してもエラーとならない問題を対応しました。
■5.11-2(2009-09-05)---SET=の表示でタイトルと内容表示幅の合計が８０文字を超えた場合内容の表示幅が狭くなり、
更に、これが最初にあると表示位置が下に１行ずれる問題を対応しました。
●5.11-1(2009-09-02)---DATA=内でプログラム群の指定も可能にしました。
★関連してSET=での定義情報の設定を変更しました。（型１の空白設定をやめ、個別に値を設定する）
★関連してSET&､CHECK1&,CHECK2&、SECTION&の設定方法を変更しました。
★関連してデータ辞書の組み立てでCHECK61からCHECK66までの結合に空白を付ける事を止めました。
  DATA=[{属性}]データ名{定義}[{チェック1}][{チェック2}] [{メッセージ}][タイトル]]
  を
  DATA=[{属性}]データ名{定義}[{チェック1}[{チェック2}[{メッセージ}]]][{{命令群}}][タイトル]
  としました。
  _Xシステム変数を新設---別名（ドット付き）をSET=とDATA=の開始時に設定します。
  _LEFT##システム変数を新設---DATA=で別名が設定されているとSQLのLEFT JOIN文に置き換えます。
◎************( I520090901提供 )*********
▲5.10-3(2009-09-01)---ZZZZ010121で旧パスワードが暗号化されないで登録されている問題を対応しました。
◎************( I520090831提供 )*********
▲5.10-2(2009-08-29)---ZZZZ010221でTABLEによるプログラム作成に問題が有りZZZZ010241を修正しました。
  データディクショナリのZZZZ_CHECKが'LISTBOX21'、'LISTBOX22'の時、必要なDATA=等が追加されませんでした。
●5.10-1(2009-08-29)---コピー2をZZZZZZZZとした場合、コピー1のジョブメニューで指定したコピー１からコピー５を採用すようにしました。
  目的：コピー内容が同じ場合が多い事と、コピーが変更されても少ない箇所の変更で済むので、機能を追加しました。
  これにより開発支援メニューの関連ジョブを大幅に修正しました。
◎************( I520090825提供 )*********
■5.9-4(2009-08-23)---IPRINT.EXEのVERSIONを2にアップしました。
  TEXTおよびDATAで繰り返しでの文字名が利用されないで繰り返し前の文字名となっていました。
  TEST_DATAでDATAの内容が繰り返しの場合編集後のデータが利用され、正しく表示されませんでした。
  注意：VERSION２で確実に実行したい場合はレイアウトファイルにVERSION,2を追加します。
◎************( I520090819提供 )*********
■5.9-3(2009-08-08)---パスワードが正しくチェック出来ない場合が有る問題を対応しました。
  暗号化した文字の最後が空白になった場合比較で不一致となっていました。
▲5.9-2(2009-08-08)---サンプル発注システムをテーブル構造も含め大幅に変更中。
■5.9-1(2009-08-08)---EXIT3で入力位置反転表示が残ってしまう問題に対処しました。
◎************( I520090805提供 )*********
■5.8-2(2009-08-05)---ZZZZ010502が処理中で終了しない問題を対応しました。
  理由：サービスから起動したバッチファイルがセキュリティ上の問題で一時停止してしまいます。
  ZZZZ010502起動時無条件にバッチファイル起動するので一時停止させないように操作します。
◎************( I520090804提供 )*********
■5.8-1(2009-08-03)---ZZZZ010501最新状態表示出来ずがまだ問題有ります。
  原因究明中です。
  問題点としてはVISTAおよびWindows７でRECEIVE命令が正常に実行されない模様です。
  原因はIPアドレスがIPｖ６、IPｖ４等で複数有りSENDとRECEIVEで使用方法が一致していなかった為です。
  Dns.GetHostEntry(）でもらった情報の最後のデータから採用するように変更しました。
  （IPV6が有ると最初の方がリンクローカルアドレスの為これを避けたい）
  I5MENUM.EXE、I5TIME.EXEを修正しました。
◎************( I520090729提供 )*********
■5.7-1(2009-07-29)---ZZZZ010501最新状態表示出来ずを対応しました。
  最新状況更新前にSENDを発行していました。
  I5MENUM.EXE、I5TIME.EXEを修正しました。
◎************( I520090728提供 )*********
▲5.6-2(2009-07-28)---リンクサーバ関連の動作に問題がありました。
  ZZZZ010228,ZZZZ010229,ZZZZ010243,ZZZZ010539のプログラムを大幅に修正しました。
■5.6-1(2009-07-26)---SENDが連続して送られると受信側が処理中になる問題が時々発生するのを抑えました。
  SEND後無条件に３秒待つようにしました。
  I5MENUM.EXE、I5TIME.EXEを修正しました。
◎************( I520090718提供 )*********
▲5.5-6(2009-07-18)---使用規約を変更し無償版は自社開発ソフトの場合は本番運用を可能に改めました。
▲5.5-5(2009-07-17)---バージョン２をあげた場合テスト実行で＠ZZZZ_VERSION2（？）＞？UNMATCHとなる問題に対処しました。
  ZZZZ010531に以下を追加しました。
  4810  =PROGRAM{?_M_TEST?_ETC_TABLE}
  4820  =  {W.ZZZZ_KEY1,W.ZZZZ_KEY2}{W.ZZZZ_ETC}{3};
  (I520090714以前は陽にZZZZ010107の混在テーブル 更新でZZZZ_@のZZZ_VERSION2を0に変更し再度新バージョンに変更下さい
  この処理で、テスト用も同時に更新されます）
◎************( I520090714提供 )*********
■5.5-4(2009-07-14)---バージョン２をあげた場合＠ZZZZ_VERSION2（？）＞？UNMATCH(ZZZZ010517,ZZZZ010537  SKIP）エラーとなる問題に対処しました。
  \I\BIN\I5_MENU.TXTの７行目「=EXIT{0};」をコメントにしました。
  I5MENUM.EXE、I5TIME.EXEを修正しました。
  注意：VERISION5.4以前は対処出来ないのでエラーが出た場合はクライアントを手動で再インストールして下さい。
■5.5-3(2009-07-13)---データ辞書で型１を-から＋に変更した場合に発生する問題を対応しました。
  １．大小比較で負の値が有ってもMinusエラーとしないで比較するようにしました。
  ２．入力データが初期値－符号が有った場合正常に処理されてしまう問題を対応しました。
  I5MENUM.EXE、I5TIME.EXEを修正しました。
▲5.4-3(2009-07-13)---ZZZZ_I_DICTIONARY_TABLEのZZZZ_LANGを考慮していないプログラムを修正しました。
  言語が複数有ると同じ情報が重複して表示されます。
    ZZZZ010206,ZZZZ010406 ZZZZ     1      テスト テーブル     定義 表示  
  「8710  SQL=AND X2.ZZZZ_LANG='?_LANG?'」を追加しました。
    ZZZZ010226,ZZZZ010226 ZZZZ     3      テスト テーブル     更新
  「22910 = AND ZZZZ_LANG='?_LANG_SYSTEM?'」を追加しました。
  「46910 SQL=AND X2.ZZZZ_LANG='?_LANG_SYSTEM?'」を追加しました。
◎************( I520090703提供 )*********
▲5.4-3(2009-07-03)---ZZZZ999959で「AT DATE 06 != 6」等のエラーの発生を対応しました。
  「2610  =IF{W_AT_DD@LENGTH=1}SET{W_AT_DD='0'+W_AT_DD};」を追加しました。
■5.4-2(2009-07-03)---PostgreSQL8.4に対応しました。
  エラーの表示文字が異なっているため5.3以前では正しく動きません。
  I5MENUM.EXE、I5TIME.EXEを修正しました。
▲5.3-1(2009-07-03)---ヘルプの内容に誤りが有り修正しました。
  特に許可が２文字の説明のままになっている部分有り。
◎************( I520090620提供 )*********
▲5.3-5(2009-06-20)---IBM DB2 V9.7動作確認OKによりインストールをI95,I91からI9に変更。（I9でV9.7,V9.5,V9.1共通とする）。
▲5.3-4(2009-06-20)---ZZZZ010212[テスト ＳＱＬ 発行」で異常終了発生。
  「5800  SET={O}$X1.ZZZZ_OWNER{3}」の{3}を{5}に変更。
▲5.3-3(2009-06-19)---ZZZZ010226[テスト テーブル     更新」でPUBLIC設定がうまく機能しませんでした。
  プログラムを大幅に手直ししました。
▲5.3-2(2009-06-19)---ZZZZ010239[テスト オブジェクト 許可の更新]が異常終了します。
  プログラムを大幅に手直ししました。
■5.3-1(2009-06-14)---認証でテスト中は使用者があればJ（ジョブ登録必要）はP（使用者があれば良い）と見なし動かせるようにしました。
  テスト中はJは管理者権限かジョブ登録が必要であったが、セキュリティ関連テーブルがテストと本番で共用なので、無用な登録を避け仕様を変更する。
  I5MENUM.EXE、I5TIME.EXEを修正しました。
◎**********( I520090605提供 )**********
▲5.2-10(2009-06-05)---共有Iがアクセス拒否される問題を対応しました。
  SET_END.BATを修正しました。
▲5.2-9(2009-06-03)---ディスクトップ上等空白のあるフォルダー上でインストールするとエラーとなります。
  注意：５．２以前はc:\等ルートに置くことで、問題が回避出来ます。
  SET_END.TXTとSET_END.BATを修正しディスクトップ上のフォルダーからインストール可能としました。
◎**********( I520090517提供 )**********
▲5.2-8(2009-05-12)---メニュー立ち上げ時TMPフォルダー内ファイル削除でのエラー回避。
  削除エラーでメニューが立ち上がらない問題を回避のため削除エラーを無視する。
  ￥I\BIN\I5_MENU.TXTの=ERASE_FILE{?W_FILE?};を=ERASE_FILE{?W_FILE?}NOP{};に変更。
■5.2-7(2009-05-05)---FORM1=の変数対応。
  PROGRAM＝NOT意外でFORM1=に変数を与えた場合、変数がそのまま表示されていたが、PROGRRAM=NOTと同様、変数を内容で置き換えるようにした。
  I5MENUM.EXE、I5TIME.EXEを修正しました。
■5.2-6(2009-04-24)---PEPLACE命令追加。
  REPLACE_PART2、REPLACE_PART_ADD2、REPLACE_PART_CHANGE2命令を追加。
  どれも入力テーブルのZ_CANCELを使用しない。
  I5MENUM.EXE、I5TIME.EXEを修正しました。
■5.2-5(2009-04-08)---テーブル用変数を追加。
  (1)&[テーブル別名].WORK_DATA--データの作業列名。(","区切)
  (2)&[テーブル別名].WORK_KEY--キーの作業列名。(","区切)
  I5MENUM.EXE、I5TIME.EXEを修正しました。
▲5.2-4(2009-04-08)---サンプル発注システムのテーブル構造を変更しました、5.1に再インストールした場合は対処が必要です。
  (1)ZZZY_SLIP_PLAN(_W)_TABLEのZZZY_ZZ_NOをINTからCHAR(12)に変更しました。
  (2)ZZZY_SLIP_PLAN(_W)_TABLEにZZZY_ZZ_START_DATEを追加しました。
  (3)ZZZY_SLIP_NO_TABLEを新設しました。
■5.2-3(2009-04-07)---&X1.C&...の変数設定でCHARをNCHARとしてしまいます。
  正しく設定されるように変更しました。
  I5MENUM.EXE、I5TIME.EXEを修正しました。
■5.2-2(2009-04-03)---ZZZZ010501が処理中で画面が変わらない問題発生。
   原因不明につき、I5TIMEW.EXEからのSENDデータを少なくして様子をみる。
  I5TIMEW.EXEを修正しました。
■5.2-1(2009-04-01)---起動パラメータの'ZZZ_ARG_SLEEP=秒数'で起動を指定秒数分待たせます。
  （スタートアップで起動時データベースサービスが立ち上がる前に起動してエラーとなる問題を回避出来るようにしました）
  (1)I5MENUM.EXE、I5TIME.EXEを修正しました。
  (2)I5SERVER.JSの'ZZZZ_ARG_STARTUP=1'を'ZZZZ_ARG_SLEEP=30'に変更。
  (3)ZZZZ01050213500を'=IF{#ZZZZ_ARG_STARTUP=1}EXIT{_END};'から'=IF_NAME{#ZZZZ_ARG_SLEEP}EXIT{_END};'に変更。
◎**********( I520090331提供 )**********
提供者：原沢信道
以上
