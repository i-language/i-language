// II_SECTION.SRC section class author nobumichi harasawa
#if IMENU||ITIME //TEST
//HH #include "ii_include_hh.h"
//PP #include "ii_include_pp.h"
//SS using System.Data.SqlClient;
//SS using System;
//SS using System.Collections.Generic;
//SS using System.Drawing;
//SS using System.IO;
//SS using Microsoft.Win32;
//SS using System.Threading.Tasks;
//JJ import java.awt.*;
//JJ import java.awt.event.*;

//JJ import java.io.*;
//JJ import java.math.*;
//JJ import java.util.*;
//SS using System.Net.Mail;
public class ii_section_l
{
//COPY $II_DIR
//COPY $II_READ
//COPY $II_SQL2
//COPY $II_URL
ii_z_l z_p;ii_z_mt_l z_mt_p;ii_zz_l w_cmd_s_n;ii_zz_l w_s_n;
readonly int CONTINUE_IF_M1=-1,CONTINUE_NORMAL_0=0,SKIP_NORMAL_1=1,SKIP_IF_2=2,IF_ERROR_3=3; //VER17
ii_data_l w_data_n;ii_read_l read_n;
bool sw_counter_b=true,sw_e_program_b,sw_p_program_b,sw_n_program_b,sw_data_b=false;
bool sw_0_program_b; //VER37_8.0.9
int counter=1,counter_len_0=1,counter_len_m=1,counter_len_p=1
,counter_len_old_0=1,counter_len_old_m=1,counter_len_old_p=1,edit=0,prog_cmd=0,sw_continue=0,sw_if_error=0,sw_jump_null=0,cnt_back_null=0;  //VER17
readonly String[] RESERV_SX?=?   {"_DRIVE_FREE","_DRIVE_TYPE","_PART","_JOB_PART","_JOB_PERMISSION","_SQL_PERMISSION","_WMI","_CLICK","_CODE","_CODE39"
,"_DATE","_DATE_GOOD","_DIGIT11","_EDIT","_DATETIME","_DATETIME_GOOD","_EDIT_ERROR","_ENVIRONMENT"
,"_SPACE","_SPACE_ERASE","_ESC","_RETURN_SQL","_FULL_SIZE","_JAN","_NEXT","_RANDOM","_REAL_TEST","_RESTORE_DB","_TRACE","_JOB","_JOB_CGI","_HEAD"
,"_TITLE","_PASSWORD","_SQL_LIMIT","_PAGE_SW","_LOGIN_PASSWORD","_LOGIN_ID","_UPPER","_LOWER","_X"
,"_SET","_TRIM","_HAVING","_ARG","_COMMAND","_FIND_CHAR","_FIND_CHAR_NOT","_FIND_CHAR_LAST","_FIND_CHAR_LAST_NOT"  // VER23.1 
,"_FIND_COUNT","_FIND_STRING","_FIND_STRING_NOT","_FIND_STRING_LAST","_FIND_STRING_LAST_NOT","_AND_SPACE","_VARIABLE","_URL_DECODE","_URL_ENCODE"
,"_URL_ENCODE_DECODE","_REGISTRY"};
readonly String[] RESERV2_SX?=?{"_SETUP","_DB_SOFT","_INSTANCE","_SYSTEM"//SETUP以下は特殊処理用
,"_SYSTEM_NAME","_SERVER_NAME","_PASSWORD_LINK","_PASSWORD_REAL","_PASSWORD_TEST","_PASSWORD64_CHECK","_REGISTRY_WRITE"
,"_LANG_SYSTEM","_PERSON"      };// file Job onle
readonly String FILE_S=":/\\";
char edit_c='\0';
String edit_s,w_kind_s,cmd2_s,w_name_top_s="";
String opt1_s="",opt2_s="",opt3_s="",opt4_s="",opt5_s="",opt6_s="",opt7_s="";
//###(new )##########
List<String> s_work_key_a=new List<String>();
List<String> s_work_data_a=new List<String>();
List<String> s_work_a=new List<String>();
List<String> s_key_a=new List<String>();
List<String> s_data_a=new List<String>();
List<ii_data_l> da_o_cursor_table_a=new List<ii_data_l>();
//###################
String usr_s,o_select_s="",o_order1_s="",o_order2_s="",o_declare_s="",o_into_s="",o_sql_key1_s="",o_sql_key2_s="";
//----------------------------------------------
public ii_section_l(ii_z_l z_ni,ii_z_mt_l z_mt_ni)
{z_p=z_ni;z_mt_p=z_mt_ni;
//###(new)###
read_n=new ii_read_l(z_p);
w_prog_edit_s_n=new ii_zz_l();w_prog_edit_org_s_n=new ii_zz_l();
w_cmd_s_n=new ii_zz_l();w_s_n=new ii_zz_l();
w1_s_n=new ii_zz_l();w2_s_n=new ii_zz_l();w3_s_n=new ii_zz_l();w_type_c_n=new ii_zz_l();
//###########
z_p.add_s(s_work_key_a,"");z_p.add_s(s_work_data_a,"");
}
//----------------------------------------------
//=****( 次の文字"{"か判定 )*****
public bool next_operand_b()
{ii_zz_l ww_i_n=new ii_zz_l();ww_i_n.i=z_p.prog_n.i;
bool b=z_p.e_left_b(ww_i_n,"{",z_p.prog_s_n.s);
//HP delete ww_i_n;
return b;
}
//=****( s1_siがs2_sのedit値以降左空白を除いた部分と一致すれば edit 値を変更 )*****
public bool edit_e_left_b(String s1_si,String s2_si)
{int start=edit;
for(;;start++)if(z_p.length(s2_si)<=start)return false;else if(' '<z_p.at_s_c(s2_si,start))break;//空白以外までstartをアップ
String s=z_p.upper_s(z_p.substring2_s(s2_si,start)); //左空白を除いた文字を抜き出し
if(!z_p.starts_with_b(s,z_p.upper_s(s1_si)))return false;//該当文字左が一致するか確認
edit =start+z_p.length(s1_si); //editを一致の次へ移動。
return true;
}

public String sql_insert_s(bool sw_program2_bi)
{String comma_s="";
int i;String out_s="(";
if(sw_program2_bi){out_s+=z_mt_p.z_insert_name_s();comma_s=",";}
for(i=0;i<z_p.count_s_i(s_work_key_a);i++){out_s+=comma_s+z_p.dot_string_s(z_p.at_s(s_work_key_a,i));comma_s=",";} 
if(sw_data_b)for(i=0;i<z_p.count_s_i(s_work_data_a);i++){out_s+=comma_s+z_p.dot_string_s(z_p.at_s(s_work_data_a,i));comma_s=",";} 
comma_s="";
out_s+=")VALUES(";
if(sw_program2_bi){out_s+=z_mt_p.z_insert_value_s();comma_s=",";}
for(i=0;i<z_p.count_s_i(s_key_a);i++){out_s+=comma_s+z_p.at_s(s_key_a,i);comma_s=",";} 
if(sw_data_b)for(i=0;i<z_p.count_s_i(s_data_a);i++)out_s+=","+z_p.at_s(s_data_a,i); 
return out_s+")";
}
//----------------------------------------------
//====*( return 0=nomal,1=SQL error,9=abort )*****
public int program(String opt1_si,String opt2_si,String opt3_si,String opt4_si,String opt5_si)
{z_p.t_v(z_p.SE,"program(");
String where_s=(z_p.e2s_b(opt5_si,"")?"":(z_p.e2s_b(opt4_si,"")?" WHERE":" AND")+z_p.DUMMY_S+" ("+opt5_si+") ");
String sql_s,comma_s="";
int sql_cnt=3;//PROGRAM
bool sw_program2_b=true;if(z_p.e2s_b(cmd2_s,"PROGRAM2"))sw_program2_b=false;
z_mt_p.program_p.sql_cnt_ix[sql_cnt]=0;
sql_s="SELECT "+(('0'!=z_p.at_s_c(opt1_si,0)||(z_p.e2s_b(z_p.trim_s(z_p.at_s(s_work_data_a,0)),"")&&1==z_p.count_s_i(s_work_data_a)))?
     (sw_program2_b?"Z_CANCEL":"' '"):sql_data_s("",",",s_work_data_a))
// +" FROM "+opt3_si+" "+z_mt_p.db_n.lock1_s  //VER37.6.0.17 //VER37_8.0.9
   +" FROM "+opt3_si+" "+(true==sw_0_program_b?"":z_mt_p.db_n.lock1_s)  //VER37.6.0.17 //VER37_8.0.9
          +(z_p.e2s_b(opt4_si,"")?"":sql_data_s(" WHERE "," AND ",s_work_key_a,"=",s_key_a))+where_s

          +(('0'==z_p.at_s_c(opt1_si,0)||sw_p_program_b)&&sw_program2_b?(z_p.e2s_b(opt4_si,"")&&z_p.e2s_b(opt5_si,"")?" WHERE":" AND")+z_p.DUMMY_S
//          +" Z_CANCEL=' '":"")+z_mt_p.db_n.lock2_s; //VER37_8.0.9
            +" Z_CANCEL=' '":"")+(true==sw_0_program_b?"":z_mt_p.db_n.lock2_s); //VER37_8.0.9
if(0!=z_mt_p.sql_n.sql_usr2(sql_s,usr_s))return 1; 
z_mt_p.program_p.sql_record_cnt_ix[sql_cnt]=z_p.db_record_cnt;
//===( 0＝検索処理 )*****
if('0'==z_p.at_s_c(opt1_si,0))
  {if(z_p.e2s_b(z_p.trim_s(z_p.at_s(s_work_data_a,0)),"")&&1==z_p.count_s_i(s_work_data_a))return 0; //検索データ無し
   for(int i=0;i<z_p.count_s_i(s_work_data_a);i++)
     {if(!w_set_name_b(z_p.trim_s(z_p.at_s(s_work_data_a,i))))return 9;
      if(0!=w_set_data((0==z_p.db_record_cnt?"":z_p.at_s(z_mt_p.sql_n.s_sql_a,i))))return 9;
     }
   return 0;
  }
//====* (N、０件または削除済みで１，３、有りで２、の場合無視して正常終了 )**********************
if(sw_n_program_b)
  {if(0==z_p.db_record_cnt||!z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_sql_a,0),"")){if(z_p.e3c_b(z_p.at_s_c(opt1_si,0),'1','3'))return 0;} 
   else if('2'==z_p.at_s_c(opt1_si,0))return 0;
  }
//====* (P以外で、２件以上または２でデータ有りかつEでなくかつ削除済みでない場合エラー )***
if(!sw_p_program_b&&(1<z_p.db_record_cnt
  ||(0<z_p.db_record_cnt&&'2'==z_p.at_s_c(opt1_si,0)&&!sw_e_program_b&&z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_sql_a,0),""))))
  {z_p.err_s="bad (data count) \""+z_p.to_i_s(z_p.db_record_cnt)+"\"";return 1;}
//====* (0件又は削除済みの場合、１，３はE無しでエラー以外は )***
if((0==z_p.db_record_cnt||!z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_sql_a,0),""))&&z_p.e3c_b(z_p.at_s_c(opt1_si,0),'1','3'))
  {if(!sw_e_program_b){z_p.err_s="bad (data count is zero) \"0\"";return 1;}
   else if('1'==z_p.at_s_c(opt1_si,0)||('3'==z_p.at_s_c(opt1_si,0)&&sw_p_program_b&&sw_e_program_b))return 0;
  }
//====( 1 削除処理 )*********************
if('1'==z_p.at_s_c(opt1_si,0))
  if(sw_program2_b)
    sql_s="UPDATE "+opt3_si+" SET "+z_mt_p.z_update_s("CANCEL","","")+sql_data_s(" WHERE "," AND ",s_work_key_a,"=",s_key_a)+where_s
          +" AND Z_CANCEL=' '";
  else sql_s="DELETE FROM "+opt3_si+sql_data_s(" WHERE "," AND ",s_work_key_a,"=",s_key_a)+where_s; //物理削除
else if(0==z_p.db_record_cnt&&('2'==z_p.at_s_c(opt1_si,0)||('3'==z_p.at_s_c(opt1_si,0)&&sw_e_program_b)))
    sql_s="INSERT INTO "+opt3_si+sql_insert_s(sw_program2_b); 
else
//====***（修正データが無くかつ修正処理の時は処理不要 )*****
if(sw_data_b||(0<z_p.db_record_cnt&&!z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_sql_a,0),""))) //更新データ有り、又は削除済みは処理。
  {sql_s="UPDATE "+opt3_si+" SET ";
   if(sw_program2_b){sql_s+=z_mt_p.z_update_s("ADD_CHANGE_PROGRAM","","");comma_s=",";}
   sql_s+=(sw_data_b?sql_data_s(comma_s,",",s_work_data_a,"=",s_data_a):"") 
   +sql_data_s(" WHERE "," AND ",s_work_key_a,"=",s_key_a)+where_s
   +(('3'==z_p.at_s_c(opt1_si,0)&&sw_p_program_b)&&sw_program2_b?" AND Z_CANCEL=' '":"") 
   +(sw_data_b?sql_data_s(" AND("," OR ",s_work_data_a,"<>",s_data_a)+(sw_program2_b?" OR Z_CANCEL<>' '":"")+")":"");
  }
int rc=z_mt_p.sql_n.sql_usr2(sql_s,usr_s);
if(0==rc)z_mt_p.program_p.sql_record_cnt_ix[sql_cnt]=z_p.db_affected_cnt;  //VER23.1　更新数を設定。
return rc;
}
//-------( z_p.prog_s[z_p.prog] より次の"}"を編集してprog_edit_org_s_nとedit_sに設定 )---------------------------------------
ii_zz_l w_prog_edit_s_n;ii_zz_l w_prog_edit_org_s_n;
bool prog_edit1_b(bool b_bi)
{bool rc_b=true;edit=0;w_prog_edit_s_n.s="";
if((rc_b=z_p.prog_word_b(w_prog_edit_org_s_n,"}")))
    rc_b=z_mt_p.edit_b(w_prog_edit_s_n,(b_bi?z_p.lower_s(w_prog_edit_org_s_n.s):w_prog_edit_org_s_n.s)); 
edit_s=w_prog_edit_s_n.s;
return rc_b;
}
//-------( z_p.prog_s[z_p.prog]の次の"{"より、次の"}"まで編集してw_prog_edit_org_s_nとedit_sに設定 )---------------------------------------
bool prog_edit2_b()
{bool rc_b=true;edit=0;w_prog_edit_s_n.s="";
if(!(rc_b=z_p.prog_left_b("{")))z_p.err_s="not found \"{\" or bad command \""+w_cmd_s_n.s+"\"";
else if((rc_b=z_p.prog_word_b(w_prog_edit_org_s_n,"}")))
         rc_b=z_mt_p.edit_b(w_prog_edit_s_n,w_prog_edit_org_s_n.s); 
edit_s=w_prog_edit_s_n.s;
//(中止VER8.10)//if(!rc_b)if(-1==z_p.index2c_i(z_p.COMMAND_SX,cmd2_s))z_p.err_s="bad (command) \""+w_cmd_s_n.s+"\"";
return rc_b;
}
//----------------------------------------------
//bool split_data_b=false;
//(NEW)
bool split_data_b(List<String> s_name_ai,List<String> s_value_ai,String s_si)
{z_p.t_v(z_p.SE,"split_data_b(");
int i;
z_p.clear_s_v(s_name_ai);
z_p.clear_s_v(s_value_ai);
z_p.split_comma_s_v(s_name_ai,z_p.replace_s_s(s_si,z_p.new_line_s(),""));
for(i=0;i<z_p.count_s_i(s_name_ai);i++)
 {if(!z_mt_p.program_p.find_name_b(z_p.trim_s(z_p.at_s(s_name_ai,i))))
    {z_p.err_s="not found (name) \""+z_p.at_s(s_name_ai,i)+"\"";return false;} 
  z_p.add_s(s_value_ai,z_mt_p.sql_data_s(z_mt_p.program_p.da_find_name_data_p,""));
 }
return true;
}
//----------------------------------------------
//(NEW)
String sql_data_s(String sep1_si,String sep2_si,List<String> s_name_ai,String pat_si,List<String> s_data_ai)
{z_p.t_v(z_p.SE,"sql_data_s(1");
int i;String out_s="";
for(i=0;i<z_p.count_s_i(s_name_ai);i++)
  {out_s+=(0==i?sep1_si:sep2_si)+z_p.dot_string_s(z_p.at_s(s_name_ai,i))+pat_si+z_p.at_s(s_data_ai,i); 
  }
return out_s;
}
//----------------------------------------------
//(NEW)
String sql_data_s(String sep1_si,String sep2_si,List<String> s_name_ai)
{z_p.t_v(z_p.SE,"sql_data_s(2");
int i;String out_s="";
for(i=0;i<z_p.count_s_i(s_name_ai);i++)
  out_s+=(0==i?sep1_si:sep2_si)+z_p.dot_string_s(z_p.at_s(s_name_ai,i)); 
return out_s;
}
//------------( edit_sのedit値以降がs_siと一致すれば　edit値を一致の右へ変更　）----------------------------------
public bool  edit_left_b(String s_si){return edit_e_left_b(s_si,edit_s);}
//---( edit_s[edit]+"}"をs_siの文字で分割しs_niに設定しeditを変更 )----------------------------------------
bool edit_word_b(ii_zz_l s_ni,String s_si)
{ii_zz_l ww_edit_n=new ii_zz_l();ii_zz_l ww_edit_c_n=new ii_zz_l();
ww_edit_n.i=edit;
bool b=z_p.word_b(s_ni,ww_edit_n,ww_edit_c_n,edit_s+"}",s_si,1);
edit=ww_edit_n.i;edit_c=ww_edit_c_n.c;
//HP delete ww_edit_n;delete ww_edit_c_n;
return b;
}
//------( s_siの名前から内容を設定 )----------------
bool get_data_b(ii_zz_l s_ni,ii_zz_l c_ni,String s_si)
{bool b=z_mt_p.program_p.get_data_b(s_ni,c_ni,s_si);
return b;
}
//----------------------------------------------
//====*( s_siの名前のdata_nをw_data_nとw_kind_sに設定します )*****
bool w_set_name_b(String s_si)
{z_p.t_v(z_p.SE,"w_set_name_b(");
w_name_top_s="";
 if(!z_p.e2s_b(s_si,""))
  {if(z_p.e2s_b(s_si,"_COUNTER"))
     {sw_counter_b=true;w_data_n=z_p.at_da(z_p.da_common_a,0);w_kind_s="WORK";z_p.t_v(z_p.SE,"w_set_name_b)1");return true;}
   if(z_mt_p.program_p.find_name_b(s_si))
     {w_data_n=z_mt_p.program_p.da_find_name_data_p;w_kind_s=z_mt_p.program_p.find_name_kind_s;z_p.t_v(z_p.SE,"w_set_name_b)2");return true;}
   if('W'==z_p.to_upper_c(z_p.at_s_c(s_si,0)))
     {z_p.add_da(z_mt_p.program_p.da_work_a,new ii_data_l(s_si,z_p));
      w_data_n=z_p.at_da(z_mt_p.program_p.da_work_a,z_p.count_da_i(z_mt_p.program_p.da_work_a)-1);
      if(z_p.length(s_si)>1)
        {if('0'<=z_p.at_s_c(s_si,1)&&'9'>=z_p.at_s_c(s_si,1))//２桁目数値判定。
           {int len=2;
            for(;z_p.length(s_si)>len&&'0'<=z_p.at_s_c(s_si,len)&&'9'>=z_p.at_s_c(s_si,len);len++)continue;//２桁目以降の数値分長さに加える。
            w_data_n.length2=z_p.to_int1s_i(z_p.substring3_s(s_si,1,len-1));//数値分小数点以下の桁数に設定
            w_data_n.type1_s="-";//数値の指定
           }
         else if(z_p.e3c_b(z_p.at_s_c(s_si,1),'E','F'))w_data_n.type1_s=z_p.to_c_s(z_p.at_s_c(s_si,1));
         else if('C'!=z_p.at_s_c(s_si,1))w_data_n.type1_s="!";
        }
      w_kind_s="WORK";
      z_p.t_v(z_p.SE,"w_set_name_b)3");
      return true;
     }
   if(z_p.length(s_si)>=2)
     {if(z_p.starts_with_b(s_si,"#"))
        {if('T'==z_mt_p.program_c)
            if(0==z_p.sw_cgi){z_p.err_s="not use (data name time-job #..) \""+s_si+"\"";z_p.t_v(z_p.SE,"w_set_name_b)4");return false;}
         w_data_n=z_mt_p.common_set_data_n(s_si,"");w_kind_s="COMMON";w_name_top_s="#";//VER20.1
         z_p.console_write_v(s_si);
         z_p.t_v(z_p.SE,"w_set_name_b)5");
         return true;
        }
      if(z_p.starts_with_b(s_si,"%"))
        {z_mt_p.get_name_add_b(z_p.da_sw_a,z_p.substring2_s(s_si,1));
         w_data_n=z_mt_p.get_name_data_n;w_kind_s="SW";w_name_top_s="%";
         z_p.t_v(z_p.SE,"w_set_name_b)6");
         return true;
        }
      if(z_p.starts_with_b(s_si,"!"))
        {if('T'==z_mt_p.program_c){z_p.err_s="not use (data name time-job !..)  \""+s_si+"\"";z_p.t_v(z_p.SE,"w_set_name_b)7");return false;}
         if(z_p.starts_with_b(z_mt_p.program_p.now_kind_s,"STOP")){z_p.err_s="not use (data name STOP.. !..) \""+s_si+"\"";z_p.t_v(z_p.SE,"w_set_name_b)8");return false;}
         w_data_n=z_p.at_da(z_p.da_common_a,1);((ii_data_l )w_data_n).name_s=s_si;w_kind_s="KEEP";
         z_p.t_v(z_p.SE,"w_set_name_b)9");
         return true;
        }
      if(z_p.starts_with_b(s_si,"@")){z_p.err_s="not set (data name @..) \""+s_si+"\"";z_p.t_v(z_p.SE,"w_set_name_b)10");return false;}
     }
  } 
z_p.err_s="not found (data name) \""+s_si+"\"";
z_p.t_v(z_p.SE,"w_set_name_b)11");
return false;
}
//----------------------------------------------
readonly int SKIP_LOOP_1=1,LOOP_2=2,COUNTER_SET_3=3,COUNTER_NOT_SET_4=4,IF_NOT_CHECK_5=5,SERVER_PROG_6=6
,SQL_NEXT_8=8
,CHECK_RC_10=10
,ERROR_OPT1_NULL_11=11,ERROR_OPT2_NULL_12=12,ERROR_OPT3_NULL_13=13,ERROR_OPT4_NULL_14=14,ERROR_OPT5_NULL_15=15
,CONTINUE_17=17
,ABORT_SET_18=18,ABORT_PROGRAM_19=19,ABORT_CMD_20=20,ABORT_TABLE_SPACE_21=21
,ABORT_OBJECT_SPACE_22=22,ABORT_MENU_23=23,ABORT_24=24,ABORT2_25=25,ERR_26=26,ERR_ERR_27=27
,RETURN1_28=28,RETURN0_29=29,RETURN_RETURN_30=30;
int sw_error,sw_set,rc;
int sw;//プログラムの制御用スイッチ。
String error_s,property_s,set_s;
ii_zz_l w1_s_n;ii_zz_l w2_s_n;ii_zz_l w3_s_n;ii_zz_l w_type_c_n;
bool sw_continue_b,sw_ok_password_b;
char[]  type_cx=new char[2];//CPP対応空白２個。
String public_link_s="",object_s="",lnk_s="",alias_s="";
//====( コンマ区切りで分割し\nと\rを取り前後の空白を取る　)***
String[] opt1_sx;
public int  section(int prog_i){return section("?",(z_p.at_da(z_mt_p.program_p.da_now_ap,z_mt_p.program_p.now_cnt)),prog_i);}
//----------------------------------------------
String in_kind_s;
ii_data_l in_data_n;
String add_ot_s="",w_u_s="",encode_s=""; 
//----( shift_comma_s )------------------------------------------
String shift_comma_s(String si,int ii)
{z_p.t_v(z_p.SE,"shift_comma_s(");
int begin=-1,end=z_p.length(si)-1;
for(;0<ii;ii--)if(-1==(begin=z_p.index3c_i(si,',',begin+1)))return "";
for(begin++;begin<z_p.length(si);begin++)if(!z_p.e4c_b(z_p.at_s_c(si,begin),' ','\n','\r'))break;
for(;0<end;end--)if(!z_p.e4c_b(z_p.at_s_c(si,end),' ','\n','\r'))break;
return z_p.substring3_s(si,begin,end-begin+1);
} 
//--( opt1_sx )--------------------------------------------
void opt1_sx_v() //カンマ区切りをopt1_sxに設定。
{z_p.t_v(z_p.SE,"opt1_sx_v(");
opt1_sx=z_p.split_sx(opt1_s,',');//opt1_sx設定
 for(int i=0;i<z_p.count_sx_i(opt1_sx);i++)opt1_sx[i]=z_p.trim_s(z_p.replace_rn_s(opt1_sx[i],' '));//opt1_sxの\n,\trを取り前後の空白も取る。
}
//====***( section )****************************************
public int section(String kind_si,ii_data_l data_ni,int prog_i)
{z_p.t_v(z_p.SE,"section(");
in_kind_s=kind_si;in_data_n=data_ni;
//###(new)###
List<String> s_sql_a=new List<String>();
List<String> s_w_a=new List<String>();
List<String> s_type_a=new List<String>();
List<String> s_tag_a=new List<String>();
List<int> i_tag_cnt_a=new List<int>();
//##########
bool sw_tag_b=false,sw_edit_word_b=false,rc_b;
int i=0,j=0,k=0,l=0,swl=0,swp=0,sql_cnt=0,sql_column_cnt=0
,sw_type=0,ii=0,i01;
String values_s="",name_s="",org_s="",file_s="",path_s=""
,sql_s="",sep_s="";
String[] name_sx;int sw_skip=CONTINUE_NORMAL_0;
type_cx[0]=' ';type_cx[1]=' ';  
rc=0;sw_set=0;sw_error=0;error_s="";property_s="";set_s="";sw_ok_password_b=false;
for(i=1;i<8;i++){z_mt_p.program_p.text_sx[i]="";z_mt_p.program_p.opt_org_sx[i]="";}
z_p.prog_n.i=prog_i;//開始位置を変更可能とする。
ii_zz_l w_s_n=new ii_zz_l();
prog_cmd=0;
if     (z_p.e2s_b(in_kind_s,"CLICK"))org_s=in_data_n.click_s;//CLICK=をorgにセット。
else if(z_p.e2s_b(in_kind_s,"INPUT"))org_s=in_data_n.input_s;//INPUT=をorgにセット。
else org_s=in_data_n.section1_s+in_data_n.section2_s;          //セクションをorgにセット。
if(z_p.e2s_b(org_s,""))sw=RETURN0_29; //プログラム空白は正常終了。
else
  {counter=1;sw_counter_b=true;(z_p.at_da(z_p.da_common_a,0)).data_s="1";//カウンターを初期値1に設定。
   sw=COUNTER_SET_3;//カウンターを設定指示。
  } 
/////------------------------------------------------------------------
int sw_sql=0; // SQL関連を１にするとSQLエラー表示。//VER24.1
for(;CONTINUE_17>=sw;)//CONTINUE_17(17)>=swの場合のみ繰り返す。（ABORT及びRETUEN指示は実行しない）
  {z_p.t_v(z_p.SE2,"section(for(sw="+z_p.to_i_s(sw));
   sw_continue_b=false;//内部のfor内でcontinueが必要な時はtrueにする。
   if(SKIP_LOOP_1>=sw){z_mt_p.trace_v(0,":(skip)");sw_skip=SKIP_NORMAL_1;}//スキップ指示。
   if(LOOP_2>=sw)
     {if(sw_counter_b)
        {counter=z_p.to_int_check((z_p.at_da(z_p.da_common_a,0)).data_s,'+',1,0);//カウンター変更有りはカウンター設定
        }
     }//if(LOOP_2>=sw)
   if(COUNTER_SET_3>=sw)//(3)カウンター値で$-,$$,$+を設定。
     {if(sw_counter_b)
        {sw_counter_b=false;
         counter_len_0=z_p.length(z_p.to_i_s(counter));
         counter_len_m=z_p.length(z_p.to_i_s(counter-1));
         counter_len_p=z_p.length(z_p.to_i_s(counter+1));
         if(0!=z_p.prog_n.i&&(counter_len_0!=counter_len_old_0||counter_len_m!=counter_len_old_m
            ||counter_len_p!=counter_len_old_p))
             {for(k=j=i=0;j<z_p.prog_n.i;i++,j++,k++) //現在位置補正
                 if('$'==z_p.at_s_c(org_s,i)&&(i+1)<z_p.length(org_s))
                   {if     ('$'==z_p.at_s_c(org_s,i+1)){i+=1;j+=counter_len_old_0-1;k+=counter_len_0-1;}
                    else if('-'==z_p.at_s_c(org_s,i+1)){i+=1;j+=counter_len_old_m-1;k+=counter_len_m-1;}
                    else if('+'==z_p.at_s_c(org_s,i+1)){i+=1;j+=counter_len_old_p-1;k+=counter_len_p-1;}
                   }
              z_p.prog_n.i=k;sw_tag_b=false;
             }
         z_p.prog_s_n.s=z_p.replace_s_s(z_p.replace_s_s(z_p.replace_s_s(org_s,"$$",z_p.to_i_s(counter)),"$-",z_p.to_i_s(counter-1)),"$+",z_p.to_i_s(counter+1));
         counter_len_old_0=counter_len_0;counter_len_old_m=counter_len_m;counter_len_old_p=counter_len_p;
        }
     }//if(COUNTER_SET_3>=sw)
   if(COUNTER_NOT_SET_4>=sw)//(4)カウンター値設定不要以下は次の命令をを解析。
     {sw_sql=0; // SQL関連を１にするとSQLエラー表示。//VER24.1
      if(!sw_tag_b)
        {i=z_p.prog_n.i;
         z_p.clear_s_v(s_tag_a);z_p.clear_i_v(i_tag_cnt_a);
         for(z_p.prog_n.i=0;z_p.prog_word_b(w_cmd_s_n,"{}:;*");)
           {if(':'==z_p.prog_c_n.c)
              {if(!z_p.e2s_b(w_cmd_s_n.s,""))
                  {j=z_p.last_index2c_i(w_cmd_s_n.s,(char )0X0A); //VER18.1
                   w_cmd_s_n.s=z_p.trim_s(z_p.substring2_s(w_cmd_s_n.s,j+1)); // LFが有る場合はその前を無視。//VER18.1
                   z_mt_p.edit_b(w_cmd_s_n,w_cmd_s_n.s);//VER18.1名札も?名前?を編集。
                   z_p.add_s(s_tag_a,z_p.upper_s(w_cmd_s_n.s));z_p.add_i(i_tag_cnt_a,z_p.prog_n.i);
                  }
               else{z_p.err_s="tag is null(:"+z_p.substring3_s(z_p.prog_s_n.s,z_p.prog_n.i,25)+")";
                     sw=ABORT_24;sw_continue_b=true;break;
                   } //VER11.0 で無視。 /VER15.1で復活。
              }
            if('{'==z_p.prog_c_n.c)z_p.prog_word_b(w_cmd_s_n,"}");//｛｝内は無視。
           }
         if(true==sw_continue_b)continue;//for()内でcontine指示有りに対応。
         z_p.err_s="";//エラーメッセージクリアー
         sw_tag_b=true;
         z_p.prog_n.i=i;
        }
      prog_cmd=z_p.prog_n.i;
      if(!z_p.prog_word_b(w_cmd_s_n,"{:;*")) //コマンド設定
        {if(z_p.e3s_b(w_cmd_s_n.s,"",z_p.new_line_s())){sw=RETURN0_29;continue;}//コマンド空白か改行は
         else {sw=ABORT_CMD_20;continue;}//コマンド発見できずはエラー
        }
      w_cmd_s_n.s=z_p.upper_s(w_cmd_s_n.s);//コマンド大文字化。
      sw_continue=0;                                                          //VER15.1
      sw_if_error=z_mt_p.program_p.CONTROL_IX[z_mt_p.program_p.C_IF_ERROR_7];   //VER17　セミコロン判定方法設定。
      if(z_p.e3c_b(z_p.prog_c_n.c,':','*')){sw=LOOP_2;continue;}//タグ：又はコメント*は続行。
      if(';'==z_p.prog_c_n.c)
        {cnt_back_null=z_p.prog_n.i;  //VER17 back{}先キープ。
         if(1==sw_jump_null)sw_jump_null=0;   //VER17 jump{}の一件目の;は無視
         else if(z_p.e3i_b(sw_skip,CONTINUE_IF_M1,SKIP_IF_2)) //IF...に一致命令無はエラー
           {z_p.err_s="find \";\" (IF...{...})";sw=ABORT_24;continue;}
         else if(z_p.e2i_b(sw_skip,IF_ERROR_3))   //VER17//IF_ERROR...に一致命令無はエラー
                 if(0==z_mt_p.program_p.CONTROL_IX[z_mt_p.program_p.C_ERROR_5]){sw=ABORT_24;continue;} //VER17
                 else {sw=ERR_26;continue;}                                                          //VER17
         else sw_skip=CONTINUE_NORMAL_0; //セミコロン発見でスキップ中止。
        }
      if(z_p.e2i_b(sw_skip,IF_ERROR_3))sw_skip=CONTINUE_NORMAL_0;  //VER17　IF_ERROR判定終了。
      if('{'!=z_p.prog_c_n.c)
        {if(z_p.e3s_b(w_cmd_s_n.s,"","\n")){sw=LOOP_2;continue;}//空白か改行は無視。
         else {z_p.err_s=w_cmd_s_n.s;sw=ABORT_24;continue;}
        }
      if(z_p.e2s_b(w_cmd_s_n.s,""))
        {z_p.err_s="command is space {"+z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i);sw=ABORT_24;continue;}
      if      (CONTINUE_IF_M1==sw_skip)sw_skip=CONTINUE_NORMAL_0;// IF...に命令存在。
      else if (    SKIP_IF_2==sw_skip)sw_skip=    SKIP_NORMAL_1;// IF...に命令存在。
      if(z_mt_p.program_p.sw_text_b)
      for(ii=1;ii<8;ii++){z_mt_p.program_p.text_sx[ii]=z_mt_p.program_p.opt_org_sx[ii];}
      rc_b=prog_edit1_b(z_p.e4s_b(w_cmd_s_n.s,"HEAD","BODY","BODY_FORM")); //VER18.1//VER20.1
      opt1_s=w_prog_edit_s_n.s;z_mt_p.program_p.opt_org_sx[1]=w_prog_edit_org_s_n.s;
      z_p.err21_s=w_cmd_s_n.s+"{"+(z_p.e2s_b(w_prog_edit_s_n.s,"")?w_prog_edit_org_s_n.s:w_prog_edit_s_n.s)+"}";//VER18.1//コマンドをエラー表示の為記憶。
      if(!rc_b)if(CONTINUE_NORMAL_0==sw_skip){sw=ABORT_24;continue;} //VER18.1//プログラム編集エラーはHEAD,BODY以外エラーとする。
      if(!z_p.e4s_b(w_cmd_s_n.s,"ERROR","BACK","JUMP")&&!z_p.ends_with_b(w_cmd_s_n.s,"_CLOSE"))
         z_p.err11_s=w_cmd_s_n.s+"{"+w_prog_edit_org_s_n.s+"}";//コマンドをエラー表示の為記憶。
      if(CONTINUE_NORMAL_0==sw_skip)z_mt_p.trace_v(0,"="+w_cmd_s_n.s+"{"+z_p.replace_rn_s(opt1_s,' ')+"}");
      cmd2_s=w_cmd_s_n.s;
      if(11<z_p.length(cmd2_s)&&z_p.starts_with_b(cmd2_s,"RESTORE_DB_"))  //VER18.1  
        {z_mt_p.restore_db_s=z_mt_p.program_p.restore_db_s;cmd2_s=z_p.substring2_s(cmd2_s,11);}
      if(9<z_p.length(cmd2_s)&&z_p.starts_with_b(cmd2_s,"IF_ERROR_")//VER17
         &&!z_p.starts_with_b(cmd2_s,"IF_ERROR_IF")   //VER17       
         &&!z_p.ends_with_b(cmd2_s,"_NEXT") //VER17
        ){sw_if_error=1;cmd2_s=z_p.substring2_s(cmd2_s,9);                   //VER17
         }                                                                     //VER17
      else 
      if(9<z_p.length(cmd2_s)&&z_p.starts_with_b(cmd2_s,"CONTINUE_"))   //VER15.1
        {sw_continue=1;cmd2_s=z_p.substring2_s(cmd2_s,9);                   //VER15.1
        }                                                                     //VER15.1
      if(4<z_p.length(cmd2_s)&&z_p.starts_with_b(cmd2_s,"DBO_"))  
        {if(z_p.e2s_b(z_p.menu_kind_s,"OUTPUT")){z_p.err_s="BAD DBO_...(MENU_KIND='OUTPUT')";sw=ABORT_24;continue;}//VER25.1
         if(z_p.e2s_b(z_p.menu_security_s,"X")) {z_p.err_s="BAD DBO_...(MENU_SECURITY='X')";sw=ABORT_24;continue;}//VER25.1
         usr_s="DBO";cmd2_s=z_p.substring2_s(cmd2_s,4);
         if(!z_mt_p.menu_check_b(cmd2_s+"{")){sw=ABORT_24;continue;}
        }
      else if(6<z_p.length(cmd2_s)&&z_p.starts_with_b(cmd2_s,"LOGIN_"))
          {usr_s="LOGIN";cmd2_s=z_p.substring2_s(cmd2_s,6);
           if(!z_mt_p.menu_check_b(cmd2_s+"{")){sw=ABORT_24;continue;}
          }
      else if(4<z_p.length(cmd2_s)&&z_p.starts_with_b(cmd2_s,"OUT_"))
          {usr_s="OUT";cmd2_s=z_p.substring2_s(cmd2_s,4);
           if(!z_mt_p.menu_check_b(cmd2_s+"{")){sw=ABORT_24;continue;}
          }
      else {usr_s=z_p.inp_out_s;} ////cmd2_s=w_cmd_s_n.s;////
      if(z_p.e2s_b(cmd2_s,"")){z_p.err_s="command is null"+z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i);sw=ABORT_24;continue;}
      //====*******( オプション1個 )**********
      rc=0;i01=1;sql_cnt=2;//初期値設定
      z_mt_p.program_p.sw_text_b=true;
      String s=cmd2_s;
      if(z_p.e2s_b(s,"SET"))
           {z_mt_p.program_p.sw_text_b=false;
            if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
            if(!set_set_b(true))continue;
           } 
      else if(z_p.e3s_b(s,"IF","IF_NOT"))
            {z_mt_p.program_p.sw_text_b=false;
             if(CONTINUE_NORMAL_0!=sw_skip){sw_skip=SKIP_IF_2;sw=LOOP_2;continue;}//スキップ指示中は処理せず。 
             sw_edit_word_b=false;
              if(z_p.length(edit_s)>(edit+2)&&'!'==z_p.at_s_c(edit_s,edit)&&!(z_p.e4c_b(z_p.at_s_c(edit_s,edit+1),'=','/','%')))  //VER22 
               {edit++;sw_edit_word_b=true;}// !先頭データ名対応 
     
            if(!edit_word_b(w_s_n,"=><!/%")){sw=ABORT_24;continue;}
             if(sw_edit_word_b)w_s_n.s="!"+w_s_n.s;
             int IF1=1,IF2=2;
             for(int sw2=0;;)//-----------------------for(;;)<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
               {if(IF1>=sw2)
                  {if(!get_data_b(w1_s_n,w_type_c_n,w_s_n.s)){sw=ABORT_24;sw_continue_b=true;break;} 
                   type_cx[0]=w_type_c_n.c;//左タイプ設定。
                  sw_type=0;//初期比較タイプ左タイプを使用。
                   if(z_p.length(w_s_n.s)>1)
                      {if('$'==z_p.at_s_c(w_s_n.s,0))j=1;else j=0;
                       if(z_p.e4c_b(z_p.at_s_c(w_s_n.s,j),'#','!','@'))sw_type=1;//比較タイプ右タイプに変更。
                      }
                  }//if(IF1>=sw2) 
                int sw_great=0;int sw_e=0;int sw_less=0;String head_tail_s="";
                if('!'==edit_c)
                   if     (edit_left_b("<")){sw_great=sw_e=1;}
                   else if(edit_left_b(">")){sw_e=sw_less=1;}
                   else if(edit_left_b("=")){sw_great=sw_less=1;}
                   else if(edit_left_b("/")){head_tail_s="/";}
                   else if(edit_left_b("%")){head_tail_s="%";}
                   else {sw=ABORT_24;sw_continue_b=true;break;}
                else
                  if     ('='==edit_c)sw_e=1;
                  else if('/'==edit_c){sw_e=1;head_tail_s="/";}
                  else if('%'==edit_c){sw_e=1;head_tail_s="%";}
                  else if('<'==edit_c){sw_less=1;if(edit_left_b(">"))sw_great=1;
                                       else      if(edit_left_b("="))sw_e=1;
                                      }
                  else                {sw_great=1;if(edit_left_b("<"))sw_less=1;
                                       else       if(edit_left_b("="))sw_e=1;
                                      }
               if(!edit_word_b(w_s_n,",}")){sw=ABORT_24;sw_continue_b=true;break;}
               if(!get_data_b(w2_s_n,w_type_c_n,w_s_n.s)){sw=ABORT_24;sw_continue_b=true;break;}
               type_cx[1]=w_type_c_n.c;//右タイプ設定。
               if(z_p.e2s_b(head_tail_s,""))
                 {ii_zz_l zz_p=new ii_zz_l();zz_p.s=w3_s_n.s;
                  rc=z_p.compare(zz_p,w1_s_n.s,type_cx[sw_type],sw_great,sw_e,sw_less,w2_s_n.s);//比較処理
                  w3_s_n.s=zz_p.s;
                 } 
               else
                 {if(z_p.e2s_b(head_tail_s,"/"))if(z_p.starts_with_b(w1_s_n.s,w2_s_n.s))rc=0;else rc=1;//前方一致比較
                  else                if(z_p.ends_with_b(w1_s_n.s,w2_s_n.s))  rc=0;else rc=1;//後方一致比較
                  if(0==sw_e){if(0==rc)rc=1;else rc=0;}//!有りは反転。
                  w3_s_n.s=(0==sw_e?"!":"")+head_tail_s; 
                 }
               z_mt_p.trace_v(0,":("+z_p.to_c_s(type_cx[sw_type])+")\""+w1_s_n.s+"\""+w3_s_n.s+"\""
                         +w2_s_n.s+"\"");  //VER 15.1で修正。
               if(0==rc){sw_skip=CONTINUE_IF_M1;sw=IF_NOT_CHECK_5;sw_continue_b=true;break;}//一致したので判定中止しスキップ無し指示で次へ行く
               else if(9==rc){sw=ABORT_24;sw_continue_b=true;break;} 
               if('}'==edit_c){sw_skip=SKIP_IF_2;sw=IF_NOT_CHECK_5;sw_continue_b=true;break;}//全て判定済みで一致無しでスキップ指示で次に行く。
               sw_edit_word_b=false;
               if(z_p.length(edit_s)>(edit+2)&&'!'==z_p.at_s_c(edit_s,edit)&&!(z_p.e4c_b(z_p.at_s_c(edit_s,edit+1),'=','/','%'))) // VER22
                 {edit++;sw_edit_word_b=true;}// !先頭データ名対応 
               if(!edit_word_b(w_s_n,"=><!/%")){sw=ABORT_24;sw_continue_b=true;break;}
               if(sw_edit_word_b)w_s_n.s="!"+w_s_n.s;
               if(!z_p.e2s_b(w_s_n.s,""))sw2=IF1;
               else                        sw2=IF2;
               }//for(;;)
             if(true==sw_continue_b)continue;//for()内で設定された場合の処置。
                
            }
     else if(z_p.e2s_b(s,"JUMP"))
         { z_mt_p.program_p.sw_text_b=false;
            if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
            if(z_p.e2s_b(opt1_s,"")){sw=SKIP_LOOP_1;sw_jump_null=1;continue;}//VER17
            opt1_s=z_p.upper_s(opt1_s);
            for(i=0;z_p.count_s_i(s_tag_a)>i;i++)
               if(z_p.e2s_b(opt1_s,z_p.at_s(s_tag_a,i))&&z_p.at_i(i_tag_cnt_a,i)>z_p.prog_n.i)
                 {z_p.prog_n.i=z_p.at_i(i_tag_cnt_a,i);sw=LOOP_2;sw_continue_b=true;break;}
            if(true==sw_continue_b)continue;//for()内で設定された場合の処置。
            z_p.err_s="not found (tag) \""+opt1_s+":\"";sw=CHECK_RC_10;rc=1;continue;////VER24.1
         }
     else if(z_p.e2s_b(s,"BACK"))
         {  z_mt_p.program_p.sw_text_b=false;
            if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
            if(z_p.e2s_b(opt1_s,"")){sw=LOOP_2;z_p.prog_n.i=cnt_back_null;continue;}  //VER17 back{}は前方の;まで移動。
            opt1_s=z_p.upper_s(opt1_s);
            for(i=z_p.count_s_i(s_tag_a)-1;0<=i;i--)
              if(z_p.e2s_b(opt1_s,z_p.at_s(s_tag_a,i))&&z_p.at_i(i_tag_cnt_a,i)<z_p.prog_n.i)
                {z_p.prog_n.i=z_p.at_i(i_tag_cnt_a,i);sw=LOOP_2;sw_continue_b=true;break;}
            if(true==sw_continue_b)continue;//for()内で設定された場合の処置。
            z_p.err_s="not found (tag) \""+opt1_s+":\"";sw=CHECK_RC_10;rc=1;continue;//VER24.1
         }
     else if(z_p.e2s_b(s,"COMPUTE"))
         {  z_mt_p.program_p.sw_text_b=false;
            if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
            rc=compute(0);sw=CHECK_RC_10;continue; 
         }
     else if(z_p.e2s_b(s,"COMPUTE_CUT"))
         {   z_mt_p.program_p.sw_text_b=false;
            if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中　 
            rc=compute(1);sw=CHECK_RC_10;continue; 
         }
     else if(z_p.e2s_b(s,"EXIT"))
         {  z_mt_p.program_p.sw_text_b=false;
            if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中　 
            if(z_p.e2s_b(opt1_s,"")){sw=RETURN0_29;continue;} //セクション終了
            opt1_s=z_p.upper_s(opt1_s);
            if(z_p.e2s_b(opt1_s,"_END")){z_p.sw_program=z_p.count_pr_i(z_mt_p.program_list_n.pr_a)-1;sw=RETURN0_29;continue;};//ジョブ終了 
            if(z_p.e3c_b(z_p.at_s_c(opt1_s,0),'-','+'))i=1;else i=0;
            i=z_p.to_int_check(z_p.substring2_s(opt1_s,i),'+',0,0);
            if(z_p.return_b)
              {if('+'==z_p.at_s_c(opt1_s,0))
                  if(1!=i){z_p.err_s="bad number \"EXIT{"+z_p.to_i_s(i)+"}\"";sw=ABORT_24;continue;}//{+1}以外エラー。
                  else{if(!z_p.e2s_b(in_kind_s,"?")){z_p.err_s="not use ("+in_kind_s+") \"EXIT{+1}\"";sw=ABORT_24;continue;}
                       if(z_p.e3s_b(z_mt_p.program_p.now_kind_s,"END","SQL"))
                         {z_p.err_s="not use ("+z_mt_p.program_p.now_kind_s+") \"EXIT{+1};\"";sw=ABORT_24;continue;}
                          z_p.sw_program=-2;//次のプログラムへの指示
                          sw=RETURN0_29;continue;//次のプログラムへ行く
                      }
                  else if('-'==z_p.at_s_c(opt1_s,0))
                         {z_p.sw_program=z_p.count_pr_i(z_mt_p.program_list_n.pr_a)-i;if(0>z_p.sw_program)z_p.sw_program=0;}//EXIT{-数};の場合は数分戻る。
                       else if(i>z_p.count_pr_i(z_mt_p.program_list_n.pr_a))//EXIT{数];の数が現在処理番号より大きい場合はエラー。
                              {z_p.err_s="orver \"EXIT["+z_p.to_i_s(i)+"]\">"+z_p.to_i_s(z_p.count_pr_i(z_mt_p.program_list_n.pr_a));sw=ABORT_24;continue;} 
                       else z_p.sw_program=i; //EXIT{数];で数の番号へ戻る。
               sw=RETURN0_29;continue;//該当プログラム番号へ行く
              }  
            if(!z_mt_p.program_p.exit_b(opt1_s,cmd2_s)){sw=ABORT_24;continue;}//EXIT{数};の数の部分が数字に変換できない場合は該当データに行く。
            z_mt_p.sw_exit=1;//EXIT{データ名};有効化。
           sw=RETURN0_29;continue; //該当データに行く 
         }
     else if(z_p.e3s_b(s,"EXIT2","EXIT3"))
         {  z_mt_p.program_p.sw_text_b=false;
            if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
            opt1_s=z_p.upper_s(opt1_s);
            if(z_p.e2s_b(opt1_s,""))//空白は次の項目の意味。
              {if((z_mt_p.program_p.now_cnt+1)<z_p.count_da_i(z_mt_p.program_p.da_now_ap)
                  &&z_p.e3s_b(z_mt_p.program_p.now_kind_s,"DATA","SET"))
                  z_mt_p.program_p.exit_cnt=z_mt_p.program_p.now_cnt+1;//次の項目に移動指示。//VER14.1
               else {z_p.err_s="bad (last data) ("+cmd2_s+"{})";sw=ABORT_24;continue;}//最後の項目はエラー。
              }
            else if(!z_mt_p.program_p.exit_b(opt1_s,cmd2_s)){sw=ABORT_24;continue;}//exit_cnt設定。データ名有効か判定。
            if(z_p.e3c_b((z_p.at_da(z_mt_p.program_p.da_now_ap,z_mt_p.program_p.exit_cnt)).mark2_c,'O','N'))
              {z_p.err_s="bad (mark2 in('O','N')["+(z_p.at_da(z_mt_p.program_p.da_now_ap,z_mt_p.program_p.exit_cnt)).name_s+"]";
               sw=ABORT_24;continue;
              }//mark2 がOかNはエラー。
            z_mt_p.sw_exit=(z_p.e2s_b(cmd2_s,"EXIT2")?2:3);//EXIT?{データ名};有効化。
            sw=RETURN0_29;continue;//該当データに行く
         }
     else if(z_p.e2s_b(s,"SQL"))
         {  if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
            if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
            rc=z_mt_p.sql_n.sql_usr2(opt1_s,usr_s);
            z_p.sql_count_123=z_p.db_affected_cnt;
            sw_sql=1;sw=CHECK_RC_10;continue;
         }
     else if(z_p.e3s_b(s,"SQL1","SQL2"))
         {if(z_p.e2s_b(s,"SQL1"))sql_cnt=1;
          if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
          if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
          s_sql_a=(1==sql_cnt?z_mt_p.program_p.s_sql1_a:z_mt_p.program_p.s_sql2_a);
          z_mt_p.program_p.sw_sql_ix[sql_cnt]=1;
          z_p.sql_limit=z_mt_p.program_p.sql_limit_org;z_mt_p.program_p.sql_limit_org=0; 
          z_mt_p.program_p.sql_cnt_ix[sql_cnt]=0;
          rc=z_mt_p.sql_n.sql_usr3(s_sql_a,opt1_s,usr_s);
          z_mt_p.program_p.sql_record_cnt_ix[sql_cnt]=z_p.db_record_cnt;
          z_mt_p.program_p.sql_column_cnt_ix[sql_cnt]=z_p.db_column_cnt;
          sw=CHECK_RC_10;continue;
         } 
     else if(z_p.e2s_b(s,"SQL1_MENU"))
         {  sql_cnt=1;
            if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
            if(z_p.e2s_b(z_p.substring3_s(z_p.job_s,4,2),"00"))
              {w1_s_n.s="1";w2_s_n.s="<='"+opt1_s+"' AND SYSTEM_MENU2='00' AND SYSTEM_MENU3='00'";}
            else if(z_p.e2s_b(z_p.substring3_s(z_p.job_s,6,2),"00"))
                     {w1_s_n.s="2";w2_s_n.s="='"+z_p.substring3_s(z_p.job_s,4,2)+"' AND SYSTEM_MENU2<='"+opt1_s+"' AND SYSTEM_MENU3='00'";}
                 else{w1_s_n.s="3";w2_s_n.s="='"+z_p.substring3_s(z_p.job_s,4,2)+"' AND SYSTEM_MENU2 in('00','"
                      +z_p.substring3_s(z_p.job_s,6,2)+"') AND SYSTEM_MENU3<='"+opt1_s+"'";
                     }
           if('H'!=z_p.db_c)
              w3_s_n.s="SELECT SYSTEM_MENU"+w1_s_n.s+",SYSTEM_MENU1,SYSTEM_MENU2,SYSTEM_MENU3,SYSTEM_MENU,SYSTEM_SECURITY,"
              +(z_p.e2s_b(z_p.person_security_s,"")?"'='":"CASE WHEN SYSTEM_SECURITY IN('X',' ') OR "
              +z_p.DUMMY_S+"('"+z_p.person_security_s+"'='ADMIN' OR " +z_p.DUMMY_S+"SYSTEM_SECURITY='P' AND '"+z_p.person_security_s
              +"'='PERSON') AND SYSTEM_PERMISSION IN('ZZZZ','"+z_p.person_permission_s
              +"') OR (EXISTS (SELECT 'A' FROM "+z_mt_p.sql_n.m_real_dbo_zzzzzz_s()
              +"_I_SECURITY_J_TABLE X2 WHERE "+z_mt_p.db_n.cl_s+"SYSTEM_MENU0"+z_mt_p.db_n.c_s+"SYSTEM_MENU1"
              +z_mt_p.db_n.c_s+"SYSTEM_MENU2"+z_mt_p.db_n.c_s+"SYSTEM_MENU3=SYSTEM_JOB"+z_mt_p.db_n.cr_s
              +" AND SYSTEM_PERSON='"+z_p.person_s+"' AND X2.Z_CANCEL=' ' "
              +"AND (SYSTEM_END_DATE=' ' OR SYSTEM_END_DATE>="+z_mt_p.db_n.now8_s+") " 
              +z_p.DUMMY_S+"AND (SYSTEM_BEGIN_DATE=' ' OR SYSTEM_BEGIN_DATE<="+z_mt_p.db_n.now8_s+")) "
              +z_p.DUMMY_S+"OR EXISTS (SELECT 'A' FROM "+z_mt_p.sql_n.m_real_dbo_zzzzzz_s()+"_I_SECURITY_G_J_TABLE X2 WHERE "
              +z_mt_p.db_n.cl_s+"SYSTEM_MENU0"+z_mt_p.db_n.c_s+"SYSTEM_MENU1"+z_mt_p.db_n.c_s+"SYSTEM_MENU2"+z_mt_p.db_n.c_s
              +"SYSTEM_MENU3"+z_mt_p.db_n.cr_s+"=SYSTEM_JOB  AND X2.Z_CANCEL=' ' AND EXISTS (SELECT 'A' FROM "
              +z_mt_p.sql_n.m_real_dbo_zzzzzz_s()+"_I_SECURITY_G_TABLE X3 WHERE "
              +z_p.DUMMY_S+"X3.SYSTEM_GROUP=X2.SYSTEM_GROUP AND X3.SYSTEM_PERSON='"+z_p.person_s+"' AND X3.Z_CANCEL=' ' "
              +z_p.DUMMY_S+"AND (SYSTEM_END_DATE=' ' OR SYSTEM_END_DATE>="+z_mt_p.db_n.now8_s+") " 
              +z_p.DUMMY_S+"AND (SYSTEM_BEGIN_DATE=' ' OR SYSTEM_BEGIN_DATE<="+z_mt_p.db_n.now8_s+")))) THEN '-' "
              +z_p.DUMMY_S+(z_p.e2s_b(z_p.test_s,"REAL")||z_p.e2s_b(z_p.person_security_s,"GUEST")?"":"WHEN ('"+z_p.person_permission_s
              +"' IN ('ZZZZ',SYSTEM_PERMISSION) OR SYSTEM_PERMISSION IN('ZZZZ','"
              +z_p.person_permission_s+"')) AND ('A'<>SYSTEM_SECURITY OR 'ADMIN'='"+z_p.person_security_s
              +"') THEN '+' ")+"ELSE '*' END")
              +z_p.DUMMY_S+" FROM "+z_mt_p.sql_n.m_real_dbo_zzzzzz_s()+"_I_MENU_TABLE X1 WHERE SYSTEM_LANG='"
              +z_p.lang_s+"' AND (SYSTEM_MENU0='"+z_p.substring3_s(z_p.job_s,0,4)+"' AND (SYSTEM_MENU1"+w2_s_n.s
              +" OR SYSTEM_MENU1='00' AND SYSTEM_MENU2='00') OR SYSTEM_MENU0='"+z_p.substring3_s(z_p.job_s,0,4)
              +"' AND SYSTEM_MENU1='00' AND SYSTEM_MENU2='00' AND SYSTEM_MENU3 IN('98','99'))"
              +z_p.DUMMY_S+" AND SYSTEM_TEST IN(' '"+z_p.DUMMY_S+(z_p.e2s_b(z_p.test_s,"REAL")?"":",'TEST'")+") AND Z_CANCEL=' ' ORDER BY 2,3,4";
             else
              w3_s_n.s="SELECT SYSTEM_MENU"+w1_s_n.s+",SYSTEM_MENU1,SYSTEM_MENU2,SYSTEM_MENU3,SYSTEM_MENU,SYSTEM_SECURITY,"
              +z_p.DUMMY_S+(z_p.e2s_b(z_p.person_security_s,"")?"'='":"CASE WHEN SYSTEM_SECURITY IN('X',' ') OR "
              +z_p.DUMMY_S+"('"+z_p.person_security_s+"'='ADMIN' OR " +"SYSTEM_SECURITY='P' AND '"+z_p.person_security_s
              +"'='PERSON') AND SYSTEM_PERMISSION IN('ZZZZ','"+z_p.person_permission_s
              +"') OR X2.SYSTEM_JOB IS NOT NULL"

              +z_p.DUMMY_S+" OR X3.SYSTEM_JOB IS NOT NULL"
              +z_p.DUMMY_S+" THEN '-' "
              +(z_p.e2s_b(z_p.test_s,"REAL")||z_p.e2s_b(z_p.person_security_s,"GUEST")?"":"WHEN ('"+z_p.person_permission_s
              +"' IN ('ZZZZ',SYSTEM_PERMISSION) OR SYSTEM_PERMISSION IN('ZZZZ','"
              +z_p.person_permission_s+"')) AND ('A'<>SYSTEM_SECURITY OR 'ADMIN'='"+z_p.person_security_s
              +"') THEN '+' ")+z_p.DUMMY_S+"ELSE '*' END")
              +" FROM "+z_mt_p.sql_n.m_real_dbo_zzzzzz_s()+"_I_MENU_TABLE X1"

            +z_p.DUMMY_S+" LEFT OUTER JOIN "+z_mt_p.sql_n.m_real_dbo_zzzzzz_s()+"_I_SECURITY_J_TABLE X2 ON "
            +z_mt_p.db_n.cl_s+"SYSTEM_MENU0"+z_mt_p.db_n.c_s+"SYSTEM_MENU1"+z_mt_p.db_n.c_s+"SYSTEM_MENU2"+z_mt_p.db_n.c_s
            +"SYSTEM_MENU3"+z_mt_p.db_n.cr_s+"=X2.SYSTEM_JOB AND X2.SYSTEM_PERSON='"+z_p.person_s+"' AND X2.Z_CANCEL=' ' "
            +"AND (X2.SYSTEM_END_DATE=' '   OR X2.SYSTEM_END_DATE  >="+z_mt_p.db_n.now8_s+") " 
            +z_p.DUMMY_S+"AND (X2.SYSTEM_BEGIN_DATE=' ' OR X2.SYSTEM_BEGIN_DATE<="+z_mt_p.db_n.now8_s+") "

            +z_p.DUMMY_S+" LEFT OUTER JOIN "+z_mt_p.sql_n.m_real_dbo_zzzzzz_s()+"_I_SECURITY_G_J_TABLE X3 ON "
            +z_mt_p.db_n.cl_s+"SYSTEM_MENU0"+z_mt_p.db_n.c_s+"SYSTEM_MENU1"+z_mt_p.db_n.c_s+"SYSTEM_MENU2"+z_mt_p.db_n.c_s
            +"SYSTEM_MENU3"+z_mt_p.db_n.cr_s+"=X3.SYSTEM_JOB  AND X3.Z_CANCEL=' ' AND EXISTS (SELECT 'A' FROM "
            +z_mt_p.sql_n.m_real_dbo_zzzzzz_s()+"_I_SECURITY_G_TABLE X4 WHERE "
            +"X4.SYSTEM_GROUP=X3.SYSTEM_GROUP AND X4.SYSTEM_PERSON='"+z_p.person_s+"' AND X4.Z_CANCEL=' ' "
            +z_p.DUMMY_S+"AND (X4.SYSTEM_END_DATE=' '   OR X4.SYSTEM_END_DATE>="+z_mt_p.db_n.now8_s+") " 
            +z_p.DUMMY_S+"AND (X4.SYSTEM_BEGIN_DATE=' ' OR X4.SYSTEM_BEGIN_DATE<="+z_mt_p.db_n.now8_s+")) "
 
            +z_p.DUMMY_S+" WHERE SYSTEM_LANG='"+z_p.lang_s+"' AND (SYSTEM_MENU0='"+z_p.substring3_s(z_p.job_s,0,4)+"' AND (SYSTEM_MENU1"+w2_s_n.s
            +" OR SYSTEM_MENU1='00' AND SYSTEM_MENU2='00') OR MENU0='"+z_p.substring3_s(z_p.job_s,0,4)
            +"' AND SYSTEM_MENU1='00' AND SYSTEM_MENU2='00' AND SYSTEM_MENU3 IN('98','99'))"
            +" AND SYSTEM_TEST IN(' '"+(z_p.e2s_b(z_p.test_s,"REAL")?"":",'TEST'")+") AND X1.Z_CANCEL=' ' ORDER BY 2,3,4";
            opt1_s=w3_s_n.s;
            s_sql_a=z_mt_p.program_p.s_sql1_a;
            z_mt_p.program_p.sw_sql_ix[sql_cnt]=1;
            z_mt_p.program_p.sql_cnt_ix[sql_cnt]=0;
            rc=z_mt_p.sql_n.sql_dbo_zzzz2(s_sql_a,opt1_s); 
            z_mt_p.program_p.sql_record_cnt_ix[sql_cnt]=z_p.db_record_cnt;
            z_mt_p.program_p.sql_column_cnt_ix[sql_cnt]=z_p.db_column_cnt;
            sw=CHECK_RC_10;continue;
         } 
     else if(z_p.e3s_b(s,"SQL1_FIRST","SQL2_FIRST"))
         {if(z_p.e2s_b(s,"SQL1_FIRST"))sql_cnt=1; 
          z_mt_p.program_p.sw_text_b=false;
          if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
          if(z_mt_p.program_p.sw_sql_ix[sql_cnt]!=1){sw=ABORT_24;z_p.err_s="not after (SQL"+z_p.to_i_s(sql_cnt)+")";continue;}//VER14.1
          z_mt_p.program_p.sql_cnt_ix[sql_cnt]=0;
          sw=CHECK_RC_10;continue;//VER17
         }
     else if(z_p.e3s_b(s,"SQL1_NEXT","SQL2_NEXT"))
         {if(z_p.e2s_b(s,"SQL1_NEXT"))sql_cnt=1; 
          if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
          if(z_mt_p.program_p.sw_sql_ix[sql_cnt]!=1){sw=ABORT_24;z_p.err_s="not after (SQL"+z_p.to_i_s(sql_cnt)+")";continue;}//VER14.1
          s_sql_a=(1==sql_cnt?z_mt_p.program_p.s_sql1_a:z_mt_p.program_p.s_sql2_a);
          sw=SQL_NEXT_8;continue;
         }
     else if(z_p.e2s_b(s,"DROP_TABLE"))
         {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
          if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
          opt1_s=z_p.trim_s(opt1_s);
          if(-1!=z_p.index2c_i(opt1_s,' ')||z_p.e2s_b(opt1_s,"")){sw=ABORT_TABLE_SPACE_21;continue;}
          rc=z_mt_p.sql_n.sql_usr2("DROP TABLE "+opt1_s+(z_p.e3c_b(z_p.db_c,'P','F')?" CASCADE":"")
                                               +('H'==z_p.db_c?" WITH PROGRAM":""),usr_s);
          if(z_p.e2s_b(z_p.db_i_error_s,"NOT_EXIST")){z_p.db_error_s="";rc=0;}
          sw_sql=1;sw=CHECK_RC_10;continue;
         }
     else if(z_p.e2s_b(s,"SLEEP"))
         {z_mt_p.program_p.sw_text_b=false;
          if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
          j=z_p.to_int_check(opt1_s,'+',0,0);if(!z_p.return_b){z_p.err_s="not numeric ("+opt1_s+")";sw=ABORT_24;continue;}
          z_p.sleep_v(j*1000);
          sw=CHECK_RC_10;continue;
         } 
     else if(z_p.e2s_b(s,"COMMAND"))
         {if('T'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;} 
          if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
          ii_zz_l s_n=new ii_zz_l();s_n.s=opt1_s;
            rc=z_p.command(z_p.replace_rn_s(s_n.s,' '));
          if(0!=rc&&""==z_p.err_s)z_p.err_s="error (COMMAND{"+s_n.s+"})";
#if IMENU
          if(z_p.e2s_b(z_p.main_program_s,"IMENU"))z_mt_p.imenu_p.repaint_v();
#endif //MENU
          sw=CHECK_RC_10;continue;
         } 
     else if(z_p.e2s_b(s,"DIR"))
         {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
          if(z_mt_p.program_p.dir_n.open_b(z_mt_p.get_tmp_or_same_file_s(opt1_s),'F'))rc=0;else rc=z_p.SW_ERROR_5;
          sw=CHECK_RC_10;continue;
         }
     else if(z_p.e2s_b(s,"DIR_DIR"))
         {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
          if(z_mt_p.program_p.dir_dir_n.open_b(z_mt_p.get_tmp_or_same_file_s(opt1_s),'D'))rc=0;else rc=z_p.SW_ERROR_5;
          sw=CHECK_RC_10;continue;
         }
     else if(z_p.e2s_b(s,"DIR_DIR_NEXT"))
         {z_mt_p.program_p.sw_text_b=false;
          if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
          if(!z_mt_p.program_p.dir_dir_n.next_b()){sw=LOOP_2;continue;}//データ無は";"まで移動しない。(次の命令を実行）
          if(!edit_word_b(w1_s_n,",}")){sw=ABORT_24;continue;}
          if(','==edit_c){z_p.err_s="find ','";sw=ABORT_24;continue;}
          if(!z_p.e2s_b(w1_s_n.s,""))
            {if(!w_set_name_b(w1_s_n.s)){sw=ABORT_24;continue;}
             w_set_data(z_mt_p.program_p.dir_dir_n.dir_file_s); 
            } 
          sw=SKIP_LOOP_1;continue; //データ有りは";"まで移動する。
         } 
     else if(z_p.e2s_b(s,"DIR_NEXT"))
         {z_mt_p.program_p.sw_text_b=false;
          if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
          if(!z_mt_p.program_p.dir_n.next_b()){sw=LOOP_2;continue;}//データ無は";"まで移動しない。(次の命令を実行）
          if(!edit_word_b(w1_s_n,",}")){sw=ABORT_24;continue;}
          if(!z_p.e2s_b(w1_s_n.s,""))
            {if(!w_set_name_b(w1_s_n.s)){sw=ABORT_24;continue;}
             w_set_data(z_mt_p.program_p.dir_n.dir_file_s); 
            } 
          if('}'==edit_c){sw=SKIP_LOOP_1;continue;} //データ有りは";"まで移動する。
          if(!edit_word_b(w1_s_n,",}")){sw=ABORT_24;continue;}
          if(','==edit_c){z_p.err_s="find ','";sw=ABORT_24;continue;}
          if(!z_p.e2s_b(w1_s_n.s,""))
            {if(!w_set_name_b(w1_s_n.s)){sw=ABORT_24;continue;}
             w_set_data(z_mt_p.program_p.dir_n.last_write_time_s); 
            } 
          sw=SKIP_LOOP_1;continue; //データ有りは";"まで移動する。
         }
     else if(z_p.e2s_b(s,"ERASE_DIR"))
         {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
          if(-1!=z_p.index2s_i(opt1_s,z_p.dir_s)){z_p.err_s="bad dir char \""+z_p.dir_s+"\"";rc=z_p.SW_ERROR_5;}//VER17
          else if(!z_p.delete_dir_b(z_p.get_tmp_path_s(z_p.dir_s)+opt1_s,cmd2_s+"{"))rc=z_p.SW_ERROR_5;
          sw=CHECK_RC_10;continue; //VER17
         }
     else if(z_p.e2s_b(s,"ERASE_FILE"))
         {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
          if(-1!=z_p.index2s_i(opt1_s,z_p.dir_s)){z_p.err_s="bad file char \""+z_p.dir_s+"\"";rc=z_p.SW_ERROR_5;}//VER17
          else if(!z_p.delete_file_b(z_p.get_tmp_path_s(z_p.dir_s)+opt1_s,cmd2_s+"{"))rc=z_p.SW_ERROR_5; //VER17
           sw=CHECK_RC_10;continue; //VER17
         }
     else if(z_p.e2s_b(s,"ERROR"))
         {z_mt_p.program_p.sw_text_b=false;
          if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
          String save_err_s=(!z_p.e2s_b(opt1_s,"")?opt1_s:z_p.err_s+" "+z_p.err11_s);//z_p.err_sが書き変わる可能性が有るのでキープ。
          z_mt_p.sql_n.sql_close_v(z_p.ROLLBACK,1);//ROLLBACKを実行。
          z_p.err_s=save_err_s; 
          z_mt_p.sw_err=z_p.SW_ERROR_5;//エラー発生。
          sw=RETURN1_28;continue;
         }
     else if(z_p.e3s_b(s,"IF_FILE","IF_FILE_NOT"))
         {z_mt_p.program_p.sw_text_b=false;
          if(CONTINUE_NORMAL_0!=sw_skip){sw_skip=SKIP_IF_2;sw=LOOP_2;continue;}//スキップ処理中は処理せず。
          if(read_n.open_b(z_mt_p.get_tmp_or_same_file_s(opt1_s),"/"))sw_skip=CONTINUE_IF_M1;//スキップせず。
          else                                                sw_skip=SKIP_IF_2;//スキップする。
          read_n.read_close_v();
          sw=IF_NOT_CHECK_5;continue;    
         }
 else if(z_p.e3s_b(s,"IF_NAME","IF_NAME_NOT"))
     {z_mt_p.program_p.sw_text_b=false;
      if(CONTINUE_NORMAL_0!=sw_skip){sw_skip=SKIP_IF_2;sw=LOOP_2;continue;}//スキップ処理中は処理せず。   
      if(z_mt_p.program_p.get_data_b(w1_s_n,w_type_c_n,opt1_s,1))
        {type_cx[0]=w_type_c_n.c;
         sw_skip=CONTINUE_IF_M1;//スキップせず。 
        } 
      else sw_skip=SKIP_IF_2;//スキップする。
      sw=IF_NOT_CHECK_5;continue;    
     }
 else if(z_p.e3s_b(s,"IF_TABLE","IF_TABLE_NOT"))
     {z_mt_p.program_p.sw_text_b=false;
      opt1_s=z_p.trim_s(opt1_s);
      if(-1!=z_p.index2c_i(opt1_s,' ')||z_p.e2s_b(opt1_s,"")){sw=ABORT_TABLE_SPACE_21;continue;}
      if(CONTINUE_NORMAL_0!=sw_skip){sw_skip=SKIP_IF_2;sw=LOOP_2;continue;} 
      if(0==(rc=z_mt_p.sql_n.get_table(opt1_s,0,usr_s)))
        {z_p.clear_s_v(z_mt_p.sql_n.s_table_a);table_found_v(opt1_s);sw_skip=CONTINUE_IF_M1;}//スキップせず。
      else sw_skip=SKIP_IF_2;//スキップする。//VER23.1
      sw=IF_NOT_CHECK_5;continue;
     } 
 else if(z_p.e2s_b(s,"MAKE_DIR"))
     {if('F'!=z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;} 
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if(!z_p.make_directory_b(opt1_s,cmd2_s+"{"))rc=z_p.SW_ERROR_5; //VER17
      sw=CHECK_RC_10;continue; //VER17
     }
 else if(z_p.e2s_b(s,"MESSAGE"))
     {z_mt_p.program_p.sw_text_b=false;
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
#if IMENU
      if(z_p.e2s_b(z_p.main_program_s,"IMENU"))
          z_mt_p.program_p.display_msg_v((z_p.e2s_b(opt1_s,"")?z_p.err_s:
            z_p.replace_rn_s(opt1_s,' ')));
#else //MENU_ELSE
      if(z_p.e2s_b(z_p.main_program_s,"ITIME"))
           z_mt_p.insert_time_log("",z_p.job_s,""
                           ,(z_p.e2s_b(opt1_s,"")?z_p.err_s:
       z_p.replace_rn_s(opt1_s,' ')));
#endif //MENU_ENDIF
      sw=CHECK_RC_10;continue;       
     }
 else if(z_p.e2s_b(s,"NOP"))
     {z_mt_p.program_p.sw_text_b=false;
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      sw=CHECK_RC_10;continue;
     }
 else if(z_p.e2s_b(s,"OUTPUT_CLEAR"))
     {z_mt_p.program_p.sw_text_b=false;
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      output_clear_v();sw=CHECK_RC_10;continue;
     }
 else if(z_p.e2s_b(s,"OUTPUT"))
     {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      rc=output();sw_sql=1;sw=CHECK_RC_10;continue;
     }
 else if(z_p.e3s_b(s,"READ1_CLOSE","READ2_CLOSE"))
   {if(z_p.e2s_b(s,"READ1_CLOSE"))i01=0;
    z_mt_p.program_p.sw_text_b=false;
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      z_mt_p.program_p.read_nx[i01].read_close_v();
      sw=CHECK_RC_10;continue;
   }
 else if(z_p.e3s_b(s,"READ1_NEXT","READ2_NEXT"))
     {if(z_p.e2s_b(s,"READ1_NEXT"))i01=0;
      z_mt_p.program_p.sw_text_b=false;
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if(0==(rc=read(z_mt_p.program_p.read_nx[i01])))
         {sw=SKIP_LOOP_1;
          continue;
         } //データ有りは";"まで移動する。
      if(1==rc){sw=LOOP_2;continue;}//データ無は";"まで移動しない。(次の命令を実行）
      sw=ABORT_24;continue;   
     }
 else if(z_p.e2s_b(s,"SET_DICTIONARY"))
     {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      rc=z_mt_p.sql_n.set_dictionary_da_i(z_mt_p.program_p.da_table_a,opt1_s,usr_s,z_mt_p.program_p.job_permission_s);//VER 22.1
      sw=CHECK_RC_10;continue;
     }
 else if(z_p.e2s_b(s,"SQL_REAL_TEST"))
     {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if(0!=(rc=z_mt_p.sql_n.sql_usr2(opt1_s,usr_s))){sw_sql=1;sw=CHECK_RC_10;continue;}
      z_p.sql_count_123=z_p.db_affected_cnt;
      if(z_p.e2s_b(z_p.test_s,"REAL")&&z_p.e2s_b(z_p.real_test_s,"REAL"))
        {z_p.real_test_s="TEST";
         ii_zz_l opt1_s_n=new ii_zz_l();
         if(!z_mt_p.edit_b(opt1_s_n,z_mt_p.program_p.text_sx[1])){sw=ABORT_24;continue;} 
         opt1_s=opt1_s_n.s;
         rc=z_mt_p.sql_n.sql_usr2(opt1_s,usr_s);
         z_p.real_test_s="REAL";
         sw_sql=1;sw=CHECK_RC_10;continue;
        }
      sw_sql=1;sw=CHECK_RC_10;continue;
     }
#if IMENU
 else if(z_p.e3s_b(s,"TIMER_BEEP","TIMER"))
     {if('T'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;}  
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if(z_p.e2s_b(s,"TIMER_BEEP"))z_p.sw_beep=1; //beep一回発生
      z_mt_p.program_p.sw_text_b=false;
      i=z_p.to_int_check(opt1_s,'-',0,0);
      if(!z_p.return_b){z_p.err_s="not numeric ("+w_cmd_s_n.s+"{"+opt1_s+"})";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}//VER17
      z_mt_p.menu_p.timer_v(i*1000); 
       sw=CHECK_RC_10;continue;
     } 
#endif  //MENU
 else if(z_p.e2s_b(s,"WRITE_SYSTEM"))
     {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if(1!=z_p.sw_setup){z_p.err_s="not setup";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}//VER17
//      if(!read_n.open_b(z_p.server_file_path_s()+z_p.dir_s+"BAT"+z_p.dir_s
//        +"Z_SETUP.CFG","/")){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}//VER17
//      read_n.read_close_v();  
      ii_write_l write_n=new ii_write_l(z_p);
//      if(!write_n.open_b(z_p.server_file_path_s()+z_p.dir_s+"BAT"+z_p.dir_s   //VER35
//         +"I_"+z_p.server_name_s+"_"+z_p.system_s+".I","OT","UTF-8,W")){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}//VER17//VER000600003
      if(!write_n.open_b(z_p.get_tmp_path_s(z_p.dir_s)   //VER36.00060003
         +"I_"+z_p.server_name_s+"_"+z_p.system_s+".I","OT","UTF-8,W")){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}//VER17//VER000600003
      opt1_s=z_p.pad_end_s(opt1_s,64);//６４文字化
      if(z_p.e2s_b(z_p.password_n.pwd64_s(opt1_s),"OK"))  
          write_n.write_b(z_p.lang_s+"\t"+z_p.server_name_s+"\t"+z_p.system_s+"\t"
          +z_p.db_soft_s+"\t"+z_p.setup_s+"\t"+z_p.instance_s+"\t"+z_p.system_name_s+"\t"
          +z_p.password_real_s+"\t"+z_p.password_test_s+"\t"+z_p.password_link_s+"\t"
          +z_p.password_n.pwd32set_s(opt1_s));
       write_n.write_close_v();
       sw=CHECK_RC_10;continue;
     }
 else if(z_p.e3s_b(s,"WRITE1","WRITE2"))
      {if(z_p.e2s_b(s,"WRITE1"))i01=0;
       z_mt_p.program_p.sw_text_b=false;
       if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
       rc=write(z_mt_p.program_p.write_nx[i01]);
       sw=CHECK_RC_10;continue;
      }
 else if(z_p.e3s_b(s,"WRITE1_CLOSE","WRITE2_CLOSE"))
     {if(z_p.e2s_b(s,"WRITE1_CLOSE"))i01=0;
      z_mt_p.program_p.sw_text_b=false;
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      z_mt_p.program_p.write_nx[i01].write_close_v();
      sw=CHECK_RC_10;continue;
     }
  else if(z_p.e3s_b(s,"SERIALPORT1_CLOSE","SERIALPORT2_CLOSE"))
      {if(z_p.e2s_b(s,"SERIALPORT1_CLOSE"))i01=0;
       if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
   if( null !=z_mt_p.program_p.serialport_nx[i01])
      {z_mt_p.program_p.serialport_nx[i01].close_v();z_mt_p.program_p.serialport_nx[i01]= null ;}
       sw=CHECK_RC_10;continue;//VER17
      }
 else if(z_p.e3s_b(s,"SERIALPORT1_WRITE","SERIALPORT2_WRITE"))
     {if(z_p.e2s_b(s,"SERIALPORT1_WRITE"))i01=0;
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if(!get_data_b(w1_s_n,w_type_c_n,opt1_s)){sw=ABORT_24;continue;}
      type_cx[0]=w_type_c_n.c; 
      if( null ==z_mt_p.program_p.serialport_nx[i01]){z_p.err_s="not open serialport";sw=ABORT_24;continue;}//VE14.1
      z_mt_p.program_p.serialport_nx[i01].write_b(w1_s_n.s);
      sw=CHECK_RC_10;continue;//VER17
     }
 else if(z_p.e2s_b(s,"SERVER_PUT"))
     {if('T'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;}  
      if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      path_s="";file_s=opt1_s;sw=SERVER_PROG_6;continue;
     } 
 else if(z_p.e3s_b(s,"RECEIVE_BEEP","RECEIVE"))
     {if(z_p.e2s_b(s,"RECEIVE_BEEP"))
        {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         z_p.sw_beep=2; //ビープ連続発生
        }
      if('T'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;}  
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
#if IMENU
      if(z_p.e2s_b(z_p.main_program_s,"IMENU"))
        {z_mt_p.socket_n.receive_cancel();
         i=z_p.to_int_check(opt1_s,'-',0,0);
         if(!z_p.return_b){z_p.err_s="not numeric ("+w_cmd_s_n.s+"{"+opt1_s+"})";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if(1>i||99<i){z_p.err_s="bad recive number \""+z_p.to_i_s(i)+"\"";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if(0!=z_mt_p.socket_n.receive(z_p.to2_i_s(i,2),z_mt_p)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
        }
#endif //MENU
      rc=0;
      sw=CHECK_RC_10;continue;//VER17
     } 
 else if(z_p.e2s_b(s,"BEEP"))
     {z_mt_p.program_p.sw_text_b=false;
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
#if IMENU //VER33.1
      z_p.beep_v();
#endif //MENU VER33.1
      sw=CHECK_RC_10;continue;//VER17
     }
#if ITIME
 else if(z_p.e2s_b(s,"BODY"))
     {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if(true==z_p.cgi_password_b)//パスワードエラー時無視。
         {z_mt_p.cgi_n.body_v();
          z_mt_p.cgi_n.console_write_v(opt1_s);  //CGI　標準出力に吐き出す。
         }
      sw=CHECK_RC_10;continue;//VER17
     }
 else if(z_p.e2s_b(s,"BODY_FORM"))
     {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      z_mt_p.cgi_n.form_v(opt1_s);
      sw=CHECK_RC_10;continue;//VER17
     }
 else if(z_p.e2s_b(s,"HEAD"))
     {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      z_mt_p.cgi_n.console_write_v(opt1_s);  //CGI　標準出力に吐き出す。
      sw=CHECK_RC_10;continue;//VER17
     }
#endif //TIME
     else if(z_p.e2s_b(s,"WEB"))
         {if('T'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;} 
          if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
          ii_zz_l s_n=new ii_zz_l();s_n.s=opt1_s;
          rc=z_p.command(('W'==z_p.os_c?"START ":"xdg-open ")+z_p.replace_rn_s(s_n.s,' '));
          if(0!=rc&&""==z_p.err_s)z_p.err_s="error (WEB{"+s_n.s+"})";
          sw=CHECK_RC_10;continue;
         } 
 else if(z_p.e2s_b(s,"ZIP"))
     {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if(-1!=z_p.index2s_i(opt1_s,z_p.dir_s)){z_p.err_s="bad zip char \""+z_p.dir_s+"\"";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
      rc=z_mt_p.zip_n.zip(z_p.get_tmp_path_s(z_p.dir_s)+opt1_s);
      sw=CHECK_RC_10;continue;//VER17
     }
 else if(z_p.e3s_b(s,"CURSOR","CURSOR2"))//テーブル関連事前設定。
     {if(CONTINUE_NORMAL_0==sw_skip)//事前設定; 
        {ii_zz_l cursor_s_n=new ii_zz_l();
         z_mt_p.edit_b(cursor_s_n,opt1_s);//テーブル名
         z_mt_p.program_p.o_table_sx=z_p.split_sx(cursor_s_n.s,',');
         z_p.clear_da_v(da_o_cursor_table_a);
         rc=z_mt_p.sql_n.set_table_da_i(da_o_cursor_table_a,"",z_mt_p.program_p.o_table_sx[0],usr_s,1);//テーブル定義情報セット。
        }
     }
//====*( オペランド１個の場合の新文法処理用 )*****
  if(!next_operand_b()) // VER24.1 オペランド一個判定(prog_n.iはそのまま）
    {ii_xml_json_l w_xj_n;
     opt1_sx_v();   //カンマ区切りをopt1_sxに設定。 
      if(z_p.e2s_b(s,"BAT_SERVER"))
     
          {if('T'!=z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;} 
           if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
           rc=z_p.server_bat(z_mt_p.work_s(),opt1_sx[0]+z_mt_p.bat_param_s()+shift_comma_s(opt1_s,1));
           sw=CHECK_RC_10;continue;
          } 
    else if(z_p.e2s_b(s,"COPY_FILE"))
        {if('T'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;}  
          if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
          if(2!=z_p.count_sx_i(opt1_sx))             {z_p.err_s="not e (parameter count)!=2";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
          if(z_p.e2s_b(opt1_sx[0],""))        {z_p.err_s="(parameter1) is null";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
          if(z_p.e2s_b(opt1_sx[1],""))        {z_p.err_s="(parameter2) is null";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
          if(z_p.e2s_b(opt1_sx[0],opt1_sx[1])){z_p.err_s="e (parameter1,parameter2)";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
          if(!z_p.copy_file_b(z_mt_p.get_tmp_or_same_file_s(opt1_sx[1]),z_mt_p.get_tmp_or_same_file_s(opt1_sx[0]),cmd2_s+"{"))//VER36
                 rc=z_p.SW_ERROR_5;  
          sw=CHECK_RC_10;continue;
        }  
   else if(z_p.e2s_b(s,"COPY_TABLE"))
       {  if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中
         if(2>z_p.count_sx_i(opt1_sx)){z_p.err_s="not e (parameter count)<2";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
         if(-1!=z_p.index2c_i(opt1_sx[0],' ')){z_p.err_s="find (parameter1) (' ')";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if(z_p.e2s_b(opt1_sx[0],""))   {z_p.err_s="(parameter1) is null";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if(-1!=z_p.index2c_i(opt1_sx[1],' ')){z_p.err_s="find (parameter2) (' ')";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if(z_p.e2s_b(opt1_sx[1],"")){z_p.err_s="(parameter2) is null";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if(z_p.e2s_b(opt1_sx[0],opt1_sx[1])){z_p.err_s="e (paramater1=parameter2)";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if(0!=(rc=z_mt_p.sql_n.get_table(opt1_sx[1],1,usr_s))){sw_sql=1;sw=CHECK_RC_10;continue;}
         if(0!=(rc=z_mt_p.sql_n.create_table(opt1_sx[0],"",usr_s))){sw_sql=1;sw=CHECK_RC_10;continue;}
         if(3>z_p.count_sx_i(opt1_sx)||!z_p.e2s_b(opt1_sx[2],"NOT"))
            rc=z_mt_p.sql_n.sql_usr2("INSERT INTO "+opt1_sx[0]+" "+z_mt_p.sql_n.link_set_b("SELECT * FROM",opt1_sx[1]
             ,(z_p.e3s_b(shift_comma_s(opt1_s,2),""," ")?"":"I"),shift_comma_s(opt1_s,2)),usr_s);
         sw_sql=1;sw=CHECK_RC_10;continue;
       }
     else if(z_p.e2s_b(s,"CREATE_INDEX"))
        {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中
         if(4>z_p.count_sx_i(opt1_sx))               {z_p.err_s="under (parameter count)<4";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
         if(-1!=z_p.index2c_i(opt1_sx[0],' ')){z_p.err_s="find (parameter1) (' ')";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if(z_p.e2s_b(opt1_sx[0],"")){z_p.err_s="(parameter1) is null";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         i=z_p.to_int_check(opt1_sx[1],'+',0,1);if(!z_p.return_b){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}  
         if(9<i){z_p.err_s="index["+opt1_sx[1]+"] error";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}  
         if(!z_p.e3s_b(opt1_sx[2],"","UNIQUE")){z_p.err_s="(parameter3) "+z_p.e_err_s;rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         z_mt_p.sql_n.define_table_b(opt1_sx[0],usr_s);
         rc=z_mt_p.sql_n.create_index(opt1_sx[0],opt1_sx[1],opt1_s,opt1_sx[2],usr_s,3); 
         sw_sql=1;sw=CHECK_RC_10;continue;
        }
   else if(z_p.e2s_b(s,"CREATE_OBJECT"))
       { if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
        if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中
        if(3>z_p.count_sx_i(opt1_sx)){z_p.err_s="under (parameter count)<3";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
        if(-1!=z_p.index2c_i(opt1_sx[0],' ')){z_p.err_s="find (parameter1) (' ')";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
        if(z_p.e2s_b(opt1_sx[0],"")){z_p.err_s="(parameter1) is null";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
        if(!z_p.e8s_b(opt1_sx[1],"VIEW","FUNC","PROC","TRIG","FUNCTION","PROCEDURE","TRIGGER"))
          {z_p.err_s=z_p.e_err_s;rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
        rc=z_mt_p.sql_n.create_object(opt1_sx[0],opt1_sx[1],shift_comma_s(opt1_s,2),"",usr_s);
        sw_sql=1;sw=CHECK_RC_10;continue;
       }
     else if(z_p.e2s_b(s,"DROP_INDEX"))
         {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         if(-1!=z_p.index2c_i(opt1_sx[0],' ')){z_p.err_s="find (parameter1) (' ')";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if(z_p.e2s_b(opt1_sx[0],"")){z_p.err_s="(parameter1) is null";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if(1==z_p.count_sx_i(opt1_sx)||z_p.e2s_b(opt1_sx[1],""))
           {rc=z_mt_p.sql_n.drop_index(opt1_sx[0],1,usr_s);//全インデックス削除。
            if(z_p.e2s_b(z_p.db_i_error_s,"NOT_EXIST"))rc=0;
            sw_sql=1;sw=CHECK_RC_10;continue;
           }
         i=z_p.to_int_check(opt1_sx[1],'+',0,1);if(!z_p.return_b){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}  
         if(9<i){z_p.err_s="index["+opt1_sx[1]+"] error";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}  
         rc=z_mt_p.sql_n.drop_index(opt1_sx[0],i,1,usr_s);
         sw_sql=1;sw=CHECK_RC_10;continue;
         }
     else if(z_p.e2s_b(s,"DROP_OBJECT"))
        {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         if(2>z_p.count_sx_i(opt1_sx)){z_p.err_s="under (parameter count)<2";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
         if(z_p.e2s_b(opt1_sx[0],"")){z_p.err_s="(parameter1) is null";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         for(i=0,j=0;i<z_p.length(opt1_sx[0]);i++)//カッコ内の空白は良しとする（PostgreSQLの対応）
         if(0==j&&' '==z_p.at_s_c(opt1_sx[0],i)){z_p.err_s="find (parameter1) (' ')";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         else if('('==z_p.at_s_c(opt1_sx[0],i))j=1;
         else if(')'==z_p.at_s_c(opt1_sx[0],i))j=0;
         if(!z_p.e8s_b(opt1_sx[1],"VIEW","FUNC","PROC","TRIG","FUNCTION","PROCEDURE","TRIGGER"))
           {z_p.err_s=z_p.e_err_s;rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         rc=z_mt_p.sql_n.drop_object(opt1_sx[0],opt1_sx[1],usr_s);
         if(z_p.e2s_b(z_p.db_i_error_s,"NOT_EXIST"))rc=0;//削除相手が無い場合は正常終了。
         sw_sql=1;sw=CHECK_RC_10;continue;
        }
   else if(z_p.e4s_b(s,"EXE","EXE_I","EXE_WAIT"))
       {if('T'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;} 
        if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
        if(z_p.e2s_b(cmd2_s,"EXE_I"))rc=z_mt_p.process_i(opt1_sx[0],shift_comma_s(opt1_s,1),z_p.test_s);
        else                         rc=z_p.process(opt1_sx[0],shift_comma_s(opt1_s,1),"",(z_p.e2s_b(cmd2_s,"EXE")?false:true)); //VER 46.6.0.3
        sw=CHECK_RC_10;continue;
       } 
   else if(z_p.e2s_b(s,"FIND_REPEAT")) //VER20.1
       { if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 //VER24.1
         if(2>z_p.count_sx_i(opt1_sx)){z_p.err_s="not e (parameter count)<2";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
         if(!get_data_b(w_s_n,w_type_c_n,opt1_sx[0]+"_COUNT")){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}//opt1_sx[0]+'_COUNT'の設定。
         i=z_p.to_int_check(w_s_n.s,'+',0,1);if(!z_p.return_b){z_p.err_s="not numeric "+opt1_sx[0]+"_COUNT("+w_s_n.s+")";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}  //数値化
         if(!get_data_b(w_s_n,w_type_c_n,shift_comma_s(opt1_s,1))){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}//の設定。
         String find_repeat_s=w_s_n.s;  
         ii_zz_l zz_p=new ii_zz_l();
         for(;i>0;i--)
           {if(!get_data_b(w_s_n,w_type_c_n,opt1_sx[0]+z_p.to_i_s(i))){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}//opt1_sx[0]+iの設定。
            if(0==z_p.compare(zz_p,w_s_n.s,w_type_c_n.c,0,1,0,find_repeat_s))break;//一致 
           }  
         z_mt_p.program_p.find_repeat_s=z_p.to_i_s(i);//結果を_FIND_REPEATに設定。
         sw=CHECK_RC_10;continue;
       }
   else if(z_p.e2s_b(s,"GRANT"))
       {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
        if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         if(-1!=z_p.index2c_i(opt1_sx[0],' ')){z_p.err_s="find (parameter1) (' ')";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if(z_p.e2s_b(opt1_sx[0],"")){z_p.err_s="(parameter1) is null";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
        public_link_s="";object_s="";
        for(i=1;i<z_p.count_sx_i(opt1_sx);i++) 
           if     (z_p.e3s_b(opt1_sx[i],"PUBLIC","LINK"))public_link_s=opt1_sx[i];
           else if(z_p.e8s_b(opt1_sx[i],"TABLE","VIEW","FUNC","FUNCTION","PROC","PROCEDURE","SELECT"))object_s=opt1_sx[i];
           else {z_p.err_s=z_p.e_err_s;if(!z_p.e2s_b(opt1_sx[i],""))rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
        z_mt_p.sql_n.define_table_b(opt1_sx[0],usr_s);
        rc=z_mt_p.sql_n.grant_all(opt1_sx[0],object_s,public_link_s,usr_s,1);
        sw_sql=1;sw=CHECK_RC_10;continue;
       }
    else if(z_p.e3s_b(s,"REVOKE_PERMISSION","GRANT_PERMISSION"))
        {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         if(2>z_p.count_sx_i(opt1_sx)){z_p.err_s="under (parameter count)<2";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
         if(-1!=z_p.index2c_i(opt1_sx[0],' ')){z_p.err_s="find (parameter1) (' ')";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if(z_p.e2s_b(opt1_sx[0],"")){z_p.err_s="(parameter1) is null";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if(4!=z_p.length(opt1_sx[1])){z_p.err_s="not e (parameter2 length)!=4";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         lnk_s="";object_s="";
         for(i=2;i<z_p.count_sx_i(opt1_sx);i++) 
            if(z_p.e3s_b(opt1_sx[i],"L","LNK"))lnk_s=opt1_sx[i];
            else if(z_p.e8s_b(opt1_sx[i],"TABLE","VIEW","FUNC","FUNCTION","PROC","PROCEDURE","SELECT"))object_s=opt1_sx[i];
            else {z_p.err_s=z_p.e_err_s;if(!z_p.e2s_b(opt1_sx[i],""))rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         z_mt_p.sql_n.define_table_b(opt1_sx[0],usr_s);
         rc=z_mt_p.sql_n.grant_permission(cmd2_s,opt1_sx[0],object_s,opt1_sx[1],lnk_s,usr_s);
         sw_sql=1;sw=CHECK_RC_10;continue;
        }
     else if(z_p.e2s_b(s,"RENAME_FILE"))
         {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
          if(2!=z_p.count_sx_i(opt1_sx))             {z_p.err_s="not e (parameter count)!=2";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
          if(z_p.e2s_b(opt1_sx[0],""))        {z_p.err_s="(parameter1) is null";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
          if(z_p.e2s_b(opt1_sx[1],""))        {z_p.err_s="(parameter2) is null";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
          if(z_p.e2s_b(opt1_sx[0],opt1_sx[1])){z_p.err_s="e (parameter1,parameter2)";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
          if(-1!=z_p.index2s_i(opt1_s,z_p.dir_s)){z_p.err_s="bad file char \""+z_p.dir_s+"\"";rc=z_p.SW_ERROR_5;}//VER17
          if(!z_p.rename_file_b(opt1_sx[1],opt1_sx[0],cmd2_s+"{"))rc=z_p.SW_ERROR_5;  
          sw=CHECK_RC_10;continue;
         }
   else if(z_p.e3s_b(s,"ICHART","IPRINT"))
       {  if('T'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;} 
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         ichart_iprint_v(opt1_sx[0],(2>z_p.count_sx_i(opt1_sx)?"":opt1_sx[1]),(3>z_p.count_sx_i(opt1_sx)?"":opt1_sx[2]),shift_comma_s(opt1_s,3));
         continue;
       }
    else if(z_p.e2s_b(s,"INSERT"))
        {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         if(2>z_p.count_sx_i(opt1_sx)){z_p.err_s="under (parameter count)<2";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
         if(-1!=z_p.index2c_i(opt1_sx[0],' ')){z_p.err_s="find (parameter1) (' ')";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if(z_p.e2s_b(opt1_sx[0],"")){z_p.err_s="(parameter1) is null";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         edit_s=shift_comma_s(opt1_s,1);edit=0;set_set_b(false); //VER23.1
         if(CHECK_RC_10==sw){if(0!=rc){sw_continue_b=true;continue;}} //VER26.1
         else {rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;sw_continue_b=true;continue;}
         rc=insert(opt1_sx[0],z_p.name_only_s(shift_comma_s(opt1_s,1))); 
         sw_sql=1;sw=CHECK_RC_10;continue;
        } 
   else if(z_p.e2s_b(s,"INSERT_FILE"))
       { if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         if(4>z_p.count_sx_i(opt1_sx)){z_p.err_s="under (parameter count/operand1)<4";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
         if(-1!=z_p.index2c_i(opt1_sx[0],' ')){z_p.err_s="find (parameter1/operand1) (' ')";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if(z_p.e2s_b(opt1_sx[0],"")){z_p.err_s="(parameter1/operand1) is null";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if(z_p.e2s_b(opt1_sx[1],"")){z_p.err_s="(parameter2/operand1) is null";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         name_sx=z_p.split_sx(shift_comma_s(opt1_s,3),',');name_s="";values_s="";z_p.clear_s_v(s_type_a);
         if(0!=(rc=z_mt_p.sql_n.get_table(opt1_sx[0],0,usr_s))){sw_sql=1;sw=CHECK_RC_10;continue;}//テーブル情報設定
         swp=0;
         for(int iz=0;iz<z_p.count_sx_i(name_sx);iz++)//s_type_aとname_sを編集。
           {String w_s=z_p.dot_string_s(name_sx[iz]);
            if(z_p.e2s_b(w_s,""))z_p.add_s(s_type_a," ");
            else 
            for(i=0;;i+=2)
               if(z_p.count_s_i(z_mt_p.sql_n.s_table_a)<=i)
                 {z_p.err_s="not found (Table data name ("+w_s+")) ";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;sw_continue_b=true;break;}
               else
                 {if(z_p.e2s_b(w_s,z_p.at_s(z_mt_p.sql_n.s_table_a,i)))
                    {z_p.add_s(s_type_a,z_p.type_s(z_p.at_s(z_mt_p.sql_n.s_table_a,i+1)));
                     name_s+=(z_p.e2s_b(name_s,"")?"":",")+w_s;
                     swp=1;break;
                    }     
                 }
            if(true==sw_continue_b)break;
           }
        if(true==sw_continue_b)continue;   
        if(0==swp){z_p.err_s=w_cmd_s_n.s+"{.}{} data name is null";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         for(i=0;z_p.count_s_i(z_mt_p.sql_n.s_table_a)>i;i+=2)//name_sとvalue_sを編集。 
           if(z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_table_a,i),"Z_ADD"))
             {name_s+=(z_p.e2s_b(name_s,"")?"":",")+z_p.at_s(z_mt_p.sql_n.s_table_a,i);
              values_s+=","+z_mt_p.db_n.now17_s;
             }
           else if(z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_table_a,i),"Z_ADD_PERSON"))
             {name_s+=(z_p.e2s_b(name_s,"")?"":",")+z_p.at_s(z_mt_p.sql_n.s_table_a,i);
              values_s+=",'"+(z_p.e2s_b(z_p.person_s,"")?" ":z_p.person_s)+"'";
             }
           else if(z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_table_a,i),"Z_LAST_COMPUTER"))
             {name_s+=(z_p.e2s_b(name_s,"")?"":",")+z_p.at_s(z_mt_p.sql_n.s_table_a,i);
              values_s+=",'"+(z_p.e2s_b(z_p.computer_s,"")?" ":z_p.computer_s)+"'";
             }
           else if(z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_table_a,i),"Z_LAST_JOB"))
             {name_s+=(z_p.e2s_b(name_s,"")?"":",")+z_p.at_s(z_mt_p.sql_n.s_table_a,i);
              values_s+=",'"+(z_p.e2s_b(z_p.job_s,"")?" ":z_p.job_s)+"'";
             }
         z_p.clear_s_v(z_mt_p.sql_n.s_table_a); 
         if(!read_n.open_b(z_mt_p.get_tmp_or_same_file_s(opt1_sx[1]),opt1_sx[2])){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}//ファイルからデータを読み込む。
         sql_s="";sep_s="SELECT ";int end=0;
         for(ii=0;;ii++)//データ１件づつ処理しdata_sにセット。
            {if(0!=(end=read_n.read())||63==ii||('F'==z_p.db_c&&1==ii))//64件単位に処理。(HiRDBの最大値）
               {if(!z_p.e2s_b(sql_s,""))if(0!=(rc=z_mt_p.sql_n.sql_usr2("INSERT INTO "+opt1_sx[0]+"("+name_s+")"+z_p.new_line_s()+sql_s,usr_s)))
                      {read_n.read_close_v();rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;break;}   //VER15.1
                if(0!=end)break;//処理終了
                sep_s="SELECT ";sql_s="";ii=0;
               }
             z_p.csv_in_v(s_w_a,read_n.read_data_s,opt1_sx[1]);//データの分割
             for(i=0;z_p.count_s_i(s_type_a)>i;i++)//s_type_aに合わせてデータを構成。
               {String w_ss=(z_p.count_s_i(s_w_a)<=i?"":z_p.at_s(s_w_a,i)); 
                String w_s=z_p.at_s(s_type_a,i);
                if     (z_p.e2s_b(w_s," ")){w_ss=z_mt_p.sql_char_s(w_ss);}
                else if(z_p.e2s_b(w_s,"/")){w_ss=z_mt_p.sql_nchar_s(w_ss);}
                else if(z_p.e2s_b(w_s,"E")){w_ss=z_mt_p.sql_char_s(z_p.date_time_edit_s(w_ss,2));}
////            else                      {w_ss="0";}// VER37.8.0.9
                else                      {if(z_p.e2s_b(w_ss,""))w_ss="0";} // VER37.8.0.9
                sql_s+=sep_s+w_ss;
                sep_s=",";
               }
             sql_s+=values_s+" "+z_p.replace_s_s(z_mt_p.db_n.from_dual_s,"*",z_p.system_s+z_p.substring3_s(z_p.real_test_s,0,1));
             sep_s=z_p.new_line_s()+"UNION ALL SELECT ";
            }
         if(rc==z_p.SW_ERROR_5)continue;  ////ERROR==sw//// // VER15.1  
         z_p.clear_s_v(s_type_a);z_p.clear_s_v(z_mt_p.sql_n.s_sql_a);read_n.read_close_v();//後始末。
         sw=CHECK_RC_10;continue; //VER17
       }
  else if(z_p.e2s_b(s,"READ_CLOSE"))
      {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
       for(i=z_p.count_re_i(z_mt_p.re_read_a)-1;-1<i;i--){if(z_p.e2s_b((z_p.at_re(z_mt_p.re_read_a,i)).read_name_s,opt1_s))break;}
       if(-1!=i) //VER28.1
        {(z_p.at_re(z_mt_p.re_read_a,i)).read_close_v();z_p.remove_re_v(z_mt_p.re_read_a,i);}
       sw=CHECK_RC_10;continue;
      }
else if(z_p.e2s_b(s,"READ_OPEN"))
     {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if(z_p.e2s_b(opt1_sx[1],"")){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="file name is space";continue;}
      for(i=z_p.count_re_i(z_mt_p.re_read_a)-1;-1<i;i--){if(z_p.e2s_b((z_p.at_re(z_mt_p.re_read_a,i)).read_name_s,opt1_sx[0]))break;}
      if(-1!=i){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="name("+opt1_sx[0]+") found";continue;}
      if(2>z_p.count_sx_i(opt1_sx)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="file name not found";continue;}
      z_p.add_re(z_mt_p.re_read_a,new ii_read_l(z_p));i=z_p.count_re_i(z_mt_p.re_read_a)-1;
       (z_p.at_re(z_mt_p.re_read_a,i)).read_name_s=opt1_sx[0];//名前設定。
      if((z_p.at_re(z_mt_p.re_read_a,i)).open_b(z_mt_p.get_tmp_or_same_file_s(opt1_sx[1]),shift_comma_s(opt1_s,2)))rc=0;
      else {(z_p.at_re(z_mt_p.re_read_a,i)).read_close_v();z_p.remove_re_v(z_mt_p.re_read_a,i);
            rc=z_p.SW_ERROR_5;
           }
      sw=CHECK_RC_10;continue;
     }
 else if(z_p.e2s_b(s,"READ_NEXT"))
     {z_mt_p.program_p.sw_text_b=false;
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      for(i=z_p.count_re_i(z_mt_p.re_read_a)-1;-1<i;i--){if(z_p.e2s_b((z_p.at_re(z_mt_p.re_read_a,i)).read_name_s,opt1_sx[0]))break;}
      if(-1==i){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="name("+opt1_s+") not found";continue;}
      if(0==(rc=read(z_p.at_re(z_mt_p.re_read_a,i),1)))
         {z_mt_p.program_p.program_read_data_s=(z_p.at_re(z_mt_p.re_read_a,i)).read_data_s;//_READ_DATAを設定。
          sw=SKIP_LOOP_1;
          continue;
         } //データ有りは";"まで移動する。
      if(1==rc){sw=LOOP_2;continue;}//データ無は";"まで移動しない。(次の命令を実行）
      sw=ABORT_24;continue;   
     }
 else if(z_p.e3s_b(s,"SERIALPORT1_OPEN","SERIALPORT2_OPEN"))
     {if(z_p.e2s_b(s,"SERIALPORT1_OPEN"))i01=0;
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if( null !=z_mt_p.program_p.serialport_nx[i01]){z_p.err_s="alreay open serialport";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
      if(2>z_p.count_sx_i(opt1_sx)){z_p.err_s="under (parameter count/operand1)<2";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
       z_mt_p.program_p.serialport_nx[i01]=new ii_serialport_l(z_p);
      if(z_mt_p.program_p.serialport_nx[i01].open_b(shift_comma_s(opt1_s,1),opt1_sx[0]))rc=0;else rc=z_p.SW_ERROR_5;
      sw=CHECK_RC_10;continue;
     }
 else if(z_p.e3s_b(s,"SERIALPORT1_READ","SERIALPORT2_READ"))
     {if(z_p.e2s_b(s,"SERIALPORT1_READ"))i01=0;
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if(2>z_p.count_sx_i(opt1_sx)){z_p.err_s="under (parameter count/operand1)<2";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
      if(!w_set_name_b(opt1_sx[0])){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
      i=z_p.to_int_check(shift_comma_s(opt1_s,1),'0',0,1);if(!z_p.return_b){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
      if( null ==z_mt_p.program_p.serialport_nx[i01]){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="not open serialport";continue;}//VE14.1
      if(0!=z_mt_p.program_p.serialport_nx[i01].read(i)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
      if(0!=w_set_data(z_mt_p.program_p.serialport_nx[i01].data_s))rc=z_p.SW_ERROR_5;//VER17{rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
      sw=CHECK_RC_10;continue;
     }
  else if(z_p.e2s_b(s,"SERVER_BAT"))
      {   if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
         if('F'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;} 
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         path_s=opt1_sx[0];
         file_s=shift_comma_s(opt1_s,1);
         sw=SERVER_PROG_6;continue;
      }
  else if(z_p.e2s_b(s,"SERVER_GET"))
      {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
      if('F'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;} 
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      path_s=shift_comma_s(opt1_s,1);file_s=opt1_sx[0];
      sw=SERVER_PROG_6;continue;
      }
  else if(z_p.e2s_b(s,"SET_TABLE"))
      {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
       if(2!=z_p.count_sx_i(opt1_sx)){z_p.err_s="not e (parameter count)!=2";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
      alias_s=z_mt_p.alias_s(z_p.trim_s(opt1_sx[0]));
      ii_zz_l para2_s_n=new ii_zz_l();
      z_mt_p.edit_b(para2_s_n,opt1_sx[1]);
      for(i=0;i<z_p.count_s_i(z_mt_p.program_p.s_keep_alias_a);i++)//別名重複チェックVER23.1
        if(z_p.e2s_b(alias_s,z_p.at_s(z_mt_p.program_p.s_keep_alias_a,i))){z_p.err_s="find (same alias name) \"&"+alias_s+"\"";rc=z_p.SW_ERROR_5;break;}//VER23.1
      if(z_p.SW_ERROR_5!=rc)
        {for(i=0;i<z_p.count_da_i(z_mt_p.program_p.da_table_a);)//旧テーブル情報削除//VER23.1
         if(z_p.starts_with_b(z_p.upper_s((z_p.at_da(z_mt_p.program_p.da_table_a,i)).name_s),"&"+z_p.upper_s(alias_s)+"."))
            z_p.remove_da_v(z_mt_p.program_p.da_table_a,i);
         else i++;  
         rc=z_mt_p.sql_n.set_table_da_i(z_mt_p.program_p.da_table_a,"&"+alias_s,para2_s_n.s,usr_s,0);
        } 
         sw=CHECK_RC_10;continue;
      }
//   else if(z_p.e2s_b(s,"URL")) //VER36
//        {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
//         if(3>z_p.count_sx_i(opt1_sx)){z_p.err_s="not e (parameter count)<3";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
//         if(-1!=z_p.index2s_i(opt1_sx[0],z_p.dir_s)){z_p.err_s="bad file char \""+z_p.dir_s+"\"";rc=z_p.SW_ERROR_5;}//VER17
//         rc=z_mt_p.url_n.url(opt1_sx[0],opt1_sx[1],shift_comma_s(opt1_s,2),"","GET");
//         sw=CHECK_RC_10;continue;
//        }
//    else if(z_p.e2s_b(s,"URL_POST"))
//        {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
//         if(4>z_p.count_sx_i(opt1_sx)){z_p.err_s="not e (parameter count)<4";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
//         if(-1!=z_p.index2s_i(opt1_sx[0],z_p.dir_s)){z_p.err_s="bad file char \""+z_p.dir_s+"\"";rc=z_p.SW_ERROR_5;}//VER17
//         rc=z_mt_p.url_n.url(opt1_sx[0],opt1_sx[1],shift_comma_s(opt1_s,3),opt1_sx[2],"POST");
//         sw=CHECK_RC_10;continue;
//        }
    else if(z_p.e2s_b(s,"WRITE"))
        {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         for(i=z_p.count_wr_i(z_mt_p.wr_write_a)-1;-1<i;i--){if(z_p.e2s_b((z_p.at_wr(z_mt_p.wr_write_a,i)).write_name_s,opt1_sx[0]))break;}
         if(-1==i){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="name("+opt1_sx[0]+") not found";continue;}
         rc=write(z_p.at_wr(z_mt_p.wr_write_a,i),1);
         sw=CHECK_RC_10;continue;
        }
   else if(z_p.e2s_b(s,"WRITE_CLOSE"))
       {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
        for(i=z_p.count_wr_i(z_mt_p.wr_write_a)-1;-1<i;i--){if(z_p.e2s_b((z_p.at_wr(z_mt_p.wr_write_a,i)).write_name_s,opt1_sx[0]))break;}
        if(-1==i){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="name("+opt1_sx[0]+") not found";continue;}
        (z_p.at_wr(z_mt_p.wr_write_a,i)).write_close_v();z_p.remove_wr_v(z_mt_p.wr_write_a,i);
        sw=CHECK_RC_10;continue;
       }
   else if(z_p.e2s_b(s,"WRITE_OPEN"))
       {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
        if(2>z_p.count_sx_i(opt1_sx)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="file name not found";continue;}
        if(z_p.e2s_b(opt1_sx[1],"")){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="file name is space";continue;}
        for(i=z_p.count_wr_i(z_mt_p.wr_write_a)-1;-1<i;i--){if(z_p.e2s_b((z_p.at_wr(z_mt_p.wr_write_a,i)).write_name_s,opt1_sx[0]))break;}
        if(-1!=i){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="name("+opt1_sx[0]+") found";continue;}
        if('T'==z_mt_p.program_c)if(-1!=z_p.index3sc_i(opt1_sx[0],FILE_S,0))
            {z_p.err_s="find file name ("+FILE_S+")";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
        add_ot_s="";w_u_s="";encode_s=""; 
        for(j=2;j<z_p.count_sx_i(opt1_sx);j++)
          if     (z_p.e2s_b(z_p.upper_s(opt1_sx[j]),"ADD"))add_ot_s="ADD";
          else if(z_p.e2s_b(z_p.upper_s(opt1_sx[j]),"OT"))add_ot_s="OT";
          else if(z_p.e2s_b(z_p.upper_s(opt1_sx[j]),"W"))w_u_s="W";
          else if(z_p.e2s_b(z_p.upper_s(opt1_sx[j]),"U"))w_u_s="U";
          else encode_s=opt1_sx[j];
       z_p.add_wr(z_mt_p.wr_write_a,new ii_write_l(z_p));i=z_p.count_wr_i(z_mt_p.wr_write_a)-1;
       (z_p.at_wr(z_mt_p.wr_write_a,i)).write_name_s=opt1_sx[0];//名前設定。
       if((z_p.at_wr(z_mt_p.wr_write_a,i)).open_b(z_mt_p.get_tmp_or_same_file_s(opt1_sx[1]),add_ot_s,encode_s+","+w_u_s))rc=0;
       else {(z_p.at_wr(z_mt_p.wr_write_a,i)).write_close_v();z_p.remove_wr_v(z_mt_p.wr_write_a,i);
             rc=z_p.SW_ERROR_5;
            };
        sw=CHECK_RC_10;continue;
       } 
 else if(z_p.e2s_b(s,"XML_BEGIN"))
     {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if(2>z_p.count_sx_i(opt1_sx)){z_p.err_s="under (parameter count/operand1)<2";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
      if(!get_data_b(w_s_n,w_type_c_n,opt1_sx[0])){sw=CHECK_RC_10;rc=z_p.SW_ERROR_5;continue;}
      z_p.add_xm(z_mt_p.program_p.xm_xml_a,new ii_xml_json_l(z_p,w_s_n.s,0));
      i=z_p.count_xm_i(z_mt_p.program_p.xm_xml_a);
      for(ii=1;ii<z_p.count_sx_i(opt1_sx);ii++)
       {if(z_p.e2s_b(opt1_sx[ii],"")){z_p.err_s="data name is null";rc=z_p.SW_ERROR_5;break;}
        if(!w_set_name_b(opt1_sx[ii])){rc=z_p.SW_ERROR_5;break;}
        (z_p.at_xm(z_mt_p.program_p.xm_xml_a,i-1)).xml_json_data_v(opt1_sx[ii]);        
       } 
      sw=CHECK_RC_10;continue;//VER17
     }
 else if(z_p.e2s_b(s,"XML_CONTINUE"))
     {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      i=z_p.count_xm_i(z_mt_p.program_p.xm_xml_a);
      if(0==i){z_p.err_s="XML_BEGIN not found";sw=CHECK_RC_10;rc=1;continue;};
      if(!get_data_b(w_s_n,w_type_c_n,opt1_sx[0])){sw=CHECK_RC_10;rc=z_p.SW_ERROR_5;continue;}
      (z_p.at_xm(z_mt_p.program_p.xm_xml_a,i-1)).xml_json_continue_v(w_s_n.s);
      sw=CHECK_RC_10;continue;//VER17
     }
 else if(z_p.e2s_b(s,"XML_END"))
     {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if(0<z_p.count_xm_i(z_mt_p.program_p.xm_xml_a))
         z_p.remove_xm_v(z_mt_p.program_p.xm_xml_a,z_p.count_xm_i(z_mt_p.program_p.xm_xml_a)-1);
      sw=CHECK_RC_10;continue;//VER17
     }
 else if(z_p.e2s_b(s,"XML"))
     {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      i=z_p.count_xm_i(z_mt_p.program_p.xm_xml_a);
      if(0==i){z_p.err_s="XML_BEGIN not found";sw=CHECK_RC_10;rc=1;continue;};
      w_xj_n=z_p.at_xm(z_mt_p.program_p.xm_xml_a,i-1);
      rc=w_xj_n.xml_json_run();
      if(0==rc&&0!=w_xj_n.xml_json)
        for(ii=0;ii<z_p.count_s_i(w_xj_n.s_xml_json_name_org_a);ii++)
           if(1==w_xj_n.xml_json||1==z_p.at_i(w_xj_n.i_xml_json_sw_a,ii))
             {if(!w_set_name_b(z_p.at_s(w_xj_n.s_xml_json_name_org_a,ii))){rc=z_p.SW_ERROR_5;break;}
              if(0!=w_set_data(z_p.at_s(w_xj_n.s_xml_json_data_a,ii))){rc=z_p.SW_ERROR_5;break;}        
             } 
      sw=CHECK_RC_10;continue;//VER17
     }
 else if(z_p.e2s_b(s,"JSON_BEGIN"))
     {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if(2>z_p.count_sx_i(opt1_sx)){z_p.err_s="under (parameter count/operand1)<2";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
      if(!get_data_b(w_s_n,w_type_c_n,opt1_sx[0])){sw=CHECK_RC_10;rc=z_p.SW_ERROR_5;continue;}
      z_p.add_xm(z_mt_p.program_p.xm_json_a,new ii_xml_json_l(z_p,w_s_n.s,1));
      i=z_p.count_xm_i(z_mt_p.program_p.xm_json_a);
      for(ii=1;ii<z_p.count_sx_i(opt1_sx);ii++)
         {if(z_p.e2s_b(opt1_sx[ii],"")){z_p.err_s="data name is null";rc=z_p.SW_ERROR_5;break;}
          if(!w_set_name_b(opt1_sx[ii])){rc=z_p.SW_ERROR_5;break;}
          (z_p.at_xm(z_mt_p.program_p.xm_json_a,i-1)).xml_json_data_v(opt1_sx[ii]);        
         } 
      sw=CHECK_RC_10;continue;//VER17
     }
 else if(z_p.e2s_b(s,"JSON_CONTINUE"))
     {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      i=z_p.count_xm_i(z_mt_p.program_p.xm_json_a);
      if(0==i){z_p.err_s="XML_BEGIN not found";sw=CHECK_RC_10;rc=1;continue;};
      if(!get_data_b(w_s_n,w_type_c_n,opt1_sx[0])){sw=CHECK_RC_10;rc=z_p.SW_ERROR_5;continue;}
      (z_p.at_xm(z_mt_p.program_p.xm_json_a,i-1)).xml_json_continue_v(w_s_n.s);
      sw=CHECK_RC_10;continue;//VER17
     }
 else if(z_p.e2s_b(s,"JSON"))
     {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      i=z_p.count_xm_i(z_mt_p.program_p.xm_json_a);
      if(0==i){z_p.err_s="XML_BEGIN not found";sw=CHECK_RC_10;rc=1;continue;};
      w_xj_n=z_p.at_xm(z_mt_p.program_p.xm_json_a,i-1);
      rc=w_xj_n.xml_json_run();
      if(0==rc&&0!=w_xj_n.xml_json)
        for(ii=0;ii<z_p.count_s_i(w_xj_n.s_xml_json_name_org_a);ii++)
           if(1==w_xj_n.xml_json||1==z_p.at_i(w_xj_n.i_xml_json_sw_a,ii))
              {if(!w_set_name_b(z_p.at_s(w_xj_n.s_xml_json_name_org_a,ii))){rc=z_p.SW_ERROR_5;break;}
               if(0!=w_set_data(z_p.at_s(w_xj_n.s_xml_json_data_a,ii))){rc=z_p.SW_ERROR_5;break;}        
              }
      sw=CHECK_RC_10;continue;//VER17
     }
 else if(z_p.e2s_b(s,"JSON_END"))
     {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      i=z_p.count_xm_i(z_mt_p.program_p.xm_json_a);
      if(0<i)z_p.remove_xm_v(z_mt_p.program_p.xm_json_a,i-1);
      sw=CHECK_RC_10;continue;//VER17
     }
    } 
  rc_b=prog_edit2_b(); //VER18.1
  opt2_s=w_prog_edit_s_n.s;z_mt_p. program_p.opt_org_sx[2]=w_prog_edit_org_s_n.s;
  z_p.err21_s+="{"+(z_p.e2s_b(w_prog_edit_s_n.s,"")?w_prog_edit_org_s_n.s:w_prog_edit_s_n.s)+"}";//VER18.1//コマンドをエラー表示の為記憶。
  if(CONTINUE_NORMAL_0==sw_skip)z_mt_p.trace_v(0,"{"+z_p.replace_rn_s(opt2_s,' ')+"}"); //VER19.1
  if(!rc_b)if(CONTINUE_NORMAL_0==sw_skip){sw=ABORT_24;continue;} //VER18.1
  //====*******( オプション2個 )**********
    if(z_p.e3s_b(s,"SQL_REPEAT","SQL_SET"))
      {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      z_p.t_v(z_p.SE2,"SQL="+opt2_s);
      rc=z_mt_p.sql_n.sql_usr3(z_mt_p.program_p.s_sql3_a,opt2_s,usr_s);
        if(0!=rc){sw_sql=1;sw=CHECK_RC_10;continue;} //VER26.1 
      s_sql_a=z_mt_p.program_p.s_sql3_a;
      sql_cnt=4;//SQL_SET
      if(z_p.e2s_b(cmd2_s,"SQL_REPEAT"))sql_cnt=5;//SQL_REPEAT
      z_mt_p.program_p.sql_record_cnt_ix[sql_cnt]=z_p.db_record_cnt;
      z_mt_p.program_p.sql_column_cnt_ix[sql_cnt]=z_p.db_column_cnt;
      z_mt_p.program_p.sql_cnt_ix[sql_cnt]=0;
      edit_s=opt1_s;edit=0;
      i=1;
      sw=SQL_NEXT_8;continue; //VER26.1
      }
 else if(z_p.e2s_b(s,"BAT_SERVER"))
     {if('T'!=z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;} 
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      rc=z_p.server_bat(z_mt_p.work_s(),opt1_s+z_mt_p.bat_param_s()+
         z_p.replace_rn_s(opt2_s,' '));
      sw=CHECK_RC_10;continue;//VER17
     }
 else if(z_p.e2s_b(s,"COPY_FILE"))
     {if('T'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;}  
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if(!z_p.copy_file_b(z_mt_p.get_tmp_or_same_file_s(opt2_s),z_mt_p.get_tmp_or_same_file_s(opt1_s),cmd2_s+"{")) //VER36
           rc=z_p.SW_ERROR_5; // VER17{rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
      sw=CHECK_RC_10;continue;//VER17
     }
 else if(z_p.e2s_b(s,"DROP_OBJECT"))
     {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      opt1_s=z_p.trim_s(opt1_s);
      if(z_p.e2s_b(opt1_s,"")){sw=ERROR_OPT1_NULL_11;continue;}
      for(i=0,j=0;i<z_p.length(opt1_s);i++)//カッコ内の空白は良しとする（PostgreSQLの対応）
      if(0==j&&' '==z_p.at_s_c(opt1_s,i)){sw=ABORT_OBJECT_SPACE_22;continue;}
      else if('('==z_p.at_s_c(opt1_s,i))j=1;
      else if(')'==z_p.at_s_c(opt1_s,i))j=0;
      if(!z_p.e8s_b(opt2_s,"VIEW","FUNC","PROC","TRIG","FUNCTION","PROCEDURE","TRIGGER"))
        {z_p.err_s=z_p.e_err_s;rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
      rc=z_mt_p.sql_n.drop_object(opt1_s,opt2_s,usr_s);
      if(z_p.e2s_b(z_p.db_i_error_s,"NOT_EXIST"))rc=0;//削除相手が無い場合は正常終了。////||z_p.e2s_b(z_p.db_error_s,"L145")////
      sw_sql=1;sw=CHECK_RC_10;continue;
     }
 else if(z_p.e2s_b(s,"DROP_INDEX"))
     {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      opt1_s=z_p.trim_s(opt1_s);
      if(-1!=z_p.index2c_i(opt1_s,' ')||z_p.e2s_b(opt1_s,"")){sw=ABORT_TABLE_SPACE_21;continue;}
      if(z_p.e2s_b(opt2_s,""))
        {rc=z_mt_p.sql_n.drop_index(opt1_s,1,usr_s);
         if(z_p.e2s_b(z_p.db_i_error_s,"NOT_EXIST"))rc=0;
         sw_sql=1;sw=CHECK_RC_10;continue;
        }
      i=z_p.to_int_check(opt2_s,'+',0,1);if(!z_p.return_b){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}  
      if(9<i){z_p.err_s="index["+opt2_s+"] error";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}  
      rc=z_mt_p.sql_n.drop_index(opt1_s,i,1,usr_s);
      sw_sql=1;sw=CHECK_RC_10;continue;
     }
 else if(z_p.e4s_b(s,"EXE","EXE_I","EXE_WAIT"))
   {  if('T'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;} 
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if(z_p.e2s_b(cmd2_s,"EXE_I"))rc=z_mt_p.process_i(opt1_s,opt2_s,z_p.test_s);
      else                           rc=z_p.process(opt1_s,opt2_s,"",(z_p.e2s_b(cmd2_s,"EXE")?false:true)); //VER36.6.0.3
      sw=CHECK_RC_10;continue;
   }
 else if(z_p.e2s_b(s,"FIND_REPEAT")) //VER20.1
   {  if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 //VER24.1
      if(!get_data_b(w_s_n,w_type_c_n,opt1_s+"_COUNT")){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}//opt1_s+'_COUNT'の設定。
      i=z_p.to_int_check(w_s_n.s,'+',0,1);if(!z_p.return_b){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="not numeric "+opt1_s+"_COUNT("+w_s_n.s+")";continue;}  //数値化
      if(!get_data_b(w_s_n,w_type_c_n,opt2_s)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}//opt2_sの設定。
      String find_repeat_s=w_s_n.s;
      ii_zz_l zz_p=new ii_zz_l();
      for(;i>0;i--)
        {if(!get_data_b(w_s_n,w_type_c_n,opt1_s+z_p.to_i_s(i))){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}//opt1_s+iの設定。//VER36.1
         if(0==z_p.compare(zz_p,w_s_n.s,w_type_c_n.c,0,1,0,find_repeat_s))break;//一致 
        }  
      z_mt_p.program_p.find_repeat_s=z_p.to_i_s(i);//結果を_FIND_REPEATに設定。f w
      sw=CHECK_RC_10;continue;
   }
 else if(z_p.e2s_b(s,"INSERT"))
   {  if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      opt1_s=z_p.trim_s(opt1_s);
      if(-1!=z_p.index2c_i(opt1_s,' ')||z_p.e2s_b(opt1_s,"")){sw=ABORT_TABLE_SPACE_21;continue;}
      edit_s=opt2_s;edit=0;set_set_b(false); //VER23.1
      if(CHECK_RC_10==sw){if(0!=rc){sw_continue_b=true;continue;}} //VER26.1
      else {rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;sw_continue_b=true;continue;}
      rc=insert(opt1_s,z_p.name_only_s(opt2_s)); 
      sw_sql=1;sw=CHECK_RC_10;continue;
   } 
 else if(z_p.e3s_b(s,"READ1_OPEN","READ2_OPEN"))
   { if(z_p.e2s_b(s,"READ1_OPEN"))  i01=0;
    if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if(z_mt_p.program_p.read_nx[i01].open_b(z_mt_p.get_tmp_or_same_file_s(opt1_s),opt2_s))rc=0;else rc=z_p.SW_ERROR_5;
      sw=CHECK_RC_10;continue;
   }
 else if(z_p.e3s_b(s,"SERIALPORT1_OPEN","SERIALPORT2_OPEN"))
   {if(z_p.e2s_b(s,"SERIALPORT1_OPEN"))i01=0;
    if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
    if( null !=z_mt_p.program_p.serialport_nx[i01]){z_p.err_s="alreay open serialport";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
    z_mt_p.program_p.serialport_nx[i01]=new ii_serialport_l(z_p);
    if(z_mt_p.program_p.serialport_nx[i01].open_b(opt1_s,opt2_s))rc=0;else rc=z_p.SW_ERROR_5;
    sw=CHECK_RC_10;continue;
   }
 else if(z_p.e3s_b(s,"SERIALPORT1_READ","SERIALPORT2_READ"))
   {if(z_p.e2s_b(s,"SERIALPORT1_READ"))i01=0;
    if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
    if(!w_set_name_b(opt1_s)){sw=ABORT_24;continue;}
    i=z_p.to_int_check(opt2_s,'0',0,1);if(!z_p.return_b){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
    if( null ==z_mt_p.program_p.serialport_nx[i01]){sw=ABORT_24;z_p.err_s="not open serialport";continue;}//VE14.1
    if(0!=z_mt_p.program_p.serialport_nx[i01].read(i)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
    if(0!=w_set_data(z_mt_p.program_p.serialport_nx[i01].data_s))rc=z_p.SW_ERROR_5;//VER17{rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
    sw=CHECK_RC_10;continue;
   }
 else if(z_p.e2s_b(s,"SERVER_BAT"))
   {  if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
      if('F'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;} 
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      path_s=opt1_s;
      file_s=z_p.replace_rn_s(opt2_s,' ');
      sw=SERVER_PROG_6;continue;
   }
 else if(z_p.e2s_b(s,"SERVER_GET"))
   {   if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
      if('F'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;} 
      if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      path_s=opt1_s;file_s=opt2_s;
      sw=SERVER_PROG_6;continue;
   }
 else if(z_p.e2s_b(s,"SET_TABLE"))
   {  if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      opt1_s=z_mt_p.alias_s(z_p.trim_s(opt1_s));
      ii_zz_l opt2_s_n=new ii_zz_l();
      z_mt_p.edit_b(opt2_s_n,opt2_s);
      opt2_s=opt2_s_n.s;
      for(i=0;i<z_p.count_s_i(z_mt_p.program_p.s_keep_alias_a);i++)//別名重複チェックVER23.1
        if(z_p.e2s_b(opt1_s,z_p.at_s(z_mt_p.program_p.s_keep_alias_a,i))){z_p.err_s="find (same alias name) \"&"+opt1_s+"\"";rc=z_p.SW_ERROR_5;break;}//VER23.1
      if(z_p.SW_ERROR_5!=rc)
        {for(i=0;i<z_p.count_da_i(z_mt_p.program_p.da_table_a);)//旧テーブル情報削除//VER23.1
         if(z_p.starts_with_b(z_p.upper_s((z_p.at_da(z_mt_p.program_p.da_table_a,i)).name_s),"&"+z_p.upper_s(opt1_s)+"."))
            z_p.remove_da_v(z_mt_p.program_p.da_table_a,i);
         else i++;  
         rc=z_mt_p.sql_n.set_table_da_i(z_mt_p.program_p.da_table_a,"&"+opt1_s,opt2_s,usr_s,0);
        } 
      sw=CHECK_RC_10;continue;
   }
// else if(z_p.e2s_b(s,"URL")) //VER36
//     {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
//      rc=z_mt_p.url_n.url("",opt2_s,opt1_s,"","GET");  //VER24.2
//      sw=CHECK_RC_10;continue;
//     }
 else if(z_p.e3s_b(s,"CURSOR","CURSOR2"))//キー関連事前設定。
     {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
      if(CONTINUE_NORMAL_0==sw_skip)//事前設定 
        {z_p.split_comma_s_v(s_work_a,opt2_s+",");int work_a_cnt=z_p.count_s_i(s_work_a)/2*2;//偶数化。
         o_select_s="";o_order1_s="";o_order2_s="";o_declare_s="";o_into_s="";o_sql_key1_s="";o_sql_key2_s="";z_mt_p.program_p.o_where_s="";
         if('O'==z_p.db_c)o_into_s="F";  
         for(int jj=0;jj<work_a_cnt;jj+=2)
           {
            z_p.set_s_v(s_work_a,jj,  z_p.trim_s(z_p.at_s(s_work_a,jj)));
            z_p.set_s_v(s_work_a,jj+1,z_p.trim_s(z_p.at_s(s_work_a,jj+1)));
            o_select_s+=(z_p.e2s_b(o_select_s,"")?"SELECT ":",")+z_p.at_s(s_work_a,jj);
            if('O'!=z_p.db_c)o_into_s+=(z_p.e2s_b(o_into_s,"")?"":",")+z_mt_p.db_n.o_fs_s+z_p.at_s(s_work_a,jj);
            int kk=0; 
            for(;kk<z_p.count_da_i(da_o_cursor_table_a);kk++)
                 if(z_p.e2s_b("&C&"+z_p.at_s(s_work_a,jj),z_p.at_da(da_o_cursor_table_a,kk).name_s))
                 {o_declare_s+=(z_p.e2s_b(o_declare_s,"")?"":",")+(z_p.at_da(da_o_cursor_table_a,kk)).data_s;break;}
            if(z_p.count_da_i(da_o_cursor_table_a)==kk){z_p.err_s="not found (column name)("+z_p.at_s(s_work_a,jj)+")";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;break;} 
            if(z_p.e2s_b(z_p.at_s(s_work_a,jj+1),"K"))
               {o_order1_s+=(z_p.e2s_b(o_order1_s,"")?"":",")+z_p.at_s(s_work_a,jj);
                o_sql_key1_s+=z_mt_p.db_n.o_wd_s+z_p.at_s(s_work_a,jj)+"<>"+z_mt_p.db_n.o_fd_s+z_p.at_s(s_work_a,jj)+" OR "; 
                o_sql_key2_s+=z_mt_p.db_n.o_set_s+z_mt_p.db_n.o_wd_s+z_p.at_s(s_work_a,jj)+z_mt_p.db_n.o_from_s+z_mt_p.db_n.o_fd_s+z_p.at_s(s_work_a,jj)+";"; 
                z_mt_p.program_p.o_where_s+=(z_p.e2s_b(z_mt_p.program_p.o_where_s,"")?" WHERE ":" AND ")+z_p.at_s(s_work_a,jj)+"="+z_mt_p.db_n.o_ws_s+z_p.at_s(s_work_a,jj); 
               }
            else if( z_p.e3s_b(z_p.at_s(s_work_a,jj+1),"A","D"))
               {o_order2_s+=(z_p.e2s_b(o_order2_s,"")?"":",")+z_p.at_s(s_work_a,jj);if(z_p.e2s_b(z_p.at_s(s_work_a,jj+1),"D"))o_order2_s+=" DESC";}
            else if(!z_p.e2s_b(z_p.at_s(s_work_a,jj+1),"")){z_p.err_s="bad in(K,A,D,) ("+z_p.at_s(s_work_a,jj+1)+")";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;break;}
           }
         if(0!=rc)continue;
         ii_zz_l o_declare_s_n=new ii_zz_l();ii_zz_l keys_s_n=new ii_zz_l();ii_zz_l sep_s_n=new ii_zz_l();
         keys_s_n.s=z_mt_p.db_n.o_fd_s; 
         if('O'!=z_p.db_c)if(0!=z_mt_p.sql_n.create_table(o_declare_s_n,keys_s_n,z_p.split_sx(o_declare_s,','),"",usr_s,sep_s_n,1,"")) //declare 設定
                             {rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
        }
     }
  if(true==sw_continue_b)continue;//switch内でcontinue指示有り。 
//====*( オペランド２個の場合の新文法処理用 )*****
  if(!next_operand_b())// VER24.1 オペランド2個判定
    {opt1_sx_v(); //カンマ区切りをopt1_sxに設定。
     if(z_p.e3s_b(s,"SQL_FILE2","SQL_FILE"))
         {if(z_p.e2s_b(s,"SQL_FILE2"))if('T'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;} 
         if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         add_ot_s="";w_u_s="";encode_s=""; 
         for(j=1;j<z_p.count_sx_i(opt1_sx);j++)
           if     (z_p.e2s_b(z_p.upper_s(opt1_sx[j]),"ADD"))add_ot_s="ADD";
          else if(z_p.e2s_b(z_p.upper_s(opt1_sx[j]),"OT"))add_ot_s="OT";
          else if(z_p.e2s_b(z_p.upper_s(opt1_sx[j]),"W"))w_u_s="W";
          else if(z_p.e2s_b(z_p.upper_s(opt1_sx[j]),"U"))w_u_s="U";
          else encode_s=opt1_sx[j];
         z_p.sql_limit=z_mt_p.program_p.sql_limit_org;z_mt_p.program_p.sql_limit_org=0; 
         rc=z_mt_p.sql_n.sql_sql(z_mt_p.sql_n.s_sql_a,z_p.substring2_s(cmd2_s,4),z_p.real_test_s,usr_s
 //      ,"",opt2_s,(z_p.e2s_b(cmd2_s,"SQL_FILE")?z_p.get_tmp_path_s(z_p.dir_s)+z_p.job_s+z_p.hh_s+z_p.mm_s:"")+opt1_sx[0] //VER36
         ,"",opt2_s,(z_p.e2s_b(cmd2_s,"SQL_FILE")?z_p.get_tmp_path_s(z_p.dir_s)+z_p.job_s+z_p.hh_s+z_p.mm_s+opt1_sx[0]:
           z_mt_p.get_tmp_or_same_file_s(opt1_sx[0])) //VER36.000600003
            ,add_ot_s,encode_s+","+w_u_s,"");
         z_mt_p.program_p.file_record_cnt=z_p.db_record_cnt;
         z_mt_p.program_p.file_column_cnt=z_p.db_column_cnt;
         sw_sql=1;sw=CHECK_RC_10;continue;
         }

    else if(z_p.e4s_b(s,"CREATE_TABLE0","CREATE_TABLE2","CREATE_TABLE"))  //VER22.1
           {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
            if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中
            if(-1!=z_p.index2c_i(opt1_sx[0],' ')||z_p.e2s_b(opt1_sx[0],"")){z_p.err_s="find space table";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
            rc=z_mt_p.sql_n.create_table(opt1_sx[0],shift_comma_s(opt1_s,1),opt2_s,"",usr_s,cmd2_s);
            sw_sql=1;sw=CHECK_RC_10;continue;
           }
    else if(z_p.e2s_b(s,"URL")) //VER36
           {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
            // if(3>z_p.count_sx_i(opt1_sx)){z_p.err_s="not e (parameter count)<3";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
            if(-1!=z_p.index2s_i(opt1_sx[0],z_p.dir_s)){z_p.err_s="bad file char \""+z_p.dir_s+"\"";rc=z_p.SW_ERROR_5;}//VER17
            //if(-1!=z_p.index2s_i(opt1_s,z_p.dir_s)){z_p.err_s="bad file char \""+z_p.dir_s+"\"";rc=z_p.SW_ERROR_5;}
            rc=z_mt_p.url_n.url(opt1_sx[0],(2>z_p.count_sx_i(opt1_sx)?"":opt1_sx[1]),opt2_s,"","GET"); //VER36.6.0.3
            //rc=z_mt_p.url_n.url(opt1_s,"",opt2_s,"","GET");
            sw=CHECK_RC_10;continue;
           }
    }
  rc_b=prog_edit2_b();  //VER18.1
  opt3_s=w_prog_edit_s_n.s;z_mt_p.program_p.opt_org_sx[3]=w_prog_edit_org_s_n.s;
   z_p.err21_s+="{"+(z_p.e2s_b(w_prog_edit_s_n.s,"")?w_prog_edit_org_s_n.s:w_prog_edit_s_n.s)+"}";//VER18.1//コマンドをエラー表示の為記憶。
  if(CONTINUE_NORMAL_0==sw_skip)z_mt_p.trace_v(0,"{"+z_p.replace_rn_s(opt3_s,' ')+"}");//VER19.1
  if(!rc_b)if(CONTINUE_NORMAL_0==sw_skip){sw=ABORT_24;continue;}//VER18.1
  //====*******( オプション3個 )**********
  ii_zz_l x2_n=new ii_zz_l();
   if(z_p.e4s_b(s,"CREATE_TABLE0","CREATE_TABLE2","CREATE_TABLE"))  //VER22.1
       {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
        if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中
        opt1_s=z_p.trim_s(opt1_s); 
        if(-1!=z_p.index2c_i(opt1_s,' ')||z_p.e2s_b(opt1_s,"")){sw=ABORT_TABLE_SPACE_21;continue;}
        rc=z_mt_p.sql_n.create_table(opt1_s,opt2_s,opt3_s,"",usr_s,cmd2_s);
        sw_sql=1;sw=CHECK_RC_10;continue;
       }
   else if(z_p.e2s_b(s,"COPY_TABLE"))
       {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
        if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中
        opt1_s=z_p.trim_s(opt1_s); 
        if(-1!=z_p.index2c_i(opt1_s,' ')||z_p.e2s_b(opt1_s,"")){sw=ABORT_TABLE_SPACE_21;continue;}
        if(0!=(rc=z_mt_p.sql_n.get_table(opt2_s,1,usr_s))){sw_sql=1;sw=CHECK_RC_10;continue;}
        if(0!=(rc=z_mt_p.sql_n.create_table(opt1_s,"",usr_s))){sw_sql=1;sw=CHECK_RC_10;continue;}
        if(!z_p.e2s_b(opt3_s,"NOT"))
           rc=z_mt_p.sql_n.sql_usr2("INSERT INTO "+opt1_s+" "+z_mt_p.sql_n.link_set_b("SELECT * FROM",opt2_s
            ,(z_p.e3s_b(opt3_s,""," ")?"":"I"),opt3_s),usr_s);
        sw_sql=1;sw=CHECK_RC_10;continue;
       }
   else if(z_p.e2s_b(s,"GRANT"))
       {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
        if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
        if(!z_p.e4s_b(opt3_s,"PUBLIC","","LINK"))
          {z_p.err_s=z_p.e_err_s;rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         opt1_s=z_p.trim_s(opt1_s); 
        if(-1!=z_p.index2c_i(opt1_s,' ')||z_p.e2s_b(opt1_s,"")){sw=ABORT_TABLE_SPACE_21;continue;}
        z_mt_p.sql_n.define_table_b(opt1_s,usr_s);
        rc=z_mt_p.sql_n.grant_all(opt1_s,opt2_s,opt3_s,usr_s,1);
        sw_sql=1;sw=CHECK_RC_10;continue;
       }
   else if(z_p.e2s_b(s,"CREATE_OBJECT"))
       {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
        if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中
        opt1_s=z_p.trim_s(opt1_s); 
        if(-1!=z_p.index2c_i(opt1_s,' ')||z_p.e2s_b(opt1_s,"")){sw=ABORT_OBJECT_SPACE_22;continue;}
        if(!z_p.e8s_b(opt2_s,"VIEW","FUNC","PROC","TRIG","FUNCTION","PROCEDURE","TRIGGER"))
          {z_p.err_s=z_p.e_err_s;rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
        rc=z_mt_p.sql_n.create_object(opt1_s,opt2_s,opt3_s,"",usr_s);
        sw_sql=1;sw=CHECK_RC_10;continue;
       } 
   else if(z_p.e3s_b(s,"ICHART","IPRINT"))
       {if('T'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;} 
        if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
        opt1_sx=z_p.split_sx(opt1_s,',');
        ichart_iprint_v(opt1_sx[0],(2>z_p.count_sx_i(opt1_sx)?"":opt1_sx[1]),opt2_s,opt3_s);
        continue;
       }
   else if(z_p.e2s_b(s,"SEND"))
       {if('F'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;}
        if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
        i=z_p.to_int_check(opt1_s,'-',0,0);
        if(!z_p.return_b){z_p.err_s=w_cmd_s_n.s+"{"+opt1_s+"} not numeic";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
        if(1>i||99<i){z_p.err_s=w_cmd_s_n.s+"{"+opt1_s+"} number error";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
        if(0!=z_mt_p.socket_n.send(z_p.to2_i_s(i,2),opt2_s,opt3_s))
          {z_p.sleep_v(500); //短時間の連続送信の防止。
           rc=z_p.SW_ERROR_5; //rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;//VER17
          }
        z_p.sleep_v(500); //短時間の連続送信の防止。
        sw=CHECK_RC_10;continue; //VER17
       }
   else if(z_p.e2s_b(s,"SPLIT_CHAR"))
       {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
        z_p.split_count=0;z_mt_p.program_p.split_char_count=0;
        ii_zz_l x3_n=new ii_zz_l();
        if(!z_p.e2s_b(opt3_s,""))if(!edit_opt_b(x3_n)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}//opt3編集。
        if(z_p.e2s_b(x3_n.s,""))x3_n.s=" ";//空白の場合スペースと判断。
        if(z_p.e2s_b(opt1_s,"")){sw=ERROR_OPT1_NULL_11;continue;} //名前空白の場合エラー。
        swl=swp=k=j=i=0;
        edit=0;edit_s=opt2_s;if(!edit_opt_b(x2_n)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}//opt2編集。
        int SPLIT_CHAR0=0,SPLIT_CHAR1=1,SPLIT_CHAR2=2;
        for(int sw2=0;;)//----------------------------------for(;>=sw2)------------------------------
          {if(SPLIT_CHAR0>=sw2)if(i>=z_p.length(x2_n.s)){w2_s_n.s="";sw2=SPLIT_CHAR2;continue;}//文字判定終わり。
           if(SPLIT_CHAR1>=sw2)  
             {if(i<z_p.length(x2_n.s))
              if('\''==z_p.at_s_c(x2_n.s,i)){if(0==swl)swp=swl=1;else swl=0;}//引用符内は判定中止。
              if(i>=z_p.length(x2_n.s)||(0==swl&&-1!=(k=z_p.index2c_i(x3_n.s,z_p.at_s_c(x2_n.s,i)))))//iの位置に区切り文字有り。
                {if(i>=j)w2_s_n.s=z_p.substring3_s(x2_n.s,j,i-j);j=++i;swp=0;sw2=SPLIT_CHAR2;continue;}//VER17.1
              if(i<z_p.length(x2_n.s))
              if(i>=z_p.length(x2_n.s)){w2_s_n.s="";sw2=SPLIT_CHAR2;continue;}
              i++;
              sw2=SPLIT_CHAR1;continue;
             }
           if(!z_p.e2s_b(x3_n.s," ")||!z_p.e2s_b(w2_s_n.s,""))
             {if(!w_set_name_b(opt1_s+z_p.to_i_s(++z_p.split_count))){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;sw_continue_b=true;break;} //VER17
              if(0!=w_set_data(w2_s_n.s)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;sw_continue_b=true;break;}//VER17
             }
           if(i>=z_p.length(x2_n.s))
             {if(-1!=k&&0<i&&' '!=z_p.at_s_c(x3_n.s,k))//最後のデータが空白の場合の処理。
                {if(!w_set_name_b(opt1_s+z_p.to_i_s(++z_p.split_count))){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;sw_continue_b=true;break;}
                 if(0!=w_set_data("")){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;sw_continue_b=true;break;} //VER17
                }
               z_mt_p.program_p.split_char_count=z_p.split_count;
               sw=CHECK_RC_10;sw_continue_b=true;break;//VER17
             }
           sw2=SPLIT_CHAR0; 
          }//for(;;)------------------------------------------------------------------------------------
           if(true==sw_continue_b)continue;
       }
   else if(z_p.e2s_b(s,"SPLIT_FORM"))
       {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
        i=z_p.split_count=0;z_mt_p.program_p.split_form_count=0;
        if(z_p.e2s_b(opt3_s,""))opt3_s="80";
        if(!get_data_b(w_s_n,w_type_c_n,opt3_s)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
        l=z_p.to_int_check(w_s_n.s,'+',0,1);if(!z_p.return_b){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}  
        if(z_p.e2s_b(opt1_s,"")){sw=ERROR_OPT1_NULL_11;continue;} 
        edit=0;edit_s=opt2_s;if(!edit_opt_b(x2_n)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}//opt2編集。
        for(;;)//------------------------------------------------------------------------
          {for(k=0,ii=j=i;i<z_p.length(x2_n.s);)
             {k+=z_p.form_length(z_p.at_s_c(x2_n.s,ii));
              if(ii<z_p.length(x2_n.s)&&z_p.e3i_b(z_p.kind_code(z_p.at_s_c(x2_n.s,ii)),z_p.HIGH_SURROGATE_4,z_p.LOW_SURROGATE_5)){ii++;ii++;}
              else for(ii++;;)if(ii<z_p.length(x2_n.s)&&z_p.COMBINING_0==z_p.kind_code(z_p.at_s_c(x2_n.s,ii)))ii++;else break;
              if((ii-j)>l||k>l)break;
              i=ii;
             }   
           if(i==j)
             {if(0!=z_p.length(x2_n.s)){z_p.err_s="length==0 found";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;sw_continue_b=true;break;}
              w2_s_n.s="";
             }  
           else w2_s_n.s=z_p.substring3_s(x2_n.s,j,i-j);
           if(!w_set_name_b(opt1_s+z_p.to_i_s(++z_p.split_count))){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;sw_continue_b=true;break;}
           if(0!=w_set_data(w2_s_n.s)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;sw_continue_b=true;break;}
           z_mt_p.program_p.split_form_count=z_p.split_count;
           if(i>=z_p.length(x2_n.s)){sw=CHECK_RC_10;sw_continue_b=true;break;}
          }//for(;;)
           if(true==sw_continue_b)continue; 
       }
   else if(z_p.e3s_b(s,"WRITE1_OPEN","WRITE2_OPEN"))
       {if(z_p.e2s_b(s,"WRITE1_OPEN"))i01=0;
        if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
        if('T'==z_mt_p.program_c)if(-1!=z_p.index3sc_i(opt1_s,FILE_S,0))
           {z_p.err_s="find file name ("+FILE_S+")";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
        if(!z_p.e4s_b(opt2_s,"","ADD","OT")){z_p.err_s=z_p.e_err_s;rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
        if(z_mt_p.program_p.write_nx[i01].open_b(z_mt_p.get_tmp_or_same_file_s(opt1_s),opt2_s,opt3_s))rc=0;else rc=z_p.SW_ERROR_5;
        sw=CHECK_RC_10;continue;
       }
   else if(z_p.e2s_b(s,"ZZ_ADDLOGIN"))
       {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
        if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
        if(!z_p.e4s_b(opt1_s,"LINK","TEST","REAL")){z_p.err_s="BAD OPT1 [LINK,TEST,REAL]";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
        rc=z_mt_p.sql_n.zz_addlogin(opt1_s,z_p.replace_s_s(opt2_s,"'","''"),z_p.replace_s_s(opt3_s,"'","''"),usr_s);
        sw_sql=1;sw=CHECK_RC_10;continue;
       }
   if(true==sw_continue_b)continue;//switch内でcontinue指示有り。 
//====*( オペランド3個の場合の新文法処理用 )*****
  if(!next_operand_b())// VER24.1 オペランド3個判定
    {opt1_sx_v(); //カンマ区切りをopt1_sxに設定。
     if(z_p.e3s_b(s,"PROGRAM","PROGRAM2"))   //新旧で順番が大幅に異なります。
        {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         sw_e_program_b=sw_p_program_b=sw_n_program_b=false;
         sw_0_program_b=false; //VER37_8.0.9
         if(2>z_p.count_sx_i(opt1_sx)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="under patameter count < 2";continue;}
         if(-1!=z_p.index2c_i(opt1_sx[1],' ')||z_p.e2s_b(opt1_sx[1],""))
             {rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="patameter2 is null";continue;}
         if(z_p.e2s_b(opt2_s,"")&&'0'!=z_p.at_s_c(opt1_s,0)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="operand2 is null";continue;}
         z_p.clear_s_v(s_work_key_a);z_p.clear_s_v(s_work_data_a);
         z_p.add_s(s_work_key_a,"");z_p.add_s(s_work_data_a,"");
         if(z_p.e2s_b(opt1_sx[0],"")){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="patameter1 is null";continue;}
         if(z_p.e2s_b(shift_comma_s(opt1_s,2),""))
           {sw_data_b=false;
            if('3'==z_p.at_s_c(opt1_sx[0],0)){z_p.err_s="parameter2 is null[CHANGE]";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
           }
         else sw_data_b=true;
         if(('0'!=z_p.at_s_c(opt1_sx[0],0)&&'1'!=z_p.at_s_c(opt1_sx[0],0)&&'2'!=z_p.at_s_c(opt1_sx[0],0)&&'3'!=z_p.at_s_c(opt1_sx[0],0))
            ||3<z_p.length(opt1_sx[0]))
           {z_p.err_s="operand1 {"+opt1_sx[0]+"} error";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if('2'==z_p.at_s_c(opt1_sx[0],0)&&!z_p.e2s_b(opt3_s,""))
           {z_p.err_s="operand3 {"+opt3_s+"}{operand3 is not space (2)";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         for(i=1;i<z_p.length(opt1_sx[0]);i++)
            if     ('E'==z_p.at_s_c(opt1_sx[0],i)&&'0'!=z_p.at_s_c(opt1_sx[0],0))sw_e_program_b=true;
            else if('P'==z_p.at_s_c(opt1_sx[0],i)&&z_p.e3c_b(z_p.at_s_c(opt1_sx[0],0),'1','3'))sw_p_program_b=true;
            else if('N'==z_p.at_s_c(opt1_sx[0],i))sw_n_program_b=true;
            else if('0'==z_p.at_s_c(opt1_sx[0],i))sw_0_program_b=true; //VER37_8.0.9
            else {z_p.err_s="operand1 {"+z_p.to_c_s(z_p.at_s_c(opt1_sx[0],i))+"} error";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;sw_continue_b=true;break;}
         if(true==sw_continue_b)continue; 
         if(!z_p.e2s_b(opt2_s,""))
            {edit_s=opt2_s;edit=0;set_set_b(false); //名前=値の処理　//VER23.1 //VER26.1
             if(CHECK_RC_10==sw){if(0!=rc){sw_continue_b=true;continue;}} //VER26.1
             else {rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;sw_continue_b=true;continue;}
             if(!split_data_b(s_work_key_a,s_key_a,z_p.name_only_s(opt2_s))){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
            }
         edit_s=shift_comma_s(opt1_s,2);edit=0;set_set_b(false); //名前=値の処理　//VER23.1 //26.1
         if(CHECK_RC_10==sw){if(0!=rc){sw_continue_b=true;continue;}} //VER26.1
         else {rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;sw_continue_b=true;continue;}
         if(sw_data_b)
           {if(!split_data_b(s_work_data_a,s_data_a,z_p.name_only_s(shift_comma_s(opt1_s,2)))){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
           }
         if(0!=program(opt1_sx[0],shift_comma_s(opt1_s,2),opt1_sx[1],opt2_s,opt3_s))rc=z_p.SW_ERROR_5; //VER23.1 
         sw_sql=1;sw=CHECK_RC_10;continue;
        }
    else if(z_p.e2s_b(s,"UPDATE"))
        {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         if(2>z_p.count_sx_i(opt1_sx)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="under patameter count < 2";continue;}
         if(-1!=z_p.index2c_i(opt1_sx[0],' ')||z_p.e2s_b(opt1_sx[0],"")){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="patameter1 is null";continue;}
         if(z_p.e2s_b(shift_comma_s(opt1_s,1),"")){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="patameter2 is null";continue;}
         if(z_p.e2s_b(opt2_s,"")){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="operand2 is null";continue;}
         if(z_p.e2s_b(opt3_s,"")){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;z_p.err_s="operand3 is null";continue;}
         String[] column_sx=z_p.split_sx(shift_comma_s(opt1_s,1),',');
         List<String> s_a=new List<String>();
         z_p.split_comma_s_v(s_a,opt2_s);
         String comma_s=" ";
         if(z_p.count_sx_i(column_sx)!=z_p.count_s_i(s_a))
           {z_p.err_s="name_count="+z_p.to_i_s(z_p.count_sx_i(column_sx))+",values_count="+z_p.to_i_s(z_p.count_s_i(s_a));rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         w_s_n.s="UPDATE"+('M'==z_p.db_c?"":" "+opt1_sx[0])+('F'==z_p.db_c?"":" O")+" SET "
             +(z_p.e4c_b(z_p.db_c,'O','I','H')?(1==z_p.count_sx_i(column_sx)?"":"(")+shift_comma_s(opt1_s,1)
             +(1==z_p.count_sx_i(column_sx)?"":")")+"=(SELECT "+opt2_s+" FROM "+opt3_s+")":"");
         if(z_p.e3c_b(z_p.db_c,'P','M'))
           {for(i=0;i<z_p.count_sx_i(column_sx);i++){w_s_n.s+=comma_s+z_p.dot_string_s(column_sx[i])+"="+z_p.at_s(s_a,i);comma_s=",";}
            w_s_n.s+=" FROM ";
            if('M'==z_p.db_c)w_s_n.s+=opt1_sx[0]+" O,";
            w_s_n.s+=opt3_s;  
           }
         else if(z_p.e3c_b(z_p.db_c,'L','D'))//L,D
                for(i=0;i<z_p.count_sx_i(column_sx);i++){w_s_n.s+=comma_s+z_p.dot_string_s(column_sx[i])+"=(SELECT "+z_p.at_s(s_a,i)+" FROM "+opt3_s+")";comma_s=",";}
         w_s_n.s+=(z_p.e6c_b(z_p.db_c,'O','I','L','D','H')?" WHERE EXISTS(SELECT "+opt2_s+" FROM "+opt3_s+")":""); 
         rc=z_mt_p.sql_n.sql_usr2(w_s_n.s,usr_s);
         z_p.sql_count_123=z_p.db_affected_cnt;
         sw_sql=1;sw=CHECK_RC_10;continue;
        } 
    else if(z_p.e2s_b(s,"URL_POST"))
       {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
//        if(4>z_p.count_sx_i(opt1_sx)){z_p.err_s="not e (parameter count)<4";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
//        if(-1!=z_p.index2s_i(opt1_sx[0],z_p.dir_s)){z_p.err_s="bad file char \""+z_p.dir_s+"\"";rc=z_p.SW_ERROR_5;}//VER17
        if(-1!=z_p.index2s_i(opt1_s,z_p.dir_s)){z_p.err_s="bad file char \""+z_p.dir_s+"\"";rc=z_p.SW_ERROR_5;}
//      rc=z_mt_p.url_n.url(opt1_sx[0],opt1_sx[1],shift_comma_s(opt1_s,3),opt1_sx[2],"POST");
        rc=z_mt_p.url_n.url(opt1_s,"",opt2_s,opt3_s,"POST");
        sw=CHECK_RC_10;continue;
       }

    }
   rc_b=prog_edit2_b(); //VER18.1
   opt4_s=w_prog_edit_s_n.s;z_mt_p.program_p.opt_org_sx[4]=w_prog_edit_org_s_n.s;
   z_p.err21_s+="{"+(z_p.e2s_b(w_prog_edit_s_n.s,"")?w_prog_edit_org_s_n.s:w_prog_edit_s_n.s)+"}";//VER18.1//コマンドをエラー表示の為記憶。
   if(CONTINUE_NORMAL_0==sw_skip)z_mt_p.trace_v(0,"{"+z_p.replace_rn_s(opt4_s,' ')+"}");//VER19.1
   if(!rc_b)if(CONTINUE_NORMAL_0==sw_skip){sw=ABORT_24;continue;}//VER18.1
//====*******( オプション4個 )**********
    if(z_p.e2s_b(s,"CREATE_INDEX"))
        {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中
         opt1_s=z_p.trim_s(opt1_s); 
         if(-1!=z_p.index2c_i(opt1_s,' ')||z_p.e2s_b(opt1_s,"")){sw=ABORT_TABLE_SPACE_21;continue;}
         z_mt_p.sql_n.define_table_b(opt1_s,usr_s);
         rc=z_mt_p.sql_n.create_index(opt1_s,opt2_s,opt3_s,opt4_s,usr_s,0); 
         sw_sql=1;sw=CHECK_RC_10;continue;
        }
    else if(z_p.e2s_b(s,"SQL_FILE"))
        {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         if(!z_p.e4s_b(opt2_s,"","ADD","OT")){z_p.err_s=z_p.e_err_s;rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         z_p.sql_limit=z_mt_p.program_p.sql_limit_org;z_mt_p.program_p.sql_limit_org=0; 
         rc=z_mt_p.sql_n.sql_sql(z_mt_p.sql_n.s_sql_a,"FILE",z_p.real_test_s,usr_s
            ,"",opt4_s,z_p.get_tmp_path_s(z_p.dir_s)+z_p.job_s+z_p.hh_s+z_p.mm_s+opt1_s,opt2_s,opt3_s,"");
         z_mt_p.program_p.file_record_cnt=z_p.db_record_cnt;
         z_mt_p.program_p.file_column_cnt=z_p.db_column_cnt;
         sw_sql=1;sw=CHECK_RC_10;continue;
        }
    else if(z_p.e2s_b(s,"SQL_FILE2"))
        {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
         if('T'==z_mt_p.program_c){sw=ABORT_PROGRAM_19;continue;} 
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         if(!z_p.e4s_b(opt2_s,"","ADD","OT")){z_p.err_s=z_p.e_err_s;rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         z_p.sql_limit=z_mt_p.program_p.sql_limit_org;z_mt_p.program_p.sql_limit_org=0; 
         rc=z_mt_p.sql_n.sql_sql(z_mt_p.sql_n.s_sql_a,"FILE2",z_p.real_test_s,usr_s
            ,"",opt4_s,z_mt_p.get_tmp_or_same_file_s(opt1_s),opt2_s,opt3_s,"");  //VER36.000600003
         z_mt_p.program_p.file_record_cnt=z_p.db_record_cnt;
         z_mt_p.program_p.file_column_cnt=z_p.db_column_cnt;
         sw_sql=1;sw=CHECK_RC_10;continue;
        }
    else if(z_p.e3s_b(s,"REVOKE_PERMISSION","GRANT_PERMISSION"))
        {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         if(!z_p.e4s_b(opt4_s,"","L","LNK"))
           {z_p.err_s=z_p.e_err_s;rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
         if(z_p.e2s_b(opt3_s,"")){sw=ERROR_OPT3_NULL_13;continue;}
         opt1_s=z_p.trim_s(opt1_s); 
         if(-1!=z_p.index2c_i(opt1_s,' ')||z_p.e2s_b(opt1_s,"")){sw=ABORT_TABLE_SPACE_21;continue;}
         z_mt_p.sql_n.define_table_b(opt1_s,usr_s);
         rc=z_mt_p.sql_n.grant_permission(cmd2_s,opt1_s,opt2_s,opt3_s,opt4_s,usr_s);
         sw_sql=1;sw=CHECK_RC_10;continue;
        } 
    else if(z_p.e2s_b(s,"INSERT_FILE"))
        {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         opt1_s=z_p.trim_s(opt1_s); 
         if(-1!=z_p.index2c_i(opt1_s,' ')||z_p.e2s_b(opt1_s,"")){sw=ABORT_TABLE_SPACE_21;continue;}
         if(z_p.e2s_b(opt1_s,"")){sw=ERROR_OPT1_NULL_11;continue;} 
         if(z_p.e2s_b(opt2_s,"")){sw=ERROR_OPT2_NULL_12;continue;} 
         if(z_p.e2s_b(opt3_s,"")){sw=ERROR_OPT3_NULL_13;continue;} 
         name_sx=z_p.split_sx(opt2_s,',');name_s="";values_s="";z_p.clear_s_v(s_type_a);
         if(0!=(rc=z_mt_p.sql_n.get_table(opt1_s,0,usr_s))){sw_sql=1;sw=CHECK_RC_10;continue;}//テーブル情報設定
         swp=0;
         for(int iz=0;iz<z_p.count_sx_i(name_sx);iz++)//s_type_aとname_sを編集。
           {String w_s=z_p.dot_string_s(name_sx[iz]);
            if(z_p.e2s_b(w_s,""))z_p.add_s(s_type_a," ");
            else 
            for(i=0;;i+=2)
               if(z_p.count_s_i(z_mt_p.sql_n.s_table_a)<=i){z_p.err_s="not found (Table data name ("+w_s+")) ";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;sw_continue_b=true;break;}
               else
                 {if(z_p.e2s_b(w_s,z_p.at_s(z_mt_p.sql_n.s_table_a,i)))
                    {z_p.add_s(s_type_a,z_p.type_s(z_p.at_s(z_mt_p.sql_n.s_table_a,i+1)));
                     name_s+=(z_p.e2s_b(name_s,"")?"":",")+w_s;
                     swp=1;break;
                    }     
                 }
            if(true==sw_continue_b)break;
           }
        if(true==sw_continue_b)continue;   
        if(0==swp){z_p.err_s=w_cmd_s_n.s+"{.}{} data name is null";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         for(i=0;z_p.count_s_i(z_mt_p.sql_n.s_table_a)>i;i+=2)//name_sとvalue_sを編集。 
           if(z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_table_a,i),"Z_ADD"))
             {name_s+=(z_p.e2s_b(name_s,"")?"":",")+z_p.at_s(z_mt_p.sql_n.s_table_a,i);
              values_s+=","+z_mt_p.db_n.now17_s;
             }
           else if(z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_table_a,i),"Z_ADD_PERSON"))
             {name_s+=(z_p.e2s_b(name_s,"")?"":",")+z_p.at_s(z_mt_p.sql_n.s_table_a,i);
              values_s+=",'"+(z_p.e2s_b(z_p.person_s,"")?" ":z_p.person_s)+"'";
             }
           else if(z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_table_a,i),"Z_LAST_COMPUTER"))
             {name_s+=(z_p.e2s_b(name_s,"")?"":",")+z_p.at_s(z_mt_p.sql_n.s_table_a,i);
              values_s+=",'"+(z_p.e2s_b(z_p.computer_s,"")?" ":z_p.computer_s)+"'";
             }
           else if(z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_table_a,i),"Z_LAST_JOB"))
             {name_s+=(z_p.e2s_b(name_s,"")?"":",")+z_p.at_s(z_mt_p.sql_n.s_table_a,i);
              values_s+=",'"+(z_p.e2s_b(z_p.job_s,"")?" ":z_p.job_s)+"'";
             }
         z_p.clear_s_v(z_mt_p.sql_n.s_table_a); 
         if(!read_n.open_b(z_mt_p.get_tmp_or_same_file_s(opt3_s),opt4_s)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}//ファイルからデータを読み込む。
         sql_s="";sep_s="SELECT ";int end=0;
         for(ii=0;;ii++)//データ１件づつ処理しdata_sにセット。
            {if(0!=(end=read_n.read())||63==ii||('F'==z_p.db_c&&1==ii))//64件単位に処理。(HiRDBの最大値）
               {if(!z_p.e2s_b(sql_s,""))if(0!=(rc=z_mt_p.sql_n.sql_usr2("INSERT INTO "+opt1_s+"("+name_s+")"+z_p.new_line_s()+sql_s,usr_s)))
                      {read_n.read_close_v();rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;break;}   //VER15.1
                if(0!=end)break;//処理終了
                sep_s="SELECT ";sql_s="";ii=0;
               }
             z_p.csv_in_v(s_w_a,read_n.read_data_s,opt3_s);//データの分割
             for(i=0;z_p.count_s_i(s_type_a)>i;i++)//s_type_aに合わせてデータを構成。
               {String w_ss=(z_p.count_s_i(s_w_a)<=i?"":z_p.at_s(s_w_a,i)); 
                String w_s=z_p.at_s(s_type_a,i);
                if     (z_p.e2s_b(w_s," ")){w_ss=z_mt_p.sql_char_s(w_ss);}
                else if(z_p.e2s_b(w_s,"/")){w_ss=z_mt_p.sql_nchar_s(w_ss);}
                else if(z_p.e2s_b(w_s,"E")){w_ss=z_mt_p.sql_char_s(z_p.date_time_edit_s(w_ss,2));}
                else                      {if(z_p.e2s_b(w_ss,""))w_ss="0";}
                sql_s+=sep_s+w_ss;
                sep_s=",";
               }
             sql_s+=values_s+" "+z_p.replace_s_s(z_mt_p.db_n.from_dual_s,"*",z_p.system_s+z_p.substring3_s(z_p.real_test_s,0,1));
             sep_s=z_p.new_line_s()+"UNION ALL SELECT ";
            }
         if(rc==z_p.SW_ERROR_5)continue;   // VER15.1 ////ERROR==sw/// 
         z_p.clear_s_v(s_type_a);z_p.clear_s_v(z_mt_p.sql_n.s_sql_a);read_n.read_close_v();//後始末。
         sw=CHECK_RC_10;continue; //VER17
        }
    else if(z_p.e2s_b(s,"UPDATE"))
        {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;} 
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         opt1_s=z_p.trim_s(opt1_s); 
         if(-1!=z_p.index2c_i(opt1_s,' ')||z_p.e2s_b(opt1_s,"")){sw=ABORT_TABLE_SPACE_21;continue;}
         if(z_p.e2s_b(opt2_s,"")){sw=ERROR_OPT2_NULL_12;continue;}
         if(z_p.e2s_b(opt3_s,"")){sw=ERROR_OPT3_NULL_13;continue;}
         if(z_p.e2s_b(opt4_s,"")){sw=ERROR_OPT4_NULL_14;continue;}
         opt1_sx=z_p.split_sx(opt2_s,',');
         List<String> s_a=new List<String>();z_p.split_comma_s_v(s_a,opt3_s);
         String comma_s=" ";
         if(z_p.count_sx_i(opt1_sx)!=z_p.count_s_i(s_a))
           {z_p.err_s="name_count="+z_p.to_i_s(z_p.count_sx_i(opt1_sx))+",values_count="+z_p.to_i_s(z_p.count_s_i(s_a));rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         w_s_n.s="UPDATE"+('M'==z_p.db_c?"":" "+opt1_s)+('F'==z_p.db_c?"":" O")+" SET "
             +(z_p.e4c_b(z_p.db_c,'O','I','H')?(1==z_p.count_sx_i(opt1_sx)?"":"(")+opt2_s+(1==z_p.count_sx_i(opt1_sx)?"":")")+"=(SELECT "+opt3_s+" FROM "+opt4_s+")":"");
         if(z_p.e3c_b(z_p.db_c,'P','M'))
           {for(i=0;i<z_p.count_sx_i(opt1_sx);i++){w_s_n.s+=comma_s+z_p.dot_string_s(opt1_sx[i])+"="+z_p.at_s(s_a,i);comma_s=",";}
            w_s_n.s+=" FROM ";
            if('M'==z_p.db_c)w_s_n.s+=opt1_s+" O,";
            w_s_n.s+=opt4_s;  
           }
         else if(z_p.e3c_b(z_p.db_c,'L','D'))//L,D
                for(i=0;i<z_p.count_sx_i(opt1_sx);i++){w_s_n.s+=comma_s+z_p.dot_string_s(opt1_sx[i])+"=(SELECT "+z_p.at_s(s_a,i)+" FROM "+opt4_s+")";comma_s=",";}
         w_s_n.s+=(z_p.e6c_b(z_p.db_c,'O','I','L','D','H')?" WHERE EXISTS(SELECT "+opt3_s+" FROM "+opt4_s+")":""); 
         rc=z_mt_p.sql_n.sql_usr2(w_s_n.s,usr_s);
         z_p.sql_count_123=z_p.db_affected_cnt;
         sw_sql=1;sw=CHECK_RC_10;continue;
        }
    if(true==sw_continue_b)continue;//switch内でcontinue指示有り。 
//====*( オペランド４個の場合の新文法処理用 )*****
    if(!next_operand_b())// VER24.1 オペランド４個判定
      {opt1_sx_v(); //カンマ区切りをopt1_sxに設定。
        if(z_p.e10s_b(s,"REPLACE_ALL2","REPLACE_PART","REPLACE_PART2","REPLACE_PART_ADD","REPLACE_PART_ADD2"
                      ,"REPLACE_PART_CHANGE","REPLACE_PART_CHANGE2","REPLACE_PART_CANCEL","REPLACE_ALL"))
            {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
             if(z_p.e2s_b(cmd2_s,"REPLACE_PART_CANCEL"))
                {if (2>z_p.count_sx_i(opt1_sx)){z_p.err_s="under (parameter count)<2";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}} 
             else if(3>z_p.count_sx_i(opt1_sx)){z_p.err_s="under (parameter count)<3";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
             rc=replace(opt1_sx[0],opt1_sx[1],opt2_s,shift_comma_s(opt1_s,2),opt3_s,opt4_s);sw_sql=1;sw=CHECK_RC_10;continue;
            }
      }
    rc_b=prog_edit2_b();//VER18.1
    opt5_s=w_prog_edit_s_n.s;z_mt_p.program_p.opt_org_sx[5]=w_prog_edit_org_s_n.s;
    z_p.err21_s+="{"+(z_p.e2s_b(w_prog_edit_s_n.s,"")?w_prog_edit_org_s_n.s:w_prog_edit_s_n.s)+"}";//VER18.1//コマンドをエラー表示の為記憶。
   if(CONTINUE_NORMAL_0==sw_skip)z_mt_p.trace_v(0,"{"+z_p.replace_rn_s(opt5_s,' ')+"}");//VER19.1
    if(!rc_b)if(CONTINUE_NORMAL_0==sw_skip){sw=ABORT_24;continue;}//VER18.1
   //====*******( オプション5個 )**********
    if(z_p.e3s_b(s,"PROGRAM","PROGRAM2"))   //VER23.1
        {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         sw_e_program_b=sw_p_program_b=sw_n_program_b=false;
         sw_0_program_b=false; //VER37_8.0.9
         opt3_s=z_p.trim_s(opt3_s); 
         if(-1!=z_p.index2c_i(opt3_s,' ')||z_p.e2s_b(opt3_s,"")){sw=ABORT_TABLE_SPACE_21;continue;}
         if(z_p.e2s_b(opt4_s,"")&&'0'!=z_p.at_s_c(opt1_s,0)){sw=ERROR_OPT4_NULL_14;continue;}
         z_p.clear_s_v(s_work_key_a);z_p.clear_s_v(s_work_data_a);
         z_p.add_s(s_work_key_a,"");z_p.add_s(s_work_data_a,"");

         if(z_p.e2s_b(opt1_s,"")){sw=ERROR_OPT1_NULL_11;continue;}
         if(z_p.e2s_b(opt2_s,""))
           {sw_data_b=false;
            if('3'==z_p.at_s_c(opt1_s,0)){z_p.err_s="operand2 is null[CHANGE]";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
           }
         else sw_data_b=true;
         if(('0'!=z_p.at_s_c(opt1_s,0)&&'1'!=z_p.at_s_c(opt1_s,0)&&'2'!=z_p.at_s_c(opt1_s,0)&&'3'!=z_p.at_s_c(opt1_s,0))
            ||3<z_p.length(opt1_s))
           {z_p.err_s="operand1 {"+opt1_s+"} error";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         if('2'==z_p.at_s_c(opt1_s,0)&&!z_p.e2s_b(opt5_s,""))
           {z_p.err_s="operand5 {"+opt5_s+"}{2 not space";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
         for(i=1;i<z_p.length(opt1_s);i++)
            if     ('E'==z_p.at_s_c(opt1_s,i)&&'0'!=z_p.at_s_c(opt1_s,0))sw_e_program_b=true;
            else if('P'==z_p.at_s_c(opt1_s,i)&&z_p.e3c_b(z_p.at_s_c(opt1_s,0),'1','3'))sw_p_program_b=true;
            else if('N'==z_p.at_s_c(opt1_s,i))sw_n_program_b=true;
            else if('0'==z_p.at_s_c(opt1_s,i))sw_0_program_b=true; //VER37_8.0.9
            else {z_p.err_s="operand1 {"+z_p.to_c_s(z_p.at_s_c(opt1_s,i))+"} error";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;sw_continue_b=true;break;}
         if(true==sw_continue_b)continue; 
         if(!z_p.e2s_b(opt4_s,""))
            {edit_s=opt4_s;edit=0;set_set_b(false); //VER23.1
             if(CHECK_RC_10==sw){if(0!=rc){sw_continue_b=true;continue;}} //VER26.1
             else {rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;sw_continue_b=true;continue;}
             if(!split_data_b(s_work_key_a,s_key_a,z_p.name_only_s(opt4_s))){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;} 
            }
         edit_s=opt2_s;edit=0;set_set_b(false); //VER23.1
         if(CHECK_RC_10==sw){if(0!=rc){sw_continue_b=true;continue;}} //VER26.1
         else {rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;sw_continue_b=true;continue;}
         if(sw_data_b)
           {if(!split_data_b(s_work_data_a,s_data_a,z_p.name_only_s(opt2_s))){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
           }
         if(0!=program(opt1_s,opt2_s,opt3_s,opt4_s,opt5_s))rc=z_p.SW_ERROR_5; //VER23.1 
         sw_sql=1;sw=CHECK_RC_10;continue;
        }
 else if(z_p.e2s_b(s,"LINK_SET"))
     {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
      if(!w_set_name_b(opt1_s)){rc=9;sw=RETURN_RETURN_30;continue;}
      w_data_n.data_s=z_mt_p.sql_n.link_set_b(opt2_s,opt3_s,opt4_s,opt5_s);
      sw=CHECK_RC_10;continue;
     }
   rc_b=prog_edit2_b();
   opt6_s=w_prog_edit_s_n.s;z_mt_p.program_p.opt_org_sx[6]=w_prog_edit_org_s_n.s;
   z_p.err21_s+="{"+(z_p.e2s_b(w_prog_edit_s_n.s,"")?w_prog_edit_org_s_n.s:w_prog_edit_s_n.s)+"}";//VER18.1//コマンドをエラー表示の為記憶。
  if(CONTINUE_NORMAL_0==sw_skip)z_mt_p.trace_v(0,"{"+z_p.replace_rn_s(opt6_s,' ')+"}");//VER19.1
   if(!rc_b)if(CONTINUE_NORMAL_0==sw_skip){sw=ABORT_24;continue;}//VER18.1
   //====*******( オプション6個 )**********
    if(z_p.e10s_b(s,"REPLACE_ALL2","REPLACE_PART","REPLACE_PART2","REPLACE_PART_ADD","REPLACE_PART_ADD2"
                  ,"REPLACE_PART_CHANGE","REPLACE_PART_CHANGE2","REPLACE_PART_CANCEL","REPLACE_ALL"))
        {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         rc=replace(opt1_s,opt2_s,opt3_s,opt4_s,opt5_s,opt6_s);sw_sql=1;sw=CHECK_RC_10;continue;
        }
    else if(z_p.e2s_b(s,"SMTP"))
        {if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
//JJ     z_p.dialog_box_error_v(z_mt_p,cmd2_s+" does not work by the JAVA","JAVA");     
//JHP    z_p.dialog_box_error_v(z_mt_p,cmd2_s+" does not work by the C++","C++");     
//SS          if(z_p.e2s_b(opt3_s,"")){sw=ERROR_OPT3_NULL_13;continue;}
//SS          if(z_p.e2s_b(opt4_s,"")){sw=ERROR_OPT4_NULL_14;continue;}
//SS          if(z_p.e2s_b(opt1_s,""))
//SS            {z_mt_p.program_p.find_name_i=0;//i=0;
//SS             if(!z_mt_p.program_p.find_name_b("ZZZZZZ_SMTP_SERVER",z_p.da_fix_a))
//SS               {z_p.err_s="(@ZZZZZZ_SMTP_SERVER) not found";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
//SS             opt1_s=z_p.lower_s(z_mt_p.program_p.da_find_name_data_p.data_s);
//SS            } 
#if IMENU
//SS          int port=0;
#endif //MENU 
//SS          opt1_s=z_p.lower_s(opt1_s);
//SS          if(z_p.e2s_b(opt2_s,""))
//SS            {z_mt_p.program_p.find_name_i=0;//i=0;
//SS             if(!z_mt_p.program_p.find_name_b("ZZZZZZ_SMTP_PORT",z_p.da_fix_a))
//SS               {z_p.err_s="(@ZZZZZZ_SMTP_PORT) not found";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
//SS                opt2_s=z_p.lower_s(z_mt_p.program_p.da_find_name_data_p.data_s);
//SS            }
#if IMENU
#endif //MENU 
//SS          if(!z_p.return_b){z_p.err_s="port not numeric";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
//SS          opt3_s=z_p.lower_s(opt3_s);
//SS          opt4_s=z_p.lower_s(opt4_s);
//SS          if(!z_p.e2s_b(z_p.real_test_s,"REAL")){opt5_s="*(TEST)*"+opt5_s;opt6_s="*(TEST)*"+opt6_s;}
#if IMENU
//SS          if(z_p.e2s_b(z_p.main_program_s,"IMENU"))
//SS            {if(0==z_mt_p.program_p.CONTROL_IX[z_mt_p.program_p.C_SMTP_15])
//SS             if(!z_p.dialog_box_yes_no_b("To="+opt3_s+"\nFrom="+opt4_s+"\nSubject="
//SS              +opt5_s+"\nBody="+opt6_s,"SMTP")){sw=CHECK_RC_10;continue;}//VER17
//SS            } 
#endif //MENU
//SS         for(i=0;;)//---------------------------------------------------------------
//SS           {j=z_p.index3c_i(opt3_s,';',i);
//SS            w_s_n.s=(-1==j?z_p.substring2_s(opt3_s,i):z_p.trim_s(z_p.substring3_s(opt3_s,i,j-i)));
//SS            try{if(!z_p.e2s_b(w_s_n.s,""))
//SS                   {
#if IMENU
///////////////////////(  Virus Error BEGIN )///////////////////////////////////////////////////
//SS                    System.Net.Mail.MailMessage MailMessage_n=
//SS                       new System.Net.Mail.MailMessage(opt4_s,w_s_n.s,opt5_s,opt6_s);
//SS                   SmtpClient SmtpClient_n=new SmtpClient(opt1_s,port);
//SS                   SmtpClient_n.Send(MailMessage_n);
///////////////////////(  Virus Error END)///////////////////////////////////////////////////
#endif //MENU
//SS                  }
//SS               }
//SS             catch(Exception e_ni){z_p.err_s=e_ni.Message;rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
//SS            i=j+1;
//SS            if(-1==j||z_p.length(opt3_s)<=i)break;
//SS           }//for(;;)-----------------------------------------------------------------
          sw=CHECK_RC_10;continue; //VER17
        }
   if(true==sw_continue_b)continue;//switch内でcontinue指示有り。 
    rc_b=prog_edit2_b();//VER18.1
    opt7_s=w_prog_edit_s_n.s;z_mt_p.program_p.opt_org_sx[7]=w_prog_edit_org_s_n.s;
    z_p.err21_s+="{"+(z_p.e2s_b(w_prog_edit_s_n.s,"")?w_prog_edit_org_s_n.s:w_prog_edit_s_n.s)+"}";//VER18.1//コマンドをエラー表示の為記憶。
  if(CONTINUE_NORMAL_0==sw_skip)z_mt_p.trace_v(0,"{"+z_p.replace_rn_s(opt7_s,' ')+"}");//VER19.1
    if(!rc_b)if(CONTINUE_NORMAL_0==sw_skip){sw=ABORT_24;continue;}//VER18.1
   //====*******( オプション7個 )**********
   if(z_p.e3s_b(s,"CURSOR","CURSOR2"))
        {if('M'==z_mt_p.program_c){sw=ABORT_MENU_23;continue;}
         if(CONTINUE_NORMAL_0!=sw_skip){sw=LOOP_2;continue;}  //スキップ中 
         if(z_p.e2s_b(opt1_s,"")){sw=ERROR_OPT1_NULL_11;continue;} 
         if(z_p.e2s_b(opt2_s,"")){sw=ERROR_OPT2_NULL_12;continue;} 
         String where_s=(z_p.e2s_b(cmd2_s,"CURSOR")?" WHERE Z_CANCEL=' '":"");
         if('H'==z_p.db_c)//HのみDROP実行。
           {w_s_n.s="DROP PROCEDURE "+z_mt_p.program_p._pmx_wp_s()+"__";
            rc=z_mt_p.sql_n.sql_usr2(w_s_n.s,usr_s);
            if(0!=rc)
              {if(z_p.e2s_b(z_p.db_i_error_s,"NOT_EXIST"))
                 {z_p.db_error_s="";z_p.db_i_error_s="";rc=0;}//無しはエラーとせず。
               else {sw_sql=1;sw=CHECK_RC_10;continue;}
              }
           }

         ii_zz_l o_declare_s_n=new ii_zz_l();ii_zz_l keys_s_n=new ii_zz_l();ii_zz_l sep_s_n=new ii_zz_l();
         keys_s_n.s=z_mt_p.db_n.o_fd_s; 
         if('O'!=z_p.db_c)if(0!=z_mt_p.sql_n.create_table(o_declare_s_n,keys_s_n,z_p.split_sx(o_declare_s,','),"",usr_s,sep_s_n,1,"")) //declare 設定
                             {rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
//====( opt3=where )***
         if(!z_p.e2s_b(opt3_s,""))where_s+=(z_p.e2s_b(where_s,"")?" WHERE (":" AND (")+z_p.new_line_s()+opt3_s+")";
//====( opt4=declear )***
         if(!z_p.e2s_b(opt4_s,""))
           {keys_s_n.s=z_mt_p.db_n.o_wd_s; 
            if(0!=z_mt_p.sql_n.create_table(o_declare_s_n,keys_s_n,z_p.split_sx(o_declare_s+(z_p.e2s_b(opt4_s,"")?"":","+opt4_s),','),"",usr_s,sep_s_n,1,"")) //declare 設定
               {rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
           }
//=============================
         w_s_n.s=z_mt_p.db_n.c_begin1_s+(z_p.e2s_b(z_mt_p.db_n.c_begin2_s,"")?""
                 :z_mt_p.work_table_s()+z_mt_p.db_n.c_begin2_s)
                +(z_p.e2s_b(z_mt_p.db_n.c_begin3_s,"")?""
                 :z_mt_p.work_table_s()+z_mt_p.db_n.c_begin3_s)+z_mt_p.db_n.object_begin_s+z_mt_p.db_n.c_begin9_s// BEGIN
           +" DECLARE "+z_mt_p.db_n.o_end_sw_s+" INT"+z_mt_p.db_n.o_default_s+"0;"+o_declare_s_n.s //DECLARE 
             +z_mt_p.db_n.c_cursor_s+o_select_s+" FROM "+z_mt_p.program_p.o_table_sx[0]+" X1 "+where_s
             +(z_p.e2s_b(o_order1_s,"")?(z_p.e2s_b(o_order2_s,"")?"":" ORDER BY "+o_order2_s):" ORDER BY "
             +o_order1_s+(z_p.e2s_b(o_order2_s,"")?"":","+o_order2_s))
             +('O'!=z_p.db_c?"":";F O_CURSOR%ROWTYPE")//CURSOR SQL
              +z_mt_p.db_n.c_start_s+z_mt_p.db_n.object_main_s//CURSOR_START,OBJECT_MAIN
              +z_mt_p.db_n.c_fetch_s+o_into_s+";"
               +z_mt_p.db_n.c_loop_s
//===============================
               +(z_p.e2s_b(o_sql_key1_s,"")?""
               :z_p.new_line_s()+z_mt_p.db_n.o_if_s+" "+o_sql_key1_s+z_mt_p.db_n.o_end_sw_s+"<>0 "+z_mt_p.db_n.o_then_s+" BEGIN"
               +z_p.new_line_s()+opt7_s
               +z_p.new_line_s()+z_mt_p.db_n.o_if_s+" "+z_mt_p.db_n.o_end_sw_s+"=0 "+z_mt_p.db_n.o_then_s+" BEGIN "+o_sql_key2_s
               +z_p.new_line_s()+opt5_s
               +z_p.new_line_s()+z_mt_p.db_n.o_end_s+" "+z_mt_p.db_n.o_end_if_s
               +z_p.new_line_s()+z_mt_p.db_n.o_end_s+" "+z_mt_p.db_n.o_end_if_s)
               +z_p.new_line_s()+z_mt_p.db_n.o_if_s+" "+z_mt_p.db_n.o_end_sw_s+"=0 "+z_mt_p.db_n.o_then_s+" BEGIN"
               +(z_p.e2s_b(o_sql_key1_s,"")?z_p.new_line_s()+opt5_s:"")
               +z_p.new_line_s()+opt6_s
               +(z_p.e2s_b(o_sql_key1_s,"")?z_p.new_line_s()+opt7_s:"")
               +z_p.new_line_s()+z_mt_p.db_n.o_end_s+" "+z_mt_p.db_n.o_end_if_s
//==============================
               +z_mt_p.db_n.c_stop_s+z_mt_p.db_n.c_end0_s
               +z_mt_p.db_n.object_end_s+z_mt_p.db_n.c_end1_s
               +(z_p.e2s_b(z_mt_p.db_n.c_end2_s,"")?"":z_mt_p.work_table_s()+z_mt_p.db_n.c_end2_s)
               +(z_p.e2s_b(z_mt_p.db_n.c_end3_s,"")?""
                 :z_mt_p.work_table_s()+z_mt_p.db_n.c_end3_s);//STOP+END
         rc=z_mt_p.sql_n.sql_usr2(w_s_n.s,usr_s);//カーソル実行(Hは定義のみ）
         if('H'==z_p.db_c)
           {if(0==rc){w_s_n.s="CALL "+z_mt_p.work_table_s()+"__()";
                      rc=z_mt_p.sql_n.sql_usr2(w_s_n.s,usr_s);//"H"はCALL実行
                     }
            String save_db_error_s="",save_db_i_error_s="";int save_rc=0;
            if(0!=rc){save_db_error_s=z_p.db_error_s;save_db_i_error_s=z_p.db_i_error_s;}//エラーをキープ。
            w_s_n.s="DROP PROCEDURE "+z_mt_p.work_table_s()+"__";
            save_rc=z_mt_p.sql_n.sql_usr2(w_s_n.s,usr_s);//"H"はDROPを無条件実行。
            if(0!=rc){z_p.db_error_s=save_db_error_s;z_p.db_i_error_s=save_db_i_error_s;}//エラーを戻す。
            else rc=save_rc; //DROP 判定。
           }
        sw=CHECK_RC_10;continue;
        }
   z_p.err_s="commnd ("+w_cmd_s_n.s+") error";
   sw=ABORT_24;continue;
     }
  if(IF_NOT_CHECK_5>=sw)//IF_.._NOTの場合は判定結果を逆にする。
     {if(z_p.ends_with_b(cmd2_s,"_NOT"))sw_skip=(SKIP_IF_2==sw_skip?CONTINUE_IF_M1:SKIP_IF_2);//スキップ条件反転。
      if(sw_skip==SKIP_IF_2)z_mt_p.trace_v(0,":(skip)");
      sw=LOOP_2;continue;//次の命令実行
     }
   if(SERVER_PROG_6>=sw) 
     {if(-1!=z_p.index2c_i(path_s,' '))
        {z_p.err_s="find ' ' (path name) "+cmd2_s+"{"+path_s+"}";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
      if(!z_p.dot_dot_check_b(path_s)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
      if(!z_p.dot_dot_check_b(file_s)){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;continue;}
      if(z_p.e2s_b(path_s,""))path_s="TMP";
      rc=z_mt_p.socket_n.client(cmd2_s,path_s,file_s,z_mt_p);
       sw=CHECK_RC_10;continue; //VER17 
      //====*
     }
    if(SQL_NEXT_8>=sw) // SQL_REPEAT,SQL_SET
     {sql_column_cnt=0;
       for(;;)//--------------------------------------------------------
         {if(z_p.count_s_i(s_sql_a)<=z_mt_p.program_p.sql_cnt_ix[sql_cnt])
            {
#if IMENU
              if(z_p.e2s_b(z_p.main_program_s,"IMENU"))z_p.err_s=z_p.at_s(z_p.s_lang_a,z_mt_p.txt_not_found);
#endif //MENU
             if(0==z_mt_p.program_p.CONTROL_IX[z_mt_p.program_p.C_IF_ERROR_7]
                &&z_p.e3s_b(cmd2_s,"SQL_REPEAT","SQL_SET"))sw=CHECK_RC_10;//VER17
             else sw=LOOP_2; //データ無は";"まで移動しない。(次の命令を実行）
             sw_continue_b=true;break;
            }
          if(!edit_word_b(w_s_n,",}")){sw=ABORT_24;sw_continue_b=true;break;}
          if(!z_p.e2s_b(w_s_n.s,""))
            {if(z_p.e2s_b(cmd2_s,"SQL_REPEAT"))w_s_n.s+=z_p.to_i_s(i);//SQL_REPEATは番号付加。
             if(!w_set_name_b(w_s_n.s)){sw=ABORT_24;sw_continue_b=true;break;}
            }
          sql_column_cnt++;
          if(z_p.count_s_i(s_sql_a)<=z_mt_p.program_p.sql_cnt_ix[sql_cnt]
            ||sql_column_cnt>z_mt_p.program_p.sql_column_cnt_ix[sql_cnt])w2_s_n.s="";
          else w2_s_n.s=z_p.at_s(s_sql_a,z_mt_p.program_p.sql_cnt_ix[sql_cnt]++);
          if(!z_p.e2s_b(w_s_n.s,""))if(0!=w_set_data(w2_s_n.s))
            {if(z_p.e3s_b(cmd2_s,"SQL_REPEAT","SQL_SET")){sw=CHECK_RC_10;rc=1;sw_continue_b=true;break;} //VER26.1
             else {sw=ABORT_24;sw_continue_b=true;break;}
            }
          if(','!=edit_c)break;
         }//for(;;)//-----------------------------------------------------------------------
      if(true==sw_continue_b)continue;//for(;;)内でcontinue指示有り。
      if(sql_column_cnt<z_mt_p.program_p.sql_column_cnt_ix[sql_cnt])
         z_mt_p.program_p.sql_cnt_ix[sql_cnt]+=z_mt_p.program_p.sql_column_cnt_ix[sql_cnt]-sql_column_cnt;
      if(z_p.e2s_b(cmd2_s,"SQL_REPEAT")){edit=0;i++;sw=SQL_NEXT_8;continue;}//SQL_REPEATは繰り返す。
      if(z_p.e2s_b(cmd2_s,"SQL_SET")){sw=CHECK_RC_10;continue;}//VER17
      sw=SKIP_LOOP_1;continue; //データ有りは";"まで移動する。
     }//if(SQL_NEXT_8>=sw)
   if(CHECK_RC_10>=sw)//rc：0=正常終了次へ、9=異常終了アボートへ、以外はエラーメッセージへ。
     {if(1==sw_sql){if(0!=rc)z_mt_p.trace_v(0,"*?(db_error)?*="+z_p.db_error_s);}//DBエラートレース書き出し。
      if(9==rc){sw=ABORT2_25;continue;} //VER17 //VER15.1　致命エラーでアボート
      //==（エラー無）IF_ERROR_で無い又はCONTINUE_である場合次へ(LOOP_2)、IF_ERROR_で有りかつCONTINUE_で無い場合は；まで(SKIP_LOOP_1)
      if(0==rc)
           {sw=(1==sw_continue||0==sw_if_error?LOOP_2:SKIP_LOOP_1);
            //if(sw==SKIP_LOOP_1)z_mt_p.trace_v(0,":(skip)");
             continue;
           }  //VER15.1　//VER17　
      //====（エラー有り）IF_ERROR_で有りかつCONTINUE_で無い場合は次へ。（LOOP_2)
      if(1==sw_if_error&&0==sw_continue){sw=LOOP_2;sw_skip=IF_ERROR_3;continue;};//VER17 IF_ERRORで処理続行。
      if(0==z_mt_p.program_p.CONTROL_IX[z_mt_p.program_p.C_ERROR_5]){sw=ABORT2_25;continue;} //VER17　エラー処理無でアボート
       sw=ERR_26;continue;  //VER17
     }//if(SQL_CHECK_RC_10>=sw)
   if(ERROR_OPT1_NULL_11>=sw){z_p.err_s=" operand1 is null";sw=CHECK_RC_10;rc=1;continue;}//VER17   //VER24.1 ERR->CHECK_RC_10;
   if(ERROR_OPT2_NULL_12>=sw){z_p.err_s=" operand2 is null";sw=CHECK_RC_10;rc=1;continue;}//VER17   //VER24.1 ERR->CHECK_RC_10;
   if(ERROR_OPT3_NULL_13>=sw){z_p.err_s=" operand3 is null";sw=CHECK_RC_10;rc=1;continue;}//VER17   //VER24.1 ERR->CHECK_RC_10;
   if(ERROR_OPT4_NULL_14>=sw){z_p.err_s=" operand4 is null";sw=CHECK_RC_10;rc=1;continue;}//VER17   //VER24.1 ERR->CHECK_RC_10;
   if(ERROR_OPT5_NULL_15>=sw){z_p.err_s=" operand5 is null";sw=CHECK_RC_10;rc=1;continue;}//VER23.1   //VER24.1 ERR->CHECK_RC_10;
   rc=0;
   for(i=z_p.prog_n.i;z_p.length(z_p.prog_s_n.s)>i;i++)
    {if     (';'==z_p.at_s_c(z_p.prog_s_n.s,i))break;
      else if('{'==z_p.at_s_c(z_p.prog_s_n.s,i)){sw=LOOP_2;sw_continue_b=true;break;}
    }
   if(true==sw_continue_b)continue;//for(内でcontinue指示対応。
   if(1==z_mt_p.program_p.CONTROL_IX[z_mt_p.program_p.C_ERROR_5]){sw=ERR_26;continue;}
   sw=ABORT_24;
  }//for(;;)
//====* 
if(ABORT_SET_18>=sw){z_p.err_s="(SET{"+w1_s_n.s+"=...})error";sw=ABORT_24;}
if(ABORT_PROGRAM_19>=sw)
  {if     ('M'==z_mt_p.program_c)z_p.err_s="menu-job command ("+w_cmd_s_n.s+") error";
   else if('T'==z_mt_p.program_c)z_p.err_s="time-job command ("+w_cmd_s_n.s+") error";
   else                          z_p.err_s="file-job command ("+w_cmd_s_n.s+") error";
   sw=ABORT_24;
  }
if(ABORT_CMD_20>=sw){z_p.err_s="command("+w_cmd_s_n.s+") error";sw=ABORT_24;}
if(ABORT_TABLE_SPACE_21>=sw){z_p.err_s="table name space found ["+w_cmd_s_n.s+"{"+opt1_s+"}]";sw=ABORT_24;}
if(ABORT_OBJECT_SPACE_22>=sw){z_p.err_s="object name space found ["+w_cmd_s_n.s+"{"+opt1_s+"}]";sw=ABORT_24;}
if(ABORT_MENU_23>=sw){z_p.err_s="menu not use("+w_cmd_s_n.s+"{})";sw=ABORT_24;}
if(ABORT_24>=sw)z_p.db_error_s="";
if(ABORT2_25>=sw){z_mt_p.sw_err=z_p.SW_ABORT_9;sw=ERR_ERR_27;}
if(ERR_26>=sw)z_mt_p.sw_err=z_p.SW_ERROR_5;
if(ERR_ERR_27>=sw)
  {z_p.err2_s="["+z_p.to1_i_s(z_p.count_pr_i(z_mt_p.program_list_n.pr_a))+","+in_data_n.name_s+"]";  //VER18.1
   if(z_p.e2s_b(z_p.db_error_s,"")&&0==z_p.sw_cgi)z_p.err3_s=z_p.substring2_s(z_p.prog_s_n.s,prog_cmd);
  }
if(RETURN1_28>=sw){rc=1;sw=RETURN_RETURN_30;}//return 1;で終了。
if(RETURN0_29>=sw){rc=0;z_p.err_s="";z_p.db_error_s="";z_p.db_i_error_s="";}//return 0;で終了
z_mt_p.program_p.job_permission_s=z_mt_p.program_p.job_permission_default_s;//許可を初期値に戻す。
z_p.real_test_s=z_p.test_s;   //REAL_TESTを初期値に戻す。　　　　　　　　　　　　　　　　　　　　　　　　　
if(z_p.e2s_b(in_kind_s,"?"))z_p.receive_sw_s="";
//HP z_p.clear_s_v(s_sql_a);
//HP z_p.clear_s_v(s_w_a);
//HP z_p.clear_s_v(s_type_a);
//HP z_p.clear_s_v(s_tag_a);
//HP z_p.clear_i_v(i_tag_cnt_a);
z_p.t_v(z_p.SE,"section)");
return rc;
}
//===========================( section() END )==================================================================
//== ( swは途中はABORT_24又はCHECK_RC_10,ABORT_SET_18,ERR_26を設定 )====
//== ( swは終了はABORT_24又はCHECK_RC_10）====
//== ( エラーはsw==CHECK_RC_10の時rcに設定 )====
bool set_set_b(bool set_bi)
{z_p.t_v(z_p.SE,"set_set_b(");
int i=0,j=0,k=0;
if(!set_bi)sw_continue_b=false;
sw_error=z_p.SW_OFF_0;error_s="";
for(;;)
  {if(!edit_word_b(w1_s_n,"+=,}")){sw=ABORT_24;z_p.t_v(z_p.SE,"set_set_b)1");return false;} //左辺名前w1_s_nに設定//VER23.1(",}"を追加)
   if(z_p.e3c_b(edit_c,'+','='))break;//VER23.1
   if(set_bi){z_p.err_s="'=' not found";sw=ABORT_24;z_p.t_v(z_p.SE,"set_set_b)2");return false;} //VER23.1
              if(z_p.e2c_b(edit_c,'}')){rc=sw_error;z_p.err_s=error_s;sw=CHECK_RC_10;sw_continue_b=true;z_p.t_v(z_p.SE,"set_set_b)3");return false;}//終了　VER23.1
  }
int SET1=1,SET2=2,SET3=3,SET_NEXT=4,SET_OK=5;//プログラム制御用スイッチ
for(int sw2=0;;)//////( sw2 w1_n.sが左辺)<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
     {//swtchまたは内部for()内でcontinueが必要な時はtrueにする。
      if(SET1>=sw2)//--------------------------------------------------------------(SET1>=sw2)   
        {property_s=""; 
         if(-1!=(sw_set=z_p.index2sx_i(RESERV_SX,z_p.upper_s(w1_s_n.s)))){sw2=SET2;continue;}//予約語左辺はSET2へ
         if(-1!=(sw_set=z_p.index2sx_i(RESERV2_SX,z_p.upper_s(w1_s_n.s))))//ファイル起動処理のみ有効。//
           {if('F'==z_mt_p.program_c){sw2=SET2;continue;}                 //ファイル起動処理予約語左辺はSET2へ
            else {sw=ABORT_SET_18;sw_continue_b=true;break;}
           } 
         if(!z_p.e2s_b(w1_s_n.s,"")&&-1!=(i=z_p.index3c_i(w1_s_n.s,'@',1)))
           {property_s=z_p.substring2_s(w1_s_n.s,i);set_s=z_p.substring3_s(w1_s_n.s,0,i);}//@前をset_sに@以降をproperty_sに設定。
         else set_s=w1_s_n.s;     //set_sが左辺名 
         if(z_p.e2s_b(set_s,"_DATA"))
           {if(z_p.e3s_b(z_mt_p.program_p.now_kind_s,"DATA","SET")
               ||(z_p.e2s_b(z_mt_p.program_p.now_kind_s,"START")&&!z_p.e2s_b(property_s,"")))
              {w_data_n=in_data_n;w_kind_s=z_mt_p.program_p.now_kind_s;}//_DATAの場合自分自身を設定。
            else {sw=ABORT_24;sw_continue_b=true;break;}
           }
         else if(!w_set_name_b(set_s)){sw=ABORT_24;sw_continue_b=true;break;} //データ名判定。
         if(!z_p.e2s_b(z_mt_p.program_p.program_s,"NOT")&&z_p.e2s_b(w_kind_s,"DATA")
            &&!z_p.e4s_b(z_mt_p.program_p.now_kind_s,"DATA","START","SQL")
            &&!z_p.starts_with_b(z_mt_p.program_p.now_kind_s,"STOP")&&!z_p.e2s_b(in_kind_s,"COLOR"))
            if(z_p.e2s_b(property_s,""))
              {z_p.err_s="not set \""+w_data_n.name_s+"\"";sw=ABORT_24;sw_continue_b=true;break;}
         w1_s_n.s=w_data_n.name_s;
        }
         if(SET2>=sw2)//--------------------------------------------------------------(SET2>=sw2)
           {w2_s_n.s="";
            if('+'==edit_c)
              {if(!edit_left_b("=")){sw=ABORT_24;sw_continue_b=true;break;}
               w2_s_n.s=w_data_n.data_s;
              }
            else w2_s_n.s="";
           }//if(SET2>=sw2)
         if(SET3>=sw2)//--------(右辺の値をw2_s_n.sに追加 )------------------------------------------------(SET3>=sw2)
           {if(!edit_word_b(w_s_n,"+,}")){sw=ABORT_24;sw_continue_b=true;break;}//右辺の名前w_s_nに設定
            if(!get_data_b(w_s_n,w_type_c_n,w_s_n.s)){sw=ABORT_24;sw_continue_b=true;break;}//右辺の名前を値に変換=w_s_n.s
            type_cx[0]=w_type_c_n.c; 
            if('+'==edit_c){w2_s_n.s+=w_s_n.s;sw2=SET3;continue;} //w2_s_n.sに追加して再処理。
            String s_s=z_p.upper_s(w1_s_n.s);
            if(z_p.e2s_b(s_s,"_PART"))
              {if('F'!=z_mt_p.program_c||2!=z_p.length(w_s_n.s)){sw=ABORT_24;sw_continue_b=true;break;}
               w3_s_n.s=z_p.part_s=w_s_n.s;
               sw2=SET_NEXT;continue;
              }
            if(z_p.e2s_b(s_s,"_JOB_PART"))
              {if(!z_mt_p.check_part_b(w_s_n.s,cmd2_s+"{"+z_p.upper_s(w1_s_n.s)+"=")){sw=ERR_26;sw_continue_b=true;break;}
               w3_s_n.s=z_mt_p.program_p.job_part_s=w_s_n.s; 
               sw2=SET_NEXT;continue;
              }
                  if(z_p.e2s_b(s_s,"_JOB_PERMISSION"))
                    {if(!z_mt_p.check_permission_b(w_s_n.s,cmd2_s+"{"+z_p.upper_s(w1_s_n.s)+"=")){sw=ERR_26;sw_continue_b=true;break;}
                     w3_s_n.s=z_mt_p.program_p.job_permission_s=w_s_n.s; 
                     sw2=SET_NEXT;continue;
                    }
                  if(z_p.e2s_b(s_s,"_SQL_PERMISSION"))
                    {if(!z_mt_p.check_permission_b(w_s_n.s,cmd2_s+"{"+z_p.upper_s(w1_s_n.s)+"=")){sw=ERR_26;sw_continue_b=true;break;}
                     w3_s_n.s=z_mt_p.program_p.sql_permission_s=w_s_n.s;
                     sw2=SET_NEXT;continue;
                    }
                  if(z_p.e2s_b(s_s,"_DRIVE_FREE"))
                    {w3_s_n.s="0";
//SJ                 try{
//HP                 QStorageInfo si_nn(z_p.substring3_s(w_s_n.s,0,1)+":\\");
//SS                 System.IO.DriveInfo drive_n=new System.IO.DriveInfo(z_p.substring3_s(w_s_n.s,0,1));
//JJ                 javax.swing.filechooser.FileSystemView fsv_nn=javax.swing.filechooser.FileSystemView.getFileSystemView();
//JJ                 File f_n=new File(z_p.substring3_s(w_s_n.s,0,1)+":\\");
//HP                 w3_s_n.s=QString::fromStdString(std::to_string(si_nn.bytesFree())); //availableDiskSpace(z_p.substring3_s(w_s_n.s,0,1))));
//SJ                 w3_s_n.s=""+
//SS                 drive_n.TotalFreeSpace;
//JJ                 f_n.getFreeSpace();
//SJ                    }catch(Exception){w3_s_n.s="0";} 
//HP                 if(z_p.e2s_b(w3_s_n.s,"-1"))w3_s_n.s="0";//負は補正
                     z_mt_p.program_p.drive_free_s=w3_s_n.s;
                     sw2=SET_NEXT;continue;
                    } 
                  if(z_p.e2s_b(s_s,"_DRIVE_TYPE"))
                    {w3_s_n.s="UNKNOWN";
#if W
//SJ                 try{
//HP                 TCHAR dr_tx[4];LPCTSTR dr_lp=reinterpret_cast<LPCTSTR>(w_s_n->s.utf16());
//HP                 dr_tx[0]=dr_lp[0];dr_tx[1]=':';dr_tx[2]='\\';dr_tx[3]='\0';
//SS                 System.IO.DriveInfo drive_n=new System.IO.DriveInfo(z_p.substring3_s(w_s_n.s,0,1));
//JJ                 javax.swing.filechooser.FileSystemView fsv_nn=javax.swing.filechooser.FileSystemView.getFileSystemView();
//JJ                 File f_n=new File(z_p.substring3_s(w_s_n.s,0,1)+":\\");
//HP                 if(DRIVE_FIXED==GetDriveType(dr_tx)) 
//SS                 if(System.IO.DriveType.Fixed==drive_n.DriveType) 
//JJ                 if(z_p.e3s_b(fsv_nn.getSystemTypeDescription(f_n),"ローカル ディスク","Local Disk"))
                        w3_s_n.s="FIXED"; 
//HP                 else if(DRIVE_REMOTE==GetDriveType(dr_tx)) 
//SS                 else if(System.IO.DriveType.Network==drive_n.DriveType) 
//JJ                 else if(z_p.e3s_b(fsv_nn.getSystemTypeDescription(f_n),"ネットワーク ドライブ","Network Drive"))
                        w3_s_n.s="NETWORK"; 
//HP                 else if(DRIVE_CDROM==GetDriveType(dr_tx)) 
//SS                 else if(System.IO.DriveType.CDRom==drive_n.DriveType) 
//SP                    w3_s_n.s="CDROM"; 
//HP                 else if(DRIVE_REMOVABLE==GetDriveType(dr_tx)) 
//SS                 else if(System.IO.DriveType.Removable==drive_n.DriveType) 
//JJ                 else if(z_p.e3s_b(fsv_nn.getSystemTypeDescription(f_n),"リムーバブル ディスク","Removable Disk"))
                        w3_s_n.s="REMOVABLE"; 
//HP                 else if(DRIVE_RAMDISK==GetDriveType(dr_tx)) 
//SS                 else if(System.IO.DriveType.Ram==drive_n.DriveType) 
//SP                     w3_s_n.s="RAM"; 
//SJ                     }catch(Exception){}
#endif //W
                     z_mt_p.program_p.drive_type_s=w3_s_n.s;
                     sw2=SET_NEXT;continue;
                    }
                  if(z_p.e2s_b(s_s,"_WMI"))
                    {z_mt_p.program_p.wmi_s=w3_s_n.s=""; 
#if W
//HP                 z_p.dialog_box_error_v(z_p.upper_s(w1_s_n.s)+" does not work by the CPP","CPP");     
//SS #pragma warning disable CA1416
//SS                 try{w3_s_n.s=(new System.Management.ManagementObject(w2_s_n.s))[w_s_n.s].ToString();}
//SS                 catch(Exception){w3_s_n.s="";}
//SS #pragma warning restore CA1416
//SS                 z_mt_p.program_p.wmi_s=w3_s_n.s;
//JJ                 z_p.dialog_box_error_v(z_mt_p,z_p.upper_s(w1_s_n.s)+" does not work by the JAVA","JAVA");     
#endif //W
                     sw2=SET_NEXT;continue;
                    }
                  if(z_p.e2s_b(s_s,"_REGISTRY"))
                    {
                     z_p.registry_key_s="";
                     z_p.registry_s=w3_s_n.s="";
#if W
//SS #pragma warning disable CA1416
//HP                 HKEY Hkey_nn;DWORD Data_dw;DWORD Data_size_dw;LONG rc_l;
//HP                 Data_size_dw=(int)sizeof(Data_dw);
//HP                 rc_l=::RegOpenKeyEx(HKEY_LOCAL_MACHINE,w2_s_n.s.toStdWString() .data(),NULL,KEY_QUERY_VALUE,&Hkey_nn);
//HP                 if(rc_l!=ERROR_SUCCESS){sw_error=z_p.SW_ERROR_5;error_s="_REGISTRY KEY NOT FOUND";sw2=SET_NEXT;continue;};
//HP                 rc_l=::RegQueryValueEx(Hkey_nn,w_s_n.s.toStdWString() .data(),0,NULL,(LPBYTE)&Data_dw,&Data_size_dw);
//HP                 if(rc_l==ERROR_SUCCESS){z_p.registry_key_s=w2_s_n.s;z_p.registry_s=w3_s_n.s=QString::number(Data_dw);}
//HP                 else {sw_error=z_p.SW_ERROR_5;error_s="_REGISTRY SUBKEY NOT FOUND";}
//HP                 ::RegCloseKey(Hkey_nn);
//SS                 try{Microsoft.Win32.RegistryKey key=Microsoft.Win32.Registry.LocalMachine.OpenSubKey(w2_s_n.s);　//VER33.1
//SS                     w3_s_n.s=z_p.registry_s=key.GetValue(w_s_n.s).ToString();
//SS                     if( null ==w3_s_n.s)w3_s_n.s=z_p.registry_s="";  
//SS                    }catch(Exception e_ni){sw_error=z_p.SW_ERROR_5;error_s=e_ni.Message;w2_s_n.s="";}
//SS                 z_p.registry_key_s=w2_s_n.s;
//JJ                 z_p.dialog_box_error_v(z_mt_p,z_p.upper_s(w1_s_n.s)+" does not work by the JAVA","JAVA");     
//SS #pragma warning restore CA1416
#endif //W
                      sw2=SET_NEXT;continue;
                    }
                   if(z_p.e2s_b(s_s,"_REGISTRY_WRITE"))
                     {
#if W
//SS #pragma warning disable CA1416
//HP                 HKEY Hkey_nn;DWORD Disposition_dw;LONG rc_l;
//HP                 rc_l=::RegCreateKeyEx(HKEY_LOCAL_MACHINE,z_p.registry_key_s.toStdWString() .data(),0,NULL,REG_OPTION_NON_VOLATILE
//HP                        ,KEY_ALL_ACCESS,NULL,&Hkey_nn,&Disposition_dw);
//HP                 if(rc_l!=ERROR_SUCCESS){sw_error=z_p.SW_ERROR_5;error_s="_REGISTRY_WRITE KEY ERROR";sw2=SET_NEXT;continue;};
//HP                 int i=w_s_n.s.toInt();
//HP                 rc_l=::RegSetValueEx(Hkey_nn,w2_s_n.s.toStdWString() .data(),0,REG_DWORD,(CONST BYTE*)&i,(int)sizeof(i));
//HP                 if(rc_l!=ERROR_SUCCESS){sw_error=z_p.SW_ERROR_5;error_s="_REGISTRY_WRITE WRITE ERROR";}
//HP                 ::RegCloseKey(Hkey_nn);
//SS                 if(1!=z_p.sw_setup){z_p.err_s="not use (setup)";sw=ABORT_24;sw_continue_b=true;break;}  
//SS                  w3_s_n.s=w2_s_n.s+"+"+w_s_n.s;i=0;Object o;
//SS                  try{o=Convert.ToInt32(w_s_n.s);}catch(Exception){o=w_s_n.s;} 
//SS                  try{Microsoft.Win32.RegistryKey key=Microsoft.Win32.Registry.LocalMachine.CreateSubKey(z_p.registry_key_s); //VER33.1
//SS                      key.SetValue(w2_s_n.s,o);
//SS                      }catch(Exception e_ni){sw_error=z_p.SW_ERROR_5;error_s=e_ni.Message;}
//JJ                  z_p.dialog_box_error_v(z_mt_p,z_p.upper_s(w1_s_n.s)+" does not work by the JAVA","JAVA");     
//SS #pragma warning restore CA1416
#endif //W
                      sw2=SET_NEXT;continue;
                     }
                   if(z_p.e2s_b(s_s,"_UPPER"))
                     {w3_s_n.s=z_mt_p.program_p.upper_s=z_p.upper_s(w2_s_n.s)+z_p.upper_s(w_s_n.s);sw2=SET_NEXT;continue;}
                   if(z_p.e2s_b(s_s,"_URL_DECODE"))
                     {w3_s_n.s=z_mt_p.program_p.url_decode_s=z_p.url_decode_s(w2_s_n.s+w_s_n.s,z_mt_p.program_p.url_encode_decode_s);sw2=SET_NEXT;continue;}
                   if(z_p.e2s_b(s_s,"_URL_ENCODE"))
                     {w3_s_n.s=z_mt_p.program_p.url_encode_s=z_p.url_encode_s(w2_s_n.s+w_s_n.s,z_mt_p.program_p.url_encode_decode_s);sw2=SET_NEXT;continue;}
                   if(z_p.e2s_b(s_s,"_URL_ENCODE_DECODE"))
                     {if(z_p.e2s_b(z_p.url_encode_s("日本",w2_s_n.s+w_s_n.s),"日本")){sw_error=z_p.SW_ERROR_5;error_s="_URL_ENCODE_DECODE";sw2=SET_NEXT;continue;}
                      w3_s_n.s=z_mt_p.program_p.url_encode_decode_s=w2_s_n.s+w_s_n.s;sw2=SET_NEXT;continue;
                     }
                   if(z_p.e2s_b(s_s,"_LOWER")){w3_s_n.s=z_mt_p.program_p.lower_s=z_p.lower_s(w2_s_n.s)+z_p.lower_s(w_s_n.s);sw2=SET_NEXT;continue;}
                   if(z_p.e2s_b(s_s,"_PERSON")){w3_s_n.s=z_p.person_s=w_s_n.s;sw2=SET_NEXT;continue;}
                   if(z_p.e2s_b(s_s,"_PASSWORD"))
                     {if(sw_ok_password_b||z_p.e3s_b(z_p.job_s,"ZZZZ010121","ZZZZ010124")) 
                         w3_s_n.s=z_p.password_s=z_p.password_n.pwd_s(w2_s_n.s,z_p.setup_s,w_s_n.s);
                      else w3_s_n.s=z_p.password_s=""; 
                      sw2=SET_NEXT;continue;
                     }
                   if(z_p.e2s_b(s_s,"_LANG_SYSTEM")){w3_s_n.s=z_p.lang_system_s=w2_s_n.s+w_s_n.s;sw2=SET_NEXT;continue;}
                   if(z_p.e2s_b(s_s,"_FIND_CHAR"))
                     {for(i=0;z_p.length(w2_s_n.s)>i;i++)
                        {for(j=0;z_p.length(w_s_n.s)>j;j++){if(z_p.at_s_c(w2_s_n.s,i)==z_p.at_s_c(w_s_n.s,j))break;}//一致判定
                            if(z_p.length(w_s_n.s)>j)break;//一致は判定中止
                        }
                      if(z_p.length(w2_s_n.s)==i)i=-1;//一致無しは0化。
                      w3_s_n.s=z_mt_p.program_p.find_char_s=z_p.to1_i_s(i+1);
                      sw2=SET_NEXT;continue;
                     }
                   if(z_p.e2s_b(s_s,"_FIND_CHAR_NOT"))
                     {for(i=0;z_p.length(w2_s_n.s)>i;i++)
                        {for(j=0;z_p.length(w_s_n.s)>j;j++){if(z_p.at_s_c(w2_s_n.s,i)==z_p.at_s_c(w_s_n.s,j))break;}//一致判定
                         if(z_p.length(w_s_n.s)==j)break;//不一致は判定中止
                        }
                      if(z_p.length(w2_s_n.s)==i)i=-1;//全て一致は0化。
                      w3_s_n.s=z_mt_p.program_p.find_char_not_s=z_p.to1_i_s(i+1);
                      sw2=SET_NEXT;continue;
                     }
                   if(z_p.e2s_b(s_s,"_FIND_CHAR_LAST"))
                     {for(i=z_p.length(w2_s_n.s)-1;0<=i;i--)
                        {for(j=0;z_p.length(w_s_n.s)>j;j++){if(z_p.at_s_c(w2_s_n.s,i)==z_p.at_s_c(w_s_n.s,j))break;}//一致判定
                         if(z_p.length(w_s_n.s)>j)break;//一致は判定中止
                        }
                      w3_s_n.s=z_mt_p.program_p.find_char_last_s=z_p.to1_i_s(i+1);
                      sw2=SET_NEXT;continue;
                     }
                   if(z_p.e2s_b(s_s,"_FIND_CHAR_LAST_NOT"))
                     {for(i=z_p.length(w2_s_n.s)-1;0<=i;i--)
                        {for(j=0;z_p.length(w_s_n.s)>j;j++){if(z_p.at_s_c(w2_s_n.s,i)==z_p.at_s_c(w_s_n.s,j))break;}//一致判定
                         if(z_p.length(w_s_n.s)==j)break;//不一致は判定中止
                        }
                      w3_s_n.s=z_mt_p.program_p.find_char_last_not_s=z_p.to1_i_s(i+1);
                      sw2=SET_NEXT;continue;
                     }
                   if(z_p.e2s_b(s_s,"_FIND_COUNT"))
                     {i=0;
                      if(!(z_p.e2s_b(w_s_n.s,"")||z_p.e2s_b(w2_s_n.s,"")))
                         for(j=0;0<=(j=z_p.index3s_i(w2_s_n.s,w_s_n.s,j));){i++;j+=z_p.length(w_s_n.s);}
                      w3_s_n.s=z_mt_p.program_p.find_count_s=z_p.to_i_s(i);
                      sw2=SET_NEXT;continue;
                     }
                   if(z_p.e2s_b(s_s,"_FIND_STRING"))
                     {w3_s_n.s=z_mt_p.program_p.find_string_s=z_p.to1_i_s(
                      (z_p.e2s_b(w_s_n.s,"")||z_p.e2s_b(w2_s_n.s,"")?0:z_p.index2s_i(w2_s_n.s,w_s_n.s)+1));sw2=SET_NEXT;continue;
                     }
                   if(z_p.e2s_b(s_s,"_FIND_STRING_NOT"))
                     {if(z_p.e2s_b(w2_s_n.s,""))i=-1;//自分が無い場合０。
                      else if(z_p.e2s_b(w_s_n.s,"")||z_p.length(w_s_n.s)>z_p.length(w2_s_n.s))i=0;//比較相手が無い及び比較相手が長い場合は先頭で不一致。
                      else
                        {j=z_p.length(w2_s_n.s)-z_p.length(w_s_n.s)+1; 
                         for(i=0;j>i;i+=z_p.length(w_s_n.s)){if(!z_p.e2s_b(z_p.substring3_s(w2_s_n.s,i,z_p.length(w_s_n.s)),w_s_n.s))break;}//不一致は判定中止
                         if     (z_p.length(w2_s_n.s)==i)i=-1;//全て一致は0化。
                         else if(z_p.length(w2_s_n.s)<i)i-=z_p.length(w_s_n.s);//文字数が不足の物はその場所で不一致。
                        }
                      w3_s_n.s=z_mt_p.program_p.find_string_not_s=z_p.to1_i_s(i+1);
                      sw2=SET_NEXT;continue;
                     }
                   if(z_p.e2s_b(s_s,"_FIND_STRING_LAST"))
                     {w3_s_n.s=z_mt_p.program_p.find_string_last_s=
                      z_p.to1_i_s(z_p.e2s_b(w_s_n.s,"")||z_p.e2s_b(w2_s_n.s,"")?0:z_p.last_index2s_i(w2_s_n.s,w_s_n.s)+1);
                      sw2=SET_NEXT;continue;
                     } 
                   if(z_p.e2s_b(s_s,"_FIND_STRING_LAST_NOT"))
                     {if     (z_p.e2s_b(w_s_n.s,""))i=z_p.length(w2_s_n.s)-1;//比較相手が無いので最後が一致しない事とする。
                      else if(z_p.length(w_s_n.s)>z_p.length(w2_s_n.s))i=0;//比較相手が長いので先頭で一致しない事とする。
                      else
                        {for(i=z_p.length(w2_s_n.s)-z_p.length(w_s_n.s);0<=i;i-=z_p.length(w_s_n.s)){if(z_p.substring3_s(w2_s_n.s,i,z_p.length(w_s_n.s))!=w_s_n.s)break;}//不一致は判定中止     }
                         if(0==(i+z_p.length(w_s_n.s)))i=-1;//全て一致判定は０化。 
                         else if(0>i)i=0;//文字数が不足の物は先頭で不一致。 
                        }
                      w3_s_n.s=z_mt_p.program_p.find_string_last_not_s=z_p.to1_i_s(z_p.e2s_b(w2_s_n.s,"")?0:(i+1));
                      sw2=SET_NEXT;continue;
                     }
                 w2_s_n.s+=w_s_n.s;//w2_s_n.sが+以前のデータでw_s_n.sが最後のデータ。
                 if(-1==sw_set)
                   {if(z_p.e2s_b(property_s,""))     //propertyの無い物はここで転送して終了。
                      {if(0!=w_set_data(w2_s_n.s)&&z_p.SW_OFF_0==sw_error){sw_error=z_p.SW_ERROR_5;error_s=z_p.err_s;}
                       sw2=SET_OK;continue;
                      }
                    w3_s_n.s=w2_s_n.s;
                    s_s=z_p.upper_s(property_s);
                    if(z_p.e2s_b(s_s,"@MARK2"))
                      {if('N'==w_data_n.mark2_c||!z_p.e6s_b(w2_s_n.s,""," ","/","!","O"))
                         {z_p.err_s="mark2='N' or "+z_p.e_err_s+" (SET{..@MARK2=..})";sw=ABORT_24;sw_continue_b=true;break;}
                          w3_s_n.s=(z_p.e2s_b(w2_s_n.s,"")?" ":w2_s_n.s);w_data_n.mark2_c=(z_p.at_s_c(w3_s_n.s,0));sw2=SET_NEXT;continue;
                      }
                    else if(z_p.e2s_b(s_s,"@MARK3"))
                      {if(!z_p.e9s_b(w2_s_n.s,""," ","=","<",">","<=",">=","<>"))
                         {z_p.err_s=z_p.e_err_s+" (SET{..@MARK3=..})";sw=ABORT_24;sw_continue_b=true;break;}
                       w3_s_n.s=(z_p.e2s_b(w2_s_n.s," ")?"":w2_s_n.s);w_data_n.mark3_s=w3_s_n.s;sw2=SET_NEXT;continue;
                      } 
                    else if(z_p.e2s_b(s_s,"@MARK4"))
                      {if(!z_p.e4s_b(w2_s_n.s,""," ","G"))
                         {z_p.err_s=z_p.e_err_s+" (SET{..@MARK4=..})";sw=ABORT_24;sw_continue_b=true;break;}
                       w3_s_n.s=(z_p.e2s_b(w2_s_n.s," ")?"":w2_s_n.s);w_data_n.mark4_s=w3_s_n.s;sw2=SET_NEXT;continue;
                      }
                    else if(z_p.e2s_b(s_s,"@TYPE1")){w3_s_n.s=(z_p.e2s_b(w2_s_n.s,"")?" ":w2_s_n.s);w_data_n.type1_s=(w3_s_n.s);sw2=SET_NEXT;continue;}
                    else if(z_p.e2s_b(s_s,"@TYPE2"))
                      {w3_s_n.s=(z_p.e2s_b(w2_s_n.s,"")?" ":w2_s_n.s);
                       if(z_p.find_char_b(z_p.at_s_c(w_data_n.type1_s,0),"+-"))//数値判定
                         {if(!(z_p.find_char_b(w_data_n.type2_c," Z")&&z_p.find_char_b(z_p.at_s_c(w3_s_n.s,0)," Z"))
                           &&!(z_p.find_char_b(w_data_n.type2_c,"CE")&&z_p.find_char_b(z_p.at_s_c(w3_s_n.s,0),"CE")))//カンマが無い場合
                            {z_p.err_s="not set (SET{..@TYPE2='"+w3_s_n.s+"')";sw=ABORT_24;sw_continue_b=true;break;}
                         }
                       else if(!(z_p.find_char_b(z_p.at_s_c(w3_s_n.s,0)," ILRK*X")))//文字の場合の判定 //VER15.1でRを追加。
                              {z_p.err_s="not set (SET{..@TYPE2='"+w3_s_n.s+"')";sw=ABORT_24;sw_continue_b=true;break;}
                       w_data_n.type2_c=(z_p.at_s_c(w3_s_n.s,0));
                       sw2=SET_NEXT;continue;
                      }
                    else if(z_p.e2s_b(s_s,"@LENGTH0"))
                           {if(!(z_p.starts_with_b(w_data_n.name_s,"W")))
                              {z_p.err_s="not use (W..@LENGTH0) ("+w_data_n.name_s+"@LENGTH0)";sw=ABORT_24;sw_continue_b=true;break;}
                               w_data_n.length0=z_p.to_int_check(w2_s_n.s,'+',0,1);
                            if(!z_p.return_b){sw=ABORT_24;sw_continue_b=true;break;}
                            sw2=SET_NEXT;continue;
                           }
                    else if(z_p.e2s_b(s_s,"@LENGTH1"))
                           {if(!(z_p.starts_with_b(w_data_n.name_s,"W")))
                              {z_p.err_s="not use (W..@LENGTH1) ("+w_data_n.name_s+"@LENGTH1)";sw=ABORT_24;sw_continue_b=true;break;}
                            w_data_n.length1=z_p.to_int_check(w2_s_n.s,'+',0,1);
                            if(!z_p.return_b){sw=ABORT_24;sw_continue_b=true;break;} 
                            sw2=SET_NEXT;continue;
                           }
                    else if(z_p.e2s_b(s_s,"@LENGTH2"))
                           {if(z_p.e3s_b(w_data_n.type1_s,"+","-"))
                              {z_p.err_s="not use (type1!='+','-') ("+w_data_n.name_s+"@LENGTH2)";sw=ABORT_24;sw_continue_b=true;break;}
                               w_data_n.length2=z_p.to_int_check(w2_s_n.s,'+',0,1);
                            if(!z_p.return_b){sw=ABORT_24;sw_continue_b=true;break;}
                            sw2=SET_NEXT;continue;
                           }
                    else if(z_p.e2s_b(s_s,"@COLOR"))
                           {
#if IMENU
                       //z_p.console_write_v(z_p.main_program_s+"/"+w_kind_s+"/"+w2_s_n.s);
                            if(z_p.e2s_b(z_p.main_program_s,"IMENU"))
                            if(z_p.e3s_b(w_kind_s,"SET","DATA"))
                              {w_data_n.color_v(w2_s_n.s);z_mt_p.program_p.display_v(2,w_data_n,w_kind_s);}
#endif //MENU
                            sw2=SET_NEXT;continue;
                           }  
                    else if(z_p.e2s_b(s_s,"@WHERE")){ w_data_n.where_s=(w2_s_n.s);sw2=SET_NEXT;continue;}
                    else if(z_p.e2s_b(s_s,"@SELECT")){w_data_n.select_s=(w2_s_n.s);sw2=SET_NEXT;continue;}
                    else {z_p.err_s="bad (propaty) \""+property_s+"\"";sw=ABORT_24;sw_continue_b=true;break;}
                   }
             else
               {s_s=z_p.upper_s(w1_s_n.s); 
                if(z_p.e2s_b(s_s,"_AND_SPACE")){w3_s_n.s=z_mt_p.program_p.and_space_s=w2_s_n.s;}
#if IMENU
                else if(z_p.e2s_b(s_s,"_CLICK"))
                      {w3_s_n.s=w2_s_n.s;z_mt_p.program_p.keyboard_n.auto_v(1,w2_s_n.s);if(z_p.e2s_b(in_kind_s,"CLICK"))z_p.sw_click_b=true;}
#endif //MENU
                else if(z_p.e2s_b(s_s,"_CODE")){w3_s_n.s=z_mt_p.program_p.code_s=(z_p.e2s_b(w2_s_n.s,"")?"1":z_p.to_i_s(z_p.kind_code(z_p.at_s_c(w2_s_n.s,0))));}
                else if(z_p.e2s_b(s_s,"_CODE39")){w3_s_n.s=z_mt_p.program_p.code39_s=z_p.code39_s(w2_s_n.s);}
                else if(z_p.e2s_b(s_s,"_DIGIT11")){w3_s_n.s=z_mt_p.program_p.digit11_s=z_p.digit11_s(w2_s_n.s);}
                else if(z_p.e2s_b(s_s,"_DATE")){w3_s_n.s=z_mt_p.program_p.date_s=z_p.date_good_s(w2_s_n.s,0);}
                else if(z_p.e2s_b(s_s,"_DATE_GOOD")){w3_s_n.s=z_mt_p.program_p.date_good_s=z_p.date_good_s(w2_s_n.s,0);}
                else if(z_p.e2s_b(s_s,"_DATETIME")){w3_s_n.s=z_mt_p.program_p.date_time_s=z_p.date_time_edit_s(w2_s_n.s,2);}
                else if(z_p.e2s_b(s_s,"_DATETIME_GOOD")){w3_s_n.s=z_mt_p.program_p.date_time_good_s=z_p.date_time_good_s(w2_s_n.s);}
                else if(z_p.e2s_b(s_s,"_EDIT"))
                      {if(!z_mt_p.edit_b(w3_s_n,w2_s_n.s)){sw_error=z_p.SW_ERROR_5;error_s=z_p.err_s;} 
                         z_mt_p.program_p.edit_s=w3_s_n.s;
                      }
                else if(z_p.e2s_b(s_s,"_EDIT_ERROR"))
                      {   z_mt_p.edit_b(w3_s_n,w2_s_n.s);
                         z_mt_p.program_p.edit_error_s=w3_s_n.s;
                      }
                else if(z_p.e2s_b(s_s,"_ENVIRONMENT"))//if(!z_p.environment(w3_s_n,w2_s_n.s)){sw=ABORT_24;sw_continue_b=true;break;} 
                      {z_mt_p.program_p.environment_s=w3_s_n.s=z_p.environment_s(w2_s_n.s);
                      }
                else if(z_p.e2s_b(s_s,"_ESC")){z_mt_p.program_p.sw_esc_b=(z_p.e2s_b(w2_s_n.s,"1")?true:false);w3_s_n.s=w2_s_n.s;}
                else if(z_p.e2s_b(s_s,"_FULL_SIZE")){w3_s_n.s=z_mt_p.program_p.full_size_s=z_p.full_size_s(w2_s_n.s);}
                else if(z_p.e2s_b(s_s,"_VARIABLE")){z_mt_p.program_p.variable_s=w2_s_n.s;} //ver23.1
                else if(z_p.e2s_b(s_s,"_RANDOM"))
                      {int random_i=z_p.to_int1s_i(w2_s_n.s); //ver20.1
                       if(1>random_i){sw_error=z_p.SW_ERROR_5;error_s=w2_s_n.s+" is bad(_RANDOM)";}
                       else z_mt_p.program_p.random_i=random_i;
                       
                      }
                else if(z_p.e2s_b(s_s,"_RETURN_SQL")){z_p.sw_return_sql=(z_p.e2s_b(w2_s_n.s,"1")?1:0);w3_s_n.s=w2_s_n.s;}
                else if(z_p.e2s_b(s_s,"_SPACE"))
                      {w3_s_n.s="";for(k=0;k<z_p.length(w2_s_n.s);k++)w3_s_n.s+=(' '>z_p.at_s_c(w2_s_n.s,k)?' ':z_p.at_s_c(w2_s_n.s,k));
                       z_mt_p.program_p.space_s=w3_s_n.s;  //空白以下空白化
                      }
                else if(z_p.e2s_b(s_s,"_SPACE_ERASE")){z_mt_p.program_p.space_erase_s=w3_s_n.s=z_p.replace_s_s(w2_s_n.s," ","");}  //全ての空白を削除。
                else if(z_p.e2s_b(s_s,"_HAVING"))
                      {  w2_s_n.s=z_p.trim_s(w2_s_n.s);
                         w3_s_n.s=z_mt_p.program_p.having_s=(z_p.e2s_b(w2_s_n.s,"")||z_p.starts_with_b(w2_s_n.s,"HAVING ")?"":"HAVING ")+w2_s_n.s;
                         
                      } 
                else if(z_p.e2s_b(s_s,"_JAN")){w3_s_n.s=z_mt_p.program_p.jan_s=z_p.jan_s(w2_s_n.s);}
                else if(z_p.e2s_b(s_s,"_NEXT")){w3_s_n.s=z_mt_p.program_p.next_s=z_p.next_s(w2_s_n.s);}
                else if(z_p.e2s_b(s_s,"_REAL_TEST"))
                      { if(z_p.e2s_b(w2_s_n.s,"ALTER"))
                          {if(z_p.e2s_b(z_p.job_s,"ZZZZ010220"))
                             {if(z_p.e2s_b(z_p.test_s,"REAL")){w3_s_n.s=z_p.real_test_s=z_p.test_s="TEST";}
                              else                  {w3_s_n.s=z_p.real_test_s=z_p.test_s="REAL";}
                              z_mt_p.init_fix_b();
                             }
                          } 
                        else if(z_p.starts_with_b(z_p.job_s,"ZZZZ01")||z_p.starts_with_b(z_p.job_s,"ZZZZ99")
                              ||1==z_p.sw_setup||z_p.e2s_b(z_p.menu_permission_s,"ZZZZ"))
                               {if(z_p.e2s_b(w2_s_n.s,"REAL")){if(z_p.e2s_b(z_p.test_s,"REAL"))w3_s_n.s=z_p.real_test_s="REAL";}
                                else                                   w3_s_n.s=z_p.real_test_s="TEST";
                               }
                         
                      }
                else if(z_p.e2s_b(s_s,"_RESTORE_DB"))//VER18.1
                      {z_mt_p.program_p.restore_db_s=w2_s_n.s;
                        
                      } 
                else if(z_p.e2s_b(s_s,"_SQL_LIMIT"))
                      { z_mt_p.program_p.sql_limit_org=z_p.to_int_check(w2_s_n.s,'+',0,0);w3_s_n.s=w2_s_n.s;  
                         
                      }
                else if(z_p.e2s_b(s_s,"_TRACE"))
                      {if     (z_p.e2s_b(z_p.sw_trace_s,"0")&&z_p.e2s_b(w2_s_n.s,"1"))w3_s_n.s=z_p.sw_trace_s="1";
                        else if(z_p.e2s_b(z_p.sw_trace_s,"1")&&z_p.e2s_b(w2_s_n.s,"0"))w3_s_n.s=z_p.sw_trace_s="0";else w3_s_n.s="";
                        
                      }
                else if(z_p.e2s_b(s_s,"_TRIM")){w3_s_n.s=z_p.trim_trim_s=z_p.trim_s(w2_s_n.s);}
                else if(z_p.e2s_b(s_s,"_JOB_CGI"))//VER20.1
                          {w3_s_n.s=z_p.job_cgi_s=w2_s_n.s;}
                else if(z_p.e2s_b(s_s,"_JOB"))
                      {   if(z_p.e3c_b(z_mt_p.program_c,'M','F'))
                           {w3_s_n.s=z_p.job_s=w2_s_n.s;
#if IMENU
                            z_mt_p.title_bar_v();
#endif //MENU
                           }
                         else {z_p.err_s="not use (not menu-job,file-job) \"_JOB\"";sw=ABORT_24;sw_continue_b=true;break;}
                         
                      } 
#if IMENU
                else if(z_p.e2s_b(s_s,"_HEAD"))
                      {if(z_p.e3c_b(z_mt_p.program_c,'M','F'))
                                {w3_s_n.s=z_p.job_name_s=w2_s_n.s;z_mt_p.title_bar_v();}
                      } 
                else if(z_p.e2s_b(s_s,"_PAGE_SW")){w3_s_n.s=z_p.page_sw_s=w2_s_n.s;}
                else if(z_p.e2s_b(s_s,"_TITLE"))
                      {   if(z_p.e3c_b(z_mt_p.program_c,'M','F'))
                           {w3_s_n.s=z_p.title_s=w2_s_n.s;z_mt_p.title_bar_v();
                            z_mt_p.program_p.display_v("["+z_p.title_s+"]",1,28,34,z_p.head_c);
                           }
                         
                      }
#endif //MENU
                else if(z_p.e2s_b(s_s,"_ARG")){z_mt_p.program_p.arg_s=w3_s_n.s=z_p.arg_set_s(w2_s_n.s);}
         //       else if(z_p.e2s_b(s_s,"_COMMAND")){z_mt_p.program_p.command_s=w3_s_n.s=z_p.command_set_s(w2_s_n.s);}
                else if(z_p.e2s_b(s_s,"_SETUP")){w3_s_n.s=z_p.setup_s=(1==z_p.sw_setup?w2_s_n.s:"");} //VER35
                else if(z_p.e2s_b(s_s,"_DB_SOFT")){w3_s_n.s=w2_s_n.s;z_mt_p.set_db_soft_v(w3_s_n.s);}
                else if(z_p.e2s_b(s_s,"_INSTANCE")){w3_s_n.s=z_p.instance_s=w2_s_n.s;z_mt_p.sql_n.sql_close_v(z_p.COMMIT,0);}
                else if(z_p.e2s_b(s_s,"_LOGIN_PASSWORD")){w3_s_n.s=z_mt_p.program_p.login_password_s=w2_s_n.s;}
                else if(z_p.e2s_b(s_s,"_LOGIN_ID")){w3_s_n.s=z_mt_p.program_p.login_id_s=w2_s_n.s;}
                else if(z_p.e2s_b(s_s,"_SERVER_NAME")){w3_s_n.s=z_p.server_name_s=w2_s_n.s;z_mt_p.set_db_v();}
                else if(z_p.e2s_b(s_s,"_SYSTEM"))
                       {w3_s_n.s=z_p.system_s=w2_s_n.s;z_mt_p.set_db_v();
#if IMENU
                        if(z_p.e3c_b(z_mt_p.program_c,'M','F'))z_mt_p.title_bar_v();
#endif //MENU
                        z_p.exe_option_s=z_p.exe_param_s+" I_"+z_p.server_name_s+"_"+z_p.system_s+".I"; 
                       } 
                else if(z_p.e2s_b(s_s,"_SYSTEM_NAME")){w3_s_n.s=z_p.system_name_s=w2_s_n.s;}
                else if(z_p.e2s_b(s_s,"_PASSWORD_LINK"))
                       {if(1==z_p.sw_setup)w3_s_n.s=z_p.password_link_s=z_p.password_n.pwddb_s(w2_s_n.s,w1_s_n.s,"IN");
                        else w3_s_n.s="";
                       }
                else if(z_p.e2s_b(s_s,"_PASSWORD_REAL"))
                       {if(1==z_p.sw_setup)w3_s_n.s=z_p.password_real_s=z_p.password_n.pwddb_s(w2_s_n.s,w1_s_n.s,"IN");
                        else w3_s_n.s=""; 
                       }
                else if(z_p.e2s_b(s_s,"_PASSWORD_TEST"))
                       {if(1==z_p.sw_setup)w3_s_n.s=z_p.password_test_s=z_p.password_n.pwddb_s(w2_s_n.s,w1_s_n.s,"IN");
                        else w3_s_n.s=""; 
                       }
                else if(z_p.e2s_b(s_s,"_PASSWORD64_CHECK"))
                       {w3_s_n.s=z_p.password64_check_s=(1==z_p.sw_setup&&!z_p.e2s_b(w2_s_n.s,"")?z_p.password_n.pwd64_s(z_p.pad_end_s(w2_s_n.s,64)):"NG"); 
                        if(z_p.e2s_b(z_p.password64_check_s,"OK"))sw_ok_password_b=true;
                         
                       }  
                else if(z_p.e2s_b(s_s,"_X")){w3_s_n.s=z_p.x_s=w2_s_n.s;}
                else if(z_p.e2s_b(s_s,"_SET")){w3_s_n.s=z_p.set_s=w2_s_n.s;}
                else  {z_p.err_s="program error \""+z_p.upper_s(w1_s_n.s)+"\"";sw=ABORT_24;sw_continue_b=true;break;}
               }//else
           }//if(SET3>=sw2)//--------------------------------------------------------------(SET3>=sw2)
             if(SET_NEXT>=sw2)//--------------------------------------------------------------(SET_NEXT>=sw2)
               {z_mt_p.trace_v(0,":"+w_name_top_s+w1_s_n.s+z_p.upper_s(property_s)+"=\""+w3_s_n.s+"\"");}  //VER18.1
             if(SET_OK>=sw2)//--------------------------------------------------------------(SET_OK>=sw2)
               {if('}'==edit_c){rc=sw_error;z_p.err_s=error_s;sw=CHECK_RC_10;sw_continue_b=true;break;}
               for(;;)
                 {if(!edit_word_b(w1_s_n,"+=,}")){sw=ABORT_24;z_p.t_v(z_p.SE,"set_set_b)4");return false;} //左辺名前w1_s_nに設定//VER23.1(",}"を追加)
                  if(z_p.e3c_b(edit_c,'+','='))break;//VER23.1
                  if(set_bi){z_p.err_s="'=' not found";sw=ABORT_24;z_p.t_v(z_p.SE,"set_set_b)5");return false;} //VER23.1
                  if(z_p.e2c_b(edit_c,'}')){rc=sw_error;z_p.err_s=error_s;sw=CHECK_RC_10;sw_continue_b=true;z_p.t_v(z_p.SE,"set_set_b)6");return false;}//終了　VER23.1
                 }
                if(z_p.e2s_b(w1_s_n.s,""))sw2=SET2;
                else                        sw2=SET1;
               }
     }//for(;;) sw2 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
             if(sw_continue_b){z_p.t_v(z_p.SE,"set_set_b)7");return false;}//for()内でbreak;対応
z_p.t_v(z_p.SE,"set_set_b)8");
return true;
}
//====*( int (0=on,5=ng,9=err) compute compute_cut_ii) )*****
int compute(int compute_cut_ii)
{z_p.t_v(z_p.SE,"compute(");
ii_zz_l ww_s_n=new ii_zz_l();ii_zz_l ww2_s_n=new ii_zz_l();ii_zz_l ww_type_c_n=new ii_zz_l();
char compute_c;
//SJ decimal decimal1_d=z_p.decimal_d(0),decimal2_d=z_p.decimal_d(0);
double double1_o=0,double2_o=0;
char type_c=' ';
int length2,rc=9;
//SJ int i;
if(!edit_word_b(ww_s_n,"+-*=/%")){}
else if(!w_set_name_b(ww_s_n.s)){}
else
  {for(;;)
     {if(z_p.e3s_b(w_data_n.type1_s,"+","-"))
        {type_c=z_p.at_s_c(w_data_n.type1_s,0);length2=w_data_n.length2;}
      else 
        {length2=0;compute_cut_ii=-1;//(文字はそのまま）
         if(z_p.e2s_b(w_data_n.type1_s,"F"))type_c=z_p.at_s_c(w_data_n.type1_s,0);else type_c='+'; 
        }
      if('='==edit_c)
        {if(!edit_word_b(ww_s_n,"+*-/%")){rc=9;break;}
      if(!get_data_b(ww_s_n,ww_type_c_n,ww_s_n.s)){rc=9;break;}
        } 
      else 
        {ww_s_n.s=w_data_n.data_s;
         if(!edit_left_b("=")){rc=9;break;}
        }
      compute_c=edit_c;
//SJ    if('F'==type_c)
          {double1_o=z_p.to_double_o(ww_s_n.s,'-',1,0);if(!z_p.return_b){rc=5;break;}}
//SJ       else {decimal1_d=z_p.to_decimal_d(ww_s_n.s,type_c,z_p.decimal_d(0),1);
//SJ             if(!z_p.return_b){rc=5;break;}
//SJ             }
      if(!edit_word_b(ww_s_n,",}")){rc=9;break;}
      if(!get_data_b(ww_s_n,ww_type_c_n,ww_s_n.s)){rc=9;break;} 
//SJ  if('F'==type_c)
        {double2_o=z_p.to_double_o(ww_s_n.s,'-',1,0);if(!z_p.return_b){rc=5;break;}
         if     ('+'==compute_c)double1_o+=double2_o;
         else {if('-'==compute_c)double1_o-=double2_o;
         else  if('*'==compute_c)double1_o*=double2_o;
         else  if('/'==compute_c)double1_o/=double2_o;
//SJ     else  if('%'==compute_c)double1_o%=double2_o;
//HP     else  if('%'==compute_c)double1_o=fmod(double1_o,double2_o);
              }
         ww2_s_n.s=z_p.to_o_s(double1_o);
        }
//SJ    else 
//SJ      {decimal2_d=z_p.to_decimal_d(ww_s_n.s,'-',z_p.decimal_d(0),1);
//SJ         if(!z_p.return_b){rc=5;break;}
//SJ       try{
//SS           if('+'==compute_c)decimal1_d+=decimal2_d;
//JJ           if     ('+'==compute_c)decimal1_d=decimal1_d.add(decimal2_d);
//SS           else if('-'==compute_c)decimal1_d-=decimal2_d;
//JJ           else if('-'==compute_c)decimal1_d=decimal1_d.subtract(decimal2_d);
//SS           else if('*'==compute_c)decimal1_d*=decimal2_d;
//JJ           else if('*'==compute_c)decimal1_d=decimal1_d.multiply(decimal2_d);
//SS           else if('/'==compute_c)decimal1_d/=decimal2_d;
//JJ           else if('/'==compute_c)decimal1_d=decimal1_d.divide(decimal2_d,length2,(0==compute_cut_ii?RoundingMode.HALF_UP:RoundingMode.DOWN));//VER28.1
//SS           else if('%'==compute_c)decimal1_d%=decimal2_d;
//JJ           else if('%'==compute_c)decimal1_d=decimal1_d.subtract(decimal2_d.multiply(decimal1_d.divide(decimal2_d,RoundingMode.DOWN)));//VER28.1
//SJ          }catch(Exception e_ni){z_p.err_s=z_p.message_s(e_ni);{rc=5;break;}}
//SJ       if(0==compute_cut_ii)//COMPUTE(文字はそのまま）
//SS       decimal1_d=decimal.Round(decimal1_d,length2);//四捨五入
//JJ       decimal1_d=decimal1_d.setScale(length2,RoundingMode.HALF_UP);//四捨五入//VER28.1
//SJ       ww2_s_n.s=z_p.to_d_s(decimal1_d);//(文字はそのまま）
//SJ       if(1==compute_cut_ii) //COMPUTE_CUT(文字はそのまま）
//SJ       if(-1!=(i=z_p.index2c_i(ww2_s_n.s,'.')))
//SJ         {if(0<length2)i+=length2+1;
//SJ          ww2_s_n.s=z_p.substring3_s(ww2_s_n.s,0,i);//切捨て
//SJ         }
//SJ      }
      if(0!=w_set_data(ww2_s_n.s)){rc=5;break;}
      if('}'==edit_c){rc=0;break;}
      if(!edit_word_b(ww_s_n,"+*-/%="))break;
      if(!z_p.e2s_b(ww_s_n.s,""))if(!w_set_name_b(ww_s_n.s)){rc=9;break;}
     }//for(;;)
  }//else
//HP delete ww_s_n;delete ww2_s_n;delete ww_type_c_n;
z_p.t_v(z_p.SE,"compute)");
return rc;
}
//----------------------------------------------
//====*( int(0=ok,1=AtEnd,5=ng,9=err)*****
int read(ii_read_l read_n){return read(read_n,0);}  //先頭スキップ無し。
int read(ii_read_l read_n,int skip_i)
{z_p.t_v(z_p.SE,"read(");
int rc=0,cnt=0;
if(0!=(rc=read_n.read())){if(1==rc)return 1;else return 5;}
ii_zz_l ww_s_n=new ii_zz_l();
List<String> s_ww_a=new List<String>();
z_p.csv_in_v(s_ww_a,read_n.read_data_s,read_n.read_file_s);  
for(;;)
  {if(!edit_word_b(w_s_n,",}")){rc=9;break;}
   if(0<skip_i){if('}'==edit_c)break;skip_i--;continue;} //VER24.1 skip_i分スキップする。
   if(!z_p.e2s_b(w_s_n.s,""))
     {if(!w_set_name_b(w_s_n.s)){rc=9;break;}
      if(cnt<z_p.count_s_i(s_ww_a))ww_s_n.s=z_p.at_s(s_ww_a,cnt);else ww_s_n.s="";
      if(0!=w_set_data(ww_s_n.s)){rc=9;break;} 
     }
   if('}'==edit_c)break;
   cnt++;
  }//for(;;)
//HP delete ww_s_n;z_p.clear_s_v(s_ww_a);delete s_ww_a; 
z_p.t_v(z_p.SE,"read)");
return rc;
}
//====**********( REPLACE_i...{ )********************************
int replace(String  opt1_si,String  opt2_si,String  opt3_si,String  opt4_si,String  opt5_si,String  opt6_si)
{z_p.t_v(z_p.SE,"replace(");
String[] key_name_sx;String[] data_name_sx;
String sql_s,where_out_s="",where_in_s="";
int rc=0;
z_mt_p.program_p.o_o_s=('P'==z_p.db_c?opt1_si:"O")+".";//VER24.1
if('F'==z_p.db_c)//VER24.1
  {List<String> s_work_a=new List<String>();
   z_p.split_s_v(s_work_a,opt1_si,'.');//VER24.1
   z_mt_p.program_p.o_o_s=z_p.at_s(s_work_a,z_p.count_s_i(s_work_a)-1)+".";//VER24.1
  }//VER24.1
opt5_si=z_p.replace_s_s(opt5_si,"*O*.",z_mt_p.program_p.o_o_s);//VER24.1
if(z_p.e2s_b(opt1_si,"")){z_p.err_s="output table name is null";return 1;}
if(z_p.e2s_b(opt2_si,"")){z_p.err_s="input table name is null";return 1;}
if(z_p.e2s_b(opt3_si,"")){z_p.err_s="keys name is null";return 1;}
key_name_sx=z_p.split_sx(opt3_si,',');
data_name_sx=z_p.split_sx(opt4_si,',');
if(!z_p.e2s_b(opt5_si,""))where_out_s=" AND ("+opt5_si+")";
if(!z_p.e2s_b(opt6_si,""))where_in_s=" AND ("+opt6_si+")";
ii_zz_l ww_s_n=new ii_zz_l();
if(!z_p.e6s_b(cmd2_s,"REPLACE_PART2","REPLACE_PART_ADD","REPLACE_PART_ADD2","REPLACE_PART_CHANGE","REPLACE_PART_CHANGE2"))
//====*****( cancel )********************************************************************************
  {sql_s="UPDATE "+('M'==z_p.db_c?"":opt1_si+" ")+(z_p.e3c_b(z_p.db_c,'P','F')?"":"O ")
   +" SET "+z_mt_p.z_update_s("CANCEL","","")+('M'==z_p.db_c?" FROM "+opt1_si+" O":"")
   +" WHERE"+(z_p.e3s_b(cmd2_s,"REPLACE_ALL","REPLACE_ALL2")?" NOT":"")
   +" EXISTS(SELECT "+z_p.dot_string_s(key_name_sx[0])+" FROM "+opt2_si+" I";
   ww_s_n.s=" WHERE ";
   for(int iz=0;iz<z_p.count_sx_i(key_name_sx);iz++)
     {String s=key_name_sx[iz];
      sql_s+=ww_s_n.s+z_mt_p.program_p.o_o_s+z_p.dot_string_s(s)+"=I."+z_p.dot_string_s(s);ww_s_n.s=" AND ";
     }
   if    (z_p.e3s_b(cmd2_s,"REPLACE_PART","REPLACE_PART_CANCEL"))sql_s+=" AND I.Z_CANCEL<>' '";
   else if(z_p.e2s_b(cmd2_s,"REPLACE_ALL"))sql_s+=" AND I.Z_CANCEL=' '";
   sql_s+=where_in_s+")AND "+z_mt_p.program_p.o_o_s+"Z_CANCEL=' '"+where_out_s;
   rc=z_mt_p.sql_n.sql_usr2(sql_s,usr_s); 
   if(0!=rc||z_p.e2s_b(cmd2_s,"REPLACE_PART_CANCEL"))
     {
//HP  delete ww_s_n; 
      return rc;
     } 
  }
//====*****( change )*********************************************************************************
//====*********( 条件作成 sql2_s )********************************
String sql2_s="",sql3_s="";
ww_s_n.s=" FROM "+('M'!=z_p.db_c?"":opt1_si+" O,")+opt2_si+" I WHERE ";
for(int iz=0;iz<z_p.count_sx_i(key_name_sx);iz++)
   {String s=key_name_sx[iz];
    sql2_s+=ww_s_n.s+z_mt_p.program_p.o_o_s+z_p.dot_string_s(s)+"=I."+z_p.dot_string_s(s);ww_s_n.s=" AND ";
   }//KEY条件
sql3_s=sql2_s+where_in_s;
if(!z_p.e2s_b(z_p.trim_s(opt4_si),""))//更新データ有り。
  {ww_s_n.s=" AND(";
   for(int iz=0;iz<z_p.count_sx_i(data_name_sx);iz++)
     {String s=data_name_sx[iz];
      sql2_s+=ww_s_n.s+z_mt_p.program_p.o_o_s+z_p.dot_string_s(s)+"<>I."+z_p.dot_string_s(s)+" OR "
      +z_mt_p.program_p.o_o_s+z_p.dot_string_s(s)+" IS NULL AND I."+z_p.dot_string_s(s)
      +" IS NOT NULL OR "+z_mt_p.program_p.o_o_s+z_p.dot_string_s(s)+" IS NOT NULL AND I."+z_p.dot_string_s(s)+" IS NULL";ww_s_n.s=" OR ";
     }
   sql2_s+=" OR "+z_mt_p.program_p.o_o_s+"Z_CANCEL<>' ')";//削除済みは無条件に更新対象とする。
  }
else  sql2_s+=" AND "+z_mt_p.program_p.o_o_s+"Z_CANCEL<>' '";//更新対象無しでは、修正は無いので削除済のみ処理。（作成のみ発生）
if(!z_p.ends_with_b(cmd2_s,"2"))sql2_s+=" AND I.Z_CANCEL=' '";//最後が2の命令はI.Z_CANCELを無視。
sql2_s+=where_in_s+(z_p.e5c_b(z_p.db_c,'M','P','L','F')?"":")")+where_out_s;//条件指定分を挿入。
if     (z_p.e3s_b(cmd2_s,"REPLACE_PART_CHANGE","REPLACE_PART_CHANGE2"))
        sql2_s+=" AND "+z_mt_p.program_p.o_o_s+"Z_CANCEL=' '";//CHANGEの命令は作成処理はしない。（削除されていない物のみ処理）
else if(z_p.e3s_b(cmd2_s,"REPLACE_PART_ADD","REPLACE_PART_ADD2"))
        sql2_s+=" AND "+z_mt_p.program_p.o_o_s+"Z_CANCEL<>' '";//ADDの命令は修正処理はしない。（削除済みの処理）
//====**********************************
sql_s="UPDATE "+('M'==z_p.db_c?"":opt1_si)+(z_p.e3c_b(z_p.db_c,'P','F')?"":" O")+" SET ";
if(z_p.e3c_b(z_p.db_c,'M','P'))//M,P
  {sql_s+=z_mt_p.z_update_s("ADD_CHANGE",z_mt_p.program_p.o_o_s,"");
   if(!z_p.e2s_b(z_p.trim_s(opt4_si),""))
     for(int iz=0;iz<z_p.count_sx_i(data_name_sx);iz++)
       {String s=data_name_sx[iz];sql_s+=","+z_p.dot_string_s(s)+"=I."+z_p.dot_string_s(s);}

  }
else
  {if(z_p.e3c_b(z_p.db_c,'O','I')) //O,I
    {sql_s+="("+z_mt_p.z_update_s("ADD_CHANGE1",z_mt_p.program_p.o_o_s,"");
     if(!z_p.e2s_b(z_p.trim_s(opt4_si),""))
       for(int iz=0;iz<z_p.count_sx_i(data_name_sx);iz++)
         {String w_s=data_name_sx[iz];sql_s+=","+z_p.dot_string_s(w_s);}
     sql_s+=")=(SELECT "+z_mt_p.z_update_s("ADD_CHANGE2",z_mt_p.program_p.o_o_s,"");
     if(!z_p.e2s_b(z_p.trim_s(opt4_si),""))
        for(int iz=0;iz<z_p.count_sx_i(data_name_sx);iz++)
          {String w_s=data_name_sx[iz];sql_s+=",I."+z_p.dot_string_s(w_s);}
     ww_s_n.s=" FROM "+opt2_si+" I WHERE ";
      for(int iz=0;iz<z_p.count_sx_i(key_name_sx);iz++)
       {String w_ss=key_name_sx[iz];sql_s+=ww_s_n.s+z_mt_p.program_p.o_o_s+z_p.dot_string_s(w_ss)+"=I."+z_p.dot_string_s(w_ss);
        ww_s_n.s=" AND ";
       }//KEY条件
     sql_s+=where_in_s+")";
    }
   else//L
    {sql_s+=z_mt_p.z_update_s("ADD_CHANGE",z_mt_p.program_p.o_o_s,"");
     if(!z_p.e2s_b(z_p.trim_s(opt4_si),""))
      for(int iz=0;iz<z_p.count_sx_i(data_name_sx);iz++)
        {String w_s=data_name_sx[iz];sql_s+=","+z_p.dot_string_s(w_s)+"=(SELECT I."+z_p.dot_string_s(w_s)+sql3_s+")"; 
        } 
    } 
   sql_s+=" WHERE EXISTS(SELECT 'X' ";
  }
sql_s+=sql2_s;
if(z_p.e3c_b(z_p.db_c,'L','F'))sql_s+=")";
rc=z_mt_p.sql_n.sql_usr2(sql_s,usr_s); 
if(0!=rc||z_p.e4s_b(cmd2_s,"REPLACE_PART_CHANGE","REPLACE_PART_CHANGE2","REPLACE_PART_CANCEL"))
  { 
//HP  delete ww_s_n; 
   return rc;
  } 
//====*******( insert )*************************************************************************
sql_s="INSERT INTO "+opt1_si+"("+z_mt_p.z_insert_name_s();
for(int iz=0;iz<z_p.count_sx_i(key_name_sx);iz++)sql_s+=","+z_p.dot_string_s(key_name_sx[iz]);
if(!z_p.e2s_b(opt4_si,""))for(int iz=0;iz<z_p.count_sx_i(data_name_sx);iz++)sql_s+=","+z_p.dot_string_s(data_name_sx[iz]);
sql_s+=")SELECT "+z_mt_p.z_insert_value_s();
for(int iz=0;iz<z_p.count_sx_i(key_name_sx);iz++)sql_s+=","+z_p.dot_string_s(key_name_sx[iz]);
if(!z_p.e2s_b(opt4_si,""))for(int iz=0;iz<z_p.count_sx_i(data_name_sx);iz++)sql_s+=","+z_p.dot_string_s(data_name_sx[iz]);
sql_s+=" FROM "+opt2_si+" I WHERE NOT EXISTS(SELECT "+z_p.dot_string_s(key_name_sx[0])+" FROM "+opt1_si;
ww_s_n.s=('P'==z_p.db_c?"":" O")+z_p.DUMMY_S+" WHERE ";
for(int iz=0;iz<z_p.count_sx_i(key_name_sx);iz++)
  {String w_s=key_name_sx[iz];sql_s+=ww_s_n.s+z_mt_p.program_p.o_o_s+z_p.dot_string_s(w_s)+"=I."+z_p.dot_string_s(w_s);
   ww_s_n.s=" AND ";
  }
sql_s+=")";
if(!z_p.ends_with_b(cmd2_s,"2"))sql_s+="AND I.Z_CANCEL=' '";
sql_s+=where_in_s;
//====***********************************************************
rc=z_mt_p.sql_n.sql_usr2(sql_s,usr_s); 
//====*****************( 終了 )************************
//HP  delete ww_s_n; 
return(rc);
}
//----------------------------------------------
//====*( int w_set_data(String s_si),w_data_nにデータを転送する )*******
int w_set_data(String s_si)
{z_p.t_v(z_p.SE,"w_set_data(");
int rc=0;
rc=w_data_n.set_i(s_si);
z_mt_p.trace_v(0,":"+w_name_top_s+w_data_n.name_s+"=\""+w_data_n.data_s+"\""); //VER15.1で修正。
#if IMENU
if(z_p.e2s_b(z_p.main_program_s,"IMENU"))
   if(9!=rc)
     {if(!z_p.e3s_b(w_kind_s,"WORK","KEEP"))z_mt_p.program_p.display_v(2,w_data_n,w_kind_s);
      if(z_p.e2s_b(w_kind_s,"SET")&&!z_p.e2s_b(z_mt_p.program_p.now_kind_s,"SET"))w_data_n.data_save_s=w_data_n.data_s;//セーブも変更 
      if(z_p.e2s_b(w_kind_s,"KEEP"))if(!z_mt_p.program_p.set_keep_b(z_p.substring2_s(w_data_n.name_s,1),s_si))rc=9;
     }
#endif //MENU
z_p.t_v(z_p.SE,"w_set_data)");
return rc;
}
//----------------------------------------------
//====*( OUTPUT_CLEAR{}を実行 )***** 
int output_clear_v()
{z_p.t_v(z_p.SE,"output_clear_v(");
z_mt_p.program_p.output_record_cnt=0;
z_mt_p.program_p.output_column_cnt=0;
z_p.clear_s_v(z_mt_p.program_p.s_sql0_a);
z_p.t_v(z_p.SE,"output_clear_v)");
return 0;
}
//----------------------------------------------
//====*( OUTPUT{}を実行 )***** 
int output()
{z_p.t_v(z_p.SE,"output(");
ii_zz_l ww_s_n=new ii_zz_l();ii_zz_l w1_s_n=new ii_zz_l();ii_zz_l type_c_n=new ii_zz_l();
z_mt_p.program_p.output_column_cnt=0;
int rc=0;
for(;;) 
  {if(!edit_word_b(ww_s_n,",}")){rc=9;break;}
   if(!get_data_b(w1_s_n,type_c_n,ww_s_n.s)){rc=9;break;}
   z_p.add_s(z_mt_p.program_p.s_sql0_a,w1_s_n.s);
   z_mt_p.program_p.output_column_cnt++;
   if('}'==edit_c)break;
  } 
z_mt_p.program_p.output_record_cnt++;
z_p.t_v(z_p.SE,"output)");
return rc;
}
//----------------------------------------------
//====*( int(0=ok,5=ng,9=err) WRITE?_FILE{}を実行 )***** 
int write(ii_write_l write_ni){return write(write_ni,0);}
int write(ii_write_l write_ni,int skip_i)//skip_i分スキップ。（VER24.1)
{z_p.t_v(z_p.SE,"write(");
ii_zz_l ww_s_n=new ii_zz_l();ii_zz_l ww1_s_n=new ii_zz_l();ii_zz_l ww2_s_n=new ii_zz_l();
ii_zz_l ww3_s_n=new ii_zz_l();ii_zz_l ww_type_c_n=new ii_zz_l();ii_zz_l ww_sep_s_n=new ii_zz_l();
int rc=0;
for(;;) 
  {if(!edit_word_b(ww_s_n,",}")){rc=9;break;}
   if(0<skip_i){if('}'==edit_c)break;skip_i--;continue;}//skip_i分スキップ。
   if(!get_data_b(ww1_s_n,ww_type_c_n,ww_s_n.s)){rc=9;break;}
   ww3_s_n.s+=ww2_s_n.s+z_p.csv_out_s(ww_sep_s_n,ww1_s_n.s,write_ni.write_file_s);ww2_s_n.s=ww_sep_s_n.s;
   if('}'==edit_c)break;
  }
if(!write_ni.write_b(ww3_s_n.s))rc=5;
//HP delete ww_s_n;delete ww1_s_n;delete ww2_s_n;delete ww3_s_n;delete ww_type_c_n;delete ww_sep_s_n;
z_p.t_v(z_p.SE,"write)");
return rc;
}
bool edit_opt_b(ii_zz_l s_ni)
{ii_zz_l ww_s_n=new ii_zz_l();ii_zz_l ww1_s_n=new ii_zz_l();ii_zz_l ww_type_c_n=new ii_zz_l();
bool b=true;
for(;;) 
  {if(!edit_word_b(ww_s_n,",}")){b=false;break;}
   if(z_p.e2s_b(ww_s_n.s,"")){z_p.err_s="data name is null";b=false;break;}
   if(!get_data_b(ww1_s_n,ww_type_c_n,ww_s_n.s)){b=false;break;}
   s_ni.s+=ww1_s_n.s;
   if('}'==edit_c)break;
  }
//HP delete ww_s_n;delete ww1_s_n;delete ww_type_c_n;
return b;
}
//----------------------------------------------
void table_found_v(String s_si)
{z_p.err_s="table ("+s_si+") found";z_p.db_error_s=z_mt_p.db_n.found_s;}
//----------------------------------------------
//====*( INSERT{}を実行 )*****
public int insert(String table_si,String datas_si)
{z_p.t_v(z_p.SE,"insert(");
String[] work_sx;String sql_s="";int i;
sql_s="INSERT INTO "+table_si+"("+z_mt_p.z_insert_name_s();
work_sx=z_p.split_sx(datas_si,',');
for(i=0;i<z_p.count_sx_i(work_sx);i++)sql_s+=","+z_p.dot_string_s(work_sx[i]);
sql_s+=")VALUES("+z_mt_p.z_insert_value_s();
for(i=0;i<z_p.count_sx_i(work_sx);i++)
  {if(!z_mt_p.program_p.find_name_b(z_p.trim_s(work_sx[i])))
   {z_p.err_s="data name ("+z_p.trim_s(work_sx[i])+") not found";z_p.t_v(z_p.SE,"insert)1");return 9;}
   sql_s+=","+z_mt_p.sql_data_s(z_mt_p.program_p.da_find_name_data_p,"");
  }
sql_s+=")";
z_p.t_v(z_p.SE,"insert)2"); 
return z_mt_p.sql_n.sql_usr2(sql_s,usr_s);
}
void ichart_iprint_v(String opt1_si,String opt2_si,String opt3_si,String opt4_si)
{bool data_b=false,wait_b=false;
z_p.sql_limit=z_mt_p.program_p.sql_limit_org;z_mt_p.program_p.sql_limit_org=0; 
 String s0="",s1="",s2="";int cnt=4,i=0;
 if(z_p.e2s_b(cmd2_s,"IPRINT"))
            {if(z_p.e3s_b(opt2_si,"PRINT","REAL")){cnt=1;s1="PRINT";}//オプション無しは印刷。
             else if(z_p.e3s_b(opt2_si,"DISPLAY","TEST")){cnt=1;s1=opt2_si;}//cnt=1はオプション対応済
            }  
        if(1<cnt)//オプション判定。
          {if     (z_p.e3s_b(opt2_si,"VERSION","SETTING")){cnt=0;wait_b=true;s1=opt2_si+" "+opt2_si;}//cnt=0は定義不要。
           else if(z_p.e2s_b(opt2_si,"HELP"))              cnt=0;//cnt=0は定義不要。
           else if(z_p.e3s_b(opt2_si,"DATA","TEST_DATA")) {data_b=true;s1=(z_p.e2s_b(cmd2_s,"IPRINT")?opt2_si:"");}//data_b=true;はデータをひな形で対応。
           else if(!z_p.e2s_b(opt2_si,"")){z_p.err_s=cmd2_s+"{,"+opt2_si+"}";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;return;}
          }
        if(0<cnt)//定義要
          {if(z_p.e2s_b(cmd2_s,"ICHART"))//ICHART
             {cnt=1;
              s0="SELECT  "+z_mt_p.db_n.cl_s
                   +"RTRIM(SYSTEM_CHART_KEY1)"+z_mt_p.db_n.c_s
                    +"CASE SYSTEM_CHART_KEY1 WHEN ' ' THEN '' ELSE '.' END"+z_mt_p.db_n.c_s
                   +"RTRIM(SYSTEM_CHART_KEY2)"+z_mt_p.db_n.c_s
                    +"CASE SYSTEM_CHART_KEY3 WHEN ' ' THEN '' ELSE '.' END"+z_mt_p.db_n.c_s
                   +"RTRIM(SYSTEM_CHART_KEY3)"+z_mt_p.db_n.c_s+"'='"+z_mt_p.db_n.c_s
                   +"RTRIM(SYSTEM_CHART_CUSTOM_PROPERTIES)"+z_mt_p.db_n.c_s
                    +"CASE SYSTEM_CHART_CUSTOM_PROPERTIES WHEN ' ' THEN '' ELSE '=' END"+z_mt_p.db_n.c_s
                   +"RTRIM(SYSTEM_CHART_DATA1)"+z_mt_p.db_n.c_s
                    +"CASE SYSTEM_CHART_DATA2 WHEN ' ' THEN '' ELSE ',' END"+z_mt_p.db_n.c_s
                   +"RTRIM(SYSTEM_CHART_DATA2)"+z_mt_p.db_n.c_s
                    +"CASE SYSTEM_CHART_DATA3 WHEN ' ' THEN '' ELSE ',' END"+z_mt_p.db_n.c_s
                   +"RTRIM(SYSTEM_CHART_DATA3)"+z_mt_p.db_n.c_s
                    +"CASE SYSTEM_CHART_DATA4 WHEN ' ' THEN '' ELSE ',' END"+z_mt_p.db_n.c_s
                   +"RTRIM(SYSTEM_CHART_DATA4)"+z_mt_p.db_n.cr_s+" FROM "
                   +z_mt_p.program_p._pmx_s("_MP_",z_p.real_test_s,z_p.inp_out_s,"ZZZZ","ZZ")+"ZZ_CHART_TABLE"  
                   +" WHERE SYSTEM_CHART='"+opt1_si+"' AND Z_CANCEL=' '"
                   +"  ORDER BY SYSTEM_CHART_NO,SYSTEM_CHART_KEY1"
                   +",CASE SYSTEM_CHART_KEY2 WHEN 'CHART_TYPE' THEN 1 ELSE 2 END"                     
                   +",SYSTEM_CHART_KEY2,SYSTEM_CHART_KEY3";                     

             }
           else  //IPRINT 
             {cnt=2;
              s0="SELECT SYSTEM_PRINT_DATA FROM "
                     +z_mt_p.program_p._pmx_s("_MP_",z_p.real_test_s,z_p.inp_out_s,"ZZZZ","ZZ")+"ZZ_PRINT_TABLE"  
                     +" WHERE SYSTEM_PRINT='"+opt1_si+"' AND Z_CANCEL=' ' ORDER BY SYSTEM_SEQ";                     
             }
           if(!z_p.e2s_b(opt1_si,""))//VER20.1
             {rc=z_mt_p.sql_n.sql_sql(z_mt_p.sql_n.s_sql_a,"FILE",z_p.real_test_s,usr_s
              ,"",s0,z_p.get_tmp_path_s(z_p.dir_s)+z_p.job_s+z_mt_p.window_s+cmd2_s+opt3_si+z_p.to_i_s(cnt++)+".TXT","OT","","");
              if(0!=rc){rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;return;}
              if(0==z_p.db_record_cnt){z_p.err_s=cmd2_s+"{"+opt1_si+"} zero count";rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;return;}
             }
           if(z_p.e2s_b(cmd2_s,"ICHART"))//ICHART
             {i=0;int st=0,alter=0;
              if(true==data_b)         //DATAはデータ用SQL作成。
                         {String from_fual_s=z_p.replace_s_s(z_mt_p.db_n.from_dual_s,"*",z_p.system_s+z_p.substring3_s(z_p.real_test_s,0,1));
                          s0="SELECT            1,1,2,3,4 "+from_fual_s
                            +" UNION ALL SELECT 2,4,3,2,1 "+from_fual_s
                            +" UNION ALL SELECT 3,5,1,9,9 "+from_fual_s
                            +" UNION ALL SELECT 4,9,1,9,1 "+from_fual_s 
                            +" UNION ALL SELECT 5,2,8,2,8 "+from_fual_s+";"; 
                          s0=s0+s0+s0+s0+s0; 
                         }
              else s0=opt4_si; 
              for(;i<z_p.length(s0);st=i)
                {for(;i<z_p.length(s0);i++)
                    if('\''==z_p.at_s_c(s0,i)){if(0==alter)alter=1;else alter=0;}
                    else if(0==alter&&';'==z_p.at_s_c(s0,i))break;
                 if(!z_p.e2s_b(z_p.trim_s(z_p.substring3_s(s0,st,i-st-1)),"")) 
                   {if(0!=z_mt_p.sql_n.sql_sql(z_mt_p.sql_n.s_sql_a,"FILE",z_p.real_test_s,usr_s
                     ,"",z_p.substring3_s(s0,st,i-st),z_p.get_tmp_path_s(z_p.dir_s)+z_p.job_s+z_mt_p.window_s+cmd2_s+opt3_si+z_p.to_i_s(cnt++)+".TXT","OT","",""))
                      {rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;break;}
                   }
                 i++;
                 if(rc==z_p.SW_ERROR_5)break;
                } 
              if(rc==z_p.SW_ERROR_5)return;
             }
           else  //IPRINT 
            {cnt=3;
             if(false==data_b)  //DATA以外はデータファイル作成。
                 {if(!z_p.e2s_b(opt4_si,"")) //VER20.1
                  if(0!=z_mt_p.sql_n.sql_sql(z_mt_p.sql_n.s_sql_a,"FILE",z_p.real_test_s,usr_s
                     ,"",opt4_si,z_p.get_tmp_path_s(z_p.dir_s)+z_p.job_s+z_mt_p.window_s+cmd2_s+opt3_si+"1.TXT","OT","",""))
                    {rc=z_p.SW_ERROR_5;sw=CHECK_RC_10;return;}
                 }
            }
          }
       for(i=1;i<cnt;i++)
           s2+=(z_p.e2s_b(s2,"")?"":" ")+z_p.get_tmp_path_s(z_p.dir_s)+z_p.job_s+z_mt_p.window_s+z_p.mm_s+cmd2_s+opt3_si+z_p.to_i_s(i)+".TXT";
       rc=z_p.process(
//JJ                  "java"+('W'==z_p.os_c?"w":"")+" -cp "
//JJ                   +z_p.bin_path_s+z_p.iv_s+"purejavacomm.jar"+('W'==z_p.os_c?";":":") //VER33
//JJ                   +z_p.bin_path_s+z_p.iv_s+"jna.jar"+('W'==z_p.os_c?";":":")
//JJ                   +z_p.bin_path_s+"IJAVA.jar "+z_p.lower_s(cmd2_s)+"_l ",
//SS                   ('U'==z_p.os_c?"mono":z_p.bin_path_s+cmd2_s+z_p.os_c+z_p.FRAMEWORK_C+".EXE"),
//SS                   ('U'==z_p.os_c?       z_p.bin_path_s+cmd2_s+z_p.os_c+z_p.FRAMEWORK_C+".EXE ":"")+
//HP                    z_p.bin_path_s+cmd2_s+z_p.os_c+z_p.FRAMEWORK_C+".EXE ",
                       s1+" "+s2,"",wait_b); // VER36.6.0.3
        sw=CHECK_RC_10;return;
}
//HP public ~ii_section_l(){delete w_prog_edit_s_n;delete w_prog_edit_org_s_n;}
//COPY $II_WRITE
}
#endif  //MENU||TIME
