//= II_PROGRAM.CS program main class author nobumichi harasawa
//= プログラム クラス
#if IMENU||ITIME
//HH #include "ii_include_hh.h"
//PP #include "ii_include_pp.h"
//SS using Microsoft.Data.SqlClient; //VER37.8.0.12
//SS using System;
//SS using System.Drawing;
//SS using System.Collections.Generic;
//SS using System.IO;
#if IMENU||ITEST
#if XAMARIN
//SS using Xamarin.Forms;
////SS using System.Drawing.Common;
#else
//SS using System.Windows.Forms;
#endif
#endif
//JJ import java.awt.*;
//JJ import java.awt.event.*;
//JJ import java.io.*;
//JJ import java.math.*;
//JJ import java.nio.charset.*;
//JJ import java.util.*;
//=***( プログラム用クラス )*****
public class ii_program_l
{
//COPY $II_DIR
//COPY $II_READ
//COPY $II_SQL2
//COPY $II_URL
public String set_data_data_s="";public char set_data_type_c;//set_data用
public int find_name_i=0;public String find_name_kind_s="";//find_name用
String[] sx;
String[] o_insert_update_sx?=?{"?????"};
int i=0,j=0;
String section_nld_kind_s="",sql_select_s="",foreign_s="";
public String find_char_s="",find_char_not_s="",find_char_last_s="",find_char_last_not_s="",find_count_s=""
,find_repeat_s=""
,find_string_s="",find_string_not_s="",find_string_last_s="",find_string_last_not_s=""
,restore_db_s="",o_into_s="",o_sql_s="",o_where_s="",continue_s="",and_space_s="",variable_s="",program_read_data_s="";
public String[] text_sx?=?{"?","?","?","?","?","?","?","?","?"};
public String[] opt_org_sx?=?{"?","?","?","?","?","?","?","?","?"};
public String[] o_table_sx?=?{"?????"};
public bool sw_esc_b=true,sw_click_program_b=false,sw_resize_b=false,sw_set_input_b=false
           ,sw_set_key_input_b=false,sw_security_b=false;
public bool sw_text_b=true;
public int rc=0,save_now_cnt=0,now_cnt=0,exit_cnt=0,click_now_cnt=0,keyboard_cnt=0,keyboard_start_cnt=0,sw_program_next=0
,sw_x_scroll=0//縦スクロールスイッチ0=スクロールしない、1=スクロールする。
,scroll_x_offset=0//横スクロール量の指定。
,scroll_x_offset_now=0
,scroll_y_offset=0//縦横スクロール量の指定。
,scroll_y_offset_now=0
,scroll_cnt=0,data_input_end_cnt=0,set_input_end_cnt=0,set_input_start=0
,click_set_top=0//SET=の先頭行（クリック範囲）
,click_set_bottom=0//SET=の最終行（クリック範囲）
,click_data_top=0//DATA=の先頭行（クリック範囲）
,click_data_bottom=0//DATA=の最終行（クリック範囲）
,form_max=0
,form_x_max=0//表示画面の幅文字数。
,form_y_max=0//表示画面の高さ文字数。
,form_right_max=0//スクロールを含めた幅文字数数。
,line_cnt=0,click_line_cnt=0,line_max=0,line_default=0,line_start=0
,line_occurs=0 //行繰り返しの回数。
,line_offset=1//繰り返しの行数
,column_cnt=0,click_column_cnt=0,column_max=0
,column_occurs=0//列方向繰り返し数。
,cancel=0,data_key_cnt=0,form_column_offset=0,column_offset=0,scroll_cnt_start=0,scroll_cnt_max=0
,scroll_x_line_top=0,scroll_y_line_top=0,sw_y_scroll=0//0=縦スクロール無し,1=縦実際にスクロール("NOT"のみ),2=スクロールバーを出すがデータ入替で対応。
,page_now,page_max,sw_msg=-1,skip_cnt=-1
,line_now=0,record_cnt=0,record_start_cnt=0,y_maximum=0,y_largechange=0
,file_record_cnt=0,file_column_cnt=0,sql_limit_org,order_count=0,output_record_cnt=0,output_column_cnt=0,random_i=100
,split_char_count=0,split_form_count=0;
public int[]  sql_record_cnt_ix=new int[6];public int[]  sql_cnt_ix=new int[6]; //(C++対抗空白２個)//
public int[]  sql_column_cnt_ix=new int[6];public int[]  sw_sql_ix=new int[6]; //(C++対抗空白２個)//
             //0=SQL,1=SQL1,2=SQL2,3=PROGRAM,4=SQL_SET,5=SQL_REPEQT
public String save_now_kind_s=""
,now_kind_s // "PASSWORD","SET","DATA","JUDGE","START","SQL","COLOR"
,program_s="" // "","NOT","INPUT","OUTPUT"
,wmi_s="",drive_free_s="",drive_type_s="",code_s="1",date_s=""
             ,date_good_s="",date_time_good_s="",code39_s="",digit11_s="",jan_s="",full_size_s=""
             ,login_password_s="",login_id_s="",page_s="" // "","PAGE","LINE"
             ,table_s="",table_alias_s="X1",table_edit_s=""
  ,program_name_key_s="",program_name_key_sep_s="",program_name_data_s="",program_name_data_sep_s=""
  ,data_all_s="",data_all_sql_s="",edit_s="",date_time_s="",edit_error_s="",having_s=""
  ,environment_s="",space_s="",space_erase_s="",next_s="",where_and_s="WHERE",order_by_s="ORDER BY ",group_by_s="GROUP BY ",cube_rollup_s=""
  ,program_permission_s="ZZZY",upper_s="",lower_s="",o_o_s="",arg_s=""//,command_s=""
  ,sql_permission_s="ZZZZ",job_permission_s="ZZZZ",job_permission_default_s="ZZZZ",job_part_s="ZZ"
  ,join_cmd_s="",join_table_s="",join_key_s="",join_on_s="",modori_now_kind_s="",url_s="",url_decode_s="",url_encode_s="",url_encode_decode_s="UTF-8";
public ii_data_l da_set_data_data_p;
public ii_data_l da_find_name_data_p;
//###############( new )################################################
ii_zz_l w_name_name_n;ii_zz_l w_name2_name_n;ii_zz_l w_name_copy_s_n;
ii_zz_l w_s_n;ii_zz_l w_data_dummy_s_n; 
ii_zz_l w_compute_s_n;ii_zz_l w_compute_type_c_n;
ii_zz_l w_sya_n;ii_zz_l w_at_n;ii_zz_l w_ast_n;ii_zz_l w_amp_n;
#if IMENU
public ii_paint_list_l paint_list_n= null ;
#endif
public List<ii_data_l> da_set_a=new List<ii_data_l>();
public List<ii_data_l> da_data_a=new List<ii_data_l>();
public List<ii_data_l> da_work_a=new List<ii_data_l>();
public List<ii_data_l> da_etc_a=new List<ii_data_l>();
public List<ii_data_l> da_form_data_a=new List<ii_data_l>();
public List<ii_data_l> da_save_now_ap= null ;
public List<ii_data_l> da_now_ap= null ;
public List<ii_data_l> da_table_a=new List<ii_data_l>();
       List<int> i_copy_end_a=new List<int>();
       List<int> i_copy_save_a=new List<int>();
public List<int> i_name_start_a=new List<int>();
public List<int> i_name_end_a=new List<int>();
public List<int> i_msg_a=new List<int>();
public List<String> s_form_a=new List<String>();
public List<String> s_Font_s_name_a=new List<String>();
public List<String> s_sql0_a=new List<String>();
public List<String> s_sql1_a=new List<String>();
public List<String> s_sql2_a=new List<String>();
public List<String> s_sql3_a=new List<String>();
public List<String> s_name_a=new List<String>();
public List<String> s_join_alias_my_a=new List<String>();
public List<String> s_join_alias_other_a=new List<String>();
public List<String> s_join_key_my_a=new List<String>();
public List<String> s_join_key_othor_a=new List<String>();
public List<String> s_join_a=new List<String>();
public List<String> s_keep_table_a=new List<String>();
public List<String> s_keep_alias_a=new List<String>();
public List<ii_xml_json_l> xm_xml_a=new List<ii_xml_json_l>();
public List<ii_xml_json_l> xm_json_a=new List<ii_xml_json_l>();
//##############################################
public readonly int START_0=0,PERSON_0=0,PASSWORD_1=1,BEGIN_0=0,STOP_BEFORE_1=1,STOP_AFTER_2=2,END_3=3,SQL_4=4,COLOR_5=5,JUDGE_6=6;
public ii_data_l da_data_p;
public ii_data_l da_now_p;
public ii_section_l section_n;
//SJ public ii_read_l[] read_nx=new ii_read_l[2];
//HH public ii_read_l   read_nx[2];
//SJ public ii_write_l[] write_nx=new ii_write_l[2];
//HH public ii_write_l   write_nx[2];
//SJ public ii_serialport_l[] serialport_nx=new ii_serialport_l[2];
//HH public ii_serialport_l   serialport_nx[2];
public ii_dir_l dir_n;public ii_dir_l dir_dir_n;
ii_z_l z_p;ii_z_mt_l z_mt_p;
ii_data_l da_work_section_p;ii_data_l da_work_data_p;
int modori_prog=0;
readonly int SW_WORK_3=3;
readonly int SW_NON_0=0,SW_BEGIN_END_8=8,SW_ETC_9=9;
public ii_data_l msg_data_n;
int sw_data=0,sw_comment=0,sw_comment2=0
,name_start=0,name2_start=0,repeat_start=0,repeat_max=0,repeat_cnt=0,repeat2_start=0,repeat2_max=0,repeat2_cnt=0
,repeat0_start=0,repeat0_max=0,repeat0_cnt=0,program_cnt=0;
public int column=0,begin_line=4,line=0,record_max=0;
String cmd_s="",seq_s;
readonly String[] CONTROL_SX?=?{"0","1","2","3","BEGIN_ENTER","ERROR","ERROR_SQL","IF_ERROR","JUDGE","MAX","PROGRAM" //VER17(IF_ERRORを追加)
,"PROGRAM_ERROR","PROGRAM_TEST","SAME","SCROLL","SMTP","SQL_DBO","SQL_D","SQL_OUT","SQL_O","SQL_LOGIN"
,"SQL_TEST","WIDTH","HIGH","2_KEY","1_TABLE","1_PROGRAM","2_PROGRAM","3_PROGRAM","RESTORE_DB","ROLLUP","CUBE","TITLE"
                               };
public int[] CONTROL_IX?=?{0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
public readonly int C_0=0,C_1=1,C_2=2,C_3=3,C_BEGIN_ENTER_4=4,C_ERROR_5=5,C_ERROR_SQL_6=6,C_IF_ERROR_7=7,C_JUDGE_8=8,C_MAX_9=9,C_PROGRAM_10=10      //VER17
,C_PROGRAM_ERROR_11=11,C_PROGRAM_TEST_12=12,C_SAME_13=13,C_SCROLL_14=14,C_SMTP_15=15,C_SQL_DBO_16=16,C_SQL_D_17=17,C_SQL_OUT_18=18,C_SQL_O_19=19,C_SQL_LOGIN_20=20 //VER17
,C_SQL_TEST_21=21,C_WIDTH_22=22,C_HIGH_23=23,C_2_KEY_24=24,C_1_TABLE_25=25,C_1_PROGRAM_26=26,C_2_PROGRAM_27=27,C_3_PROGRAM_28=28,C_RESTORE_DB_29=29,C_ROLLUP_30=30,C_CUBE_31=31,C_TITLE_32=32; //VER18.1                            //VER17
public String sel_s="INP",sel_test_s="";
int sw_data_save=0;
public String _pmx_wp_s()
{return _pmx_s("_WP",z_p.real_test_s,z_p.inp_out_s,job_permission_s,job_part_s);}
public String _pmx_s(String s_si,String real_test_si,String inp_out_si,String permission_si,String part_si)
{if(z_p.length(s_si)<3||!z_p.e3c_b(z_p.at_s_c(s_si,2),'M','W'))s_si="_"+s_si;//_MM...,_WW...でないときは先頭にハイフンを付加し位置を合わせる。
if(!z_p.e2s_b(real_test_si,"REAL"))real_test_si="TEST";
if(!z_p.e3s_b(inp_out_si,"OUT","O"))inp_out_si="I";//OUT以外はINPとする。
return (z_mt_p.db_n.db_s(s_si,real_test_si,inp_out_si,permission_si,part_si,z_p.db_c));//VER23.1
}       
//----------------------------------------------

int repeat_set_max=0,repeat_set_cnt=1;
bool repeat_set_b()
{
z_mt_p.edit_b(z_p.prog_s_n,z_p.prog_s_n.s);
String s=z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i);
s=z_mt_p.space_cut_s(s);
sx=z_p.split_sx(s,',');
repeat_set_max=0;repeat_set_cnt=1;
if(!compute_b(z_p.trim_s(sx[0])))return false;
repeat_set_max=compute;
if(1<z_p.count_sx_i(sx))
   {if(!compute_b(z_p.trim_s(sx[1])))return false;
    repeat_set_cnt=(1>compute?1:compute);
   }
return true;
}
//=====( void main_v(Keys,shift,sw) )=====
//=====( z_mt_p.sw_err,z_mt_p.sw_exit )=====
//=====( z_p.sw_program -9=全終了,-2選択, -1==続行 ,以外戻り番号 )=====
//=====( sw_ii:0=開始 )=====

#if IMENU
int sw_tran=0,exit2_cnt=0;
Keys modori_keys=Keys.None;
bool sw_data_first_b=true;
public ii_keyboard_l keyboard_n;
int sw_caret_keep=0,sw_form=0,form_occurs_start=0,set_start=0,data_start=0,program_no=0,record_limit=0,record_down_limit=0;
String sql_s="";
readonly int SW_DATA_1=1,SW_SET_2=2,SW_START_5=5;
//=*********************************************
//=***( プログラム主処理 )**********************
//=*********************************************
//**( sw_ii -2=ジョブ読み出し+(-1),-1=プログラムの解析へ、0=ジョブ開始,1ジョブ=継続 )***
readonly int SECTION_1=1,MODORI_SECTION_2=2,SECTION_SKIP_3=3,NOT_SECTUIN_4=4,FIRST_5=5
,MODORI_STOP_TEST_6=6,TEST_SKIP_7=7,MODORI_STOP_REAL_8=8,REAL_SKIP_9=9,PROGRAM_SKIP_10=10
,CANCEL_DATA_11=11,INPUT_START_12=12,SET_CANCEL_START_13=13,KEYBORD_START_14=14,KEYBORD_NONE_15=15
,RE_ENTER_16=16,KEYBORD_17=17;
public void main_v(Keys keys_ni,bool shift_bi,int sw_ii)
{
z_p.t_v(z_p.PR,"main_v(");
int i,j;String w_s;
int sw=0;//全て実行(プログラムスイッチ)
sw_caret_keep=0;
if(modori_prog>0)//EXIT{+1}の戻り処理
  {section_nld_kind_s="";
   if(z_p.e4s_b(modori_now_kind_s,"DATA","SET","START")){keys_ni=modori_keys;sw=MODORI_SECTION_2;}
   else
    {if(z_p.e2s_b(modori_now_kind_s,"BEGIN")){begin2_v();z_p.t_v(z_p.PR,"main_v)1");return;}
     if(z_p.ends_with_b(modori_now_kind_s,"TEST"))sw=MODORI_STOP_TEST_6;
     else if(z_p.starts_with_b(modori_now_kind_s,"STOP"))sw=MODORI_STOP_REAL_8;
    }
   if(0==sw)modori_prog=0;
  }
//==========================================================================================================================
if(0==sw)
  {for(;;)
     {z_p.t_v(z_p.PR2,"main_v(1/for(sw="+z_p.to_i_s(sw));
      if(0!=z_mt_p.listbox_n.sw)z_mt_p.listbox_n.clear_v();
      if(0==sw_ii)//開始時処理
        {if(2!=z_p.sw_return_sql){sw=FIRST_5;break;}//RETURN_SQL未設定は通常処理
         z_p.sw_return_sql=0;
         if(z_p.e2s_b(program_s,"NOT")){sw=FIRST_5;break;}//PROGRAM＝NOTの場合無視
         begin_set_b(set_start);page_s="PAGE"; //SET開始位置に戻る。
         keys_ni=Keys.Enter; //表示のためEnterに変更
        }
      display_v(2);
      if(Keys.Enter==keys_ni){sw=SECTION_1;break;}//Enter 処理
      if(Keys.Escape==keys_ni) //ESC 処理
        {if(z_p.e2s_b(program_s,"INPUT")&&z_p.e2s_b(now_kind_s,"DATA")){sw=CANCEL_DATA_11;break;}//DATA=入力中止
         if(z_p.e2s_b(now_kind_s,"JUDGE"))//判定処理時
           {if(true==sw_set_input_b||z_p.e2s_b(program_s,"NOT"))display_v("",2,1,1,'N');//VER13.0 入力エリアクリア
            if(z_p.e2s_b(program_s,"INPUT"))//更新プログラム
             {data_cancel_v("DATA");              sw=INPUT_START_12;break;
             }//判定中止
            if(-1!=data_input_end_cnt){begin_data_v();sw=FIRST_5;break;} //入力項目有り次のデータ処理
           } 
         if('M'==z_mt_p.program_c){keyboard_n.auto_v(1,"00");sw=SECTION_1;break;}//メニューは上のメニュー(00)へ戻る
         z_p.sw_program=z_p.count_pr_i(z_mt_p.program_list_n.pr_a)-1;
         z_p.t_v(z_p.PR,"main_v)2");
         return;//一つ前のプログラッムへ戻る
        }
      if(z_p.e2s_b(now_kind_s,"JUDGE")){sw=KEYBORD_NONE_15;break;}
      if(Keys.Tab==keys_ni&&false==shift_bi&&z_p.e3s_b(now_kind_s,"SET","DATA")){sw=SECTION_1;break;}//Tabでセクションへ。
      break;
     }//for(;;)
  }//if(0==sw)
if(0==sw)
  {for(;;) //break;を使えるようにする為forを使用
     {z_p.t_v(z_p.PR2,"main_v(2/for(sw="+z_p.to_i_s(sw));
            String s=now_kind_s;
      if(z_p.e3s_b(s,"SET","DATA")) 
        {if(z_p.e2s_b(s,"SET"))
           {if(!(Keys.None!=keys_ni&&now_cnt!=set_input_start))
              {if(Keys.Up==keys_ni) //UpでスクロールUp
                 {if(!z_p.e2s_b(page_s,"LINE")&&false==shift_bi)scroll_y_page_up_v(1);else scroll_y_line_up_v(1);
                  if(z_p.SW_ABORT_9==z_mt_p.sw_err){z_p.t_v(z_p.PR,"main_v)3");return;} 
                  sw=KEYBORD_NONE_15;break;
                 }
               if(Keys.Down==keys_ni)//DownでスクロールDown
                  {if(!z_p.e2s_b(page_s,"LINE")&&false==shift_bi)scroll_y_page_down_v(1);else scroll_y_line_down_v(1); 
                   if(z_p.SW_ABORT_9==z_mt_p.sw_err){z_p.t_v(z_p.PR,"main_v)4");return;} 
                   sw=KEYBORD_NONE_15;break;
                  }
               if(Keys.Left==keys_ni) //Leftで操作へまたはスクロール単位変更
                 {if(z_p.e2s_b(program_s,"INPUT"))
                    {if(z_p.e3i_b(1,CONTROL_IX[C_2],CONTROL_IX[C_MAX_9]))
                       {if(0<record_max){sw=SET_CANCEL_START_13;break;}
                        else {sw=KEYBORD_NONE_15;break;}
                       } 
                     else{if(0<sql_column_cnt_ix[0]){sw=SET_CANCEL_START_13;break;}
                           else {sw=KEYBORD_NONE_15;break;}
                         }
                    }
                  if(z_p.e2s_b(program_s,"OUTPUT")&&1==CONTROL_IX[C_0])
                    {if(0<record_max){sw=SET_CANCEL_START_13;break;}
                     else {sw=KEYBORD_NONE_15;break;}
                    }
                  if(z_p.e2s_b(page_s,"LINE"))page_s="PAGE";else page_s="LINE";
                  sw=KEYBORD_NONE_15;break;
                 } 
               if(Keys.None==keys_ni){sw=KEYBORD_NONE_15;break;}
               if(-1!=keyboard_start_cnt){now_cnt=keyboard_start_cnt;sw=FIRST_5;break;}
               break;
              }
           }
         if(Keys.Up==keys_ni) //UpでDATA=の最初に戻る
           {if(-1!=keyboard_start_cnt){now_cnt=keyboard_start_cnt;sw=FIRST_5;break;}}
         if(Keys.Left==keys_ni||(Keys.Tab==keys_ni&&true==shift_bi)) //LeftまたはShift+Tabで一つ前の入力に戻る。
           {if(-1!=da_now_p.left_cnt)now_cnt=da_now_p.left_cnt;sw=KEYBORD_NONE_15;break;}
         if(Keys.None==keys_ni){sw=KEYBORD_NONE_15;break;}
         break;
        }
      else if(z_p.e2s_b(s,"START"))
        {if(Keys.None==keys_ni&&!sw_click_program_b){keys_ni=Keys.Enter;break;}//操作はEnter不要で実行させるためkeys_niをEnterに変更。
         da_now_p.data_s="";display_v(0);//現在の表示クリアー
         if(Keys.Tab==keys_ni||Keys.Right==keys_ni)
           {if(1<column_occurs) //Tabは操作入力位置移動
              {if(false==shift_bi)//右に移動（Tab)
                 {if(column_cnt==column_occurs||((z_p.e2s_b(program_s,"OUTPUT")
                     ||(z_p.e3i_b(1,CONTROL_IX[C_2],CONTROL_IX[C_MAX_9])))
                       &&(record_cnt+line_occurs)>record_max))column_cnt=1;else column_cnt++;
                 } 
               else //左に移動（Shift+Tab)
                    if(1<column_cnt)column_cnt--;
                    else
                      {i=column_occurs;
                       if(z_p.e2s_b(program_s,"OUTPUT")||z_p.e3i_b(1,CONTROL_IX[C_2],CONTROL_IX[C_MAX_9]))
                         {for(i=column_occurs;(record_cnt+line_occurs*(i-column_cnt))>record_max;)i--;
                          if(i==column_cnt)break;
                         }
                       column_cnt=i;
                      }
               set_record_cnt_v();//処理中カウント再計算
              }
            sw=KEYBORD_START_14;break;
           }
         if(sw_click_program_b)
           {sw_click_program_b=false;line_cnt=click_line_cnt;column_cnt=click_column_cnt;set_record_cnt_v();
            sw=KEYBORD_START_14;break;
           }
         if(Keys.Down==keys_ni)
           {if(record_down_limit<=record_cnt){sw=KEYBORD_NONE_15;break;}
            record_cnt++;
            if(line_cnt<line_occurs)line_cnt++;
            else if(column_cnt<column_occurs){line_cnt=1;column_cnt++;}
            else if((sql_cnt_ix[0]+sql_column_cnt_ix[0])<z_p.count_s_i(s_sql0_a)-1)
                   {scroll_y_line_down_v(0);if(z_p.SW_ABORT_9==z_mt_p.sw_err){z_p.t_v(z_p.PR,"main_v)5");return;}} 
            sw=KEYBORD_START_14;break;
           }
         if(Keys.Up==keys_ni)
           {if(1==record_cnt){sw=KEYBORD_NONE_15;break;}
            record_cnt--;
            if(1<line_cnt)line_cnt--;
            else if(1<column_cnt){line_cnt=line_occurs;column_cnt--;}
                  else if(0<sql_cnt_ix[0]){scroll_y_line_up_v(0);if(z_p.SW_ABORT_9==z_mt_p.sw_err){z_p.t_v(z_p.PR,"main_v)6");return;}} 
                  sw=KEYBORD_START_14;break;
           }
         if(Keys.Left==keys_ni){begin_set_b(set_start);page_s="PAGE";sw=KEYBORD_NONE_15;break;}
         if(Keys.Home==keys_ni){set_record_cnt_first_v();sw=KEYBORD_START_14;break;}
         if(Keys.End==keys_ni)
           {record_cnt=form_max*(page_now-1)+line_now+form_max-1; 
            if(record_cnt<=record_max||z_p.e2s_b(program_s,"INPUT"))
               {line_cnt=line_occurs;column_cnt=column_occurs;}
            else
               {record_cnt=record_max-form_max*(page_now-1)-line_now;
                line_cnt=record_cnt%line_occurs+1;
                column_cnt=record_cnt/line_occurs+1;
                record_cnt=record_max; 
               }
            sw=KEYBORD_START_14;break; 
           }
         break;
        }
      else if(z_p.e2s_b(s,"PASSWORD"))
        {if(Keys.Up==keys_ni||Keys.Left==keys_ni){now_cnt=PERSON_0;sw=KEYBORD_NONE_15;break;}
         if(Keys.None==keys_ni){sw=KEYBORD_NONE_15;break;}
        }
      break;
     }//for(;;)
  }//if(0==sw)
for(;;)////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  {z_p.t_v(z_p.PR2,"main_v(3/for(sw="+z_p.to_i_s(sw));
   if(SECTION_1>=sw)
     {if(z_p.SW_OFF_0!=z_mt_p.sw_err){sw=SECTION_SKIP_3;continue;}
      z_p.err_s="";
      display_msg_v(0);
      if(z_p.e2s_b(now_kind_s,"START"))
        {for(j=(record_cnt-1)*sql_column_cnt_ix[0],i=1;z_p.count_da_i(da_data_a)>i;i++,j++) //DATA=にSQL=の受信データを転送。
         (z_p.at_da(da_data_a,i)).data_s=(sql_column_cnt_ix[0]>=i&&z_p.count_s_i(s_sql0_a)>j?z_p.at_s(s_sql0_a,j):"");
         if(0!=section("SQL",SQL_4)){z_p.t_v(z_p.PR,"main_v)7");return;}  //SQL=以下の命令を実行
         if(z_p.e3s_b((z_p.at_da(da_data_a,0)).data_s,"2","3"))data_save_v("DATA"); //DATA=のデータをセーブ
         if(z_p.e2s_b((z_p.at_da(da_data_a,0)).data_s,"1")&&0!=CONTROL_IX[C_1_TABLE_25]) //削除テーブル処理
         if(0!=z_mt_p.sql_n.table_1(program_name_key_s,table_s)) 
           {if(z_p.SW_ABORT_9==z_mt_p.sw_err){z_p.t_v(z_p.PR,"main_v)8");return;}skip_cnt=-1;sw=KEYBORD_NONE_15;continue;}
        }
       z_p.x_s=z_mt_p.alias_s(w_sya_n,w_at_n,w_ast_n,w_amp_n,z_p.at_da(da_now_ap,now_cnt)); //_Xの設定
       //@WHERE の編集 //VER23.1
       (z_p.at_da(da_now_ap,now_cnt)).where_s=
         (0!=w_ast_n.i||z_p.e2s_b(z_p.trim_s((z_p.at_da(da_now_ap,now_cnt)).data_s),"")?"":z_mt_p.set_where_s(z_p.at_da(da_now_ap,now_cnt)));
     }//if(SECTION_1>=sw)
   if(MODORI_SECTION_2>=sw)
     {rc=section_n.section(modori_prog);modori_prog=0; //セクション処理
      if(-2==z_p.sw_program){modori_prog=z_p.prog_n.i;modori_now_kind_s=now_kind_s;
                             modori_keys=keys_ni;z_p.t_v(z_p.PR,"main_v)9");return;
                            }//EXIT{+1};//SECTION_1内で設定すると設定できない場合が有るのでここで設定。
      if(0!=rc)
        {if(z_p.SW_ABORT_9==z_mt_p.sw_err){z_p.t_v(z_p.PR,"main_v)10");return;}
         if(0<exit2_cnt)now_cnt=exit2_cnt;
         exit2_cnt=0;//VER23.1 
         skip_cnt=-1;sw=KEYBORD_NONE_15;continue;
        }
      exit2_cnt=0;
      if(((z_p.e2s_b(now_kind_s,"START")&&z_p.e2s_b(z_p.at_da(da_data_a,0).data_s,"0")
           &&z_p.SW_OFF_0==z_mt_p.sw_err&&z_p.e5i_b(z_mt_p.sw_exit,0,1,2,3))||-2==z_p.sw_program)
           &&(!(0<=z_p.sw_program&&z_p.sw_program!=z_p.count_pr_i(z_mt_p.program_list_n.pr_a))))
          {z_mt_p.sw_exit=0;z_p.sw_program=-2;z_p.t_v(z_p.PR,"main_v)11");return;}  //選択
         if(0!=section_color()){z_p.t_v(z_p.PR,"main_v)12");return;}//色表示
     }//if(MODORI_SECTION_2>=sw)
   if(SECTION_SKIP_3>=sw)
     {//=****( 更新時テーブルのキー情報再確認 )*****
      if(data_key_cnt==now_cnt&&z_p.e2s_b(now_kind_s,"DATA")
         &&(z_p.e3s_b((z_p.at_da(da_data_a,0)).data_s,"2","")&&0==CONTROL_IX[C_2])
         &&0==CONTROL_IX[C_2_KEY_24]&&!z_p.e2s_b(table_s,"")
         &&!z_p.e3c_b((z_p.at_da(da_now_ap,now_cnt)).mark2_c,'O','N'))
        {if(0!=z_mt_p.sql_n.sql_usr2(get_sql_select_s("Z_CANCEL",0),z_p.inp_out_s))z_mt_p.sw_err=z_p.SW_ERROR_5;
         else if(0!=z_p.db_record_cnt&&z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_sql_a,0),""))
                {z_p.err_s=z_p.substring2_s((z_p.at_s(z_p.s_lang_a,z_mt_p.txt_ng_find)),1);z_mt_p.sw_err=z_p.SW_ERROR_5;}
        }
     }//if(SECTION_SKIP_3>=sw)
   if(NOT_SECTUIN_4>=sw)  
     {if(z_p.SW_ERROR_5==z_mt_p.sw_err)
        {skip_cnt=-1;
         if(-1!=keyboard_cnt){sw=RE_ENTER_16;continue;}
         if(z_p.e2s_b(program_s,"INPUT")&&z_p.e2s_b(now_kind_s,"DATA")){sw=CANCEL_DATA_11;continue;}
         z_mt_p.sw_err=z_p.SW_ABORT_9;
        }
      if(z_p.SW_OFF_0!=z_mt_p.sw_err||-1!=z_p.sw_program){z_mt_p.sw_exit=0;z_p.t_v(z_p.PR,"main_v)13");return;}//処理終了
      if(0<=z_p.sw_program&&z_p.sw_program!=z_p.count_pr_i(z_mt_p.program_list_n.pr_a)){z_p.t_v(z_p.PR,"main_v)14");return;}//exit{数};
      if(z_p.e2s_b(now_kind_s,"START"))
        {keyboard_cnt=-1;
         if(z_p.e3s_b((z_p.at_da(da_data_a,0)).data_s,"2","3"))//作成か修正指示。
           {if(0!=sw_y_scroll)z_mt_p.menu_p.y_scroll_n.set_max_large_v(0,0);
            now_kind_s="DATA";
            if(0==z_mt_p.sw_exit)now_cnt++;
            else now_cnt=exit_cnt; 
            keyboard_start_cnt=-1;
           }
         else if(z_p.e2s_b((z_p.at_da(da_data_a,0)).data_s,"1"))//削除指示。 
           {data_save_v("DATA");//現表示データキープ。
            if(0!=sw_y_scroll)z_mt_p.menu_p.y_scroll_n.set_max_large_v(0,0);
            da_now_ap=da_etc_a;
            now_kind_s="JUDGE";line=0;column=0;
            da_now_p=z_p.at_da(da_etc_a,JUDGE_6);now_cnt=JUDGE_6;
            da_now_p.check2_s="1,"+z_p.lang_find_s("STOP_1");
            da_now_p.data_s="";
            if(true==sw_set_input_b||z_p.e2s_b(program_s,"NOT"))display_v("",2,1,1,'W');//判定入力表示//VER13.0
           } 
         z_mt_p.sw_exit=0;
         sw=FIRST_5;continue;
        }
      exit2_cnt=0;//VER23.1
      if(0==z_mt_p.sw_exit)now_cnt++;
      else if(1==z_mt_p.sw_exit){if(now_cnt==exit_cnt)keys_ni=Keys.None;now_cnt=exit_cnt;z_mt_p.sw_exit=0;}  //exit{...}
      else if(2==z_mt_p.sw_exit)
             {//z_p.console_write_v("now_cnt="+now_cnt+",exit_cnt="+exit_cnt);
              z_mt_p.sw_exit=0;
              exit2_cnt=now_cnt;//VER23.1
              now_cnt=exit_cnt;
              da_now_p=z_p.at_da(da_now_ap,now_cnt); //VER23.1 CUT
              z_mt_p.trace_v(0,"*=("+z_p.to1_i_s(z_p.count_pr_i(z_mt_p.program_list_n.pr_a))+","+now_kind_s+"="+da_now_p.name_s+")(SECTION_1,EXIT2)=*");
              sw=SECTION_1;continue;
             }//exit2{...}
      else if(3==z_mt_p.sw_exit){now_cnt=exit_cnt;} //exit3{...}
     }//if(NOT_SECTUIN_4>=sw)
   if(FIRST_5>=sw)
     {if(now_cnt<z_p.count_da_i(da_now_ap)){sw=KEYBORD_17;continue;} 
      if(z_p.e2s_b(now_kind_s,"DATA")&&z_p.e2s_b(program_s,"NOT")&&!z_p.e2s_b(table_s,"")&&0==CONTROL_IX[C_PROGRAM_10])
        {da_now_ap=da_etc_a;now_kind_s="JUDGE";line=0;column=0;
         da_now_p=z_p.at_da(da_etc_a,JUDGE_6);now_cnt=JUDGE_6;
         if     (0==CONTROL_IX[C_2])
           {da_now_p.check2_s="2,"+z_p.lang_find_s("STOP_2");(z_p.at_da(da_data_a,0)).data_s="2";}
         else if(0==CONTROL_IX[C_3])
                {da_now_p.check2_s="3,"+z_p.lang_find_s("STOP_3");(z_p.at_da(da_data_a,0)).data_s="3";}
         else if(0==CONTROL_IX[C_1])
                {da_now_p.check2_s="1,"+z_p.lang_find_s("STOP_1");(z_p.at_da(da_data_a,0)).data_s="1";}
         else  {(z_p.at_da(da_data_a,0)).data_s="";} //更新処理せず。
         da_now_p.data_s="";
         if(0==CONTROL_IX[C_JUDGE_8])
           {display_v(0);sw=FIRST_5;
            continue;
           }
        } 
      if(!z_p.e3s_b(now_kind_s,"JUDGE","DATA")||z_p.e2s_b(program_s,"OUTPUT")){sw=PROGRAM_SKIP_10;continue;} 
      rc=0;
      if(z_p.e2s_b(now_kind_s,"JUDGE")){if(true==sw_set_input_b||z_p.e2s_b(program_s,"NOT"))display_v("",2,1,1,'N');}//判定クリアー//VER13.0
      if(0==CONTROL_IX[C_PROGRAM_TEST_12]||!z_p.e2s_b(z_p.test_s,"REAL")||!z_p.e2s_b(z_p.real_test_s,"REAL"))
        {sw=TEST_SKIP_7;continue;}
     }//if(FIRST_5>=sw)
   if(MODORI_STOP_TEST_6>=sw)
     {rc=program_i(1,"TEST");//エラー無視(1)でプログラム実行。
      if(-2==z_p.sw_program){modori_now_kind_s+="_TEST";z_p.t_v(z_p.PR,"main_v)15");return;}//EXIT{+1};は"_TEST"を付加して終了。
      if(z_p.SW_OFF_0!=rc)if(z_p.SW_ABORT_9==z_mt_p.sw_err){z_p.t_v(z_p.PR,"main_v)16");return;}
     }//if(MODORI_STOP_TEST_6>=sw)
   if(TEST_SKIP_7>=sw)
     {if(0!=rc){sw=REAL_SKIP_9;continue;}
     }//if(TEST_SKIP_7>=sw)
   if(MODORI_STOP_REAL_8>=sw)
     {rc=program_i(CONTROL_IX[C_PROGRAM_ERROR_11],z_p.test_s); //更新処理実行
      if(-2==z_p.sw_program){z_p.t_v(z_p.PR,"main_v)17");return;}//EXIT{+1};は終了。
      if(0!=rc){if(z_p.SW_ABORT_9==z_mt_p.sw_err){z_p.t_v(z_p.PR,"main_v)18");return;}
                else if(z_p.SW_OFF_0==z_mt_p.sw_err)z_mt_p.sw_err=z_p.SW_ERROR_5;
               }
     }//if(MODORI_STOP_REAL_8>=sw)
   if(REAL_SKIP_9>=sw)
      {if('J'==z_mt_p.program_c)z_mt_p.sw_use_job=1;
       (z_p.at_da(da_data_a,0)).data_s=""; //操作クリア
       if(z_p.e2s_b(program_s,"INPUT")){sw=INPUT_START_12;continue;}
       if(0!=sw_program_next){z_p.sw_program=-2;now_cnt=data_start;z_p.t_v(z_p.PR,"main_v)19");return;}  //選択
       if(-1==data_input_end_cnt)
          {z_p.sw_program=z_p.count_pr_i(z_mt_p.program_list_n.pr_a)-1;
           z_p.t_v(z_p.PR,"main_v)20");
           return;
          }//入力項目無し終了
       begin_data_v();data_save_v("DATA");
       sw=KEYBORD_17;continue; 
      }//if(REAL_SKIP_9>=sw)
   if(PROGRAM_SKIP_10>=sw)
     {if(z_p.e2s_b(now_kind_s,"PASSWORD"))
        {if(!password_b(0)){now_cnt=PERSON_0;sw=KEYBORD_17;continue;} //パスワードチェック
         else
          {//z_p.console_write_v("begin2_v/A");
           begin2_v();z_p.t_v(z_p.PR,"main_v)21");return;
          }//パスワード不要時開始処理。
        } 
     if(z_p.e2s_b(now_kind_s,"SET")&&Keys.None!=keys_ni)
        {if(!run_sql_b())if(z_p.SW_ABORT_9==z_mt_p.sw_err){z_p.t_v(z_p.PR,"main_v)22");return;}  //SQL＝実行（エラー終了)
         if('J'==z_mt_p.program_c)z_mt_p.sw_use_job=1;
         begin_set_b(set_start);keys_ni=Keys.None;
         sw=KEYBORD_17;continue;
        }
      now_cnt=set_start;
      sw=KEYBORD_NONE_15;continue;
     }//if(PROGRAM_SKIP_10>=sw)
   if(CANCEL_DATA_11>=sw)
     {data_cancel_v("DATA");
     }//if(CANCEL_DATA_11>=sw)
   if(INPUT_START_12>=sw)
     {now_kind_s="START";da_now_ap=da_data_a;now_cnt=0;
      if(0!=sw_y_scroll)z_mt_p.menu_p.y_scroll_n.set_max_large_v(y_maximum,y_largechange);
      sw=KEYBORD_START_14;
     }//if(INPUT_START_12>=sw)
   if(SET_CANCEL_START_13>=sw)
     {data_cancel_v("SET");
      now_kind_s="START";da_now_ap=da_data_a;now_cnt=0;
      if(0!=CONTROL_IX[C_0]){(z_p.at_da(da_now_ap,0)).check2_s="0,"+z_p.lang_find_s("START_0");}
      page_s="LINE";
     }//if(SET_CANCEL_START_13>=sw)
   if(KEYBORD_START_14>=sw)
     {set_line_column_v();
     }//if(KEYBORD_START_14>=sw)
   if(KEYBORD_NONE_15>=sw)
     {keys_ni=Keys.None;
      sw=KEYBORD_17;
     }//if(KEYBORD_NONE_15>=sw)
   if(RE_ENTER_16>=sw)
     {z_mt_p.sw_exit=0;
      now_cnt=keyboard_cnt;
      sw_caret_keep=sw_ii;
      if(Keys.Down==keys_ni){keys_ni=Keys.Tab;shift_bi=false;}
     }//if(RE_ENTER_16>=sw)
   z_mt_p.sw_keyboard=0;z_mt_p.sw_on_keyboard=0;//VER13.1 
//   z_p.console_write_v("ii_program/1,sw_keyboard=0");
   z_p.t_v(z_p.PR2,"z_mt_p.sw_on_keyboard=0;ii_program/1");
   z_p.t_v(z_p.PR2,"z_mt_p.sw_keyboard=0;ii_program/1");
   da_now_p=z_p.at_da(da_now_ap,now_cnt);
   z_mt_p.trace_v(0,"*=("+z_p.to1_i_s(z_p.count_pr_i(z_mt_p.program_list_n.pr_a))+","+now_kind_s+"="+da_now_p.name_s+")=*");section_nld_kind_s="";
   z_p.x_s=z_mt_p.alias_s(w_sya_n,w_at_n,w_ast_n,w_amp_n,da_now_p); //_Xの設定
   z_p.set_s=(z_p.e2s_b(now_kind_s,"SET")?"S":"");//SET=では_SETに”S”を設定。
   if(!z_p.e5c_b((z_p.at_da(da_now_ap,now_cnt)).mark2_c,' ','!','/','#')&&3!=z_mt_p.sw_exit){sw=SECTION_1;continue;}
   if('K'==(z_p.at_da(da_now_ap,now_cnt)).mark1_c&&z_p.e2s_b((z_p.at_da(da_data_a,0)).data_s,"3")){sw=NOT_SECTUIN_4;continue;}
   if((z_p.e3c_b(da_now_p.mark2_c,'/','#')&&Keys.Down==keys_ni)||'M'==z_mt_p.program_c)
      keys_ni=Keys.None;//'/'==mark2_cの時とメニューは下矢印処理中止。
   display_msg_v(1);
   if(keyboard_cnt<now_cnt)da_now_p.left_cnt=keyboard_cnt;//左矢印戻り前回位置記憶
   if(-1==keyboard_start_cnt)keyboard_start_cnt=now_cnt;//入力開始位置指定自分
   keyboard_cnt=now_cnt;//入力位置現在値記憶。
   z_mt_p.sw_err=z_p.SW_OFF_0;z_p.err_s="";
   if(0!=z_mt_p.sw_exit){now_cnt=exit_cnt;z_mt_p.sw_exit=0;sw=SECTION_1;continue;}//exit3{...};
   if(2==sw_y_scroll)//右画面幅修正。
     {i=(page_now-1)*line_occurs+line_now-1;
      if(0>i)i=0;
      else if(z_mt_p.menu_p.y_scroll_n.get_max()<i)i=z_mt_p.menu_p.y_scroll_n.get_max();
      z_mt_p.menu_p.y_scroll_n.set_value_v(i);
     }
   display_page_v();
   if(-1!=sw_msg)
     {if(z_p.e2s_b(program_s,"INPUT")) //更新処理結果表示
        {z_p.set_i_v(i_msg_a,record_cnt,sw_msg);
         display_v(z_p.substring2_s((z_p.at_s(z_p.s_lang_a,sw_msg)),1),line+(z_p.at_da(da_data_a,0)).line,1+column,10,'L');
         sw_msg=-1;
        }
      else {
            msg_data_n.data_s=z_p.substring2_s((z_p.at_s(z_p.s_lang_a,sw_msg)),1);display_msg_v(-1);sw_msg=-1;
           }
     }
   if(z_p.e2s_b(now_kind_s,"START")&&z_p.e2s_b(program_s,"INPUT")) //START チェック判定組立
     {da_now_p.check2_s="";w_s="";
      if(z_p.count_i_i(i_msg_a)>record_cnt)
        {if(-2==z_p.at_i(i_msg_a,record_cnt)||
            (-1<z_p.at_i(i_msg_a,record_cnt)&&
             '2'==z_p.at_s_c(z_p.at_s(z_p.s_lang_a,z_p.at_i(i_msg_a,record_cnt)),0)))
           {if(0!=CONTROL_IX[C_0]){da_now_p.check2_s+="0,"+z_p.lang_find_s("START_0");w_s=",";}
            if(0==CONTROL_IX[C_1]){da_now_p.check2_s+=w_s+"1,"+z_p.lang_find_s("START_1");w_s=",";}
           } 
         if(0==CONTROL_IX[C_2]){da_now_p.check2_s+=w_s+"2,"+z_p.lang_find_s("START_2");w_s=",";}
         if(-2==z_p.at_i(i_msg_a,record_cnt)||
            (-1<z_p.at_i(i_msg_a,record_cnt)&&
             '2'==z_p.at_s_c(z_p.at_s(z_p.s_lang_a,z_p.at_i(i_msg_a,record_cnt)),0)))
         if(0==CONTROL_IX[C_3]){da_now_p.check2_s+=w_s+"3,"+z_p.lang_find_s("START_3");w_s=",";}
        }
     }
   if(9==z_mt_p.listbox_n.listbox(line,column,keys_ni))z_mt_p.sw_err=z_p.SW_ON_1;//SW_ON_1(ここだけ使用？）
   keyboard_n.keyboard_v(da_now_p,line,column,sw_caret_keep,now_kind_s); //キーボード入力開始
   z_mt_p.menu_p.keyboard_scroll_v();//キーボード入力位置移動によるスクロール処理実行。
   //=**( チェックデータが１個の時は自動入力する。 ***
   z_p.t_v(z_p.PR2,"z_mt_p.listbox_n.sw="+z_p.to_i_s(z_mt_p.listbox_n.sw)+")");
   if(2==z_mt_p.listbox_n.sw&&z_p.count_s_i(z_mt_p.listbox_n.s_data_a)==z_mt_p.listbox_n.offset
      &&!z_p.e2s_b(z_p.at_s(z_mt_p.listbox_n.s_data_a,0),"\0")&&z_p.e3s_b(now_kind_s,"DATA","SET")
      &&!(da_now_p.length1<z_p.length(z_p.at_s(z_mt_p.listbox_n.s_data_a,0))
      ||(da_now_p.length2>0&&z_p.length(z_p.at_s(z_mt_p.listbox_n.s_data_a,0))<da_now_p.length2
      &&!z_p.e4s_b(da_now_p.type1_s,"+","-","F"))))
     {keyboard_n.caret_v(0);keyboard_n.auto_v(1,z_p.at_s(z_mt_p.listbox_n.s_data_a,0));
      z_p.t_v(z_p.PR2,"ii_program_n.auto_v("+z_p.at_s(z_mt_p.listbox_n.s_data_a,0)+")");
     }
   if((z_p.e3s_b(now_kind_s,"DATA","SET")&&Keys.Down==keys_ni) //下矢印処理中（ENTER)
      ||((z_p.e3s_b(now_kind_s,"SET","START")||(z_p.e2s_b(now_kind_s,"DATA")&&z_p.e2s_b(program_s,"NOT")&&sw_data_first_b))//CONTROL=BEGIN_ENTER対応
       &&Keys.Enter==keys_ni) //ENTERは次処理実行
      ||skip_cnt>now_cnt||0!=z_mt_p.sw_exit)
     {z_mt_p.sw_exit=0;
//SS      Keys w_keys=new Keys();w_keys=Keys.Tab;
//JP      int  w_keys=Keys.Tab;
      if(z_p.e2s_b(now_kind_s,"DATA")&&z_p.e2s_b(program_s,"NOT")&&sw_data_first_b)
        {//z_p.console_write_v("II_PROGRAM_C/caret_v()");
         w_keys=Keys.Enter;sw_data_first_b=false;keyboard_n.caret_v(0);
         z_mt_p.imenu_p.repaint_v();//再描画
        }
      if(0!=z_mt_p.listbox_n.sw)
        {if(!z_mt_p.listbox_n.key_down_b(keys_ni))
           {if(z_p.SW_OFF_0==z_mt_p.sw_err)z_mt_p.listbox_n.listbox(line,column,Keys.None);skip_cnt=-1;z_p.t_v(z_p.PR,"main_v)23");return;}
        }
      else if(0!=keyboard_n.key_down_v(w_keys,false,false)){skip_cnt=-1;z_p.t_v(z_p.PR,"main_v)24");return;}
      display_v(2);
      z_mt_p.sw_on_keyboard=z_mt_p.sw_keyboard=0;  //キーボード入力終了。
 //    z_p.console_write_v("ii_program/2,sw_keyboard=0");
     z_p.t_v(z_p.PR2,"z_mt_p.sw_on_keyboard=0;ii_program/2");
     z_p.t_v(z_p.PR2,"z_mt_p.sw_keyboard=0;ii_program/2");
     sw=SECTION_1;continue;
     }
   if(z_p.e2s_b(now_kind_s,"DATA"))sw_data_first_b=false; //DATA=の２件目以降はCONTROL=BEGIN_ENTER判定中止。
   skip_cnt=-1;
   if(0!=z_mt_p.sw_exit){z_mt_p.sw_exit=0;sw=SECTION_1;continue;} //exit3{...};入力されたものとしてセクションに行く
   break;
  }//for(;;)/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
z_mt_p.sql_n.sql_close_v(z_p.COMMIT,1);//入力開始時RDBMSの待ち状態を防ぐためCOMMITを実行。
//if(2==z_p.sw_return_sql){z_p.sw_return_sql=0;main_v(Keys.Enter,false,0);}//_RETURN_SQL対応(VER10.1)//VER.8.0.17
if(2==z_p.sw_return_sql){z_p.sw_return_sql=0;main_v(Keys.Left,false,1);main_v(Keys.Enter,false,0);}//_RETURN_SQL対応(VER10.1)//VER37.8.0.17
z_p.t_v(z_p.PR,"main_v)25");
return;
}
//=***( 頁行の表示 )*****
public void display_page_v()
{z_p.t_v(z_p.PR,"display_page_v(");
msg_data_n.org_Brush_n=z_p.Brush_n('N');
msg_data_n.data_s="{"+(z_p.e2s_b(page_s,"")?"":page_s+" "+z_p.to_i_s(page_now)+"("+z_p.to_i_s(line_now)+")/"+z_p.to_i_s(page_max)+" "+z_p.to_i_s(record_cnt)
   +"/"+z_p.to_i_s(record_max))+"}{"+z_p.to_i_s(da_now_p.length1)+","+(0==da_now_p.length2?"":z_p.to1_i_s(da_now_p.length2))+","
   +da_now_p.type1_s+(' '==da_now_p.type2_c?"":","+z_p.to_c_s(da_now_p.type2_c))+"}{"+z_mt_p.edit_s(da_now_p.check_s)+"}"
   +da_now_p.title_s;
for(int len=80-z_p.form_length(msg_data_n.data_s);0<len;len--)msg_data_n.data_s+=" ";//VER23.1 80文字長に補正。
display_v(0,msg_data_n,3,1);
z_p.t_v(z_p.PR,"display_page_v)");
}
//=*********************
//=***( 表示処理 )*****
//=*********************
public void display_v(int edit_ii,ii_data_l data_ni,String kind_si)
{display_v(edit_ii,data_ni,(z_p.e3s_b(kind_si,"DATA","START")?line:0)
,(z_p.e3s_b(kind_si,"DATA","START")?column:0));
}
//----------------------------------------------
public void display_v(String s_si,int line_ii,int column_ii,int length0_ii,char color_ci)
{paint_list_n.add_v(s_si,line_ii,column_ii,length0_ii,z_p.font_s,z_p.Font_n,z_p.Brush_n(color_ci));
}
//=****( edit_ii 0=無編集、1=編集、2=編集２）******* 
public void display_v(int edit_ii){display_v(edit_ii,da_now_p,line,column);}
public void display_v(int edit_ii,ii_data_l data_ni,int line_ii,int column_ii)
{z_p.t_v(z_p.PR,"display_v(");
int i,j;
 if( null ==data_ni){z_p.t_v(z_p.PR,"display_v)1");return;} // バグ発生中。
////if(null ==data_ni.data_s)data_ni.data_s="i-program error"; //VER37.8.0.12
String s=data_ni.data_s,ss;
if('N'==data_ni.mark2_c){z_p.t_v(z_p.PR,"display_v)2");return;}
if(!(0==edit_ii||z_p.e2s_b(s,"")))
  {if(z_p.e3s_b(data_ni.type1_s,"+","-"))//数値情報の場合。
     {if(!z_p.e3c_b(data_ni.type2_c,'Z','E'))
        {for(i=0;i<z_p.length(s);i++)if(z_p.e4c_b(z_p.at_s_c(s,i),'0','.','-'))continue;else break;if(i==z_p.length(s))s="";}
      if(!z_p.e2s_b(s,""))
        {i=z_p.last_index2c_i(s,'.');
         if(0!=data_ni.length2)
           {if(-1==i){i=z_p.length(s);s+=".";}
            if((z_p.length(s)-i-1)<data_ni.length2)s+=z_p.pad_end_s("",data_ni.length2-(z_p.length(s)-i-1),'0');
            else if((z_p.length(s)-i-1)>data_ni.length2)s=z_p.substring3_s(s,0,data_ni.length2+i+1);
           }
         else if(-1!=i)s=z_p.substring3_s(s,0,i);else i=z_p.length(s);
         if(!z_p.e3c_b(data_ni.type2_c,'C','E')) //数値カンマ付加。
           {if(z_p.length(s)>1&&'-'==z_p.at_s_c(s,0))i--;
            j=(i-1)/3;  
            if(j>0&&(data_ni.length0-z_p.length(s))>=j)
              {j=i%3;if(0==j)j=3;ss=s;s="";
               for(i=0;z_p.length(ss)>i;i++)
                 {s+=z_p.at_s_c(ss,i);if((i+1)==z_p.length(ss)||'.'==z_p.at_s_c(ss,i+1))j=-1;
                  if(-1!=j&&'-'!=z_p.at_s_c(ss,i))j--;
                  if(0==j){s+=",";j=3;} 
                 } 
              } 
           }
        }
      s=z_p.pad_start_s(s,data_ni.length0);
      if(data_ni.length0<z_p.length(s))s=z_p.pad_start_s("",data_ni.length0,'?');
      else if(-1!=(i=z_p.last_index2c_i(s,'.'))) //小数点以下０消し込み
             {for(i=z_p.length(s)-1;0<i;i--)
                {if     ('0'==z_p.at_s_c(s,i)) s=z_p.substring3_s(s,0,i);
                 else if('.'==z_p.at_s_c(s,i)){s=z_p.substring3_s(s,0,i);break;}
                 else break;
                }
             } 
     }
   if(z_p.e4s_b(data_ni.type1_s,"D","T","E")&&z_p.e5i_b(z_p.length(s),8,12,14,17))  //日付け編集
     {int sw=0;
      if(z_p.e2s_b(data_ni.type1_s,"D")&&17==z_p.length(s))s=z_p.substring3_s(s,0,8);
      if((8==z_p.length(s)&&10<=data_ni.length0)
         ||(12==z_p.length(s)&&16<=data_ni.length0)
         ||(14==z_p.length(s)&&19<=data_ni.length0)
         ||(17==z_p.length(s)&&23<=data_ni.length0))sw=1;
      s=z_p.date_time_edit_s(s,sw);
     }
  }
//SS if(2!=edit_ii)data_ni.Brush_n=(Brush )data_ni.org_Brush_n.Clone();
//JP if(2!=edit_ii)data_ni.Brush_n=(Brush )data_ni.org_Brush_n;
if(z_p.length(s)>data_ni.length0)s=z_p.substring3_s(s,0,data_ni.length0);
paint_list_n.add_v(z_p.set_display_s(data_ni.type2_c,s),line_ii+data_ni.line,column_ii+data_ni.column //ペイントエリアに追加。
  ,data_ni.length0,data_ni.font_s,data_ni.Font_n,data_ni.Brush_n);
z_p.t_v(z_p.PR,"display_v)3");
}
#endif //MENU
//----------------------------------------------
void s_join_after_v()
{z_p.t_v(z_p.PR,"s_join_after_v(");
String on_and_s=" ON  ";
sx=z_p.split_sx(join_key_s,',');
for(i=0;i<z_p.count_sx_i(sx);i++)
   if(!z_p.e2s_b(z_p.trim_s(sx[i]),""))
     {z_p.remove_s_v(s_join_key_othor_a,i);z_p.insert_s_v(s_join_key_othor_a,i,z_p.trim_s(sx[i]));}
j=z_p.count_s_i(s_join_alias_my_a)-1;//別名は最後の別名
String s_join_alias_s=z_p.at_s(s_join_alias_my_a,j);
w_s_n.s=(z_p.ends_with_b(join_cmd_s,"2")?z_p.substring3_s(join_cmd_s,0,z_p.length(join_cmd_s)-1):join_cmd_s);
w_s_n.s=(z_p.e2s_b(join_cmd_s,"COMMA")?",":w_s_n.s+(!z_p.e2s_b(w_s_n.s,"INNER")?" OUTER":"")+" JOIN ")+join_table_s+" "
    +s_join_alias_s+z_p.new_line_s();
if(!z_p.e2s_b(join_cmd_s,"COMMA"))
  {for(i=0;i<z_p.count_s_i(s_join_key_my_a);i++)
    {w_s_n.s+=on_and_s+z_p.at_s(s_join_alias_my_a,j)+"."+z_p.at_s(s_join_key_my_a,i)
     +"="+z_p.at_s(s_join_alias_other_a,j)+"."+z_p.at_s(s_join_key_othor_a,i)+z_p.new_line_s();
     on_and_s=" AND ";
    }
   if(!z_p.e2s_b(z_p.trim_s(join_on_s),"")){w_s_n.s+=on_and_s+"("+join_on_s+")"+z_p.new_line_s();on_and_s=" AND ";} 
   if(!z_p.ends_with_b(join_cmd_s,"2"))w_s_n.s+=on_and_s+z_p.at_s(s_join_alias_my_a,j)+".Z_CANCEL=' '"+z_p.new_line_s();
  } 
z_p.add_s(s_join_a,w_s_n.s);
join_cmd_s="";join_key_s="";join_on_s="";z_p.clear_s_v(s_join_key_my_a);z_p.clear_s_v(s_join_key_othor_a);
}
//===========================================
//=******************************************
//=*************( プログラム解析 )***********
//=******************************************
readonly String PM_S="+-";
public bool fetch_b()
{z_p.t_v(z_p.PR,"fetch_b(");
int LOOP_1=1,LOOP_PROG_2=2,JUMP_3=3,LOOP_CHECK_4=4,NEXT_CHECK_5=5
,CONT_6=6,J1_7=7,STEP_DATA_8=8,SX_GO_9=9,SKIP_10=10
,SECTION_11=11,SECTION_LOOP_12=12,TITLE_13=13,NEXT_14=14,NEXT_COPY_15=15
,NEXT_REPEAT_16=16,NEXT_REPEAT0_17=17,NEXT_REPEAT2_18=18,FIN_19=19,
#if IMENU
OK_20=20,
#endif //MENU
ERR_21=21,ERR_NAME_22=22,ERR_TYPE1_23=23
,ERR_TYPE2_24=24,ERR_MARK_25=25,ERR_FILLER_26=26;
String data_name_s="";
int sw_sw=0;
#if IMENU
#endif //MENU
String no_s="",w_s="";
int i=0,j=0;
z_p.prog_save_s="";
sw_data=SW_NON_0;sw_comment=0;sw_comment2=0;column=0;
line=begin_line;
name_start=0;name2_start=0;repeat_start=0;repeat_max=0;repeat_cnt=0;repeat2_start=0;repeat2_max=0;
repeat2_cnt=0;repeat0_start=0;repeat0_max=0;repeat0_cnt=0;
program_cnt=0;set_input_start=0;keyboard_cnt=keyboard_start_cnt=-1;
now_cnt=0;
sw_program_next=0;data_key_cnt=data_input_end_cnt=set_input_end_cnt=-1;set_input_start=0;
click_set_top=-1;click_set_bottom=-1;click_data_top=-1;click_data_bottom=-1;
sw_x_scroll=0;line_start=4;line_occurs=0;line_offset=1;
column_max=0;column_occurs=0;form_column_offset=0;column_offset=0;
scroll_cnt_start=0;
scroll_x_line_top=z_p.max_value();scroll_y_line_top=z_p.max_value();
sw_y_scroll=record_max=0;record_start_cnt=record_cnt=1;
sw_set_input_b=false;sw_set_key_input_b=false;page_now=0;page_max=0;line_now=1;
line_max=form_y_max=z_p.Y_MAX;
column_max=form_x_max=form_right_max=scroll_cnt_max=z_p.X_MAX;
program_s="";w_data_dummy_s_n.s="";wmi_s="";drive_free_s="";drive_type_s="";code39_s="";digit11_s="";jan_s="";full_size_s="";
page_s="";
z_p.sw_program=-1; //続行
int end_prog=0,w_pos=0;
int keep_prog=0;
#if IMENU
String s1_s="",s2_s="",w1_s="";
int k=0,m,start=0,end=0,length,set_column=1,set_line=4
,sw_check=0,sw_check2=0,sw_title=0,sw_message=0;
sw_resize_b=false;
sw_form=0;sw_caret_keep=0;
form_occurs_start=-1;data_start=1;set_start=0;
if(z_p.e3c_b(z_mt_p.program_c,'M','T')){program_no=1;program_s="NOT";} //menu(メニュー表示中) or time;
else program_no=0;
#endif //MENU
if('T'==z_mt_p.program_c)  //時間起動はprogram=が無くてもNOT扱いとする。
  {sql_permission_s=job_permission_s=job_permission_default_s=z_p.menu_permission_s;
   job_part_s=z_p.part_s;
   sw_data=SW_ETC_9;da_work_data_p=da_work_section_p=z_p.at_da(da_etc_a,BEGIN_0);
   program_s="NOT";
  }
//-*****( プログラム解析 z_p.program_a カウンﾄ＝program_cnt)*****
int sw=0;
for(;;)
  {z_p.t_v(z_p.PR2,"pr/fetch_b(for sw="+z_p.to_i_s(sw));
   if(LOOP_1>=sw) 
     {sw_sw=0;
      //COPY=@...でz_p.count  (program_a)が増加するので、z_p.program_a_maxで終了
      if(0==z_p.count_i_i(i_copy_end_a)&&program_cnt>=z_p.program_a_max)
        {if(!z_p.e2s_b(join_cmd_s,""))s_join_after_v();//JOIN 後処理
         no_s=seq_s=z_p.prog_s_n.s="";
         sw=FIN_19;continue;
        }  //全て処理済みはfinへ行く。
      if(program_cnt>=z_p.count_s_i(z_p.s_program_a)){sw=NEXT_14;continue;}//VER8.3で追加。
      no_s=z_p.at_s(z_p.s_program_a,program_cnt);       //プログラム番号を設定。
      seq_s=z_p.trim_s((z_p.at_s(z_p.s_program_a,program_cnt+1)));//プログラム無いシーケンス番号を設定。
      z_p.prog_s_n.s=z_p.trim_s((z_p.at_s(z_p.s_program_a,program_cnt+2)));
//    z_mt_p.trace_v(0,"seq_s="+seq_s+"/"+z_p.to_i_s(program_cnt)+"/"+z_p.to_i_s(z_p.program_a_max)); //-----------------------------------------CPP ORACLE TEST-----//
      if(0!=repeat0_cnt)z_p.prog_s_n.s=z_p.replace_s_s(z_p.replace_s_s(z_p.replace_s_s(z_p.prog_s_n.s //z_p.prog_s_n.sにプログラムを設定。
          //repeat0_cntで'$$','$+','$-'を編集。
         ,"$$",z_p.to_i_s(repeat0_cnt)),"$-",z_p.to_i_s(repeat0_cnt-1)),"$+",z_p.to_i_s(repeat0_cnt+1));
      else
      if(0!=repeat2_cnt)z_p.prog_s_n.s=z_p.replace_s_s(z_p.replace_s_s(z_p.replace_s_s(z_p.prog_s_n.s //z_p.prog_s_n.sにプログラムを設定。
          //repeat2_cntで'$$','$+','$-'を編集。
         ,"$$",z_p.to_i_s(repeat2_cnt)),"$-",z_p.to_i_s(repeat2_cnt-1)),"$+",z_p.to_i_s(repeat2_cnt+1));
      if(0!=repeat_cnt)z_p.prog_s_n.s=z_p.replace_s_s(z_p.replace_s_s(z_p.replace_s_s(z_p.prog_s_n.s
          //repeat_cntで'##','#+','#-'を編集。
         ,"##",z_p.to_i_s(repeat_cnt)),"#-",z_p.to_i_s(repeat_cnt-1)),"#+",z_p.to_i_s(repeat_cnt+1));
      z_p.prog_n.i=0;
     }//if(LOOP_1>=sw)  
   if(LOOP_PROG_2>=sw) //(2>=)
     {if(z_p.prog_left_b("*")){sw=NEXT_14;continue;} //コメントはnextへ行く。
      if(z_p.prog_left_b("COMMENT_BEGIN")){sw_comment=1;sw=NEXT_14;continue;}//COMMENT_BEGIN発見は以後コメントと見なす。
      if(z_p.prog_left_b("COMMENT2_BEGIN")){sw_comment2=1;sw=NEXT_14;continue;}//COMMENT2_BEGIN発見は以後コメントと見なす。
      if(z_p.prog_left_b("COMMENT_END"))  {sw_comment=0;sw_comment2=0;sw=NEXT_14;continue;}//COMMENT_END発見はコメント中止。
      if(z_p.prog_left_b("COMMENT2_END")) {sw_comment2=0;sw=NEXT_14;continue;}//COMMENT2_END発見はコメント2中止。
      if(1==sw_comment||1==sw_comment2){sw=JUMP_3;continue;}//コメント中はjumpへ行く。
      if(z_p.prog_left_b("="))
        {if(z_p.e2s_b(program_s,"")){sw=NEXT_14;continue;}
         if(SW_NON_0==sw_data)
           {z_p.err_s="not after (DATA=,SET=,SQL=,START,STOP_BEFORE,STOP_AFTER,BEGIN_END,END)";sw=ERR_21;break;}
         da_work_section_p.section2_s+=z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i)+z_p.new_line_s();
         if(SW_BEGIN_END_8==sw_data)
            (z_p.at_da(da_etc_a,END_3)).section2_s+=z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i)+z_p.new_line_s();
         sw=NEXT_14;continue;
        }
     }//if(LOOP_PROG_2>=sw)
   if(JUMP_3>=sw) //(3>=)
     {if(z_p.prog_left_b("%"))  //%名前+､-の判定
        {i=z_p.index3sc_i(z_p.prog_s_n.s,PM_S,z_p.prog_n.i);
         if(z_p.e3i_b(i,-1,z_p.prog_n.i)){sw=ERR_21;break;}
         w_s=z_p.substring3_s(z_p.prog_s_n.s,z_p.prog_n.i,i-z_p.prog_n.i);
         if(z_mt_p.get_name_b(z_p.da_sw_a,w_s)){w_s=z_mt_p.get_name_data_n.data_s;if(!z_p.e2s_b(w_s,"-"))w_s="+";}
         else w_s="+";
         z_p.prog_n.i=i+1;
         if(z_p.at_s_c(z_p.prog_s_n.s,i)==z_p.at_s_c(w_s,0)){sw=LOOP_CHECK_4;continue;}
         else                       {sw=NEXT_CHECK_5;continue;}
        }
      for(i=z_p.prog_n.i;z_p.length(z_p.prog_s_n.s)>i&&'0'<=z_p.at_s_c(z_p.prog_s_n.s,i)&&'9'>=z_p.at_s_c(z_p.prog_s_n.s,i);)i++;//数字の数をiに加算
      if(i!=z_p.prog_n.i)//数字有りの判定
        {if(2==(i=sw_check_b(i-z_p.prog_n.i,z_p.to2_i_s(repeat_cnt,i-z_p.prog_n.i),""))){sw=LOOP_CHECK_4;continue;}//一致
         if(1==i){sw=NEXT_CHECK_5;continue;}//不一致
        }
      if(z_p.prog_left_b("$"))
        {for(i=z_p.prog_n.i;z_p.length(z_p.prog_s_n.s)>i&&'0'<=z_p.at_s_c(z_p.prog_s_n.s,i)&&'9'>=z_p.at_s_c(z_p.prog_s_n.s,i);)i++;//数字の数をiに加算
         if(i!=z_p.prog_n.i)
           {if    (0!=repeat0_cnt)//REPEAT0=無し
                {if(2==(i=sw_check_b(i-z_p.prog_n.i,z_p.to2_i_s(repeat0_cnt,i-z_p.prog_n.i),""))){sw=LOOP_CHECK_4;continue;}}
            else if(2==(i=sw_check_b(i-z_p.prog_n.i,z_p.to2_i_s(repeat2_cnt,i-z_p.prog_n.i),""))){sw=LOOP_CHECK_4;continue;}
            if(1==i){sw=NEXT_CHECK_5;continue;}//不一致
           }
        }
      ///-****( 条件による採用、不採用の判定 )****************
      if(2==(i=sw_check_b(1,z_p.to_c_s(z_p.os_c),z_p.to_c_s(z_p.db_c)))){sw=LOOP_CHECK_4;continue;}
      if(1==i){sw=NEXT_CHECK_5;continue;}
      if(2==(i=sw_check_b(2,z_p.lang_s,""))){sw=LOOP_CHECK_4;continue;}
      if(1==i){sw=NEXT_CHECK_5;continue;}
      if(2==(i=sw_check_b(3,program_s,""))){sw=LOOP_CHECK_4;continue;}
      if(1==i){sw=NEXT_CHECK_5;continue;};
      if(2==(i=sw_check_b(4,z_p.test_s,""))){sw=LOOP_CHECK_4;continue;}
      if(1==i){sw=NEXT_CHECK_5;continue;}
      if(2==(i=sw_check_b(5,program_s,""))){sw=LOOP_CHECK_4;continue;}
      if(1==i){sw=NEXT_CHECK_5;continue;}
      if(2==(i=sw_check_b(6,program_s,""))){sw=LOOP_CHECK_4;continue;}
      if(1==i){sw=NEXT_CHECK_5;continue;}
      if(2==(i=sw_check_b(10,"MENU_"+z_p.menu_kind_s,""))){sw=LOOP_CHECK_4;continue;}
      if(1==i){sw=NEXT_CHECK_5;continue;}
      if(2==(i=sw_check_b(11,"MENU_"+z_p.menu_kind_s,""))){sw=LOOP_CHECK_4;continue;}
      if(1==i){sw=NEXT_CHECK_5;continue;}
      if(1==sw_comment||1==sw_comment2||1==sw_sw){sw=NEXT_14;continue;}
      sw=CONT_6;continue;
     }//if(JUMP_3>=sw)
  if(LOOP_CHECK_4>=sw) //(4>=)
     {if(z_p.prog_left_b("|"))sw_sw=2; //OR 判定有りで一致
      else sw_sw=0;
      for(;z_p.prog_n.i<z_p.length(z_p.prog_s_n.s);z_p.prog_n.i++)//VER18.1
        if(' '!=z_p.at_s_c(z_p.prog_s_n.s,z_p.prog_n.i))break; //VER18.1 空白は進む。
      sw=LOOP_PROG_2;continue;     
     }//if(LOOP_CHK>=sw)
  if(NEXT_CHECK_5>=sw) //(5>=)
     {if(z_p.prog_left_b("|"))   //OR 判定処理
        {if(0==sw_sw)sw_sw=1; //OR 判定有りで不一致
         for(;z_p.prog_n.i<z_p.length(z_p.prog_s_n.s);z_p.prog_n.i++)//VER18.1
            if(' '!=z_p.at_s_c(z_p.prog_s_n.s,z_p.prog_n.i))break; //VER18.1 空白は進む。
         sw=LOOP_PROG_2;continue; //OR判定処理中（処理続行）
        }
      if(2==sw_sw){sw_sw=0;sw=LOOP_PROG_2;continue;}//OR判定で一致在り（処理続行）
      sw=NEXT_14;continue;
     }//if(NEXT_CHECK_5>=sw)
   if(CONT_6>=sw) //(6>=)
     {
#if IMENU
      if(z_p.e2s_b(z_p.main_program_s,"IMENU")&&!z_p.e2s_b(program_s,""))
        {if(z_p.prog_left_b("START"))
           {sw_data=SW_START_5;da_work_data_p=da_work_section_p=z_p.at_da(da_data_a,START_0);sw=NEXT_14;continue;}
         if(z_p.prog_left_b("STOP_BEFORE"))
           {sw_data=SW_ETC_9; da_work_data_p=da_work_section_p=z_p.at_da(da_etc_a,STOP_BEFORE_1);sw=NEXT_14;continue;}
         if(z_p.prog_left_b("STOP_AFTER")||z_p.prog_left_b("STOP"))
           {sw_data=SW_ETC_9;da_work_data_p=da_work_section_p=z_p.at_da(da_etc_a,STOP_AFTER_2);sw=NEXT_14;continue;}
         if(z_p.prog_left_b("BEGIN_END"))
           {sw_data=SW_BEGIN_END_8;da_work_data_p=da_work_section_p=z_p.at_da(da_etc_a,BEGIN_0);sw=NEXT_14;continue;}
         if(z_p.prog_left_b("BEGIN"))
           {sw_data=SW_ETC_9;da_work_data_p=da_work_section_p=z_p.at_da(da_etc_a,BEGIN_0);sw=NEXT_14;continue;}
         if(z_p.prog_left_b("END"))
           {sw_data=SW_ETC_9;da_work_data_p=da_work_section_p=z_p.at_da(da_etc_a,END_3);sw=NEXT_14;continue;}
         if(z_p.prog_left_b("COLOR"))
           {sw_data=SW_ETC_9;da_work_data_p=da_work_section_p=z_p.at_da(da_etc_a,COLOR_5);sw=NEXT_14;continue;}
        }
#endif //MENU
       bool b=z_p.prog_word_b(w_s_n,"=");cmd_s=w_s_n.s;
       if(!b){if(z_p.e2s_b(program_s,"")){sw=NEXT_14;continue;}else {sw=J1_7;continue;}}
       cmd_s=z_p.upper_s(cmd_s);
      if(z_p.e2s_b(cmd_s,"JOIN_KEY"))//JOIN処理
        {if(z_p.e2s_b(program_s,"")){sw=NEXT_14;continue;}
         if(z_p.e3s_b(join_cmd_s,"","COMMA"))
           {z_p.err_s="not after (INNER=,LEFT=,RIGHT=,FULL=)";sw=ERR_21;break;}
         join_key_s+=z_p.trim_s(z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i));
         sx=z_p.split_sx(join_key_s,',');
         if(z_p.count_sx_i(sx)>z_p.count_s_i(s_join_key_my_a))
           {z_p.err_s="over (index) ("+z_p.to_i_s(z_p.count_sx_i(sx))+">"+z_p.to_i_s(z_p.count_s_i(s_join_key_my_a))+")";sw=ERR_21;break;}
         sw=NEXT_14;continue;
        }
      if(z_p.e3s_b(cmd_s,"JOIN_ON","JOIN_WHERE"))//JOIN処理
        {if(z_p.e2s_b(program_s,"")){sw=NEXT_14;continue;}
         if(z_p.e3s_b(join_cmd_s,"","COMMA")){z_p.err_s="not after (INNER=,LEFT=,RIGHT=,FULL=)";sw=ERR_21;break;}
         join_on_s+=(z_p.e2s_b(join_on_s,"")?"":z_p.new_line_s())+z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i);
         sw=NEXT_14;continue;
        }
      if(!z_p.e2s_b(join_cmd_s,""))s_join_after_v();//JOIN 後処理
      sw=CONT_6;  // switch内でcont以下にした場合はcontinueとする為
//##############( 定義命令 解析 1/2)####################################################################
      String s=cmd_s;
      if(z_p.e2s_b(s,"COPY"))
        {if(!data_set_b(w_name_copy_s_n,2)){sw=ERR_21;break;}//名前判定,前後の空白の間のみ対応(1)
         if(z_p.e2s_b(w_name_copy_s_n.s,"")){z_p.err_s="COPY is null";sw=ERR_21;break;}//名前空白エラーVER18.1
         if(-1==(i=z_p.index2as_i(s_name_a,w_name_copy_s_n.s)))//nameの名前確認
           {if(z_p.starts_with_b(w_name_copy_s_n.s,"@"))//COPY=@...の場合ETC_TABLEからコピー
              {if(-1==(i=z_p.index2as_i(z_p.s_copy_etc_name_a,w_name_copy_s_n.s)))//copy_etcの名前確認
                 {if(0!=z_mt_p.sql_n.sql_dbo_zzzz1("SELECT '9',"+z_mt_p.db_n.substr_s+"(SYSTEM_KEY2"+z_mt_p.db_n.from_s+"26"+z_mt_p.db_n.for_s+"5),SYSTEM_ETC FROM "
                  +z_mt_p.sql_n.m_real_dbo_zzzzzz_s()+"_ETC_TABLE WHERE SYSTEM_KEY1='ZZZZZZ_COPY' AND "+('F'==z_p.db_c?"":"R")+"TRIM("
                  +z_mt_p.db_n.substr_s+"(SYSTEM_KEY2"+z_mt_p.db_n.from_s+"1"+z_mt_p.db_n.for_s+"25))='"+z_p.substring2_s(w_name_copy_s_n.s,1)+"' AND Z_CANCEL=' ' ORDER BY 2"))
                     {z_p.err_s="bad (program) ZZZZZZ_ETC_TABLE/ZZZZZZ_COPY("+z_p.substring2_s(w_name_copy_s_n.s,1)+")";sw=ERR_21;break;}
                  if(0==z_p.count_s_i(z_mt_p.sql_n.s_sql_a))
                    {z_p.err_s="not found ZZZZZZ_ETC_TABLE/ZZZZZZ_COPY("+z_p.substring2_s(w_name_copy_s_n.s,1)+")";sw=ERR_21;break;}
                  z_p.add_s(z_p.s_copy_etc_name_a,w_name_copy_s_n.s);//copy_etcへ名前登録
                  z_p.add_i(z_p.i_copy_etc_start_a,z_p.count_s_i(z_p.s_program_a));//copy_etcへ名前開始位置登録
                  for(i=0;i<z_p.count_s_i(z_mt_p.sql_n.s_sql_a);i++){z_p.add_s(z_p.s_program_a,z_p.at_s(z_mt_p.sql_n.s_sql_a,i));}
                  z_p.clear_s_v(z_mt_p.sql_n.s_sql_a);
                  z_p.add_i(z_p.i_copy_etc_end_a,z_p.count_s_i(z_p.s_program_a));//copy_etcへ名前終了位置登録
                  i=z_p.count_i_i(z_p.i_copy_etc_end_a)-1;//copy_etcの名前処理カウントに設定
                 }
               z_p.add_s(s_name_a,z_p.at_s(z_p.s_copy_etc_name_a,i));//nameの名前開登録
               z_p.add_i(i_name_start_a,z_p.at_i(z_p.i_copy_etc_start_a,i));//nameの名前開始位置登録
               z_p.add_i(i_name_end_a,z_p.at_i(z_p.i_copy_etc_end_a,i));//nameの名前終了位置登録
               i=z_p.count_i_i(i_name_end_a)-1;//nameの名前処理カウントに設定
              }
            else  //z_p.get_  n(s_name_a,i)に名前発見。
              {z_p.err_s="not found (NAME? ="+w_name_copy_s_n.s+")";sw=ERR_21;break;}//名前エラー発見
           } 
         if(z_p.at_i(i_name_end_a,i)<=z_p.at_i(i_name_start_a,i)){sw=NEXT_14;continue;}//コピー無し判定
         z_p.add_i(i_copy_save_a,program_cnt+3);//現在位置保管
         z_p.add_i(i_copy_end_a,z_p.at_i(i_name_end_a,i));//最終位置設定
         program_cnt=z_p.at_i(i_name_start_a,i);//コピー先頭位置に移動
         sw=LOOP_1;continue;
        } 
      if(z_p.e2s_b(s,"DICTIONARY"))
        {if(z_p.e2s_b(program_s,"")){sw=NEXT_14;continue;}
         if(!data_set_b(w_s_n)){sw=ERR_21;break;}
         if(0!=z_mt_p.sql_n.set_dictionary_da_i(da_table_a,w_s_n.s,z_p.inp_out_s,job_permission_s)){sw=ERR_21;break;} 
         sw=NEXT_14;continue;
        }
#if IMENU
      if(z_p.e4s_b(s,"FORM0","FORM","FORM1"))
        {if(z_p.e2s_b(program_s,"")){sw=NEXT_14;continue;}
         if(z_p.e2s_b(s,"FORM0"))
           {if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
            if(-1==form_occurs_start)form_occurs_start=z_p.count_s_i(s_form_a);//繰り返し開始指定
           }
         if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
         z_p.add_s(s_form_a,z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i));//s_form_aに登録
         sw_form=1;//FORM0,1発見
         sw=NEXT_14;continue;
        }
      if(z_p.e2s_b(s,"FORM2"))
        {if(z_p.e2s_b(program_s,"")){sw=NEXT_14;continue;}
         if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
         if(1!=sw_form){z_p.err_s="not after (FORM0=,FORM1=)";sw=ERR_21;break;}//FORM0,1の後でない
         z_p.set_s_v(s_form_a,z_p.count_s_i(s_form_a)-1,z_p.at_s(s_form_a,z_p.count_s_i(s_form_a)-1)+z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i));//s_form_aに追加
         sw_form=0;
         sw=NEXT_14;continue;
        }
      if(z_p.e2s_b(s,"LINE"))
        {if(z_p.e2s_b(program_s,"")){sw=NEXT_14;continue;}
         if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
         if(!data_set_b(w_s_n,2)){sw=ERR_21;break;}//=から右w_sに設定。
         line_default=z_p.to_int_check(w_s_n.s,'0',0,1);if(!z_p.return_b){sw=ERR_21;break;} //数値変換       
         sw=NEXT_14;continue;
        } 
#endif //MENU
      if(z_p.e2s_b(s,"NAME"))
        {if(0!=name2_start)
           {if(name2_start==program_cnt){z_p.err_s="program is null(NAME2="+w_name2_name_n.s+")";sw=ERR_21;break;}
            z_p.add_s(s_name_a,w_name2_name_n.s);z_p.add_i(i_name_start_a,name2_start);z_p.add_i(i_name_end_a,program_cnt);
            name2_start=0;
           }
         if(0!=name_start)
           {if(name_start==program_cnt){z_p.err_s="program is null(NAME="+w_name_name_n.s+")";sw=ERR_21;break;}
            z_p.add_s(s_name_a,w_name_name_n.s);z_p.add_i(i_name_start_a,name_start);z_p.add_i(i_name_end_a,program_cnt);
            name_start=0;
           }
         if(!data_set_b(w_name_name_n,1)){sw=ERR_21;break;}
         if(-1!=z_p.index2as_i(s_name_a,w_name_name_n.s)){z_p.err_s="same (NAME) (NAME?="+w_name_name_n.s+")";sw=ERR_21;break;}
         if(!z_p.e2s_b(w_name_name_n.s,""))name_start=program_cnt+3;
         sw=NEXT_14;continue;
        }
      if(z_p.e2s_b(s,"NAME2"))
        {if(z_p.count_i_i(i_copy_save_a)>0){sw=NEXT_14;continue;}//copy=中は無視する。
         if(0!=name2_start)
           {if(name2_start==program_cnt){z_p.err_s="program is null(NAME2="+w_name2_name_n.s+")";sw=ERR_21;break;}
            z_p.add_s(s_name_a,w_name2_name_n.s);z_p.add_i(i_name_start_a,name2_start);z_p.add_i(i_name_end_a,program_cnt);
            name2_start=0;
           }
         if(!data_set_b(w_name2_name_n,1)){sw=ERR_21;break;}
         if(-1!=z_p.index2as_i(s_name_a,w_name2_name_n.s)||(!z_p.e2s_b(w_name2_name_n.s,"")&&z_p.e2s_b(w_name_name_n.s,w_name2_name_n.s)))
           {z_p.err_s="find (same name) (NAME?="+w_name2_name_n.s+")";sw=ERR_21;break;}
         if(!z_p.e2s_b(w_name2_name_n.s,""))name2_start=program_cnt+3;
         sw=NEXT_14;continue;
        } 
      if(z_p.e2s_b(s,"JOB_PART"))
        {if(z_p.e2s_b(program_s,"")){sw=NEXT_14;continue;}
         if('M'==z_mt_p.program_c){z_p.err_s="not use (i?_menu.txt)";sw=ERR_21;break;}//メニュー表示中。
         if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
         if(!data_set_b(w_s_n,2)){sw=ERR_21;break;}
         if(!z_mt_p.check_part_b(w_s_n.s,cmd_s+"=")){sw=ERR_21;break;}
         job_part_s=w_s_n.s;
         sw=NEXT_14;continue;
        }
      if(z_p.e3s_b(s,"PERMISSION","JOB_PERMISSION"))
        {if(z_p.e2s_b(program_s,"")){sw=NEXT_14;continue;}
         if('M'==z_mt_p.program_c){z_p.err_s="not use (i?_menu.txt)";sw=ERR_21;break;}//メニュー表示中。
         if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
         if(!data_set_b(w_s_n,2)){sw=ERR_21;break;}
         if(!z_mt_p.check_permission_b(w_s_n.s,cmd_s+"=")){sw=ERR_21;break;}
         sql_permission_s=job_permission_s=job_permission_default_s=w_s_n.s;
         sw=NEXT_14;continue;
        }
      if(z_p.e2s_b(s,"FROM"))
        {if('M'==z_mt_p.program_c){z_p.err_s="not use (i?_menu.txt)";sw=ERR_21;break;}//メニュー表示中はNG
         if('J'==z_mt_p.program_c){z_p.err_s="not use (MENU)";sw=ERR_21;break;}//メニューJOBはNG
         if(0<z_p.count_s_i(s_keep_alias_a)){z_p.err_s="only one (FROM)";sw=ERR_21;break;}
         sx=z_p.split_sx(z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i),',');
         if(1<z_p.count_sx_i(sx))
           {table_alias_s=z_mt_p.alias_s(z_p.trim_s(sx[0]));//テーブル別名セット
            table_s=z_p.trim_s(sx[1]);//テーブル名セット
            if(!set_table_b()){sw=ERR_21;break;}
           }
         sw=NEXT_14;continue;
        }
      if(z_p.e2s_b(s,"PROGRAM"))
        {if('M'==z_mt_p.program_c){z_p.err_s="not use (i?_menu.txt)";sw=ERR_21;break;}//メニュー表示中はNG
         if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
#if IMENU //VER18.1
         if(program_no==z_p.count_pr_i(z_mt_p.program_list_n.pr_a)){sw_program_next=1;sw=FIN_19;continue;}
         program_no++;
         if(program_no<z_p.count_pr_i(z_mt_p.program_list_n.pr_a)){sw=NEXT_14;continue;}
#endif  //VER18.1
         sql_permission_s=job_permission_s=job_permission_default_s=z_p.menu_permission_s;
         job_part_s=z_p.part_s;//VER23.1
         sx=z_p.split_sx(z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i),',');
         program_s=z_p.upper_s(z_p.trim_s(sx[0]));
         if(z_p.e2s_b(program_s,""))program_s=z_p.menu_kind_s;
         if(!z_p.e4s_b(program_s,"OUTPUT","INPUT","NOT"))program_s="NOT"; // VER36.000600003
         //  {z_p.err_s=z_p.e_err_s;sw=ERR_21;break;}// VER36.000600003
#if IMENU //VER18.1
         if(z_p.e2s_b(program_s,"INPUT"))data_start=0;
#endif //MENU  //VER18.1
         sw_data=SW_ETC_9;da_work_data_p=da_work_section_p=z_p.at_da(da_etc_a,BEGIN_0);
         sel_s=z_p.inp_out_s;
         z_mt_p.set_name_data_b(z_p.da_sw_a,"Z_CANCEL_SELECT",(z_p.e2s_b(program_s,"OUTPUT")?"-":"+"));//%Z_CANCEL_SELECTの初期値。 
         z_mt_p.set_name_data_b(z_p.da_sw_a,"Z_CANCEL_WHERE" ,(z_p.e2s_b(program_s,"OUTPUT")?"+":"-"));//%Z_CANCEL_WHEREの初期値。
         z_mt_p.set_name_data_b(z_p.da_sw_a,"ZZZZZZ_SQL_SELECT" ,"+");
         z_mt_p.set_name_data_b(z_p.da_sw_a,"ZZZZZZ_SQL_FROM" ,"+");
         z_mt_p.set_name_data_b(z_p.da_sw_a,"ZZZZZZ_SQL_LEFT" ,"+");
         z_mt_p.set_name_data_b(z_p.da_sw_a,"ZZZZZZ_SQL_WHERE" ,"+");
         z_mt_p.set_name_data_b(z_p.da_sw_a,"ZZZZZZ_SQL_GROUP" ,"+");
         z_mt_p.set_name_data_b(z_p.da_sw_a,"ZZZZZZ_SQL_HAVING" ,"+");
         z_mt_p.set_name_data_b(z_p.da_sw_a,"ZZZZZZ_SQL_ORDER" ,"+");
        if(2<z_p.count_sx_i(sx))
           {table_alias_s=z_mt_p.alias_s(z_p.trim_s(sx[1]));//テーブル別名セット
            table_s=z_p.trim_s(sx[2]);//テーブル名セット
            if(!set_table_b()){sw=ERR_21;break;}
           }
         sw=NEXT_14;continue;
        } 
      if(z_p.e2s_b(s,"REPEAT"))
        {if(repeat2_cnt<repeat2_max){sw=NEXT_REPEAT2_18;continue;}
         repeat2_start=repeat2_max=repeat2_cnt=0;
         if(repeat_cnt<repeat_max){sw=NEXT_REPEAT_16;continue;}
         repeat_start=repeat_max=repeat_cnt=0;
         if(!repeat_set_b()){sw=ERR_21;break;}
         if(repeat_set_max>=repeat_set_cnt){repeat_max=repeat_set_max;repeat_cnt=repeat_set_cnt;repeat_start=program_cnt+3;}
         sw=NEXT_14;continue;
        } 
      if(z_p.e2s_b(s,"REPEAT0"))
        {if(repeat2_cnt<repeat2_max){sw=NEXT_REPEAT2_18;continue;}
         repeat2_start=repeat2_max=repeat2_cnt=0;
         if(repeat_cnt<repeat_max){sw=NEXT_REPEAT_16;continue;}
         repeat_start=repeat_max=repeat_cnt=0;
         if(repeat0_cnt<repeat0_max){sw=NEXT_REPEAT0_17;continue;}
         repeat0_start=repeat0_max=repeat0_cnt=0;
         if(!repeat_set_b()){sw=ERR_21;break;}
         if(repeat_set_max>=repeat_set_cnt){repeat0_max=repeat_set_max;repeat0_cnt=repeat_set_cnt;repeat0_start=program_cnt+3;}
         sw=NEXT_14;continue;
        }
      if(z_p.e2s_b(s,"REPEAT2"))
        {if(repeat2_cnt<repeat2_max){sw=NEXT_REPEAT2_18;continue;}
         repeat2_start=repeat2_max=repeat2_cnt=0;
         if(!repeat_set_b()){sw=ERR_21;break;}
         if(repeat_set_max>=repeat_set_cnt){repeat2_max=repeat_set_max;repeat2_cnt=repeat_set_cnt;repeat2_start=program_cnt+3;}
         sw=NEXT_14;continue;
        }

      if(z_p.e10s_b(s,"FULL","FULL2","LEFT","LEFT2","RIGHT","RIGHT2","INNER2","INNER","COMMA")||z_p.e2s_b(s,"TABLE"))
        {if(!z_p.e2s_b(s,"TABLE"))
           {if(z_p.e2s_b(program_s,"")){sw=NEXT_14;continue;}
            join_cmd_s=cmd_s;
            if(z_p.e2s_b(table_alias_s,"")){z_p.err_s="not after(PROGRAM=...TABLE)";sw=ERR_21;break;}
           } 
         if(z_p.e2s_b(program_s,"")){sw=NEXT_14;continue;}
         sx=z_p.split_sx(z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i),',');
         if(2>z_p.count_sx_i(sx)){z_p.err_s="not found (,)";sw=ERR_21;break;}
         w_s_n.s=z_mt_p.alias_s(z_p.trim_s(sx[0]));//別名セット 
         for(i=0;i<z_p.count_s_i(s_keep_alias_a);i++)//別名重複チェック
             if(z_p.e2s_b(w_s_n.s,z_p.at_s(s_keep_alias_a,i))){z_p.err_s="find (same alias name) \"&"+w_s_n.s+"\"";sw=ERR_21;break;}
         if(ERR_21<=sw)break;
         z_p.add_s(s_keep_alias_a,w_s_n.s);         //別名キープ
         z_p.add_s(s_keep_table_a,z_p.trim_s(sx[1]));//テーブル名キープ
         if(0!=z_mt_p.sql_n.set_table_da_i(da_table_a,"&"+w_s_n.s,z_mt_p.edit_s(z_p.trim_s(sx[1])),z_p.inp_out_s,0)){sw=ERR_21;break;}//テーブル関連情報設定。 
         if(!z_p.e2s_b(join_cmd_s,""))//ジョイン関連処理
           {for(i=0;i<z_p.count_s_i(s_join_alias_my_a);i++)
              if(z_p.e2s_b(w_s_n.s,(z_p.at_s(s_join_alias_my_a,i)))){z_p.err_s="find (same alias name) \"&"+w_s_n.s+"\"";sw=ERR_21;break;}//ダブりはエラー。
            if(ERR_21<=sw)break;
            z_p.add_s(s_join_alias_my_a,w_s_n.s);//別名セット
            join_table_s=z_p.trim_s(sx[1]);//テーブル名セット
            w_s_n.s=(2<z_p.count_sx_i(sx)?z_mt_p.alias_s(z_p.trim_s(sx[2])):"");//相手別名セット。
            if(z_p.e2s_b(w_s_n.s,""))w_s_n.s=z_p.at_s(s_join_alias_my_a,0);//相手別名無しはPROGRAM=の別名。
            else
              {for(i=0;i<z_p.count_s_i(s_join_alias_my_a);i++)if(z_p.e2s_b(w_s_n.s,z_p.at_s(s_join_alias_my_a,i)))break;
               if(i==z_p.count_s_i(s_join_alias_my_a)){z_p.err_s="not found (alias name) (&"+w_s_n.s+") ";sw=ERR_21;break;}//前に別名無しはエラー。
              }
            z_p.add_s(s_join_alias_other_a,w_s_n.s); 
            w_s_n.s=(3<z_p.count_sx_i(sx)?z_p.trim_s(sx[3]):"0");//インデックス番号セット。
            if(!z_p.e2s_b(w_s_n.s,"*")&&!z_p.e2s_b(join_cmd_s,"COMMA"))
              {if(z_p.e2s_b(w_s_n.s,""))w_s_n.s="0";//空白は０と見なす。
               i=z_p.to_int_check(w_s_n.s,'+',0,0);if(!z_p.return_b){z_p.err_s="bad (index not plus) index2c_i("+w_s_n.s+")";sw=ERR_21;break;} 
               if(9<i){z_p.err_s="over (index) ("+w_s_n.s+">9)";sw=ERR_21;break;} 
               for(i=0;i<z_p.count_s_i(z_mt_p.sql_n.s_index_a);i+=3)
                 if(z_p.e2s_b(w_s_n.s,z_p.at_s(z_mt_p.sql_n.s_index_a,i)))//インデックス番号一致。
                    //インデックス列名セット。
                   {z_p.add_s(s_join_key_my_a,z_p.at_s(z_mt_p.sql_n.s_index_a,i+2));
                    z_p.add_s(s_join_key_othor_a,z_p.at_s(z_mt_p.sql_n.s_index_a,i+2));
                   }
               if(0==z_p.count_s_i(s_join_key_my_a)){z_p.err_s="not found (index) ("+w_s_n.s+")";sw=ERR_21;break;}//インデックス番号無し。
              }
           } 
         sw=NEXT_14;continue;
        }
      if(z_p.e2s_b(s,"MINUS"))
        {if(!data_set_b(w_s_n,2)){sw=ERR_21;break;}
         w_s_n.s=z_mt_p.space_cut_s(w_s_n.s);
         if(z_p.length(w_s_n.s)<2||'%'!=z_p.at_s_c(w_s_n.s,0)){sw=ERR_21;break;}
         z_mt_p.set_name_data_b(z_p.da_sw_a,z_p.substring2_s(w_s_n.s,1),"-");        
         sw=NEXT_14;continue;
        }
      if(z_p.e2s_b(s,"PLUS"))
        {if(!data_set_b(w_s_n,2)){sw=ERR_21;break;}
         //z_mt_p.space_cut_v(w_s_n);
         w_s_n.s=z_mt_p.space_cut_s(w_s_n.s);
         if(z_p.length(w_s_n.s)<2||'%'!=z_p.at_s_c(w_s_n.s,0)){sw=ERR_21;break;}
         z_mt_p.set_name_data_b(z_p.da_sw_a,z_p.substring2_s(w_s_n.s,1),"+");        
         sw=NEXT_14;continue;
        }
      if(z_p.e2s_b(program_s,"")){sw=NEXT_14;continue;}
//##############( 定義命令 解析 2/2 )####################################################################
      if(z_p.e2s_b(s,"WORK"))
        {sw_data_save=sw_data;  //sw_dataをセーブ。
         sw_data=SW_WORK_3;da_work_data_p=z_p.add_da(da_work_a,new ii_data_l(z_p));
         sw=STEP_DATA_8;
        }
#if IMENU
      else if(z_p.e3s_b(s,"CHECK","CHECK1"))
        {if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
         if(!z_p.e4i_b(sw_data,SW_DATA_1,SW_SET_2,SW_WORK_3)){z_p.err_s="not after (DATA=,SET=)";sw=ERR_21;break;}
         if(0==sw_check){sw_check=1;da_work_section_p.check_s="";}
         if(!z_p.e2s_b(program_s,"OUTPUT")||SW_SET_2==sw_data)
           {da_work_section_p.check_s+=z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i);da_work_section_p.check2_s="";}
         sw=NEXT_14;
        }
      else if(z_p.e2s_b(s,"CHECK2"))
        {if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
         if(!z_p.e4i_b(sw_data,SW_DATA_1,SW_SET_2,SW_WORK_3)){z_p.err_s="not after (DATA=,SET=)";sw=ERR_21;break;}
         if(0==sw_check2){sw_check2=1;da_work_section_p.check2_s="";}
         if(!z_p.e2s_b(program_s,"OUTPUT")||SW_SET_2==sw_data)
           {da_work_section_p.check2_s+=(z_p.starts_with_b(z_p.upper_s(da_work_section_p.check2_s),"SELECT ")?z_p.new_line_s(): //VER23.1
            (z_p.starts_with_b(z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i),",")
            ||z_p.e2s_b(da_work_section_p.check2_s,"")?"":" "))
           +z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i);da_work_section_p.check_s="";
           }
         sw=NEXT_14;
        }
      else if(z_p.e2s_b(s,"CLICK"))
        {if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
         if(!z_p.e4i_b(sw_data,SW_DATA_1,SW_SET_2,SW_WORK_3)){z_p.err_s="not after (DATA=,SET=)";sw=ERR_21;break;}
         da_work_section_p.click_s+=z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i);
         sw=NEXT_14;
        }
      else if(z_p.e2s_b(s,"DATA"))
        {if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
         sw_data=SW_DATA_1;da_work_data_p=da_work_section_p=z_p.add_da(da_data_a,new ii_data_l(z_p));
         sw=STEP_DATA_8;
        }
      else if(z_p.e2s_b(s,"INPUT"))
        {if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
         if(!z_p.e4i_b(sw_data,SW_DATA_1,SW_SET_2,SW_WORK_3)){z_p.err_s="not after (DATA=,SET=)";sw=ERR_21;break;}
         da_work_section_p.input_s+=z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i);
         sw=NEXT_14;
        }
      else if(z_p.e2s_b(s,"SET"))
        {if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
         sw_data=SW_SET_2;da_work_data_p=da_work_section_p=z_p.add_da(da_set_a,new ii_data_l(z_p));
         sw=STEP_DATA_8;
        }
      else if(z_p.e2s_b(s,"SQL"))      
        {if('M'==z_mt_p.program_c){z_p.err_s="not use (i?_menu.txt)";sw=ERR_21;break;}
         if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
         sql_s+=z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i)+z_p.new_line_s();
         sw_data=SW_ETC_9;da_work_data_p=da_work_section_p=z_p.at_da(da_etc_a,SQL_4);
         sw=NEXT_14;
        }
      else if(z_p.e2s_b(s,"SQL_SELECT"))
        {if('M'==z_mt_p.program_c){z_p.err_s="not use (i?_menu.txt)";sw=ERR_21;break;}
         if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
         sql_select_s+=(z_p.e2s_b(sql_select_s,"")?"":z_p.new_line_s())+z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i);
         sw=NEXT_14;
        }
#endif //MENU
      else if(z_p.e2s_b(s,"CONTROL"))
        {z_mt_p.edit_b(z_p.prog_s_n,z_p.prog_s_n.s);
         z_p.prog_word_b(w_s_n,"\t");
         sx=z_p.split_sx(z_p.upper_s(w_s_n.s),',');
         for(i=0;z_p.count_sx_i(sx)>i;i++)
           {if(z_p.e2s_b(z_p.trim_s(sx[i]),""))continue;
            if(-1==(j=z_p.index2sx_i(CONTROL_SX,z_p.trim_s(sx[i])))){z_p.err_s="bad (control) ("+z_p.trim_s(sx[i])+")";sw=ERR_21;break;}
            CONTROL_IX[j]=1;      
            if(z_p.e7i_b(j,C_SQL_DBO_16,C_SQL_D_17,C_SQL_OUT_18,C_SQL_O_19,C_SQL_LOGIN_20,C_SQL_TEST_21))
              {if(!z_mt_p.menu_check_b("CONTROL="+z_p.trim_s(sx[i]))){sw=ERR_21;break;} 
               if     (z_p.e3i_b(j,C_SQL_DBO_16,C_SQL_D_17)){sel_s="DBO";}
               else if(z_p.e3i_b(j,C_SQL_OUT_18,C_SQL_O_19)){sel_s="OUT";}
               else if(j==C_SQL_LOGIN_20){sel_s="LOGIN";}
               else if(j==C_SQL_TEST_21){sel_test_s="TEST";}
              }
           }
         if(ERR_21<=sw)break;
         sw=NEXT_14;
        }
#if IMENU
      else if(z_p.e2s_b(s,"MESSAGE"))
        {if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
         if(!z_p.e5i_b(sw_data,SW_DATA_1,SW_SET_2,SW_WORK_3,SW_START_5)){z_p.err_s="not after (DATA=,SET=,START)";sw=ERR_21;break;}//VER23.1
         if(0==sw_message){sw_message=1;da_work_section_p.message_s="";}
         da_work_section_p.message_s+=z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i);
        sw=NEXT_14;
        }
      else if(z_p.e2s_b(s,"TITLE"))
        {if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
         if(!z_p.e4i_b(sw_data,SW_DATA_1,SW_SET_2,SW_WORK_3)){z_p.err_s="not after (DATA=,SET=)";sw=ERR_21;break;}
         if(0==sw_title){sw_title=1;da_work_section_p.title_s="";}
         da_work_section_p.title_s+=z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i);
         ii_zz_l ww_s_n=new ii_zz_l();ww_s_n.s=da_work_section_p.title_s; 
         z_mt_p.edit_b(ww_s_n,da_work_section_p.title_s);
         da_work_section_p.title_s=ww_s_n.s;
//HP     delete ww_s_n;
         sw=NEXT_14;
        }
      else if(z_p.e2s_b(s,"SELECT"))
        {if('T'==z_mt_p.program_c){z_p.err_s="not use (time-job)";sw=ERR_21;break;}//TIMEはNG。
         if(!z_p.e3i_b(sw_data,SW_DATA_1,SW_SET_2)){z_p.err_s="not after (DATA=,SET=)";sw=ERR_21;break;}
         da_work_section_p.select_s
           +=(z_p.e2s_b(da_work_section_p.select_s,"")?"":z_p.new_line_s())+z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i);

         sw=NEXT_14;
        }
#endif //MENU
     }//if(CONT_6>=sw)
   if(J1_7>=sw) //(7>=)
     {if(z_p.e2s_b(cmd_s,"")||(0<z_p.length(cmd_s)&&0==z_p.at_s_i(cmd_s,0))){sw=NEXT_14;continue;}
      z_p.err_s="bad (command) ("+cmd_s+")";
      sw=ERR_21;break;
     }//if(J1_7>=sw
      //-******************************
      //-*****( DATA=,SET=,WORK= )*****
      //-*******************************
   if(STEP_DATA_8>=sw) //(8>=)
     {
#if IMENU
      if(z_p.e2s_b(z_p.main_program_s,"IMENU")&&!z_p.e2s_b(cmd_s,"WORK"))sw_check=sw_check2=sw_title=sw_message=0;
#endif //MENU
//*************************( DATA=AAA=BBBはBEGINでSET{AAA=＄BBB};を付加。VER36.6.0.3 )===============================
      for(;;)
         {int ii=0; 
         // z_p.console_write_v("1/z_p.prog_s_n.s=("+z_p.prog_s_n.s+")");
          if     (-1<(ii=z_p.index2s_i(z_p.prog_s_n.s,"DATA=")))ii+=5;
          else if(-1<(ii=z_p.index2s_i(z_p.prog_s_n.s,"SET=" )))ii+=4;
          else if(-1<(ii=z_p.index2s_i(z_p.prog_s_n.s,"WORK=")))ii+=5;
          else break;
          for(;ii<z_p.length(z_p.prog_s_n.s);ii++)if(' '!=z_p.at_s_c(z_p.prog_s_n.s,ii))break;
          if('{'==z_p.at_s_c(z_p.prog_s_n.s,ii))if(-1==(ii=z_p.index3s_i(z_p.prog_s_n.s,"}",ii)))break;  
          //int ii_begin=ii+1;
          if(-1==(ii=z_p.index3s_i(z_p.prog_s_n.s,"=",ii)))break;
          int ii_point0=ii;
          if(-1==(ii=z_p.index3s_i(z_p.prog_s_n.s,"?",ii)))break;
          int ii_point2=ii,ii_sw=0;; 
          int iii=ii;        
          if     (-1<(ii=z_p.index3s_i(z_p.prog_s_n.s,"DATA&" ,iii))) ii+=5;
          else if(-1<(ii=z_p.index3s_i(z_p.prog_s_n.s,"SET&"  ,iii))) ii+=4;
          else if(-1<(ii=z_p.index3s_i(z_p.prog_s_n.s,"DATA2&",iii))){ii+=6;ii_sw=2;}
          else if(-1<(ii=z_p.index3s_i(z_p.prog_s_n.s,"SET2&" ,iii))) ii+=5;
          else break;
          int ii_begin=ii;
          if(-1==(ii=z_p.index3s_i(z_p.prog_s_n.s,"?",ii)))break;
          int ii_point=(0==ii_sw?ii_point0:ii_point2);
          z_p.prog_s_n.s=z_p.substring3_s(z_p.prog_s_n.s,0,ii_point)+z_p.substring3_s(z_p.prog_s_n.s,ii_begin,ii-ii_begin)
                        +z_p.substring2_s(z_p.prog_s_n.s  ,ii_point);
 
         // z_p.console_write_v("2/z_p.prog_s_n.s=("+z_p.prog_s_n.s+")");
         // z_p.console_write_v("ii_begin="+ii_begin+",ii_point0="+ii_point0+",ii_begin2="+ii_begin2+",ii_end="+ii_end+",ii="+ii);
          break;
         }
//********************************************************************************************************************
      z_mt_p.edit_b(z_p.prog_s_n,z_p.prog_s_n.s);
      if(!z_p.prog_left_b("{")){sx=z_p.split_sx("",',');sw=SX_GO_9;continue;}
      //=****( data/mark )***** 
      if(!z_p.prog_word_b(w_s_n,"}")){sw=ERR_21;break;}
      if(!z_mt_p.edit_b(w_s_n,w_s_n.s)){sw=ERR_21;break;} 
      sx=z_p.split_sx(w_s_n.s,',');
     }//if(STEP_DATA_8>=sw)
   if(SX_GO_9>=sw) //(9>=)
     {w_s_n.s=z_p.replace_s_s(z_p.upper_s(z_p.trim_s(sx[0]))," ","");//VER15.1 (replace追加)
      //=****( data/mark1,mark2,mark3 )**********
      if(!z_p.e2s_b(z_p.trim_s(sx[0]),""))
        {for(i=0;z_p.length(w_s_n.s)>i;i++)
           {if(z_p.e3c_b(z_p.at_s_c(w_s_n.s,i),'K','*'))
              if(' '==da_work_data_p.mark1_c)da_work_data_p.mark1_c=z_p.at_s_c(w_s_n.s,i);
              else {sw=ERR_MARK_25;break;}
            else
            if(z_p.e6c_b(z_p.at_s_c(w_s_n.s,i),'O','N','/','!','#'))
               if(' '==da_work_data_p.mark2_c){da_work_data_p.mark2_c=z_p.at_s_c(w_s_n.s,i);if('O'==z_p.at_s_c(w_s_n.s,i))da_work_data_p.org_color_v("L");}
               else {sw=ERR_MARK_25;break;}
            else
            if('='==z_p.at_s_c(w_s_n.s,i))
               if(z_p.e4s_b(da_work_data_p.mark3_s,"","<",">"))da_work_data_p.mark3_s+=z_p.at_s_c(w_s_n.s,i);
               else {sw=ERR_MARK_25;break;}
            else
            if('>'==z_p.at_s_c(w_s_n.s,i))
               if(z_p.e3s_b(da_work_data_p.mark3_s,"","<"))da_work_data_p.mark3_s+=z_p.at_s_c(w_s_n.s,i);
               else {sw=ERR_MARK_25;break;}
            else
            if(z_p.e8c_b(z_p.at_s_c(w_s_n.s,i),'<','L','I','E','A','C','D'))
               if(z_p.e2s_b(da_work_data_p.mark3_s,""))da_work_data_p.mark3_s+=z_p.at_s_c(w_s_n.s,i);
               else {sw=ERR_MARK_25;break;}
            else
            if('G'==z_p.at_s_c(w_s_n.s,i))
               if(z_p.e2s_b(da_work_data_p.mark4_s,""))da_work_data_p.mark4_s+=z_p.at_s_c(w_s_n.s,i);
               else {sw=ERR_MARK_25;break;}
            else
            if('1'<=z_p.at_s_c(w_s_n.s,i)&&'9'>=z_p.at_s_c(w_s_n.s,i))
               if(0==da_work_data_p.mark5)da_work_data_p.mark5=z_p.to_int_c_i(z_p.at_s_c(w_s_n.s,i));
               else {sw=ERR_MARK_25;break;}
            else {sw=ERR_MARK_25;break;}
           }
        }
       if(ERR_21<=sw)break;   // VER15.1 (バグ対応)
#if IMENU
       if(z_p.e2s_b(z_p.main_program_s,"IMENU"))
          if(SW_DATA_1==sw_data&&(('K'==da_work_data_p.mark1_c&&!z_p.e2s_b(da_work_data_p.mark3_s,"C"))||
             z_p.e3s_b(da_work_data_p.mark3_s,"A","D")))
             order_count=z_p.count_da_i(da_data_a)-1;//'K'(!'C'),'A','D'は_ORDER_COUNTの最後の番号になる。
#endif //MENU
      //=****( data/alias_s)**********
      if(1<z_p.count_sx_i(sx)&&!z_p.e2s_b(z_p.trim_s(sx[1]),"")){da_work_data_p.alias_s=z_p.trim_s(sx[1]);} 
      //=****( data/filler )**********
      if(2<z_p.count_sx_i(sx)&&!z_p.e2s_b(z_p.trim_s(sx[2]),""))
        {da_work_data_p.filler=z_p.to_int_check(z_p.trim_s(sx[2]),'+',0,1);
         if(!z_p.return_b){sw=ERR_FILLER_26;break;}
        }
      //=****( data/color )**********
      if(3<z_p.count_sx_i(sx)&&!z_p.e2s_b(z_p.trim_s(sx[3]),""))da_work_data_p.org_color_v(z_p.trim_s(sx[3]));
      //=****( data/name )*****
      if(!z_p.prog_word_b(w_s_n,"{"))
         if(z_p.length(z_p.prog_s_n.s)>z_p.prog_n.i){w_s_n.s=z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i);z_p.prog_n.i=z_p.length(z_p.prog_s_n.s);};
      w_s_n.s=z_p.upper_s(w_s_n.s);int sw_first=0;
      for(int ii=0;ii<z_p.length(w_s_n.s);ii++)
        {if((0==sw_first&&'0'<=z_p.at_s_c(w_s_n.s,ii)&&'9'>=z_p.at_s_c(w_s_n.s,ii))||'-'==z_p.at_s_c(w_s_n.s,ii))
           {z_p.err_s="bad (data name) ["+z_p.to_i_s(ii+1)+"]='"+z_p.to_c_s(z_p.at_s_c(w_s_n.s,ii))+"'";sw=ERR_21;break;}//'-'と数字開始はエラー
         else sw_first=1;
        }
      if(ERR_21<=sw)break;
//**********( ABC=DEF はBEGINにSET{ABC=$DEF};を設定　VER36.6.0.3)***************************
      for(int ii=0;ii<z_p.length(w_s_n.s);ii++)
         if('='==z_p.at_s_c(w_s_n.s,ii)) 
            {//z_p.console_write_v("1/w_s_n.s="+w_s_n.s);
             int ii_begin1=0,ii_len=ii;
             if('$'==z_p.at_s_c(w_s_n.s,0)){ii_begin1=1;ii_len=ii-1;} 
             ii++;for(;ii<z_p.length(w_s_n.s);ii++)if(' '!=z_p.at_s_c(w_s_n.s,ii))break;
             if('$'==z_p.at_s_c(w_s_n.s,ii))ii++; 
             (z_p.at_da(da_etc_a,BEGIN_0)).section1_s+="SET{"+z_p.substring3_s(w_s_n.s,ii_begin1,ii_len)+"=$"+z_p.substring2_s(w_s_n.s,ii)+"};";
             w_s_n.s=z_p.substring3_s(w_s_n.s,ii_begin1,ii_len);
             //z_p.console_write_v("2/w_s_n.s="+w_s_n.s);
             break;
            }
//**********************************************************************
      if(z_p.starts_with_b(w_s_n.s,"_")||z_p.starts_with_b(w_s_n.s,"#")||z_p.starts_with_b(w_s_n.s,"&")||z_p.starts_with_b(w_s_n.s,"@")
      ||z_p.starts_with_b(w_s_n.s,"!")||z_p.starts_with_b(w_s_n.s,"^")){z_p.err_s="bad (data name _..,#..,&..,@..,!..,^..) ("+w_s_n.s+") ";sw=ERR_21;break;}
      if(z_p.starts_with_b(w_s_n.s,"$"))
        {w_s_n.s=z_p.trim_s(z_p.substring2_s(w_s_n.s,1));
         if((z_p.e2s_b(program_s,"NOT")&&z_p.e2s_b(cmd_s,"DATA"))||!z_p.e2s_b(cmd_s,"DATA"))
           {bool b=set_old_data_data_b(w_s_n.s);
            da_work_data_p.data_s=set_data_data_s;//w_type_c_n.c=set_data_type_c;  
            if(!b){if(1<z_p.count_pr_i(z_mt_p.program_list_n.pr_a)){sw=ERR_NAME_22;break;}} //VER23.1
            else (z_p.at_da(da_etc_a,BEGIN_0)).section1_s+="SET{"+w_s_n.s+"=$"+w_s_n.s+"};";
           }
         else {sw=ERR_NAME_22;break;}
        }
      if(z_p.e2s_b(w_s_n.s,"")){z_p.err_s="data name is null";sw=ERR_21;break;}//VER18.1
      if(find_name_b(w_s_n.s)){z_p.err_s="same (data name) \""+w_s_n.s+"\"";sw=ERR_21;break;}
      da_work_data_p.name_s=w_s_n.s;
      data_name_s=z_p.dot_string_s(da_work_data_p.name_s);
      i=z_p.index2c_i(data_name_s,'_'); //VER24.1
       da_work_data_p.title_s=z_p.substring2_s(data_name_s,i+1);//VER24.1
      //=****( data/type )*****
      if(!z_p.prog_word_b(w_s_n,"}")){sw=ERR_21;break;}
      if(!z_mt_p.edit_b(w_s_n,w_s_n.s)){sw=ERR_21;break;}
      sx=z_p.split_sx(w_s_n.s,',');
      for(i=0;z_p.count_sx_i(sx)>i;i++)
        {
         w_s_n.s=z_p.trim_s(sx[i]);
         if(!z_p.e2s_b(w_s_n.s,"")&&'$'==z_p.at_s_c(w_s_n.s,0))
            {ii_zz_l ww_s_n=new ii_zz_l();ii_zz_l ww_type_c_n=new ii_zz_l();
             bool b=get_data_b(ww_s_n,ww_type_c_n,w_s_n.s);sx[i]=ww_s_n.s;
//HP         delete ww_s_n;delete ww_type_c_n;
             if(!b){sw=ERR_21;break;}
            }  
        } 
      if(ERR_21<=sw)break;
      da_work_data_p.length1=z_p.to_int_check(z_p.trim_s(sx[0]),'+',0,1);if(!z_p.return_b){sw=ERR_21;break;} 
      if(1<z_p.count_sx_i(sx)){da_work_data_p.length2=z_p.to_int_check(z_p.trim_s(sx[1]),'+',0,1);if(!z_p.return_b){sw=ERR_21;break;}}
      if(2<z_p.count_sx_i(sx))
        {da_work_data_p.type1_s=(z_p.e2s_b(z_p.trim_s(sx[2]),"")?" ":z_p.trim_s(sx[2]));
         if(1<z_p.length(da_work_data_p.type1_s))
           {if(-1!=z_p.index2c_i(da_work_data_p.type1_s,'+')){sw=ERR_TYPE1_23;break;}
            if(-1!=z_p.index2c_i(da_work_data_p.type1_s,'-')){sw=ERR_TYPE1_23;break;}
            if(-1!=z_p.index2c_i(da_work_data_p.type1_s,'D')){sw=ERR_TYPE1_23;break;}
            if(-1!=z_p.index2c_i(da_work_data_p.type1_s,'F')){sw=ERR_TYPE1_23;break;}
            if(-1!=z_p.index2c_i(da_work_data_p.type1_s,'T')){sw=ERR_TYPE1_23;break;}
            if(-1!=z_p.index2c_i(da_work_data_p.type1_s,'E')){sw=ERR_TYPE1_23;break;}
           }      
        }
      if(3<z_p.count_sx_i(sx))
        {w_s_n.s=z_p.upper_s(z_p.trim_s(sx[3])); //VER 24.1 upper_s()追加
         if(!z_p.e2s_b(w_s_n.s,""))
           {if(z_p.e3s_b(da_work_data_p.type1_s,"+","-"))//数値情報の場合。
               if(z_p.e4s_b(w_s_n.s,"C","Z","E"))da_work_data_p.type2_c=z_p.at_s_c(w_s_n.s,0);else {sw=ERR_TYPE2_24;break;}
            else
            if(z_p.e8s_b(w_s_n.s,"I","L","K","X","*","#","R"))da_work_data_p.type2_c=z_p.at_s_c(w_s_n.s,0);
            else {sw=ERR_TYPE2_24;break;}
           }
        }
      if('K'==da_work_data_p.mark1_c)z_p.t_v(z_p.PR2,"da_work_data_p.name_s="+da_work_data_p.name_s); //VER32.1 _FOREGIN 設定。
      if('K'==da_work_data_p.mark1_c)if(z_p.e2s_b(foreign_s,""))foreign_s=da_work_data_p.name_s; //VER32.1 _FOREGIN 設定。
      //=****( length0 計算 )*******
      da_work_data_p.length1+=da_work_data_p.mark5;//属性５分長さ1を長くする。
      da_work_data_p.length0=da_work_data_p.length1;
      if(0==da_work_data_p.length0){sw=SKIP_10;continue;}
      if('N'!=da_work_data_p.mark2_c&&80<da_work_data_p.length1)da_work_data_p.length0=80;
      char c=z_p.at_s_c(da_work_data_p.type1_s,0);
      if(z_p.e3c_b(c,'-','+'))
          {if(z_p.e2c_b(c,'-'))da_work_data_p.length0++;
           if(0<da_work_data_p.length2)da_work_data_p.length0++;//少数点分
           if(!z_p.e3c_b(da_work_data_p.type2_c,'C','E'))
              da_work_data_p.length0+=(da_work_data_p.length1-1-da_work_data_p.length2)/3;//カンマ分
           if(da_work_data_p.length1==da_work_data_p.length2)da_work_data_p.length0++; //全て小数点以下の場合整数部付加(VER7.10）
          }
      else if(z_p.e2c_b(c,'D')){if(7<da_work_data_p.length0&&10>da_work_data_p.length0)da_work_data_p.length0=10;}
      else if(z_p.e3c_b(c,'E','T'))
        {if      (7<da_work_data_p.length0&&10>da_work_data_p.length0)da_work_data_p.length0=10;
         if     (11<da_work_data_p.length0&&14>da_work_data_p.length0)da_work_data_p.length0=16;
         else if(13<da_work_data_p.length0&&17>da_work_data_p.length0)da_work_data_p.length0=19;
         else if(16<da_work_data_p.length0&&23>da_work_data_p.length0)da_work_data_p.length0=23;
        }
     }//if(SX_GO_9>=sw)
   if(SKIP_10>=sw) //(10>=)
     {//=****( data/check )*****
      if(z_p.prog_left_b("{"))
        {keep_prog=z_p.prog_n.i;
         if(z_p.prog_left_b("{")){sw=SECTION_11;continue;}//"{{”はセクション処理
         z_p.prog_n.i=keep_prog;
         if(!z_p.prog_word_b(w_s_n,"}")){sw=ERR_21;break;}
          da_work_data_p.check_s=w_s_n.s;
        }
      //=****( data/check2 )*****
      if(z_p.prog_left_b("{"))
        {keep_prog=z_p.prog_n.i;
         if(z_p.prog_left_b("{")){sw=SECTION_11;continue;}//"{{”はセクション処理
         z_p.prog_n.i=keep_prog;
         if(!z_p.prog_word_b(w_s_n,"}")){sw=ERR_21;break;}
         da_work_data_p.check2_s=w_s_n.s;
        }
      //=****( data/message )*****
      if(z_p.prog_left_b("{"))
        {keep_prog=z_p.prog_n.i;
         if(z_p.prog_left_b("{")){sw=SECTION_11;continue;}//"{{”はセクション処理
         z_p.prog_n.i=keep_prog;
         if(!z_p.prog_word_b(w_s_n,"}")){sw=ERR_21;break;}
         da_work_data_p.message_s=w_s_n.s;
        }
      //=****( data/dictionary_check )*****
      if(z_p.prog_left_b("{"))
        {keep_prog=z_p.prog_n.i;
         if(z_p.prog_left_b("{")){sw=SECTION_11;continue;}//"{{”はセクション処理
         z_p.prog_n.i=keep_prog;
         if(!z_p.prog_word_b(w_s_n,"}")){sw=ERR_21;break;}
         da_work_data_p.dictionary_check_s=w_s_n.s;
        }
      //=****( data/dictionary_table )*****
      if(z_p.prog_left_b("{"))
        {keep_prog=z_p.prog_n.i;
         if(z_p.prog_left_b("{")){sw=SECTION_11;continue;}//"{{”はセクション処理
         z_p.prog_n.i=keep_prog;
         if(!z_p.prog_word_b(w_s_n,"}")){sw=ERR_21;break;}
         da_work_data_p.dictionary_table_s=w_s_n.s;
        }
      //=****( data/dictionary_left )*****
      if(z_p.prog_left_b("{"))
        {keep_prog=z_p.prog_n.i;
         if(z_p.prog_left_b("{")){sw=SECTION_11;continue;}//"{{”はセクション処理
         z_p.prog_n.i=keep_prog;
         if(!z_p.prog_word_b(w_s_n,"}")){sw=ERR_21;break;}
         da_work_data_p.dictionary_left_s=w_s_n.s;
        }
      keep_prog=z_p.prog_n.i;
      if(z_p.prog_left_b("{"))if(z_p.prog_left_b("{")){sw=SECTION_11;continue;} //"{{”はセクション処理
      z_p.prog_n.i=keep_prog;
      sw=TITLE_13;continue;
      //=****( data/section )*****
     }//if(SKIP_10>=sw)
   if(SECTION_11>=sw)keep_prog=z_p.prog_n.i;  //(11>=)//開始位置キープ
   if(SECTION_LOOP_12>=sw)  //(12>=)
     { if(!z_p.prog_word_b(w_s_n,"}")){sw=ERR_21;break;}
        {end_prog=z_p.prog_n.i; //終了位置キープ
         if(!z_p.prog_left_b("}")){sw=SECTION_LOOP_12;continue;}//" }"が連続していない場合はSECTION_1中。
         //開始位置と終了位置で文字列構成。
         da_work_data_p.section1_s=z_p.trim_s(z_p.substring3_s(z_p.prog_s_n.s,keep_prog,end_prog-keep_prog-1));
        }
      //=****( data/title )*****
     }//if(SECTION_LOOP_12>=sw)
   if(TITLE_13>=sw)  //(13>=)
     {if(z_p.length(z_p.prog_s_n.s)>z_p.prog_n.i)da_work_data_p.title_s=z_p.substring2_s(z_p.prog_s_n.s,z_p.prog_n.i);
      if(' '==da_work_data_p.mark1_c&&z_p.starts_with_b(data_name_s,"Z_")) //Z_は更新入力対象にしない。
        {da_work_data_p.mark1_c='*';if(' '==da_work_data_p.mark2_c)da_work_data_p.mark2_c='O';}
      if('K'==da_work_data_p.mark1_c&&!z_p.e2s_b(cmd_s,"WORK"))
        {if(z_p.e2s_b(cmd_s,"DATA"))data_key_cnt=z_p.count_da_i(da_data_a)-1;
         program_name_key_s+=program_name_key_sep_s+data_name_s;program_name_key_sep_s=",";
        }
      else if(' '==da_work_data_p.mark1_c&&z_p.e2s_b(cmd_s,"DATA"))
        {program_name_data_s+=program_name_data_sep_s+data_name_s;program_name_data_sep_s=",";
         if(2==CONTROL_IX[C_3])CONTROL_IX[C_3]=0;
        }
      if(z_p.e2s_b(cmd_s,"DATA"))
        {data_all_s+=    (z_p.e2s_b(data_all_s    ,"")?"":",")+da_work_data_p.name_s;
         data_all_sql_s+=(z_p.e2s_b(data_all_sql_s,"")?"":",")+z_mt_p.set_alias_column_name_s(da_work_data_p.name_s);//VER18.1
        }
      if(z_p.e5c_b(da_work_data_p.mark2_c,' ','/','!','#'))
        {if     (z_p.e2s_b(cmd_s,"DATA"))data_input_end_cnt=z_p.count_da_i(da_data_a)-1;
         else if(z_p.e2s_b(cmd_s,"SET"))set_input_end_cnt=z_p.count_da_i(da_set_a)-1;
        }
      //=****( &別名チェック )*****
      int sw_dictionary=0;//全てOK            
      z_p.x_s=z_mt_p.alias_s(w_sya_n,w_at_n,w_ast_n,w_amp_n,da_work_data_p); //_Xの設定
      ii_zz_l ww_s_n=new ii_zz_l();ii_zz_l ww2_s_n=new ii_zz_l();ii_zz_l ww3_s_n=new ii_zz_l();ii_zz_l ww_type_c_n=new ii_zz_l();
         //テーブル使用データ辞書対象
      if(z_p.e3s_b(da_work_data_p.dictionary_check_s,"SECTION1","SECTION2")
        ||z_p.starts_with_b(da_work_data_p.dictionary_check_s,"SELECT")//VER19.1
        ||z_p.starts_with_b(da_work_data_p.dictionary_check_s,"LISTBOX"))
        {z_mt_p.edit_b(ww_s_n,da_work_data_p.dictionary_table_s); //データ辞書のテーブル編集。
         z_mt_p.edit_b(ww2_s_n,table_s); //PROGRAM=のテーブル名。
        if((z_p.e2s_b(ww_s_n.s,ww2_s_n.s)
           &&0==CONTROL_IX[C_SAME_13]) // {VER10.0}CONTROL=SAMEは採用                               
          ||0==w_amp_n.i){sw_dictionary=9;da_work_data_p.section1_s="";} //PROGRAM=のテーブル名と一致及び別名に'&'無しはデータ辞書不採用。
         else
           {if(get_data_b(ww3_s_n,ww_type_c_n,"&"+z_p.x_s+".TABLE")) //別名のテーブル名
             {z_mt_p.edit_b(ww2_s_n,ww3_s_n.s); //別名のテーブル編集。
              //テーブル名不一致；
              if(!z_p.e2s_b(ww_s_n.s,ww2_s_n.s))
                {z_p.err_s="not e (table name) (&"+z_p.x_s+")!='"+z_p.dot_string_s(ww_s_n.s)+"'";
//HP             delete ww_s_n;delete ww2_s_n;delete ww3_s_n;delete ww_type_c_n;
                 sw=ERR_21;break;
                }
              //別名に'*','#'有りはコメント欄にデータを転送しない。
              if(0!=w_ast_n.i||0!=w_sya_n.i||z_p.e3c_b(da_work_data_p.mark2_c,'O','N'))
                {if(z_p.starts_with_b(da_work_data_p.dictionary_check_s,"SELECT")|| //VER19.1
                   z_p.starts_with_b(da_work_data_p.dictionary_check_s,"LISTBOX")||z_p.e3c_b(da_work_data_p.mark2_c,'O','N'))
                  {da_work_data_p.section1_s="";}  //LISTBOXのSECTION_1,#有り不採用
                 else if(z_p.e2s_b(da_work_data_p.dictionary_check_s,"SECTION2"))     //SECTION2は転送先を取る。
                         if(z_p.starts_with_b(da_work_data_p.section1_s,"SQL_SET{"))
                            if(7<(w_pos=z_p.index2c_i(da_work_data_p.section1_s,'}')))
                               da_work_data_p.section1_s=z_p.substring3_s(da_work_data_p.section1_s,0,8)+z_p.substring2_s(da_work_data_p.section1_s,w_pos);
                }  
             }
           }
        }
      else {if(z_p.starts_with_b(z_p.trim_s(z_p.upper_s(da_work_data_p.check2_s)),"SELECT "))da_work_data_p.check2_s="";//SQL文は使用禁止の処置
            if(0!=w_at_n.i)da_work_data_p.section1_s=da_work_data_p.check_s=da_work_data_p.check2_s=""; //別名に@有りは命令等を無視。(CHECK='SECTION_1',='CHECK',='CHECK2')
           }
//HP  delete ww_s_n;delete ww2_s_n;delete ww3_s_n;delete ww_type_c_n;
      if(9==sw_dictionary){da_work_data_p.check_s=da_work_data_p.check2_s=da_work_data_p.section1_s="";}
      if(z_p.e2s_b(cmd_s,"WORK"))sw_data=sw_data_save; //”WORK"の場合sw_dataを戻す。
     }//if(TITLE_13>=sw)
   if(NEXT_14>=sw)program_cnt+=3; //(14>=)//次のプログラム位置に移動。
   if(NEXT_COPY_15>=sw) //(15>=)
     {if(z_p.count_i_i(i_copy_end_a)>0)//コピー中
         if(z_p.at_i(i_copy_end_a,z_p.count_i_i(i_copy_end_a)-1)<=program_cnt)//コピー最終位置に到着(VER8.3で" == "を" <= "に変更）
           {//ETC COPY 終了
            program_cnt=z_p.at_i(i_copy_save_a,z_p.count_i_i(i_copy_save_a)-1);//１個前のコピー情報設定
            z_p.remove_i_v(i_copy_end_a ,z_p.count_i_i(i_copy_end_a )-1);
            z_p.remove_i_v(i_copy_save_a,z_p.count_i_i(i_copy_save_a)-1);//コピー完了消しこみ。
            sw=NEXT_COPY_15;continue;
           }
      sw=LOOP_1;continue;
     }//if(NEXT_COPY_15>=sw)
   if(NEXT_REPEAT_16>=sw) {repeat_cnt++; program_cnt=repeat_start; sw=LOOP_1;continue;} //(16>=)//プログラム位置REPEAT開始位置に変更。 
   if(NEXT_REPEAT0_17>=sw){repeat0_cnt++;program_cnt=repeat0_start;sw=LOOP_1;continue;}//(17>=)//プログラム位置REPEAT0開始位置に変更。 
   if(NEXT_REPEAT2_18>=sw){repeat2_cnt++;program_cnt=repeat2_start;sw=LOOP_1;continue;} //(18>=)//プログラム位置REPEAT2開始位置に変更。
      //=***********************************************
   if(FIN_19>=sw) //(19>=)
     {if(repeat2_cnt<repeat2_max){sw=NEXT_REPEAT2_18;continue;}
      if(repeat_cnt <repeat_max) {sw=NEXT_REPEAT_16; continue;}
      if(repeat0_cnt<repeat0_max){sw=NEXT_REPEAT0_17;continue;}
#if IMENU
      if(z_p.e2s_b(z_p.main_program_s,"ITIME"))return true;//時間処理は戻る。
      if(program_no<z_p.count_pr_i(z_mt_p.program_list_n.pr_a)) //該当program=無しなので戻る
        {z_p.sw_program=z_p.count_pr_i(z_mt_p.program_list_n.pr_a)-1;
         return true;
        }
      //=****( set=$...のSET{};を先頭に配置する。 )*****
      i=0;
      //=*************************
      //-*****( set 解析 )*********
      //=*************************
      for(i=1;i<z_p.count_da_i(da_set_a);i++)
        {da_work_data_p=z_p.at_da(da_set_a,i);    //作業エリアda_work_data_pに現在処理対象を設定
         if('K'==da_work_data_p.mark1_c&&'O'!=da_work_data_p.mark2_c)sw_set_key_input_b=true; //SET=にキーデータ入力有りを設定。
         if('K'==da_work_data_p.mark1_c)s1_s="+";else s1_s="*"; //タイトル表示文字(1)キーは'+'以外は'*'を設定。
         if(z_p.e5c_b(da_work_data_p.mark2_c,' ','!','/','#'))//タイトル表示文字(2)入力は'#'以外は'+'を設定。
           {sw_set_input_b=true;  //SET=に入力有りを設定。
            s2_s="#";
            if(0==set_start)set_input_start=i;
            set_start=1;
           }
         else if('N'==da_work_data_p.mark2_c)
                {if(0==da_work_data_p.length0)da_work_data_p.length0=80;continue;} //'N'==mark2_c（非表示）は処理せず
         else s2_s="=";
         ii_zz_l ww_s_n=new ii_zz_l();
         z_mt_p.edit_b(ww_s_n,da_work_data_p.title_s);da_work_data_p.title_s=ww_s_n.s;//SET=のタイトルを編集。
//HP     delete ww_s_n;
         w1_s=da_work_data_p.title_s+(0!=CONTROL_IX[C_TITLE_32]?"":s1_s+s2_s); //SET=の表示文字を組立て。//VER37.8.0.17
         length=z_p.form_length(w1_s); //SET=の画面表示文字長を設定。
         if(z_p.e3s_b(da_work_data_p.type1_s,"+","-"))//数値の時はZERO表示に変更。
           {if     (' '==da_work_data_p.type2_c)da_work_data_p.type2_c='Z';
            else if('C'==da_work_data_p.type2_c)da_work_data_p.type2_c='E';
           } 
        if(0==da_work_data_p.length0)  //長さZEROは１行に表示出来る長さに変更。
           {j=80-(set_column+length);
            if(1>j)j=79-length;
            da_work_data_p.length0=j;
            da_work_data_p.length1=j;
           }
         if(-1==click_set_top)click_set_top=set_line;
         if(80<(set_column+length+(81>(length+da_work_data_p.length0)?da_work_data_p.length0:0)))
           {set_line++;set_column=1;}//タイトル表示位置決定
         display_v(w1_s,set_line,set_column,length,'N');   //SET=のタイトルを表示
         set_column+=length;//タイトル表示分移動
         if(80<(set_column+da_work_data_p.length0)){set_line++;set_column=1;} //データ表示位置決定
         if(13<set_line){z_p.err_s="over (display 10 line SET=)";sw=ERR_21;break;}//SET=表示行オーバーはエラー
         da_work_data_p.line=set_line;da_work_data_p.column=set_column+(1==set_column?0:1);//set=データ表示位置決定。
         set_column+=da_work_data_p.length0; //データ表示分移動
         set_column+=1+da_work_data_p.filler;//Filler分右へ移動。
         click_set_bottom=set_line;
        }
      if(-1==click_set_top)click_set_top=click_set_bottom=2;
      if(-1!=data_input_end_cnt)if(' '==(z_p.at_da(da_data_a,data_input_end_cnt)).mark2_c)
          (z_p.at_da(da_data_a,data_input_end_cnt)).mark2_c='/';  //最後のデータEnter以外NG化
      //////(追加テスト中)･･･
      if(-1!=set_input_end_cnt)if(' '==(z_p.at_da(da_set_a,set_input_end_cnt)).mark2_c)
          (z_p.at_da(da_set_a,set_input_end_cnt)).mark2_c='#';  //最後のデータEnter以外NG化
      //=**********************************************
      //=************( FROM の構成処理 )***************
      //=**********************************************
      bool sw_first_form_b=true;int hosei=0;
      if(z_p.e2s_b(program_s,"INPUT"))hosei=13;//"INPUT"の場合13
      else if(z_p.e2s_b(program_s,"OUTPUT")&&1==CONTROL_IX[C_0])hosei=2;//”OUTPUT”でCONTROL=0有りは２
      for(k=j=i=0;i<z_p.count_s_i(s_form_a);i++)
        {int start_form=1,len;start=0;
         String ss=z_p.replace_c_s(z_p.at_s(s_form_a,i),'\t',' ');w_s="";
         for(start=end=0;start<z_p.length(ss);start=j) //@の連続を\t+(char)数に置き換え。
           {if(-1==(end=z_p.index3c_i(ss,'@',start))){w_s+=z_p.substring2_s(ss,start);break;}
            for(j=end;j<z_p.length(ss);j++){if('@'!=z_p.at_s_c(ss,j))break;}
            w_s+=z_p.substring3_s(ss,start,end-start)+'\t'+(char )(j-end);
           }
         ii_zz_l ww_s_n=new ii_zz_l();
         z_mt_p.edit_b(ww_s_n,w_s);w_s=ww_s_n.s;
//HP     delete ww_s_n;
         for(start=end=0;start<z_p.length(w_s);)//ＦＯＲＭを構成
           {if(-1==(end=z_p.index3c_i(w_s,'\t',start)))end=z_p.length(w_s); //\t発見せず(元は@マークの有った位置）
            else      
            //=****( \t発見(元は@マークの有った位置）)*****************
              {if(-1==form_occurs_start)form_occurs_start=i;//FORM0=なしで最初の＠有りの位置を繰り返しの最初とする。
               if(sw_first_form_b)//最初に見つけたデータカラム位置補正指定
                 {sw_first_form_b=false;//補正完了。
                  if(0<hosei)
                    {(z_p.at_da(da_data_a,0)).line=i; //_STARTライン修正
                     for(int ii=0;ii<z_p.length(w_s);ii++)
                       {if(' '==z_p.at_s_c(w_s,ii))continue;//空白分カウントアップ
                        if(ii<hosei){ii=hosei-ii;w_s=z_p.pad_end_s("",ii,' ')+w_s;end+=ii;}//空白補正。
                        break;
                       }
                     hosei=0;//補正終了。
                    }
                 }
              }
            for(;z_p.length(w_s)>start&&' '==z_p.at_s_c(w_s,start);){start++;start_form++;}//先頭空白無視
            if(start<end)//表示情報記憶
              {ii_data_l ww_data_n=new ii_data_l(z_p);
               ww_data_n.data_s=z_p.substring3_s(w_s,start,end-start);
               ww_data_n.line=i;ww_data_n.column=start_form;
               if(0<end&&' '!=z_p.at_s_c(w_s,end-1))start_form++;//区切り部分空白でない時は空白追加。
               start_form+=z_p.form_length(ww_data_n.data_s);//表示文字分加算。
               ww_data_n.data_s=z_p.trim_end_s(ww_data_n.data_s);
               ww_data_n.length0=z_p.form_length(ww_data_n.data_s);
               ww_data_n.length1=z_p.form_length(ww_data_n.data_s);
               ww_data_n.org_color_v("N"); 
               if(0<ww_data_n.length0)z_p.add_da(da_form_data_a,new ii_data_l(ww_data_n));//da_form_data_aに記憶。 
               if(form_x_max<start_form)form_width_v(start_form);//右端修正//右端オーバー
//HP           delete ww_data_n;
              }
            if(end==z_p.length(w_s))break;
            for(k++;k<z_p.count_da_i(da_data_a)&&'N'==z_p.at_da(da_data_a,k).mark2_c;){k++;}//該当DATA位置を移動(k)
            if(k>=z_p.count_da_i(da_data_a))break;
            if(0==z_p.at_da(da_data_a,k).line)z_p.at_da(da_data_a,k).line=i;
            if(0==z_p.at_da(da_data_a,k).column)z_p.at_da(da_data_a,k).column=start_form;
            len=z_p.to_c_i(z_p.at_s_c(w_s,end+1));//データ長設定
            if(0==z_p.at_da(da_data_a,k).length0)//DATA=のデーター長０の場合formの長さを採用
              {z_p.at_da(da_data_a,k).length0=len;
               z_p.at_da(da_data_a,k).length1=z_p.at_da(da_data_a,k).length0;
               if(z_p.e3c_b(z_p.at_s_c(z_p.at_da(da_data_a,k).type1_s,0),'+','-'))//数値の場合有効桁数計算
                 {int cnt=0;
                  if('-'==z_p.at_s_c(z_p.at_da(da_data_a,k).type1_s,0))cnt++;//符号表示位置加算。
                  if(0<z_p.at_da(da_data_a,k).length2)cnt++;//小数点表示位置加算。
                  if(!z_p.e3c_b(z_p.at_da(da_data_a,k).type2_c,'C','E'))//カンマ表示位置分加算。
                     cnt+=((z_p.at_da(da_data_a,k).length1-cnt-z_p.at_da(da_data_a,k).length2))/4;  
                  z_p.at_da(da_data_a,k).length1=z_p.at_da(da_data_a,k).length1-cnt;
                 } 
              }
            start=end+2;  //\t+(int )数値の２桁移動
            start_form+=z_p.at_da(da_data_a,k).length0;  //DATAの長さ分加算
            if(len>z_p.at_da(da_data_a,k).length0)start_form+=len-z_p.at_da(da_data_a,k).length0;//FROM長＞DATA長の場合差分を空白化。
            else
              {for(j=(z_p.at_da(da_data_a,k).length0-len);0<j&&start<z_p.length(w_s);j--,start++)//空白分はDATAに置き換える。
                  {if(' '!=z_p.at_s_c(w_s,start))break;} 
               if(start<z_p.length(w_s)&&' '!=z_p.at_s_c(w_s,start))start_form++;//区切り部分空白でない時は空白追加。
              } 
            if(form_x_max<start_form)form_width_v(start_form);//右端修正。
           }
        }
      if(0!=z_p.count_s_i(s_form_a))//FORM?=有りの場合
         for(k++;k<z_p.count_da_i(da_data_a);k++)//formの位置未確定分は次の行の先頭を指定。
            if('N'!=z_p.at_da(da_data_a,k).mark2_c)//'N'は表示不要なので’N'以外対象とする。
              {if(sw_first_form_b)//補正必要
                 {sw_first_form_b=false;//補正完了。
                  (z_p.at_da(da_data_a,0)).line=i; //_STARTライン修正
                  if(-1==form_occurs_start)
                     form_occurs_start=i;//FORM0=なしで＠無しは追加の最初が繰り返しの最初とする。
                 } 
               if(0==z_p.at_da(da_data_a,k).line)z_p.at_da(da_data_a,k).line=i;//データの行位置変更
               if(0==z_p.at_da(da_data_a,k).column)z_p.at_da(da_data_a,k).column=hosei+1;//データの列位置変更
               hosei=0;//補正は終了
               z_p.add_s(s_form_a,"");//z_p.count_s_i(s_form_a)を加算のため。
               i++;//行を１加算
              } 
      if(0==z_p.count_s_i(s_form_a)){z_mt_p.format_n.format();}//FORM?=無しは画面を自動構成
      //=******( FORM?=有りはFORMにより画面構成 )**********************************
      else   
      if('M'==z_mt_p.program_c||z_p.e2s_b(program_s,"NOT"))//”NOT"の画面構成
        {scroll_y_line_top=4;
         for(i=0;z_p.count_da_i(da_form_data_a)>i;i++)
            {display_v(1,z_p.at_da(da_form_data_a,i),line_offset+line_start-1,column_offset);}
         line_max=line_start+z_p.count_s_i(s_form_a)-1;
         if(line_max>form_y_max)form_high_v(line_max);//通常画面サイズにに入りきらない場合の対応
         else if(0==CONTROL_IX[C_HIGH_23]){form_y_max=line_max;sw_resize_b=true;}//FORM?=分に縦幅を圧縮。
         for(i=data_start;z_p.count_da_i(da_data_a)>i;i++)
            {display_v(1,z_p.at_da(da_data_a,i),line_offset+line_start-1,column_offset);}
        }
      else //"INPUT","OUTPUT"の画面構成
        {sw_y_scroll=2;sw_resize_b=true;y_largechange=0;y_maximum=0;
         if(-1==line_start){line_offset=1;line_start=3;}
         else
           {line_offset=z_p.count_s_i(s_form_a)-form_occurs_start;
            if(4>click_set_bottom){line_start=5;}//最低でも５行目から開始。
            else {line_start=click_set_bottom+2;}//通常はSETの最後から２つ下。
            click_data_top=line_start-1;//クリックトップ位置設定。
            if(0!=line_offset&&!z_p.e2s_b(program_s,"NOT"))//FORM有りで繰り返し数決定
             {line_occurs=
               ((0==CONTROL_IX[C_HIGH_23]?z_mt_p.form_y_desktop:form_y_max)-click_data_top-1-form_occurs_start)
                /line_offset;//繰り返し数計算決定
              if(0!=line_default&&line_occurs>line_default)line_occurs=line_default;//LINE=で繰り返し数変更
             }      
            if(0<form_occurs_start)form_display_v(0,form_occurs_start-1,line_start);//繰り返し無し部分表示
            if(0==line_occurs)line_occurs=1;//繰り返し無しは１回。
            for(k=line_start,i=0;i<line_occurs;i++)
              {form_display_v(form_occurs_start,z_p.count_s_i(s_form_a),k);//繰り返し部分表示
               k+=line_offset;
              }
            w_s_n.s=z_p.pad_end_s("",z_p.X_MAX,'=');//" ==========================="を表示。
            paint_list_n.add_v(w_s_n.s,click_data_top,1,z_p.X_MAX,z_p.font_s,z_p.Font_n
                               ,z_p.Brush_nx[z_mt_p.BACKCOLOR]);//データ行の上表示
            k+=form_occurs_start;//form_occurs_start分追加
            form_y_max=k+1;click_data_bottom=k;
            paint_list_n.add_v(w_s_n.s,click_data_bottom,1,z_p.X_MAX,z_p.font_s,z_p.Font_n
                               ,z_p.Brush_nx[z_mt_p.BACKCOLOR]);//データ行の下表示
            column_occurs=1; 
           }
        }
      //=**********************************************
      if(!form_data_b(0)){return false;}
      for(m=1;z_p.count_da_i(da_set_a)>m;m++)
        {da_work_data_p=z_p.at_da(da_set_a,m);
         if('N'!=da_work_data_p.mark2_c&&0!=da_work_data_p.length0)
           {paint_list_n.add_v("",da_work_data_p.line,da_work_data_p.column,da_work_data_p.length0
            ,da_work_data_p.font_s,da_work_data_p.Font_n,da_work_data_p.org_Brush_n);
           }
        }
      form_max=line_occurs*column_occurs;
      record_down_limit=record_limit=0;
      z_p.clear_s_v(s_sql0_a);
      if(z_p.e2s_b(program_s,"INPUT"))
        {(z_p.at_da(da_data_a,0)).column=12;
         z_p.clear_i_v(i_msg_a);
         record_limit=form_max;
         if(0==CONTROL_IX[C_2]&&0==CONTROL_IX[C_MAX_9])record_down_limit=record_limit;
         sql_column_cnt_ix[0]=z_p.count_da_i(da_data_a);cancel=z_p.count_da_i(da_data_a);//VER23.1 
         line_cnt=1;record_cnt=1;record_start_cnt=1;column_cnt=1;page_now=1;line_now=1;//VER23.1
         for(i=0;(form_max+1)>i;i++)
           {z_p.add_i(i_msg_a,-1);
            for(j=0;(z_p.count_da_i(da_data_a)+1)*3>j;j++){z_p.add_s(s_sql0_a,"");} //VER23.1
           }
        }
      else (z_p.at_da(da_data_a,0)).column=1;
      (z_p.at_da(da_data_a,0)).length0=1;
      (z_p.at_da(da_data_a,0)).length1=1;
      (z_p.at_da(da_data_a,0)).title_s="_START";
      //縦方向に実際にスクロールさせる。("INPUT","OUTPUT"はスクロールしないでデータを入れ替える,"NOT"のみ発生）
      if(1==sw_y_scroll)
        {sw_resize_b=true;
         scroll_y_line_top=4;
         if(0==CONTROL_IX[C_HIGH_23])form_y_max=z_mt_p.form_y_desktop;
         y_largechange=form_max=form_y_max-scroll_y_line_top+1;//１回のスクロール数決定
         y_maximum=line_max-scroll_y_line_top+1;//最大スクロール数初期値セット。
         //１回スクロールの倍数に変更
         y_maximum=(y_maximum/y_largechange+(0==(y_maximum%y_largechange)?0:1))*y_largechange-1;
         scroll_cnt_start=0;scroll_cnt_max=line_max-form_y_max; 
        }//縦スクロール初期値設定
      if(sw_resize_b)z_mt_p.menu_p.resize_v(1);
      z_mt_p.title_bar_v();
      if(z_p.e2s_b(z_p.test_s,"TEST")){display_v("****[ TEST ]****",1,1,16,'R');z_p.head_c='R';}//テスト中赤表示
      else {display_v(z_p.person_name_s,1,1,16,'N');z_p.head_c='N';};//本番中は名前表示。
      display_v(('M'==z_mt_p.program_c?"["+z_p.title_s+"]":"("+z_p.job_name_s+")"),1,28,32,z_p.head_c);
      if(!z_p.e2s_b(z_p.menu_security_s,"X")&&'M'!=z_mt_p.program_c&&'F'!=z_mt_p.program_c&&1==program_no)
        {if(z_p.e2s_b(z_mt_p.pass_date_s,"")
         ||!z_p.e2s_b(z_mt_p.pass_date_s,z_p.substring3_s(z_p.date_time_s(z_p.date_time_now_s(),0),0,8)))
            z_p.person_security_s=""; //１日でセキュリティ解除
         if(!z_p.e2s_b(z_p.menu_security_s,"A")&&!z_p.e2s_b(z_p.person_security_s,"")) //チェック入力迂回
            if(password_b(1)){sw=OK_20;continue;} //(使用者判定抜きでセキュリティチェック）
         line=column=0;
         display_v(z_p.at_s(z_p.s_lang_a,z_mt_p.txt_person),2,4,z_mt_p.txt_person_cnt,'N'); //使用者表示
         display_v(z_p.at_s(z_p.s_lang_a,z_mt_p.txt_password),2,14+z_mt_p.txt_person_cnt,z_mt_p.txt_password_cnt,'N'); //パスワード表示
         display_v("("+z_p.menu_security_s+(z_p.e2s_b(z_p.menu_permission_s,"ZZZZ")?"":","+z_p.menu_permission_s)+")",2,58,8,'N'); //パスワードチェック詳細表示
         da_now_ap=z_p.da_security_a;now_kind_s="PASSWORD"; 
         da_now_p=z_p.at_da(z_p.da_security_a,PASSWORD_1);da_now_p.data_s="";
         display_v(2);
         now_cnt=PERSON_0;
         da_now_p=z_p.at_da(da_now_ap,now_cnt);da_now_p.data_s=z_p.person_s;
         display_v(2);
         main_v(Keys.None,false,0);
         return true; 
        }
     }//if(FIN_19>=sw)
  if(OK_20>=sw)
     {begin2_v();
#endif //MENU
      return true;
     }//if(OK_20>=sw)
   if(ERR_21<=sw)break; //ERR_21 以上はエラー
  }//for(;;)
if     (ERR_NAME_22==sw)z_p.err_s="bad name \""+w_s_n.s+"\"";
else if(ERR_TYPE1_23==sw)z_p.err_s="bad type1 \""+z_p.trim_s(sx[2])+"\"";
else if(ERR_TYPE2_24==sw)z_p.err_s="bad type2 \""+z_p.trim_s(sx[3])+"\"";
else if(ERR_MARK_25==sw)z_p.err_s="bad mark \""+z_p.to_c_s(z_p.at_s_c(sx[0],i))+"\"";
else if(ERR_FILLER_26==sw)z_p.err_s="not numeric or < 1 filler \""+z_p.trim_s(sx[1])+"\"";
if(ERR_21<=sw) //ERR_21 以上はエラー
  {if(z_p.e2s_b(no_s,""))z_p.err2_s="";
   else
     {i=z_p.to_int1s_i(no_s);if(0==i)i=9;
      z_p.err2_s=(z_p.count_s_i(z_p.s_program_name_a)>i?z_p.at_s(z_p.s_program_name_a,i):"")//VER14.1
      +" ["+z_p.pad_start_s(seq_s,6,'0')+"] "+z_p.prog_s_n.s;
     }
    z_p.err3_s="";
    z_mt_p.sw_err=z_p.SW_ABORT_9;
    return false;
  }//if(ERR_21<=sw)
return false;
}
bool set_table_b()
{
if(z_p.e2s_b(table_alias_s,""))table_alias_s="X1";//VER18.1
z_p.add_s(s_join_alias_my_a,table_alias_s); 
z_p.add_s(s_join_alias_other_a,""); 
z_p.add_s(s_join_a,"FROM "+table_s+" "+table_alias_s); 
z_p.add_s(s_keep_alias_a,table_alias_s); //別名キープ
z_p.add_s(s_keep_table_a,table_s);      //テーブル名キープ
if(0!=z_mt_p.sql_n.set_table_da_i(da_table_a,"&"+table_alias_s,z_mt_p.edit_s(table_s),z_p.inp_out_s,0))return false;
if(z_p.e2s_b(z_mt_p.sql_n.z_value_sx[0],"0"))//Z_CANCEL 無。
   z_mt_p.set_name_data_b(z_p.da_sw_a,"Z_CANCEL_WHERE","-");//%Z_CANCEL_WHEREの初期値'-'設定。 
return true;
}
#if IMENU
//----------------------------------------------
//=*******( 画面の立幅修正 )*****
void form_high_v(int i_ii)
{if(0==CONTROL_IX[C_HIGH_23])//"HIGH"指定無し
   {if(z_mt_p.form_y_desktop<i_ii){form_y_max=z_mt_p.form_y_desktop;sw_resize_b=true;}
    else {form_y_max=i_ii;sw_resize_b=true;return;}         
   }
sw_y_scroll=1;
} 
//----------------------------------------------
//=*******( 画面の右幅修正 )**********
void form_width_v(int i_ii)
{if(0==CONTROL_IX[C_WIDTH_22])//"WIDTH"指定無し
   {if(z_mt_p.form_x_desktop<i_ii){form_x_max=z_mt_p.form_x_desktop;sw_resize_b=true;}
    else {form_x_max=i_ii;sw_resize_b=true;return;}         
   }
sw_x_scroll=1;form_right_max=i_ii;
} 
//----------------------------------------------
//=*******( FORM?=による表示 )**************
void form_display_v(int begin_ii,int end_ii,int line_ii)
{for(i=0;z_p.count_da_i(da_form_data_a)>i;i++)
   if((z_p.at_da(da_form_data_a,i)).line>=begin_ii&&(z_p.at_da(da_form_data_a,i)).line<=end_ii)
        {display_v((z_p.at_da(da_form_data_a,i)).data_s,line_ii+(z_p.at_da(da_form_data_a,i)).line
                   ,(z_p.at_da(da_form_data_a,i)).column,z_p.form_length((z_p.at_da(da_form_data_a,i)).data_s),'N');
        }
}
//=*******************************************************************************************************
//=*******************************************************************************************************
public void begin2_v()
{z_p.t_v(z_p.PR,"begin2_v(");
line=begin_line;
if(0!=section("BEGIN",BEGIN_0)){z_mt_p.sw_err=z_p.SW_ABORT_9;return;}
if(-2==z_p.sw_program)return;//EXIT{+1};は終了。
if(0<=z_p.sw_program&&z_p.sw_program!=z_p.count_pr_i(z_mt_p.program_list_n.pr_a))return;
if('M'==z_mt_p.program_c||z_p.e2s_b(program_s,"NOT")){begin_data_v();data_save_v("DATA");}
else {if(0==set_start)display_v(0,z_p.at_da(da_set_a,0),"SET");
      begin_set_b(1);
     }
main_v((0!=CONTROL_IX[C_BEGIN_ENTER_4]
       ||(!z_p.e2s_b(program_s,"NOT")&&1!=z_p.count_pr_i(z_mt_p.program_list_n.pr_a)&&-1==set_input_end_cnt)
       ?Keys.Enter:Keys.None),false,0);
return;
}
//----------------------------------------------
void begin_data_v()
{now_kind_s="DATA";now_cnt=data_start;keyboard_start_cnt=-1;
da_now_ap=da_data_a;
line=line_offset+(0<line_start?line_start-1:0);
column=column_offset;
} 
//----------------------------------------------
void begin_set_b(int start_ii)
{now_kind_s="SET";now_cnt=start_ii;keyboard_start_cnt=-1;
da_now_ap=da_set_a;
keyboard_cnt=set_input_start;
line=column=0;
data_save_v("SET");
}
//----------------------------------------------
//=******( UPDATE文組み立て )******
String update_s(String s_si)
{String w_s="";
if(!z_p.e2s_b(s_si,"CANCEL"))w_s=sql_data_all_s(",",' ',1,s_si);
if(z_p.e2s_b(s_si,"CHANGE")&&z_p.e2s_b(w_s,"")){sw_msg=z_mt_p.txt_ng_same;return "";}
return "UPDATE "+table_edit_s+" SET "
   +(z_p.e2s_b(s_si,"CANCEL")?"":w_s+program_name_data_sep_s)
   +z_mt_p.z_update_s(s_si,"","")+" WHERE "+sql_data_all_s(" AND ",'K',1,""); 
}
//----------------------------------------------
//=****( 修正処理 )*****
int program_change(int sw_ii)
{int i,j,rc=0;
if(z_p.e2s_b(program_s,"INPUT")&&0==sw_ii)
   for(i=1,j=1;i<z_p.count_da_i(da_data_a);i++)
      if(' '==(z_p.at_da(da_data_a,i)).mark1_c)
        if(!(z_p.at_da(da_data_a,i)).compare_save_b(z_p.at_s(z_mt_p.sql_n.s_sql_a,j++)))
          {sw_msg=z_mt_p.txt_ng_data;return 1;}
sw_msg=-1;
String w_s=update_s("CHANGE");
if(-1!=sw_msg){if(0==sw_ii)return 1;}
else rc=z_mt_p.sql_n.sql_usr2(w_s,z_p.inp_out_s); 
if(0==rc)sw_msg=z_mt_p.txt_ok_3;else sw_msg=z_mt_p.txt_ng_xxxx;
return rc;
}
//----------------------------------------------
//=****( 削除処理 )*****
int program_cancel()
{int rc=z_mt_p.sql_n.sql_usr2(update_s("CANCEL"),z_p.inp_out_s); 
if(0==rc)sw_msg=z_mt_p.txt_ok_1;else sw_msg=z_mt_p.txt_ng_xxxx;
return rc;
}
//----------------------------------------------
//=****( 作成処理 )*****
int program_add_v()
{int rc;String w_s;
if(0==z_p.db_record_cnt)w_s="INSERT INTO "+table_edit_s+"("+program_name_key_s+program_name_data_sep_s
   +program_name_data_s+","+z_mt_p.z_insert_name_s()+")VALUES("+sql_data_all_s(",",'K',0,"")
   +program_name_data_sep_s+sql_data_all_s(",",' ',0,"")+","+z_mt_p.z_insert_value_s()+")";
else w_s=update_s("ADD");
rc=z_mt_p.sql_n.sql_usr2(w_s,z_p.inp_out_s);
if(0==rc)sw_msg=z_mt_p.txt_ok_2;else sw_msg=z_mt_p.txt_ng_xxxx;
return rc;
}
//----------------------------------------------
//=****( 更新（作成、修正、削除)処理 sw_ii(0=エラー有効,1=エラー無効 )*****
readonly int MODORI_STOP_BEFORE_1=1,STOP_BEFORE_SKIP_2=2,STOP=3,MODORI_STOP_AFTER_4=4,STOP_AFTER_SKIP=5,ERR_MSG_6=6,ERR_7=7;
int program_i(int sw_ii,String real_test_si)
{int rc;String start_s=(z_p.at_da(da_data_a,0)).data_s;
z_p.err_s="";
z_p.real_test_s=real_test_si;

int sw=0;// 全て実行。
if(modori_prog>0)//EXIT{+1};戻り処理。
  {if(z_p.starts_with_b(modori_now_kind_s,"STOP_BEFORE"))sw=MODORI_STOP_BEFORE_1;
   else sw=MODORI_STOP_AFTER_4;
  }
if(0==sw)
  {if(z_p.e2s_b((z_p.at_da(da_etc_a,STOP_BEFORE_1)).section1_s,"")&&z_p.e2s_b((z_p.at_da(da_etc_a,STOP_BEFORE_1)).section2_s,""))sw=STOP_BEFORE_SKIP_2;
   else if(0!=z_mt_p.sql_n.sql_usr2("BEGIN TRANSACTION",z_p.inp_out_s))sw=ERR_7;
        else sw_tran=1;
  }
if(MODORI_STOP_BEFORE_1>=sw)
  {if(0!=section("STOP_BEFORE",STOP_BEFORE_1)){sw_msg=z_mt_p.txt_ng_xxxx;sw=ERR_7;}
   else if(-2==z_p.sw_program)return(0);//EXIT{+1};は終了。
        else z_p.real_test_s=real_test_si;//section()で初期化されるため再設定
  }
if(STOP_BEFORE_SKIP_2>=sw)
  {for(;;)
     {if(z_p.e2s_b(table_s,"")||z_p.e2s_b(program_name_key_s,"")||0!=CONTROL_IX[C_PROGRAM_10]){sw=STOP;break;}
      if(0!=CONTROL_IX[C_1_PROGRAM_26]&&z_p.e2s_b(start_s,"1")){sw=STOP;break;}//削除処理迂回。
      if(0!=CONTROL_IX[C_2_PROGRAM_27]&&z_p.e2s_b(start_s,"2")){sw=STOP;break;}//作成処理迂回。
      if(0!=CONTROL_IX[C_3_PROGRAM_28]&&z_p.e2s_b(start_s,"3")){sw=STOP;break;}//修正処理迂回。
      if(z_p.e4s_b(start_s,"3","2","1"))z_mt_p.trace_v(0,"*==(PROGRAM("+start_s+")["+z_p.real_test_s+"])==*");
      if(0==sw_tran)if(0!=z_mt_p.sql_n.sql_usr2("BEGIN TRANSACTION",z_p.inp_out_s)){sw=ERR_7;break;}
      sw_tran=1;
      if(0!=z_mt_p.sql_n.sql_usr2(get_sql_select_s("Z_CANCEL"
          +(!z_p.e2s_b(start_s,"3")||z_p.e2s_b(program_name_data_s,"")?"":","+program_name_data_s),1),z_p.inp_out_s))if(0==sw_ii){sw=ERR_7;break;}
      if(z_p.e2s_b(start_s,"2"))
        {if(0!=z_p.db_record_cnt&&0<z_p.count_s_i(z_mt_p.sql_n.s_sql_a)&&z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_sql_a,0),""))
            if(0==sw_ii){sw_msg=z_mt_p.txt_ng_find;sw=ERR_MSG_6;break;}
        }
      else
        {if(z_p.e3i_b(0,z_p.db_record_cnt,z_p.count_s_i(z_mt_p.sql_n.s_sql_a)))
           {if(0==sw_ii){sw_msg=z_mt_p.txt_ng_none;sw=ERR_MSG_6;break;}
            else if(z_p.e2s_b(start_s,"1")){sw=STOP;break;}
            else if(z_p.e2s_b(start_s,"3"))start_s="2";else start_s=""; 
           }
         else
         if(!z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_sql_a,0),""))
           {if(0==sw_ii){sw_msg=z_mt_p.txt_ng_1;sw=ERR_MSG_6;break;}
            else if(z_p.e2s_b(start_s,"1")){sw=STOP;break;}
            else if(z_p.e2s_b(start_s,"3"))start_s="2";else start_s="";
           }
        }
      if     (z_p.e2s_b(start_s,"3"))rc=program_change(sw_ii); //修正処理
      else if(z_p.e2s_b(start_s,"1"))rc=program_cancel();      //削除処理
      else if(z_p.e2s_b(start_s,"2"))rc=program_add_v();       //作成処理
      else rc=0;
      if(0!=rc){sw=ERR_MSG_6;break;}
      break;
     }//for(;;)
  }
if(STOP>=sw)
  {if     (z_p.e2s_b((z_p.at_da(da_data_a,0)).data_s,"2"))sw_msg=z_mt_p.txt_ok_2;
   else if(z_p.e2s_b((z_p.at_da(da_data_a,0)).data_s,"3"))sw_msg=z_mt_p.txt_ok_3;
   else if(z_p.e2s_b((z_p.at_da(da_data_a,0)).data_s,"1"))sw_msg=z_mt_p.txt_ok_1;
   else if(z_p.e2s_b((z_p.at_da(da_data_a,0)).data_s,"0"))sw_msg=z_mt_p.txt_ok_0;
   if(z_p.e2s_b((z_p.at_da(da_etc_a,STOP_AFTER_2)).section1_s,"")&&
      z_p.e2s_b((z_p.at_da(da_etc_a,STOP_AFTER_2)).section2_s,""))sw=STOP_AFTER_SKIP;//STOP_AFTER Section 空白。
   else if(0==sw_tran&&0!=z_mt_p.sql_n.sql_usr2("BEGIN TRANSACTION",z_p.inp_out_s))sw=ERR_7;
        else sw_tran=1;
  }
if(MODORI_STOP_AFTER_4>=0)
  {if(0!=section("STOP_AFTER",STOP_AFTER_2)){sw_msg=z_mt_p.txt_ng_xxxx;sw=ERR_7;}
   else if(-2==z_p.sw_program)return(0);//EXIT{+1};は終了。
         else z_p.real_test_s=real_test_si;//section()で初期化されるため再設定
  }
if(STOP_AFTER_SKIP>=sw)
  {if(1==sw_tran){z_mt_p.sql_n.sql_usr2("COMMIT TRANSACTION",z_p.inp_out_s);sw_tran=0;}
   data_to_sql0_v();
   return 0;
  } 
if(ERR_MSG_6>=sw)if(z_p.e2s_b(z_p.err_s,""))z_p.err_s=z_p.substring2_s((z_p.at_s(z_p.s_lang_a,sw_msg)),1);
if(1==sw_tran){z_mt_p.sql_n.sql_usr2("ROLLBACK TRANSACTION",z_p.inp_out_s);sw_tran=0;}
data_to_sql0_v();
return 1;
}
//----------------------------------------------
void data_to_sql0_v()
{z_p.t_v(z_p.PR,"data_to_sql0_v(");
int i,j;
if(z_p.e2s_b(program_s,"INPUT"))
   for(j=(record_cnt-1)*sql_column_cnt_ix[0],i=1;sql_column_cnt_ix[0]>=i&&z_p.count_da_i(da_data_a)>i;i++,j++)
      z_p.set_s_v(s_sql0_a,j,(z_p.at_da(da_data_a,i)).data_s);
}
//----------------------------------------------
//=**** ( SQL=を実行する )*****
bool run_sql_b()
{z_p.t_v(z_p.PR,"run_sql_b(");
int i,j=0;
ii_zz_l ww_ss_n=new ii_zz_l();
String w_s="";where_and_s="WHERE";order_by_s="ORDER BY ";group_by_s="GROUP BY ";
z_p.sql_limit=sql_limit_org;sql_limit_org=0; 
z_p.err2_s="SQL=";z_p.err21_s=""; //VER18.1
z_mt_p.trace_v(0,"*=("+z_p.to1_i_s(z_p.count_pr_i(z_mt_p.program_list_n.pr_a))+",SQL=)=*");  //VER18.1
if(!z_mt_p.edit_b(ww_ss_n,sql_s)){z_mt_p.sw_err=z_p.SW_ERROR_5;return false;}//SQL文編集
//-*****(NewLineのみの行削除)****************。
int sw=0;//終了時１を設定用。
for(;;)
  { i=z_p.index3s_i(ww_ss_n.s,z_p.new_line_s(),j);
   if(-1!=i)
     {w_s+=z_p.substring3_s(ww_ss_n.s,j,i-j+z_p.length(z_p.new_line_s()));
      for(;z_p.starts_with_b(z_p.substring2_s(ww_ss_n.s,i),z_p.new_line_s());)
        {i+=z_p.length(z_p.new_line_s());
         if(i>=z_p.length(ww_ss_n.s)){sw=1;break;}//終了
        }
      if(1==sw)break;//終了 
      j=i;
      continue;
     }
   w_s+=z_p.substring2_s(ww_ss_n.s,j);
   break;
  }//for(;;)
//HP delete ww_ss_n;
//-*********************************************。
sql_cnt_ix[0]=0;
if(0==output_record_cnt) //output{}無 SQL発行
  {display_time_v();
   display_msg_v(z_p.at_s(z_p.s_lang_a,z_mt_p.txt_run));
   if(z_p.e2i_b(CONTROL_IX[C_RESTORE_DB_29],1)){z_mt_p.restore_db_s=restore_db_s;}
   if(0!=z_mt_p.sql_n.sql_sel(s_sql0_a,sel_s,sel_test_s,w_s)) //SQL=実行
     {if(0==CONTROL_IX[C_ERROR_SQL_6])z_mt_p.sw_err=z_p.SW_ABORT_9;else z_mt_p.sw_err=z_p.SW_ERROR_5;}
  } 
else //output{}有 
  {z_p.db_record_cnt=output_record_cnt;
   z_p.db_column_cnt=output_column_cnt;;
   z_p.db_affected_cnt=0;
   z_p.db_cancel=-1;
  }
display_msg_v("");
if(z_p.SW_OFF_0!=z_mt_p.sw_err)return false;
sql_record_cnt_ix[0]=z_p.db_record_cnt;
sql_column_cnt_ix[0]=z_p.db_column_cnt;
z_p.sql_count_123=z_p.db_affected_cnt;
page_now=1;line_now=1;
page_max=z_p.db_record_cnt/form_max;
z_p.clear_i_v(i_msg_a);z_p.add_i(i_msg_a,0);cancel=z_p.db_cancel;
record_start_cnt=record_cnt=1;
if(0!=z_p.db_record_cnt%form_max)page_max++;
record_down_limit=record_limit=record_max=z_p.db_record_cnt;
i=form_max-(record_max%form_max);
record_limit+=i;
line_cnt=column_cnt=1;
if(z_p.e2s_b(program_s,"INPUT")&&0==CONTROL_IX[C_2]&&0==CONTROL_IX[C_MAX_9])//作成可能行追加。
  {record_limit+=form_max;record_down_limit=record_limit;page_max++;
   if(1>i){record_limit++;page_max++;} 
   for(j=form_max*sql_column_cnt_ix[0]*3,i=0;j>i;i++)z_p.add_s(s_sql0_a,"");
  }
if(!form_data_b(1))return false; //データ表示
if(z_p.e2s_b(page_s,""))page_s="PAGE";
y_largechange=(2>page_max?1:form_max);
y_maximum=(1>page_max?1:page_max)*y_largechange-1;
z_mt_p.menu_p.y_scroll_n.set_max_large_v(y_maximum,y_largechange);
return true;
}
//----------------------------------------------
public void scroll_x_page_down_v(){scroll_x_check_b(scroll_x_offset+form_x_max+1);}
public void scroll_x_page_up_v()  {      scroll_x_v(scroll_x_offset-form_x_max-1);}
public void scroll_x_line_down_v(){scroll_x_check_b(scroll_x_offset+1);}
public void scroll_x_line_up_v()  {      scroll_x_v(scroll_x_offset-1);}
//----------------------------------------------
//=****( 画面の横方向にスクロールする )*****
public void scroll_x_check_b(int i_ii)
{z_p.t_v(z_p.PR,"scroll_x_check_b(");
if((scroll_x_offset+form_x_max+1)<=z_mt_p.menu_p.x_scroll_n.get_max())//余分に移動しないようにチェック。
  {int i=z_mt_p.menu_p.x_scroll_n.get_max()-form_x_max;//再補正。
    scroll_x_v((i_ii<i?i_ii:i));
  } 
}
//----------------------------------------------
public void scroll_x_v(int i_ii)
{z_p.t_v(z_p.PR,"scroll_x_v( sw_x_scroll="+z_p.to_i_s(sw_x_scroll)+"/"+z_p.to_i_s(i_ii));
if(0==sw_x_scroll)return;//スクロール不要は終了。
if(0>i_ii)i_ii=0;
      else if(z_mt_p.menu_p.x_scroll_n.get_max()<i_ii)i_ii=z_mt_p.menu_p.x_scroll_n.get_max(); 
if(i_ii!=scroll_x_offset)
  {z_mt_p.menu_p.x_scroll_n.set_value_v(scroll_x_offset=i_ii);//スクロール量指定
   paint_list_n.on_paint_v();//再表示
  }
}
//----------------------------------------------
public void scroll_y_page_down_v(int sw_ii){scroll_y_v(record_start_cnt+form_max,sw_ii);}
public void scroll_y_page_up_v(int sw_ii)  {scroll_y_v(record_start_cnt-form_max,sw_ii);}
public void scroll_y_line_down_v(int sw_ii){scroll_y_v(record_start_cnt+1,sw_ii);}
public void scroll_y_line_up_v(int sw_ii)  {scroll_y_v(record_start_cnt-1,sw_ii);}
//----------------------------------------------
//=****( 画面に縦方向にスクロールする )*****
//-***( sw_ii:0=START,1=SET,2=Bar )*****
public void scroll_y_v(int i_ii,int sw_ii)
{z_p.t_v(z_p.PR,"scroll_y_v(");
if(0==sw_y_scroll||0==z_mt_p.menu_p.y_scroll_n.get_max())return;//スクロール不要は終了。  
if(1>i_ii)i_ii=1;
int i=i_ii-1;
if(0>i)i=0;
else if(i>(z_mt_p.menu_p.y_scroll_n.get_max()-z_mt_p.menu_p.y_scroll_n.get_large()+1))
        i=z_mt_p.menu_p.y_scroll_n.get_max()-z_mt_p.menu_p.y_scroll_n.get_large()+1;
if(record_start_cnt==(i+1))return;
if(2==sw_ii&&z_p.e2s_b(now_kind_s,"START")){main_v(Keys.Left,false,1);}
record_start_cnt=i+1;
if(1==sw_y_scroll)
  {z_mt_p.menu_p.y_scroll_n.set_value_v(scroll_y_offset=i);
   z_mt_p.imenu_p.repaint_v();return;
  }//再表示
if(0!=sw_ii){record_cnt=record_start_cnt;line_cnt=column_cnt=1;}
sql_cnt_ix[0]=(record_start_cnt-1)*sql_column_cnt_ix[0];
if(1>=form_max)page_now=record_start_cnt;else page_now=record_start_cnt/form_max+1;
line_now=record_start_cnt-form_max*(page_now-1);
if(0!=sw_ii){record_cnt=record_start_cnt;line_cnt=column_cnt=1;}
sql_cnt_ix[0]=(record_start_cnt-1)*sql_column_cnt_ix[0];
if(1>=form_max)page_now=record_start_cnt;else page_now=record_start_cnt/form_max+1;
line_now=record_start_cnt-form_max*(page_now-1);
form_data_b(1);
display_page_v();
z_mt_p.menu_p.y_scroll_n.set_value_v(i);
//HP z_mt_p.menu_p.repaint_v();
}
//----------------------------------------------
//=****( formを画面に表示する )*****
public bool form_data_b(int sw_ii)
{z_p.t_v(z_p.PR,"form_data_b(");
int sw,i,k,m,n=sql_cnt_ix[0],o=form_max*(page_now-1)+line_now,can=-1;
String save_now_kind_s=now_kind_s;int save_now_cnt=now_cnt;
int save_line=line,save_column=column;
da_save_now_ap=da_now_ap;
z_p.page_sw_s="";
for(i=column=0;column_occurs>i;i++,column+=column_offset)
   {for(k=0,line=line_start;line_occurs>k;k++,line+=line_offset)
     {if(z_p.e2s_b(program_s,"INPUT"))
        {if(0==sw_ii)can=-1;
         else if(z_p.count_i_i(i_msg_a)>o)can=z_p.at_i(i_msg_a,o);
         else if(-1==cancel||(n+cancel)>=z_p.count_s_i(s_sql0_a)||z_p.e2s_b(z_p.at_s(s_sql0_a,n+cancel),""))
                 if(record_max<o)can=-1;else can=-2;
                 else can=z_mt_p.txt_xx_1;
         display_v((0>can?"":z_p.substring2_s((z_p.at_s(z_p.s_lang_a,can)),1))
           ,line+(z_p.at_da(da_data_a,0)).line,1+column,10,'L');
         if(z_p.count_i_i(i_msg_a)<=o)z_p.add_i(i_msg_a,can);
         display_v("",line+(z_p.at_da(da_data_a,0)).line,column+12,1,'W');
        }
      if(z_p.e2s_b(program_s,"OUTPUT")&&0!=CONTROL_IX[C_0]) 
      display_v("",line+(z_p.at_da(da_data_a,0)).line,column+1,1,'W');
      for(m=1;z_p.count_da_i(da_data_a)>m;m++)
        {da_work_data_p=z_p.at_da(da_data_a,m);
         if(0==sw_ii||sql_column_cnt_ix[0]<m||z_p.count_s_i(s_sql0_a)<(n+m)||(record_max<o&&0>can))
           {da_work_data_p.data_s="";sw=0;}
         else{da_work_data_p.data_s=z_p.at_s(s_sql0_a,n+m-1);sw=1;}
         if('N'!=da_work_data_p.mark2_c&&0!=da_work_data_p.length0)display_v(sw,da_work_data_p,line,column);
        }
      if(0!=sw_ii&&record_max>=o)
        {if(0!=section("SQL",SQL_4))return false;//SQLのセクション実行
         now_kind_s="SQL";
         if(0!=section_color())return false;//SQLの色表示。
        }
      n+=sql_column_cnt_ix[0];
      o++;
     }
   }
now_kind_s=save_now_kind_s;now_cnt=save_now_cnt;
da_now_ap=da_save_now_ap;
line=save_line;column=save_column;
return true;
}
#endif //MENU
//----------------------------------------------
//******( z_p.prog_n.sよりs_niに文字を設定 )*************
bool data_set_b(ii_zz_l s_ni){return data_set_b(s_ni,0);}//VER18.1,0はそのまま処理
bool data_set_b(ii_zz_l s_ni,int sw_ii)//sw_ii=1は空白以降を取る。sw_ii=2は前の空白を取り更に空白以降を取る。
{z_p.t_v(z_p.PR,"data_set_b(");
z_p.prog_word_b(s_ni,"\t");//z_p.prog_n.sより文字を設定。
z_mt_p.edit_b(s_ni,s_ni.s);//?名前?編集　VER18.1
if(0!=sw_ii)//VER18.1空白の処理。
  {if(2==sw_ii)s_ni.s=z_p.trim_s(s_ni.s);//VER18.1前の空白を取る。
   s_ni.s=z_mt_p.space_cut_s(s_ni.s);//VER18.1空白以降を取る。
  }
if(z_p.e2s_b(s_ni.s,""))return true;//空白は終了
if(!z_mt_p.edit_b(s_ni,s_ni.s))return false;//?名前?を変換
if(z_p.e2s_b(s_ni.s,""))return true;//空白は終了
if('$'==z_p.at_s_c(s_ni.s,0))
   {ii_zz_l ww_type_c_n=new ii_zz_l();
    bool b=get_data_b(s_ni,ww_type_c_n,s_ni.s);
//HP delete ww_type_c_n;
    if(!b)return false;
   }
s_ni.s=z_p.upper_s(s_ni.s);//大文字化
return true;
}
#if IMENU
//----------------------------------------------
//=****( data_sをdata_save_sにセーブする )*****
public void data_save_v(String s_si)
{z_p.t_v(z_p.PR,"data_save_v(");
List<ii_data_l> da_w_a;da_w_a=(z_p.e2s_b(s_si,"SET")?da_set_a:da_data_a);
if(z_p.e2s_b(s_si,"DATA"))
  {for(int i=0;z_p.count_da_i(da_data_a)>i;i++)
//SS   (z_p.at_da(da_w_a,i)).Brush_n=(Brush )(z_p.at_da(da_w_a,i)).org_Brush_n.Clone();
//JJ   (z_p.at_da(da_w_a,i)).Brush_n=(Brush )(z_p.at_da(da_w_a,i)).org_Brush_n;
   section_color(); /////////////////////////////////////////////////////////
  }
for(int i=0;z_p.count_da_i(da_w_a)>i;i++)
  {(z_p.at_da(da_w_a,i)).data_save_s=(z_p.at_da(da_w_a,i)).data_s;
//SS   (z_p.at_da(da_w_a,i)).save_Brush_n=(Brush )(z_p.at_da(da_w_a,i)).Brush_n.Clone();
//JJ   (z_p.at_da(da_w_a,i)).save_Brush_n=(Brush )(z_p.at_da(da_w_a,i)).Brush_n;
  }
}
//----------------------------------------------
//=****( キャンセルによりdata_sをdata_save_sに戻す )*****
public void data_cancel_v(String s_si)
{z_p.t_v(z_p.PR,"data_cancel_v(");
List<ii_data_l> da_w_a;da_w_a=(z_p.e2s_b(s_si,"SET")?da_set_a:da_data_a);
for(int i=1;z_p.count_da_i(da_w_a)>i;i++)
  {(z_p.at_da(da_w_a,i)).data_s=(z_p.at_da(da_w_a,i)).data_save_s;
//SS    (z_p.at_da(da_w_a,i)).Brush_n=(Brush )(z_p.at_da(da_w_a,i)).save_Brush_n.Clone();
//JJ    (z_p.at_da(da_w_a,i)).Brush_n=(Brush )(z_p.at_da(da_w_a,i)).save_Brush_n;
   display_v(2,z_p.at_da(da_w_a,i),now_kind_s);
  }
section_color();
}
//----------------------------------------------
public bool end_b()
{z_p.t_v(z_p.PR,"end_b(");
if(0!=section("END",END_3))return false;
return true;
}
#endif //MENU
//----------------------------------------------
public bool exit_b(String s_si,String cmd_si)
{z_p.t_v(z_p.PR,"exit_b(");
if(z_p.e4s_b(now_kind_s,"SET","DATA","START")) //VER14.1でSTARTを削除。//VER15.1で復活。
  {find_name_i=now_cnt;  //後方のみ有効。
   if(find_name_b(s_si,da_now_ap))    
   if(find_name_i!=now_cnt||z_p.e2s_b(cmd_si,"EXIT")){exit_cnt=find_name_i;return true;} //exit_cnt設定。                 
  }
z_p.err_s="not found (data name) "+cmd_si+"["+s_si+"]"; 
return false;
}
//----------------------------------------------
//=****( s_siのデーター名を発見してdata_nrを設定 )*****
public bool find_name_b(String s_si)
{z_p.t_v(z_p.PR,"find_name_b(");
//ii_zz_l i_n=new zz_l;
find_name_i=1;find_name_kind_s="DATA"; if(find_name_b(s_si,da_data_a)){z_p.t_v(z_p.PR,"find_name_b)1");return true;}  
find_name_i=0;find_name_kind_s="SET";  if(find_name_b(s_si,da_set_a)){z_p.t_v(z_p.PR,"find_name_b)2");return true;}  
find_name_i=0;find_name_kind_s="WORK"; if(find_name_b(s_si,da_work_a)){z_p.t_v(z_p.PR,"find_name_b)3");return true;}  
find_name_i=0;find_name_kind_s="TABLE";if(find_name_b(s_si,da_table_a)){z_p.t_v(z_p.PR,"find_name_b)4");return true;}  
z_p.t_v(z_p.PR,"find_name_b)5");
return false;
}
//----------------------------------------------
//=****( s_siのデーター名をa_aiから発見してdata_nrを設定 )*****
public bool find_name_b(String s_si,List<ii_data_l> da_ai)
{
s_si=z_p.upper_s(s_si);
for(;z_p.count_da_i(da_ai)>find_name_i;find_name_i++)
   if(z_p.e2s_b((z_p.at_da(da_ai,find_name_i)).name_s,s_si))
      {da_find_name_data_p=(z_p.at_da(da_ai,find_name_i));return true;}
find_name_i=-1;da_find_name_data_p= null ;return false;  
}
//----------------------------------------------
//-****( return:水平offset)=====
public int offset_x_i(int line_ii)
{if(1==sw_x_scroll&&line_ii>click_set_bottom)return scroll_x_offset;
return 0;
}
//----------------------------------------------
//=**** ( return:垂直offset)*****
public int offset_y_i(int line_ii,int column_ii)
{if(1==sw_y_scroll&&line_ii>=scroll_y_line_top)return scroll_y_offset;
return 0;
}
//----(name_siの名前をii_data_lクラスのa_aiアレイリストから
//     da_set_data_data_p(アドレス),set_data_data_s(data_s),set_data_type_c(type1_sの先頭文字)を設定。
public bool set_data_data_b(String name_si,List<ii_data_l> da_ai)
{z_p.t_v(z_p.PR,"set_data_data_b(");
for(int i=0;z_p.count_da_i(da_ai)>i;i++)
     if(z_p.e2s_b((z_p.at_da(da_ai,i)).name_s,name_si))
       {da_set_data_data_p=z_p.at_da(da_ai,i);set_data_data_s=da_set_data_data_p.data_s;
        set_data_type_c=(1>z_p.length(da_set_data_data_p.type1_s)?' ':z_p.at_s_c(da_set_data_data_p.type1_s,0));
        z_p.t_v(z_p.PR,"set_data_data_b)1");
        return true;
       }
da_set_data_data_p= null ;set_data_data_s="";set_data_type_c=' ';
z_p.t_v(z_p.PR,"set_data_data_b)2");
return false;
}
public String func_date_s(String si,int sw_date)
{if(1==sw_date)return si; 
 return z_mt_p.db_n.date1_s+si
        +(z_p.e2s_b(z_mt_p.db_n.date2_s,"")?"":z_mt_p.db_n.date2_s+si)
        +(z_p.e2s_b(z_mt_p.db_n.date3_s,"")?"":z_mt_p.db_n.date3_s+si)
        +z_mt_p.db_n.date4_s;
} 
//----------------------------------------------
//---------( get data(s) return data_n.data_s )--------------------------------------
//----------------------------------------------
public String get_data_s(String s_si)//VER20.1
{z_p.t_v(z_p.PR,"get_data_s(");
ii_zz_l ww_s_n=new ii_zz_l();ii_zz_l ww_type_c_n=new ii_zz_l();
bool rc_b=get_data_b(ww_s_n,ww_type_c_n,s_si,0);
String s=ww_s_n.s;
//HP delete ww_s_n;delete ww_type_c_n; 
if(rc_b)return s;  
return "";
}
//------( s_siの名前の内容を設定 )----------------------------------------
public bool get_data_b(ii_zz_l s_ni,ii_zz_l type_c_ni,String s_si)
{return get_data_b(s_ni,type_c_ni,s_si,0);  //VER18.1
}
public bool get_data_b(ii_zz_l s_ni,ii_zz_l type_c_ni,String s_si,int sw_ii)
{if(get_data_b(s_ni,type_c_ni,"",s_si,sw_ii))return true;  //VER18.1
if('T'==z_mt_p.program_c||z_p.e8c_b(z_p.at_s_c(s_si,0),'%','_','#','!','@','^',' '))return false; //VER18.1 VER19.1 VER23.1
if('$'==z_p.at_s_c(s_si,0)){if(1==z_p.count_pr_i(z_mt_p.program_list_n.pr_a))return true; else return false;}   //VER23.1 "$"付最初のプログラムは有効化に戻す。
if(1<z_p.count_pr_i(z_mt_p.program_list_n.pr_a))return get_data_b(s_ni,type_c_ni,"$",s_si,sw_ii);  //VER18.1 データ名が無いときは前のプログラムを確認。
else return false;//VER18.1前のプログラムが無いときは判定せず。 
}
//------( s1_si+s2_siの名前の内容を設定 sw_ii=1は#付データ無はエラー)----------------------------------------
//------( return false は変換エラー　)----------------------------------------
readonly int NEXT_1=1,SKIP_2=2,SET_DATA_DATA_OK_3=3,SET_DATA_4=4,SET_PLUS_NULL_5=5,SET_NULL_6=6,SET_OK_7=7,OK_8=8;
bool get_data_b(ii_zz_l s_ni,ii_zz_l type_c_ni,String s1_si,String s2_si,int sw_ii)
{z_p.t_v(z_p.PR,"get_data_b(");
String s_s=s1_si+s2_si;  //VER18.1 
s_ni.s="";type_c_ni.c=' ';
int position=-1;int length=-1;int sw_position_length=0;
int tokusyu_sw=0,unicode_length_sw=1;
String w_s="",property_s="",name_s;
String sep_s=" LIKE ",quote_s="'",rt_s="",lt_s="";
int r_sw=-5;String q_s="",l_s="",egl_s="",eg_s=""; 
if(z_p.e2s_b(s_s,"")){s_ni.s="";z_p.t_v(z_p.PR,"get_data_b)1");return true;}
if(z_p.length(s_s)>1&&'\''==z_p.at_s_c(s_s,0)&&'\''==z_p.at_s_c(s_s,z_p.length(s_s)-1))
  {s_ni.s=z_p.replace_s_s(z_p.substring3_s(s_s,1,z_p.length(s_s)-2),"''","'");
   z_p.t_v(z_p.PR,"get_data_b)2");
  return true;
  }
name_s=z_p.trim_s(z_p.upper_s(s_s));
int sw=0;//プログラム制御用。
ii_zz_l ww_i_n=new ii_zz_l();ii_zz_l ww1_s_n=new ii_zz_l();ii_zz_l ww_c_n=new ii_zz_l(); 
//****************( 部分指定対応 [position;length] )*******************************************
if(0<(ww_i_n.i=z_p.index2c_i(s_s,'['))) //部分指定有り[POS;LEN]
  {bool rc_b=true;sw_position_length=1;
   for(;;)
     {name_s=z_p.upper_s(z_p.trim_s(z_p.substring3_s(s_s,0,ww_i_n.i)));ww_i_n.i++; //名前右空白削除
      if(z_p.e2s_b(name_s,"")){name_s=z_p.trim_s(z_p.upper_s(s_s));ww_i_n.i=0;break;}//名前無エラー
      if(!z_p.word_b(ww1_s_n,ww_i_n,ww_c_n,s_s,";]",1)){rc_b=false;break;} //位置情報抜き出し
      if(';'==ww_c_n.c) //セミコロンの場合、更にセミコロン確認
        {for(;;)if(z_p.length(s_s)>ww_i_n.i&&' '>z_p.at_s_c(s_s,ww_i_n.i))ww_i_n.i++;else break; //空白以下は読み飛ばす
         if(z_p.length(s_s)>ww_i_n.i&&';'==z_p.at_s_c(s_s,ww_i_n.i)){unicode_length_sw=0;ww_i_n.i++;} //セミコロンの場合実文字数。
        }
      if(!compute_b(ww1_s_n.s,-1)){rc_b=false;break;}//数値変換不能。 //位置エラー//VER35//VER36.00060003   
       position=compute;
      ////if(0==position){z_p.err_s="bad (position) ("+ww1_s_n.s+") ";{rc_b=false;break;}} //位置エラー//VER35
      if(';'==ww_c_n.c)//文字数有り  
        {if(!z_p.word_b(ww1_s_n,ww_i_n,ww_c_n,s_s,"]",1)){rc_b=false;break;} //文字数項目抜き出し
         if(!compute_b(ww1_s_n.s,-1)){rc_b=false;break;}//数値変換不能。 //位置エラー//VER35//VER36.00060003   
         length=compute;if(0>length)length=0; //VER35//VER36.00060003 
        }
     //// if(0==position&&0==length){z_p.err_s="bad (position=0 & length=0)";rc_b=false;break;} //位置エラー//VER35//VER36.00060003
      sw=NEXT_1;
      break;
     }//for(;;) 
//*****************************************************************************
   if(!rc_b)
     {
//HP delete ww_i_n;delete ww1_s_n;delete ww_c_n; 
      z_p.t_v(z_p.PR,"get_data_b)3");
      return false;
     }
  }
if(0==sw)
  {int hex=0;
   for(;;)
     {z_p.t_v(z_p.PR2,"get_data_b(/for(sw="+z_p.to_i_s(sw));
//SJ  z_p.to_decimal_d(s_s,'-',z_p.decimal_d(0),0);if(z_p.return_b){s_ni.s=s_s;type_c_ni.c='-';sw=OK_8;break;}//１０進数変
      z_p.to_double_o(s_s,'-',0,0);                if(z_p.return_b){s_ni.s=s_s;type_c_ni.c='-';sw=OK_8;break;}//浮動小数点変換
      //16進数set**************************
      w_s=z_p.upper_s(s_s); 
      if(z_p.starts_with_b(w_s,"0X")&&3<=z_p.length(w_s)&&6>=z_p.length(w_s))
        {for(i=2;z_p.length(w_s)>i;i++)
          {if(-1==z_p.hex(z_p.at_s_c(w_s,i)))break;
           hex=hex*16+z_p.hex(z_p.at_s_c(w_s,i));
          }
         s_ni.s=z_p.to_c_s((char )hex);
         sw=OK_8;break;
        }
      break;
     }//for(;;)
  }
//=***********************
ii_data_l ww_da_work_data_p= null ;
for(;NEXT_1>=sw;)//NEXT_1以下のみ実行
  {
   if(z_p.length(name_s)>2&&-1!=(i=z_p.index3c_i(name_s,'@',1))&&!(z_p.ends_with_b(name_s,")"))) //@付きデータ名処理 //VER36.1 右カッコ除く
    {property_s=z_p.upper_s(z_p.substring2_s(name_s,i));
     name_s=z_p.upper_s(z_p.substring3_s(name_s,0,i));
    }
   //=*****( _付き予約語処理 )*****
   if(z_p.starts_with_b(name_s,"_"))
     {String s=name_s;
      if (z_p.e2s_b(s,"_")){w_s=" ";sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_$")){w_s="$";sw=SET_NULL_6;break;} //VER26.1
      if(z_p.e2s_b(s,"_#")){w_s="#";sw=SET_NULL_6;break;} //VER26.1
      if(z_p.e2s_b(s,"_A")){w_s="@";sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_AND_SPACE")){w_s=(z_p.e2s_b(and_space_s,"")?"":" AND("+and_space_s+")");sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_ARG")){w_s=arg_s;sw=SET_NULL_6;break;}
 //     if(z_p.e2s_b(s,"_COMMAND")){w_s=command_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_BIN")){w_s=z_p.os_drive_s+z_p.dir_s+"I"+z_p.dir_s+"BIN"+z_p.iv_s+z_p.dir_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_C")){w_s=z_mt_p.db_n.c_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_CGI_INFO")){w_s=z_p.cgi_info_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_CGI_INFO_BEGIN")){w_s=z_p.cgi_info_begin_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_CGI_INFO_JOB")){w_s=z_p.cgi_info_job_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_CGI_INFO_END")){w_s=z_p.cgi_info_end_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_CHECK_TYPE")){w_s=z_mt_p.db_n.CHECK_TYPE_S;sw=SET_NULL_6;break;}//VER14.1
      if(z_p.e2s_b(s,"_CHECK1_TYPE")){w_s=z_mt_p.db_n.CHECK_TYPE_S;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_CHECK2_TYPE1"))
        {w_s=z_p.CHECK2_TYPE1_CHAR_S+","+z_p.CHECK2_TYPE1_NCHAR_S+","+z_p.CHECK2_TYPE1_DECIMAL_S
             +","+z_p.CHECK2_TYPE1_DATETIME_S+","+z_p.CHECK2_TYPE1_FLOAT_S;sw=SET_NULL_6;break;
        }
      if(z_p.e2s_b(s,"_CHECK2_TYPE1_CHAR")){w_s=z_p.CHECK2_TYPE1_CHAR_S;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_CHECK2_TYPE1_NCHAR")){w_s=z_p.CHECK2_TYPE1_NCHAR_S;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_CHECK2_TYPE1_DECIMAL")){w_s=z_p.CHECK2_TYPE1_DECIMAL_S;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_CHECK2_TYPE1_FLOAT")){w_s=z_p.CHECK2_TYPE1_FLOAT_S;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_CHECK2_TYPE1_DATETIME")){w_s=z_p.CHECK2_TYPE1_DATETIME_S;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_CHECK2_TYPE1_INT")){w_s=z_p.CHECK2_TYPE1_INT_S;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_CHECK2_TYPE2_CHAR")){w_s=z_p.CHECK2_TYPE2_CHAR_S;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_CHECK2_TYPE2_NCHAR")){w_s=z_p.CHECK2_TYPE2_NCHAR_S;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_CHECK2_TYPE2_DECIMAL")){w_s=z_p.CHECK2_TYPE2_DECIMAL_S;sw=SET_NULL_6;break;}
      if(z_p.e4s_b(s,"_(C","_C(","_CL")){w_s=z_mt_p.db_n.cl_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_CODE")){w_s=code_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_CODE39")){w_s=code39_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_COMPUTER")){w_s=z_p.replace_c_s(z_p.upper_s(z_p.machine_name_s()),'-','_');sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_COMPUTER_NAME")){w_s=z_p.upper_s(z_p.machine_name_s());sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_COUNTER")){w_s=(z_p.at_da(z_p.da_common_a,0)).data_s;type_c_ni.c=z_p.at_s_c((z_p.at_da(z_p.da_common_a,0)).type1_s,0);sw=SET_NULL_6;break;}
      if(z_p.e4s_b(s,"_)C","_C)","_CR")){w_s=z_mt_p.db_n.cr_s;sw=SET_NULL_6;break;}
#if IMENU
      if(z_p.e2s_b(s,"_D")){w_s=z_mt_p.db_n.d_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_DATA")){if(now_kind_b()){ww_da_work_data_p=da_now_p;sw=SET_DATA_4;break;} else {z_p.t_v(z_p.PR,"get_data_b)4");return set_data_err_b(s2_si);}}           
      if(z_p.e5s_b(s,"_GROUP_COUNT","_LEFT_COUNT","_SELECT_COUNT","_DATA_COUNT")){w_s=z_p.to_i_s(z_p.count_da_i(da_data_a)-1);sw=SET_PLUS_NULL_5;break;}  
      if(z_p.e2s_b(s,"_DATA_ALL")){    w_s=data_all_s;    sw=SET_NULL_6;break;}  
      if(z_p.e2s_b(s,"_DATA_ALL_SQL")){w_s=data_all_sql_s;sw=SET_NULL_6;break;}  
#endif //MENU
      if(z_p.e2s_b(s,"_DATE")){w_s=date_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_DATE_GOOD")){w_s=date_good_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_DATETIME")){w_s=date_time_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_DATETIME_GOOD")){w_s=date_time_good_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_DIGIT11")){w_s=digit11_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_DB")){w_s=z_p.to_c_s(z_p.db_c);sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_DB_ERROR")){w_s=z_p.db_error_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_DB_HEADER"))
        {w_s=('D'==z_p.db_c?"":"I"+('I'==z_p.db_c?"_":z_mt_p.db_n.user_sep_s)+z_p.system_s+('I'==z_p.db_c?"_":z_mt_p.db_n.user_sep_s))//VER12.0
            +z_p.substring3_s(z_p.real_test_s,0,1);
         if('P'==z_p.db_c)w_s=z_p.lower_s(w_s);
         sw=SET_NULL_6;break;
        }
      if(z_p.e2s_b(s,"_DB_I_ERROR")){w_s=z_p.db_i_error_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_DB_SOFT")){w_s=z_p.db_soft_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_DRIVES")){w_s=z_p.drives_s();sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_E")){w_s=z_mt_p.db_n.e_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_EC")){w_s=z_mt_p.db_n.ec_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_EDIT")){w_s=edit_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_EDIT_ERROR")){w_s=edit_error_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_ENCODE"))  //VER35
          {w_s=""; 
////SS       System.Text.EncodingInfo[] stei_nx=System.Text.Encoding.GetEncodings();
////SS       foreach(System.Text.EncodingInfo stei_n in stei_nx)
////SS          w_s+=(""==w_s?"":",")+stei_n.Name;
////SS          w_s+=",shift_jis";   
//SS       for(int ii=0;65535>ii;ii++)
//SS          {try{String ss=System.Text.Encoding.GetEncoding(ii).WebName;w_s+=(""==w_s?"":",")+ss;}
//SS           catch{}
//SS          } 
//JJ       for(Charset cs_n:Charset.availableCharsets().values()) 
//JJ          w_s+=(""==w_s?"":",")+cs_n.name();
//HP        w_s="UTF-8";
////HP      const auto codecs = QTextCodec::availableCodecs(); 
////HP      for(auto it=codecs.begin();it<codecs.end();it++) 
////HP        {const auto codec=QTextCodec::codecForName(*it); 
////HP         w_s+=(""==w_s?"":",")+codec->name();
////HP        } 
           sw=SET_NULL_6;break;
          }
      if(z_p.e2s_b(s,"_ENVIRONMENT")){w_s=environment_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_ERROR")){w_s=z_p.err_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_EXE_NAME")){w_s=z_p.exe_name_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_EXE_OPTION")){w_s=z_p.exe_option_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_EXE_PARAM")){w_s=z_p.exe_param_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_EXE_PATH")){w_s=z_p.exe_path_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_FIND_CHAR")){w_s=find_char_s;sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_FIND_CHAR_NOT")){w_s=find_char_not_s;sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_FIND_CHAR_LAST")){w_s=find_char_last_s;sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_FIND_CHAR_LAST_NOT")){w_s=find_char_last_not_s;sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_FIND_COUNT")){w_s=find_count_s;sw=SET_PLUS_NULL_5;break;}   //VER15.1
      if(z_p.e2s_b(s,"_FIND_REPEAT")){w_s=find_repeat_s;sw=SET_PLUS_NULL_5;break;}   //VER20.1
      if(z_p.e2s_b(s,"_FIND_STRING")){w_s=find_string_s;sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_FIND_STRING_NOT")){w_s=find_string_not_s;sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_FIND_STRING_LAST")){w_s=find_string_last_s;sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_FIND_STRING_LAST_NOT")){w_s=find_string_last_not_s;sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_FOR")){w_s=z_mt_p.db_n.for_s;sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_FOREIGN")){w_s=foreign_s;sw=SET_NULL_6;break;} //VER32.1
      if(z_p.e2s_b(s,"_FOREIGN_TABLE")) //VER32.1
        {z_mt_p.edit_b(ww1_s_n,table_s);int ii=z_p.length(ww1_s_n.s);
         for(;ii>0&&'.'!=z_p.at_s_c(ww1_s_n.s,ii);ii--){}w_s=z_p.substring2_s(ww1_s_n.s,ii+1);sw=SET_NULL_6;break;
        }
      if(z_p.e2s_b(s,"_FROM")){w_s=z_mt_p.db_n.from_s;sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_PART")){w_s=z_p.part_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PI")){w_s="3.14159265358979";sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SETUP")){w_s=z_p.setup_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SPACE")){w_s=space_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SPACE_ERASE")){w_s=space_erase_s;sw=SET_NULL_6;break;}  //VER15.1
      if(z_p.e2s_b(s,"_SQL")){w_s=z_p.sql_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SQL_FILE")){w_s=z_p.job_s+z_p.hh_s+z_p.mm_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SQL_FILE_COUNT")){w_s=z_p.to_i_s(file_record_cnt);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SQL_FILE_COLUMN")){w_s=z_p.to_i_s(file_column_cnt);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SQL_OLD")){w_s=z_p.sql_old_s;sw=SET_NULL_6;break;}
#if IMENU
      if(z_p.e2s_b(s,"_FONT")){w_s=z_p.lang_font_org_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_FONT_SIZE")){w_s=z_p.to_i_s(z_p.lang_font_org);sw=SET_PLUS_NULL_5;break;}
#endif //MENU
      if(z_p.e2s_b(s,"_FRAMEWORK")){w_s=z_p.to_c_s(z_p.FRAMEWORK_C);sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_FROM_WORK")){w_s="";sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_FROM_COUNT")){w_s=z_p.to_i_s(z_p.count_s_i(s_join_a));sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_FROM_DUAL")){w_s=z_p.replace_s_s(z_mt_p.db_n.from_dual_s,"*",z_p.system_s+z_p.substring3_s(z_p.real_test_s,0,1));sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_FULL_SIZE")){w_s=full_size_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_FUNC_BEGIN")){w_s=z_mt_p.db_n.func_begin_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_FUNC_END")){w_s=z_mt_p.db_n.func_end_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_FUNC_RETURNS")){w_s=z_mt_p.db_n.func_returns_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_HAVING")){w_s=having_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_HHMM")){w_s=z_p.hh_s+z_p.mm_s;sw=SET_NULL_6;break;}
      if(z_p.e3s_b(s,"_ICHART","_IPRINT"))
        {w_s=
//JJ                      "java"+('W'==z_p.os_c?"w":"");
//SS #if W
//SP                       z_p./*get_*/bin_path_s/*()*/+z_p.substring2_s(name_s,1)+z_p.to_c_s(z_p.os_c)+z_p.to_c_s(z_p.FRAMEWORK_C)+".EXE"; //VER33
//SS #else //W
//SS                       "mono";
//SS #endif //W
         sw=SET_NULL_6;break;
        }
      if(z_p.e3s_b(s,"_ICHART2","_IPRINT2"))
        {w_s=
//SS #if W
//SP                      "";
//SS #else //W
//SS                       z_p./*get_*/bin_path_s/*()*/+z_p.substring3_s(name_s,1,6)+z_p.to_c_s(z_p.os_c)+z_p.to_c_s(z_p.FRAMEWORK_C)+".EXE"; //VER33
//SS #endif //W
//JJ "-cp "+z_p./*get_*/bin_path_s/*()*/+z_p.iv_s+"purejavacomm.jar"+('W'==z_p.os_c?";":":") //VER33
//JJ       +z_p./*get_*/bin_path_s/*()*/+z_p.iv_s+"jna.jar"+('W'==z_p.os_c?";":":") //VER33
//JJ       +z_p./*get_*/bin_path_s/*()+z_p.iv_s*/+"IJAVA.jar "+(z_p.lower_s(z_p.substring3_s(name_s,1,6))+"_l"); //VER33 //VER36.6.0.3
         sw=SET_NULL_6;break;
        }
      if(z_p.e2s_b(s,"_INP_OUT")){w_s=z_p.inp_out_s;sw=SET_NULL_6;break;}
#if IMENU
      if(z_p.e2s_b(s,"_INPUT")){w_s=z_p.to_c_s(z_p.input_c);sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_INPUT_POSITION")){w_s=z_p.to_i_s(keyboard_n.get_unicode()+1);sw=SET_PLUS_NULL_5;break;} //VER20.1
#endif //MENU
      if(z_p.e2s_b(s,"_INSTANCE")){w_s=z_p.instance_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_I")){w_s=z_p./*get_*/bin_path_s/*()*/;sw=SET_NULL_6;break;} //VER33
      if(z_p.e2s_b(s,"_IDB_L")){w_s=z_p.lower_s(("I_"+z_p.system_s+"_"+z_p.real_test_s));sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_IV")){w_s=z_p.iv_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_JAN")){w_s=jan_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_JOB")){w_s=z_p.job_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_JOB_CGI")){w_s=z_p.job_cgi_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_JOB_NAME")){w_s=z_p.job_name_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_JOB_PART")){w_s=job_part_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_JOB_PERMISSION")){w_s=job_permission_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_JSON"))
        {w_s=(0==z_p.count_xm_i(xm_json_a)?"0":z_p.to_i_s((int )(z_p.at_xm(xm_json_a,z_p.count_xm_i(xm_json_a)-1)).xml_json));sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SQL_PERMISSION")){ w_s=sql_permission_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_L")){w_s="{";sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_LANG")){w_s=z_p.lang_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_LANG_SYSTEM")){w_s=z_p.lang_system_s;sw=SET_NULL_6;break;}
#if IMENU
      if(z_p.e3s_b(s,"_CHECK2","_LIST_BOX_COMMENT")){w_s=z_mt_p.listbox_n.comment_s;sw=SET_NULL_6;break;}
#endif //MENU
      if(z_p.e2s_b(s,"_LOCK1")){w_s=z_mt_p.db_n.lock1_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_LOCK2")){w_s=z_mt_p.db_n.lock2_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_LOGIN_ID")){w_s=login_id_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_LOGIN_ID_ADMIN")){w_s=z_mt_p.db_n.admin_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_LOWER")){w_s=lower_s;sw=SET_NULL_6;break;}
      if(z_p.e4s_b(s,"_M","_MM","_MX")){w_s=_pmx_s(name_s,z_p.real_test_s,"",job_permission_s,job_part_s);sw=SET_NULL_6;break;}
      if(z_p.e3s_b(s,"_M_REAL","_M_TEST")){w_s=_pmx_s(name_s,z_p.substring3_s(name_s,3,4),"",job_permission_s,job_part_s);sw=SET_NULL_6;break;}
      if(z_p.e3s_b(s,"_MM_REAL","_MM_TEST")){w_s=_pmx_s(name_s,z_p.substring3_s(name_s,4,4),"",job_permission_s,job_part_s);sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_MENU_KIND")){w_s=z_p.menu_kind_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_MENU_PERMISSION")){w_s=z_p.menu_permission_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_MENU_SECURITY")){w_s=z_p.menu_security_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_N")){w_s=z_mt_p.db_n.n_s;sw=SET_NULL_6;break;}
#if IMENU
      if(z_p.e2s_b(s,"_NAME")){if(now_kind_b()){w_s=da_now_p.name_s;sw=SET_NULL_6;break;}}
      if(z_p.e2s_b(s,"_NAME_SQL")){try{w_s=z_mt_p.set_alias_column_name_s(da_now_p.name_s);}catch(Exception){w_s="";};sw=SET_NULL_6;break;}
#endif //MENU
      if(z_p.e2s_b(s,"_NEXT")){w_s=next_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_NEW_LINE")){w_s=z_p.new_line_s();sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_NOW_DATE")){w_s=z_mt_p.db_n.now_date_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_NOW0")){w_s=z_mt_p.db_n.now0_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_NOW8")){w_s=z_mt_p.db_n.now8_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_NOW17")){w_s=z_mt_p.db_n.now17_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O")){w_s=o_o_s;sw=SET_NULL_6;break;}
      if(z_p.e9s_b(s,"_O_INSERT","_O_INSERT2","_O_UPDATE_ADD","_O_UPDATE_ADD2","_O_UPDATE_CHANGE","_O_UPD_CHA","_O_UPDATE_CHANGE2","_O_UPD_CHA2"))
        {w_s=o_insert_update_s(name_s);sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_DATA")){w_s=z_mt_p.db_n.o_data_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_DATA_SQL")){w_s=z_mt_p.db_n.o_data_sql_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_DEFAULT")){w_s=z_mt_p.db_n.o_default_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_ELSE")){w_s=z_mt_p.db_n.o_end_s+" "+" ELSE BEGIN ";sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_END")){w_s=z_mt_p.db_n.o_end_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_END_IF")){w_s=z_mt_p.db_n.o_end_if_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_EQUAL")){w_s=z_mt_p.db_n.o_e_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_FD")){w_s=z_mt_p.db_n.o_fd_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_FROM")){w_s=z_mt_p.db_n.o_from_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_FS")){w_s=z_mt_p.db_n.o_fs_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_IF")){w_s=z_mt_p.db_n.o_if_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_IF_END")){w_s=z_mt_p.db_n.o_end_s+" "+z_mt_p.db_n.o_end_if_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_IN1")){w_s=z_mt_p.db_n.o_in1_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_IN2")){w_s=z_mt_p.db_n.o_in2_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_INTO")){w_s=o_into_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_NEW")){w_s=z_mt_p.db_n.o_new_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_OLD")){w_s=z_mt_p.db_n.o_old_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_DECLARE")){w_s=z_mt_p.db_n.o_declare_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_SET")){w_s=z_mt_p.db_n.o_set_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_SQL")){w_s=o_sql_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_THEN")){w_s=z_mt_p.db_n.o_then_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_WD")){w_s=z_mt_p.db_n.o_wd_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_WHERE")){w_s=o_where_s+" AND Z_CANCEL=' '";sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_WHERE2")){w_s=o_where_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_O_WS")){w_s=z_mt_p.db_n.o_ws_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_OBJECT_AS")){w_s=z_mt_p.db_n.object_as_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_OBJECT_BEGIN")){w_s=z_mt_p.db_n.object_begin_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_OBJECT_END")){w_s=z_mt_p.db_n.object_end_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_OBJECT_MAIN")){w_s=z_mt_p.db_n.object_main_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_ORDER_COUNT")){w_s=z_p.to_i_s(0==order_count?(z_p.count_da_i(da_data_a)-1):order_count);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_OS")){w_s=z_p.to_c_s(z_p.os_c);sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_OS_DRIVE")){w_s=z_p.os_drive_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_OS_VERSION")){w_s=z_p.os_ver_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_P")){w_s=z_p.dir_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PASS_DAY")){w_s=(z_p.e2s_b(z_mt_p.pass_date_s,"")?"":z_p.substring3_s(z_mt_p.pass_date_s,6,2));sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PASSWORD")){w_s=z_p.password_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PASSWORD64_CHECK")){w_s=z_p.password64_check_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PASSWORD_LINK")){w_s=z_p.password_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PAGE_SW")){w_s=z_p.page_sw_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PATH")){w_s=z_p.get_tmp_path_s("");sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PERMISSION")){if(!sw_security_b){z_p.err_s="not ready ("+name_s+")";z_p.t_v(z_p.PR,"get_data_b)5");return false;}w_s=z_p.person_permission_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PERSON")){if(!sw_security_b){z_p.err_s="not ready ("+name_s+")";z_p.t_v(z_p.PR,"get_data_b)6");return false;}w_s=z_p.person_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SECURITY")){if(!sw_security_b){z_p.err_s="not ready ("+name_s+")";z_p.t_v(z_p.PR,"get_data_b)7");return false;}w_s=z_p.person_security_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PERSON_NAME")){if(!sw_security_b){z_p.err_s="not ready ("+name_s+")";z_p.t_v(z_p.PR,"get_data_b)8");return false;}w_s=z_p.person_name_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PP")){w_s=z_p.menu_permission_s+z_p.part_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PP1")){w_s=z_p.menu_permission_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PP2")){w_s=z_p.part_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PROC")){w_s=z_mt_p.db_n.proc_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PROC_L")){w_s=z_mt_p.db_n.proc_l_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PROC_R")){w_s=z_mt_p.db_n.proc_r_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PROGRAM_COUNT")){w_s=z_p.to_i_s(sql_record_cnt_ix[3]);sw=SET_PLUS_NULL_5;break;}
#if IMENU
      if(z_p.e2s_b(s,"_PROGRAM_DATA")){w_s=program_name_data_s;sw=SET_NULL_6;break;}  
      if(z_p.e2s_b(s,"_PROGRAM_KEY")){w_s=program_name_key_s;sw=SET_NULL_6;break;}  
#endif //MENU
      if(z_p.e2s_b(s,"_PROGRAM_NO")){w_s=z_p.to_i_s(z_p.count_pr_i(z_mt_p.program_list_n.pr_a));sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_Q")){w_s="?";sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_R")){w_s="}";sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_RAND()")){w_s=z_mt_p.db_n.cast_oracle1_s+z_mt_p.db_n.rand_s+z_mt_p.db_n.cast_oracle2_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_RANDOM")){w_s=z_mt_p.random_s(random_i);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_READ_DATA")){w_s=program_read_data_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_READ1_DATA")){w_s=read_nx[0].read_data_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_READ2_DATA")){w_s=read_nx[1].read_data_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_REAL_TEST")){w_s=z_p.real_test_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_REAL_TEST_L")){w_s=z_p.lower_s(z_p.real_test_s);sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_RECEIVE_LANG")){w_s=z_p.receive_lang_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_RECEIVE_SYSTEM")){w_s=z_p.receive_system_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_RECEIVE_JOB")){w_s=z_p.receive_job_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_RECEIVE_PERSON")){w_s=z_p.receive_person_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_RECEIVE_COMPUTER_NAME")){w_s=z_p.receive_computer_name_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_RECEIVE")){w_s=z_p.receive_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_RECEIVE_SW")){w_s=z_p.receive_sw_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_REGISTRY")){w_s=z_p.registry_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_REPEAT")){w_s=z_mt_p.db_n.repeat_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_S")){w_s="#";sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_PERSON_ADMIN"))
        {if(!sw_security_b){z_p.err_s="not ready ("+name_s+")";z_p.t_v(z_p.PR,"get_data_b)9");return false;}
         if((z_p.e3s_b(z_p.person_security_s,"PERSON","ADMIN")&&z_p.e3s_b(z_p.menu_permission_s,"ZZZZ",z_p.person_permission_s))
            ||z_p.e2s_b(z_p.person_security_s,"GUEST"))w_s=z_p.person_security_s;else w_s="";
          sw=SET_PLUS_NULL_5;break;
        }
      if(z_p.e2s_b(s,"_SERVER")){w_s=z_p.replace_c_s(z_p.server_name_s,'-','_');sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SERVER_NAME")){w_s=z_p.server_name_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SET")){w_s=z_p.set_s;sw=SET_NULL_6;break;}
#if IMENU
         if(z_p.e3s_b(s,"_WHERE_COUNT","_SET_COUNT")){w_s=z_p.to_i_s((z_p.count_da_i(da_set_a)-1));sw=SET_PLUS_NULL_5;break;}  
#endif //MENU
      if(z_p.e2s_b(s,"_SET1")){w_s=z_mt_p.db_n.set1_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SET2")){w_s=z_mt_p.db_n.set2_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SPLIT_COUNT")){w_s=z_p.to_i_s(z_p.split_count);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SPLIT_CHAR_COUNT")){w_s=z_p.to_i_s(split_char_count);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SPLIT_FORM_COUNT")){w_s=z_p.to_i_s(split_form_count);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SQL_1_UPDATE")){w_s=z_p.to_i_s(z_p.db_record_cnt);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SQL_CHAR")){w_s="CHAR";sw=SET_NULL_6;break;} //VER29.1
      if(z_p.e2s_b(s,"_SQL_CHAR_SET")){w_s=z_mt_p.db_n.sql_char_set_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SQL_COUNT")){w_s=z_p.to_i_s(sql_record_cnt_ix[0]);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SQL_COUNT_123")){w_s=z_p.to_i_s(z_p.sql_count_123);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SQL_COLUMN")){w_s=z_p.to_i_s(sql_column_cnt_ix[0]);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SQL_DECIMAL")){w_s="DECIMAL";sw=SET_NULL_6;break;} //VER29.1
      if(z_p.e2s_b(s,"_SQL_DATE")){w_s="DATE";sw=SET_NULL_6;break;} //VER29.1
      if(z_p.e2s_b(s,"_SQL_DATETIME")){w_s=z_mt_p.db_n.sql_date_time_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SQL_FLOAT")){w_s="FLOAT";sw=SET_NULL_6;break;} //VER29.1
      if(z_p.e2s_b(s,"_SQL_INT")){w_s="INT";sw=SET_NULL_6;break;} //VER29.1
      if(z_p.e2s_b(s,"_SQL_LENGTH")){w_s=z_mt_p.db_n.sql_length_s;sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SQL_NCHAR")){w_s=z_mt_p.db_n.sql_nchar_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SQL_NULL")){w_s=z_mt_p.db_n.sql_null_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SQL_NVARCHAR")){w_s=z_mt_p.db_n.sql_nvarchar_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SQL_REPEAT_COUNT")){w_s=z_p.to_i_s(sql_record_cnt_ix[5]);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SQL_REPEAT_COLUMN")){w_s=z_p.to_i_s(sql_column_cnt_ix[5]);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SQL_SET_COUNT")){w_s=z_p.to_i_s(sql_record_cnt_ix[4]);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SQL_SET_COLUMN")){w_s=z_p.to_i_s(sql_column_cnt_ix[4]);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SQL_VARCHAR")){w_s=z_mt_p.db_n.sql_varchar_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SQL1_COUNT")){w_s=z_p.to_i_s(sql_record_cnt_ix[1]);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SQL1_COLUMN")){w_s=z_p.to_i_s(sql_column_cnt_ix[1]);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SQL2_COUNT")){w_s=z_p.to_i_s(sql_record_cnt_ix[2]);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_SQL2_COLUMN")){w_s=z_p.to_i_s(sql_column_cnt_ix[2]);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_START")){w_s=(z_p.at_da(da_data_a,0)).data_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_STRING_0_9")){w_s="0123456789";sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_STRING_A_Z")){w_s="ABCDEFGHIJKLMNOPQRSTUVWXYZ";sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SUBSTR")){w_s=z_mt_p.db_n.substr_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SYSTEM")){w_s=z_p.system_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SYSTEM_L")){w_s=z_p.lower_s(z_p.system_s);sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_SYSTEM_NAME")){w_s=z_p.system_name_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_T")){w_s=table_alias_s;sw=SET_NULL_6;break;} //VER18.1
      if(z_p.e2s_b(s,"_TABLE")){if(z_p.e2s_b(table_s,"")){z_p.t_v(z_p.PR,"get_data_b)10");return set_data_err_b(s2_si);}z_mt_p.edit_b(ww1_s_n,table_s);w_s=ww1_s_n.s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_TIMEOUT_CONNECT")){w_s=z_p.to_i_s(z_p.timeout_connect);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_TIMEOUT_SQL")){w_s=z_p.to_i_s(z_p.timeout_sql);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_TMP")){w_s=z_p.get_tmp_path_s(z_p.dir_s);sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_TODAY")){w_s=z_mt_p.sql_n.sql_date_s();sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_TODAY_CLIENT")){w_s=z_p.substring3_s(z_p.date_time_s(z_p.date_time_now_s(),0),0,8);sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_TODAY_TIME")){w_s=z_mt_p.sql_n.sql_time_s();sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_TODAY_TIME_CLIENT")){w_s=z_p.substring3_s(z_p.date_time_s(z_p.date_time_now_s(),0),0,17);sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_TRIM")){w_s=z_p.trim_trim_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_UPPER")){w_s=upper_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_URL")){w_s=url_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_URL_DECODE")){w_s=url_decode_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_URL_ENCODE")){w_s=url_encode_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_USER")){w_s=z_p.user_name_s();sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_USER_DOMAIN"))
        {
//SS     w_s=Environment.UserDomainName;
//JJ     w_s="";
         sw=SET_NULL_6;break;
        }
      if(z_p.e2s_b(s,"_UTF8_GET")){w_s=z_p.to1_i_s(z_mt_p.db_n.utf8_get);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_UTF8_SET")){w_s=z_p.to1_i_s(z_mt_p.db_n.utf8_set);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_VARIABLE")){w_s=variable_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_VERSION1")){w_s=z_p.to_i_s(z_p.version_n.VERSION1);sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_VERSION2"))
         {//w_s=z_p.to_i_s(z_p.version_n.VERSION2);
          //if(z_p.length(w_s)<9)w_s="0"+w_s; //VER36.000600006
          //if(z_p.length(w_s)<9)w_s="0"+w_s; //VER36.000600006
          //if(z_p.length(w_s)<9)w_s="0"+w_s; //VER36.000600006
          w_s=z_p.version_n.VERSION2_S; 
          sw=SET_PLUS_NULL_5;break;
         }
      if(z_p.e4s_b(s,"_W","_WW","_WX")){w_s=_pmx_s(name_s,z_p.real_test_s,z_p.inp_out_s,job_permission_s,job_part_s);sw=SET_NULL_6;break;}
      if(z_p.e5s_b(s,"_W_I","_W_INP","_W_O","_W_OUT")){w_s=_pmx_s(z_p.real_test_s,name_s,z_p.substring3_s(name_s,3,1),job_permission_s,job_part_s);sw=SET_NULL_6;break;}
      if(z_p.e3s_b(s,"_W_REAL","_W_TEST")){w_s=_pmx_s(name_s,z_p.substring3_s(name_s,3,4),z_p.inp_out_s,job_permission_s,job_part_s);sw=SET_NULL_6;break;}
      if(z_p.e9s_b(s,"_W_REAL_I","_W_REAL_INP","_W_REAL_O","_W_REAL_OUT","_W_TEST_I","_W_TEST_INP","_W_TEST_O","_W_TEST_OUT"))
        {w_s=_pmx_s(name_s,z_p.substring3_s(name_s,3,4),z_p.substring3_s(name_s,8,1),job_permission_s,job_part_s);sw=SET_NULL_6;break;}
      if(z_p.e5s_b(s,"_WW_I","_WW_INP","_WW_O","_WW_OUT")){w_s=_pmx_s(name_s,z_p.real_test_s,z_p.substring3_s(name_s,4,1),job_permission_s,job_part_s);sw=SET_NULL_6;break;}
      if(z_p.e3s_b(s,"_WW_REAL","_WW_TEST")){w_s=_pmx_s(name_s,z_p.substring3_s(name_s,4,4),z_p.inp_out_s,job_permission_s,job_part_s);sw=SET_NULL_6;break;}
      if(z_p.e9s_b(s,"_WW_REAL_I","_WW_REAL_INP","_WW_REAL_O","_WW_REAL_OUT","_WW_TEST_I","_WW_TEST_INP","_WW_TEST_O","_WW_TEST_OUT"))
        {w_s=_pmx_s(name_s,z_p.substring3_s(name_s,4,4),z_p.substring3_s(name_s,9,1),job_permission_s,job_part_s);sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_WHERE_AND")){w_s=where_and_s;where_and_s="AND";sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_WINDOW")){w_s=z_mt_p.window_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_DRIVE_FREE")){w_s=drive_free_s;sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_DRIVE_TYPE")){w_s=drive_type_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_WMI")){w_s=wmi_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_WORK")){w_s=z_mt_p.work_s();sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_WORK_TABLE")){w_s=z_mt_p.work_table_s();sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_X")){w_s=z_p.x_s;sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_XML")){w_s=(0==z_p.count_xm_i(xm_xml_a)?"0":z_p.to_i_s((int)(z_p.at_xm(xm_xml_a,z_p.count_xm_i(xm_xml_a)-1)).xml_json));sw=SET_PLUS_NULL_5;break;}
      if(z_p.e2s_b(s,"_YEN")){w_s="\\";sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_Z_ALL_NAME")){w_s=z_mt_p.z_all_name_s("");sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_Z_ALL_NAME_VALUE")){w_s=z_mt_p.z_all_name_s("'");sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_Z_CREATE")){w_s=z_mt_p.z_create_s();sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_Z_INSERT_NAME")){w_s=z_mt_p.z_insert_name_s();sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_Z_INSERT_VALUE")){w_s=z_mt_p.z_insert_value_s();sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_Z_UPDATE_ADD")){w_s=z_mt_p.z_update_s("ADD","","");sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_Z_UPDATE_CANCEL")){w_s=z_mt_p.z_update_s("CANCEL","","");sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_Z_UPDATE_CHANGE")){w_s=z_mt_p.z_update_s("CHANGE","","");sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_(SUBSTR")){w_s=z_mt_p.db_n.substr_s+"(";sw=SET_NULL_6;break;}
      if(z_p.e2s_b(s,"_)SUBSTR")){w_s=")";sw=SET_NULL_6;break;}
      String s1="",s2="";
      int find=-1,st=1,sw_xml_json=0,sw_xml_json2=0,sw_xml_json_lp=0;
      int ed=z_p.index3c_i(name_s,'(',2);//３文字目以降に"("有りはファンクション。
      if(-1==ed)if(z_p.starts_with_b(name_s,"_(")||z_p.starts_with_b(name_s,"_)")){st=2;ed=z_p.length(name_s);} 
      if(-1!=ed)find=z_p.index2as_i(z_mt_p.db_n.s_k_a,z_p.substring3_s(name_s,st,ed-st));//ファンクション名検索 
      if(-1!=find)
        {s1=z_p.at_s(z_mt_p.db_n.s_s1_a,find);
         s2=z_p.at_s(z_mt_p.db_n.s_s2_a,find);
         if(z_p.e2s_b(s1+s2,""))s1=z_p.at_s(z_mt_p.db_n.s_k_a,find);//s1_aとs2_aが空白はk_aをセット
         if(z_p.e2s_b(s2,"")){s1+="(";s2=")";}//s2が空白はs1に"("をs2に")"を付加。
         if(1==z_p.at_i(z_mt_p.db_n.i_oracle_a,find)){s1=z_mt_p.db_n.cast_oracle1_s+s1;s2+=z_mt_p.db_n.cast_oracle2_s;}//oracle 補正対応
         if(2==st)
           {if(z_p.starts_with_b(name_s,"_(")){w_s=s1;sw=SET_NULL_6;break;} //_(...は終了
            else                              {w_s=s2;sw=SET_NULL_6;break;} //_）...は終了
           }   
        }
       if(z_p.ends_with_b(name_s,")")) //右かっこ有り。
         {int func_len=0,func_date=0,func_cnt_min=1,func_etc=0,sw_insert_update=0;
          if(-1!=find){func_len=ed+1;func_cnt_min=z_p.at_i(z_mt_p.db_n.i_cnt_a,find);}//
          else if(z_p.starts_with_b(name_s,"_CONCAT("))     {func_len=8; func_cnt_min=2;}  //VER18.1
          else if(z_p.starts_with_b(name_s,"_CONTINUE("))   {func_len=10;func_date=-1;}    //VER18.1
          else if(z_p.starts_with_b(name_s,"_DATE("))       {func_len=6; func_date=1;}     //VER18.1
          else if(z_p.starts_with_b(name_s,"_DATEDIFF_CHAR(")){func_len=15;func_cnt_min=2;} //VER36.1
          else if(z_p.starts_with_b(name_s,"_DAY_CHAR("))   {func_len=10;func_cnt_min=2;}  //VER18.1
          else if(z_p.starts_with_b(name_s,"_DAY_DATE("))   {func_len=10;func_cnt_min=2;func_date=1;}  //VER18.1
          else if(z_p.starts_with_b(name_s,"_DIV("))        {func_len=5;func_cnt_min=2;}  //VER22.1
          else if(z_p.starts_with_b(name_s,"_FIND("))       {func_len=6; func_cnt_min=2;}   //VER18.1
          else if(z_p.starts_with_b(name_s,"_FUNC("))       {func_len=6;}   //VER18.1
          else if(z_p.starts_with_b(name_s,"_JSON("))       {func_len=6;sw_xml_json=2;}   //VER24.1
          else if(z_p.starts_with_b(name_s,"_JSON_L("))     {func_len=8;sw_xml_json=2;sw_xml_json_lp=1;}   //VER24.1
          else if(z_p.starts_with_b(name_s,"_JSON_P("))     {func_len=8;sw_xml_json=2;sw_xml_json_lp=2;}   //VER24.1
          else if(z_p.starts_with_b(name_s,"_JSON2("))      {func_len=7;sw_xml_json=2;sw_xml_json2=1;}   //VER24.1
          else if(z_p.starts_with_b(name_s,"_JSON2_L("))    {func_len=9;sw_xml_json=2;sw_xml_json2=1;sw_xml_json_lp=1;}   //VER24.1
          else if(z_p.starts_with_b(name_s,"_JSON2_P("))    {func_len=9;sw_xml_json=2;sw_xml_json2=1;sw_xml_json_lp=2;}   //VER24.1
          else if(z_p.starts_with_b(name_s,"_INPUT("))      {func_len=7;func_cnt_min=3;}   //VER20.1
          else if(z_p.starts_with_b(name_s,"_L("))          {func_len=3;}   //VER20.1
          else if(z_p.starts_with_b(name_s,"_LAST_DAY_CHAR("))   {func_len=15;func_cnt_min=1;}  //VER39.1
          else if(z_p.starts_with_b(name_s,"_LEFT("))       {func_len=6;func_cnt_min=2;}  //VER39.1
          else if(z_p.starts_with_b(name_s,"_MOD("))        {func_len=5;func_cnt_min=2;}   //VER18.1
          else if(z_p.starts_with_b(name_s,"_O_IF("))       {func_len=6; func_cnt_min=-1;}   //(_O_)VER18.1
          else if(z_p.starts_with_b(name_s,"_O_INSERT("))   {func_len=10;func_cnt_min=1;sw_insert_update=1;}     //VER18.1
          else if(z_p.starts_with_b(name_s,"_O_INSERT2("))  {func_len=11;func_cnt_min=1;sw_insert_update=1;}     //VER18.1
          else if(z_p.starts_with_b(name_s,"_O_INTO("))     {func_len=8; func_cnt_min=2;}     //VER18.1
          else if(z_p.starts_with_b(name_s,"_O_SET("))      {func_len=7; func_cnt_min=-2;}   //(_O_)VER18.1
          else if(z_p.starts_with_b(name_s,"_O_SQL("))      {func_len=7;func_cnt_min=-5;}   //(_O_)VER18.1
          else if(z_p.starts_with_b(name_s,"_O_UPDATE_ADD("))    {func_len=14;func_cnt_min=1;sw_insert_update=1;}     //VER18.1
          else if(z_p.starts_with_b(name_s,"_O_UPDATE_ADD2("))   {func_len=15;func_cnt_min=1;sw_insert_update=1;}     //VER18.1
          else if(z_p.starts_with_b(name_s,"_O_UPDATE_CHANGE(")) {func_len=17;func_cnt_min=1;sw_insert_update=1;}     //VER18.1
          else if(z_p.starts_with_b(name_s,"_O_UPD_CHA(")) {func_len=11;func_cnt_min=1;sw_insert_update=1;}     //VER18.1
          else if(z_p.starts_with_b(name_s,"_O_UPDATE_CHANGE2(")){func_len=18;func_cnt_min=1;sw_insert_update=1;}     //VER18.1
          else if(z_p.starts_with_b(name_s,"_O_UPD_CHA2(")){func_len=12;func_cnt_min=1;sw_insert_update=1;}     //VER18.1
          else if(z_p.starts_with_b(name_s,"_P("))          {func_len=3;}   //VER20.1
          else if(z_p.starts_with_b(name_s,"_R("))          {func_len=3;func_cnt_min=3;}   //VER20.1
          else if(z_p.starts_with_b(name_s,"_REPEAT("))     {func_len=8;func_cnt_min=2;}   //VER22.1
          else if(z_p.starts_with_b(name_s,"_RIGHT("))      {func_len=7;func_cnt_min=2;}  //VER39.1
          else if(z_p.starts_with_b(name_s,"_ROUNDUP("))    {func_len=9; func_cnt_min=2;}  //VER18.1
          else if(z_p.starts_with_b(name_s,"_SUBSTR("))     {func_len=8; func_cnt_min=3;}  //VER18.1
          else if(z_p.starts_with_b(name_s,"_WEEK_CHAR("))  {func_len=11;}  //VER18.1
          else if(z_p.starts_with_b(name_s,"_WEEK_DATE("))  {func_len=11;func_date=1;}  //VER18.1
          else if(z_p.starts_with_b(name_s,"_XML("))        {func_len=5;sw_xml_json=1;}   //VER24.1
          else if(z_p.starts_with_b(name_s,"_XML_L("))      {func_len=7;sw_xml_json=1;sw_xml_json_lp=1;}   //VER24.1
          else if(z_p.starts_with_b(name_s,"_XML_P("))      {func_len=7;sw_xml_json=1;sw_xml_json_lp=2;}   //VER24.1
          else if(z_p.starts_with_b(name_s,"_XML2("))       {func_len=6;sw_xml_json=1;sw_xml_json2=1;}   //VER24.1
          else if(z_p.starts_with_b(name_s,"_XML2_L("))     {func_len=8;sw_xml_json=1;sw_xml_json2=1;sw_xml_json_lp=1;}   //VER24.1
          else if(z_p.starts_with_b(name_s,"_XML2_P("))     {func_len=8;sw_xml_json=1;sw_xml_json2=1;sw_xml_json_lp=2;}   //VER24.1
          else if(-1!=(func_len=z_p.index2c_i(name_s,'(')+1)){func_etc=1;}
          else func_len=-1;// 対象外
          if(func_len>-1)
            {String sss=z_p.substring3_s(name_s,func_len,z_p.length(name_s)-func_len-1); //sssに内容設定。
             if(0==func_etc&&3==func_len) //_L(,_P(	
               {if     (z_p.starts_with_b(name_s,"_L(")){w_s=z_p.lower_s(sss);sw=SET_NULL_6;break;} //_L( VER20.1　全文字の大文字を小文字に変換。
                else if(z_p.starts_with_b(name_s,"_P("))
                       {w_s=z_p.upper_s(z_p.substring3_s(sss,0,1))+z_p.lower_s(z_p.substring2_s(sss,1));sw=SET_NULL_6;break;} //_P( VER20.1　先頭を全文字以外を小文字に変換。
               }
             if(z_p.starts_with_b(sss,"(") &&z_p.ends_with_b(sss,")") //両端「()」は「()」を取って変換。  
                &&-1==z_p.index2c_i(sss,';')&&-1==z_p.index2c_i(sss,' ')) //";"と空白が無い
               {ii_zz_l ww_sss_n=new ii_zz_l();ii_zz_l ww_type_c_n=new ii_zz_l();
               if(get_data_b(ww_sss_n,ww_type_c_n,z_p.substring3_s(sss,1,z_p.length(sss)-2)))
                  {sss=ww_sss_n.s;
                   if(z_p.e2s_b(sss,"")){if(z_p.e3c_b(ww_type_c_n.c,'+','-'))sss="0";else sss=" ";} //VER27.1 空の場合数値は"0"を以外は" "を設定。
                  }//名前有りはその内容。
                 else {z_p.err_s="not found (data name) "+sss+" ("+name_s+")";z_p.t_v(z_p.PR,"get_data_b)11");return false;}//名前無はエラー。
//HP             delete ww_sss_n;delete ww_type_c_n;
               }
             if(-1==func_date){continue_s+=sss;w_s="";sw=SET_NULL_6;break;}//_CONTINUE(
             else             {sss=continue_s+sss;continue_s="";}
//===============( _O_... begin )====================================================================
             if(func_cnt_min<0)//_O_関連
               {String column_s="",ss="",add_s="",o_sep_s=" ()+-*/%=<>!,;:";
                int start=0,len=0;
                if(-5==func_cnt_min)o_sql_s="";//_O_SQL(
                if(-2==func_cnt_min)sss=z_p.replace_s_s(sss,"(=)",z_mt_p.db_n.o_from_s); //_O_SET()
                for(int ii=1;ii<z_p.length(sss);ii++)//先頭がピリオッドの場合は処理不要なのでii=1から開始。
                   if('.'==z_p.at_s_c(sss,ii))//ピリオッド発見。
                     {len=0;add_s="";
                           //if(0==ii)continue;//先頭がピリオッドの場合は処理せず。 
                      if(z_p.e4c_b(z_p.to_upper_c(z_p.at_s_c(sss,ii-1)),'C','F','W')
                         &&(1==ii||-1!=z_p.index2c_i(o_sep_s,z_p.at_s_c(sss,ii-2))))//１個前がC,F,Wの単独文字。
                        {len=1;
                         if     ('F'==z_p.to_upper_c(z_p.at_s_c(sss,ii-1)))add_s=(-5<func_cnt_min?z_mt_p.db_n.o_fd_s:z_mt_p.db_n.o_fs_s);
                                //Fは_O_FDまたは_O_FSに変更。
                         else if('W'==z_p.to_upper_c(z_p.at_s_c(sss,ii-1)))add_s=(-5<func_cnt_min?z_mt_p.db_n.o_wd_s:z_mt_p.db_n.o_ws_s);
                          //Wは_O_WDまたは_O_WSに変更。
                        }
                      else continue;//対象以外のピリオッドは処理不要。 
                      ss+=z_p.substring3_s(sss,start,ii-len-start)+add_s;start=ii+1;  //startから該当文字直前までssに設定しstartを次の位置に移動。
                      if((ii+1)==z_p.length(sss)||-1!=z_p.index2c_i(o_sep_s,z_p.at_s_c(sss,ii+1)))ss+=column_s;//列名無しは前回の列名を付加。
                      else //列名有りは列名記憶。　 
                        {int jj=start;//startより開始。
                         for(;jj<z_p.length(sss);jj++)if(-1!=z_p.index2c_i(o_sep_s,z_p.at_s_c(sss,jj)))break;//列名区切りを探す。     
                         column_s=z_p.substring3_s(sss,start,jj-start);//列名記憶。
                        }                  
                     }
                ss+=z_p.substring2_s(sss,start);//残りの分をssに設定。
                if     (-1==func_cnt_min)w_s=z_mt_p.db_n.o_if_s+ss+z_mt_p.db_n.o_then_s+" BEGIN"; //_O_IF(
                else if(-2==func_cnt_min)w_s=z_mt_p.db_n.o_set_s+ss+";"; //_O_SET(
                else {//ss=z_p.replace_s(z_p.replace_s(ss,"(_O_WHERE)",o_where_s+" AND Z_CANCEL=' '"),"(_O_WHERE2)",o_where_s);
                      w_s=ss;o_sql_s+=" "+ss;
                     } //_O_SQL(,_O_SQL_CONTINUE(
                sw=SET_NULL_6;break;
               } 
//===============( _O_... end )====================================================================
             String[] sx=z_p.split_sx(sss,';');
             int func_cnt=z_p.count_sx_i(sx);
//===============( _XML...,_JSON... )====================================================================
             if(0!=sw_xml_json) //_XML,_JSON
               {int XML=1,JSON=2,LP_L=1,LP_P=2;w_s="";
                ii_zz_l ww_sss_n=new ii_zz_l();ii_zz_l ww_type_c_n=new ii_zz_l();
                String w_sep_s="",w_end_s="",w_quote_s="";
                if(JSON==sw_xml_json){w_sep_s="{";w_end_s="}";}
                for(int ii=0;ii<func_cnt;ii++)
                  {if(!get_data_b(ww_sss_n,ww_type_c_n,sx[ii],0)){z_p.err_s="not found (data name) "+sx[ii]+" ("+name_s+")";z_p.t_v(z_p.PR,"get_data_b)12");return false;}//名前無はエラー。
                   String ssss=z_p.substring2_s(sx[ii],z_p.index2c_i(sx[ii],'.')+1); //最初の.以降
                   if     (LP_L==sw_xml_json_lp){ssss=z_p.lower_s(ssss);}
                   else {if(LP_P==sw_xml_json_lp)ssss=z_p.substring3_s(ssss,0,1)+z_p.lower_s(z_p.substring2_s(ssss,1));}
                   if(0==sw_xml_json2)
                     {if     (JSON==sw_xml_json)ww_sss_n.s=z_p.replace_s_s(z_p.replace_s_s(z_p.replace_s_s(ww_sss_n.s,"\\","\\\\"),"\"","\\\""),"/","\\/");
                      else{ww_sss_n.s=z_p.replace_s_s(z_p.replace_s_s(z_p.replace_s_s(ww_sss_n.s,"&","&amp;"),"<","&lt;"),">","&gt;");
                           if(0!=ii)ww_sss_n.s=z_p.replace_s_s(ww_sss_n.s,"\"","&quot;");
                          }
                     } 
                   w_quote_s="";
                   if(XML==sw_xml_json||(JSON==sw_xml_json&&!z_p.e4c_b(ww_type_c_n.c,'+','-','E')))
                      if(0==sw_xml_json2||XML==sw_xml_json||0==z_p.length(ww_sss_n.s)||!z_p.e2s_b(z_p.substring3_s(ww_sss_n.s,0,1),"{")
                         ||!z_p.e2s_b(z_p.substring3_s(ww_sss_n.s,z_p.length(ww_sss_n.s)-1,1),"}"))
                         w_quote_s="\""; 
                   if(0==ii&&XML==sw_xml_json){w_s+="<"+ssss;w_end_s=">"+ww_sss_n.s+"</"+ssss+">";}
                   else w_s+=w_sep_s+(XML==sw_xml_json?" ":"\"")+ssss+(XML==sw_xml_json?"=":"\":")+w_quote_s+ww_sss_n.s+w_quote_s;
                   if(JSON==sw_xml_json)w_sep_s=",";
                  }//名前有りはその内容。
                w_s+=w_end_s;
//HP            delete ww_sss_n;delete ww_type_c_n;
                sw=SET_NULL_6;break;
               }   
//===============( _XML...,_JSON... end )====================================================================
             if(func_cnt<func_cnt_min){z_p.err_s="under (parameter count) ("+z_p.to_i_s(func_cnt)+"<"+z_p.to_i_s(func_cnt_min)+")("+name_s+")";z_p.t_v(z_p.PR,"get_data_b)13");return false;}
             String[]  find_sx=new String[func_cnt];
             for(int ii=0;ii<func_cnt;ii++)
               {sx[ii]=z_p.trim_s(sx[ii]);
                if((z_p.starts_with_b(sx[ii],"(") &&z_p.ends_with_b(sx[ii],")")) //両端「()」は「()」を取って変換。  
                   ||(z_p.starts_with_b(sx[ii],"\"")&&z_p.ends_with_b(sx[ii],"\""))) //両端「"」は 「"」を取って変換。
                  {ii_zz_l ww_ss_n=new ii_zz_l();ii_zz_l ww_type_c_n=new ii_zz_l();
                   bool b=get_data_b(ww_ss_n,ww_type_c_n,z_p.substring3_s(sx[ii],1,z_p.length(sx[ii])-2));
                   String ss=ww_ss_n.s;
//HP               delete ww_ss_n;delete ww_type_c_n;         
                  if(b)find_sx[ii]=ss;//名前有りはその内容。                   
                   else {z_p.err_s="not found (data name) "+sx[ii]+" ("+name_s+")";z_p.t_v(z_p.PR,"get_data_b)14");return false;}//名前無はエラー。
                   if(z_p.starts_with_b(sx[ii],"\"")&&z_p.ends_with_b(sx[ii],"\"")) //両端「"」
                      find_sx[ii]="'"+z_mt_p.sql_string_s(find_sx[ii])+"'"; //両端に「'」を付加し文字列化。
                   if(z_p.e2s_b(find_sx[ii],"''"))find_sx[ii]="' '"; //VER27.1 ''は空白追加。
                  }
                else find_sx[ii]=sx[ii];//名前変更無し。
                if(!z_p.starts_with_b(name_s,"_R("))//VER10.1 _R(..)は純粋に文字列なので別名対応せず。
                if(z_p.starts_with_b(find_sx[ii],"."))find_sx[ii]=table_alias_s+find_sx[ii];//VER18.1 先頭が.の場合は?_T?を付加。
               } 
             if(0!=sw_insert_update)//_O_INSERT,_O_UPDATE
               {
//SJ            o_insert_update_sx=find_sx;                                    //HP対応
//HP            o_insert_update_sx.clear();
//HP            for(int i=0;i<func_cnt;i++)o_insert_update_sx.push_back(find_sx[i]);

                w_s=o_insert_update_s(z_p.substring3_s(name_s,0,func_len-1));
                sw=SET_NULL_6;break;
               }
             if(1==func_etc) //e.t.c//VER22.1
               {w_s=z_p.substring3_s(name_s,1,func_len-1)+find_sx[0];
               for(int j=1;j<func_cnt;j++)w_s+=","+find_sx[j];  
                w_s+=")";
                sw=SET_NULL_6;break;
               } 
             if(-1!=find) //VER22.1
                if(z_p.starts_with_b(name_s,"_ATAN2")){w_s=s1+find_sx[('I'==z_p.db_c?1:0)]+","+find_sx[('I'==z_p.db_c?0:1)]+s2;}//VER22.1 DB2は１と２を交換。
                else {w_s=s1+find_sx[0]; 
                      for(int j=1;j<func_cnt;j++)w_s+=","+find_sx[j]; 
                      w_s+=s2;
                      sw=SET_NULL_6;break;
                     } 
             else if(3==func_len)w_s=z_p.replace_s_s(find_sx[0],find_sx[1],find_sx[2]); //_R(//VER20.1
             else if(5==func_len)
                     if(z_p.starts_with_b(name_s,"_DIV("))w_s=z_mt_p.db_n.div1_s+find_sx[0]+"/"+find_sx[1]+z_mt_p.db_n.div2_s; //_DIV( VER22.1
                     else                                 w_s=z_mt_p.db_n.mod1_s+find_sx[0]+z_mt_p.db_n.mod2_s+find_sx[1]+z_mt_p.db_n.mod3_s; //_MOD(
              else if(6==func_len) //_FIND(,_DATE(,_FUNC(
                     {if(z_p.starts_with_b(name_s,"_LEFT(")) //_LEFT(  //VER39.1
                         w_s=(z_p.e3c_b(z_p.db_c,'O','I')?z_mt_p.db_n.substr_s:"LEFT")
                             +"("+find_sx[0]+","+(z_p.e3c_b(z_p.db_c,'O','I')?"1,":"")+find_sx[1]+")";
                      else if(0==func_date)  //_FIND(,_FIND(,_INTO(
                        if(1==func_cnt_min)  //_FUNC(
                          {w_s=find_sx[0]+"(";
                           for(int ii=1;ii<func_cnt;ii++)w_s+=(1==ii?"":",")+find_sx[ii];
                           w_s+=")";
                          }
                        else //_FIND(
                          {w_s=z_mt_p.db_n.find1_s+(!z_p.e4c_b(z_p.db_c,'D','M','P')?find_sx[0]:find_sx[1])
                           +z_mt_p.db_n.find2_s+( z_p.e4c_b(z_p.db_c,'D','M','P')?find_sx[0]:find_sx[1])
                           +z_mt_p.db_n.find3_s;
                          } 
                      else w_s=func_date_s(find_sx[0],0);//_DATE(
                     }   
              else if(7==func_len) //_INPUT(
                      if(z_p.starts_with_b(name_s,"_RIGHT(")) //_RIGHT(  //VER39.1
                         w_s=(z_p.e3c_b(z_p.db_c,'O','I')?z_mt_p.db_n.substr_s:"RIGHT")+"(RTRIM("+find_sx[0]+"),"+(z_p.e2c_b(z_p.db_c,'I')?"CHAR_":"")
                            +(z_p.e3c_b(z_p.db_c,'O','I')?"LENGTH(RTRIM("+find_sx[0]+"))-"+find_sx[1]+"+1,":"")+find_sx[1]+")";
                      else //_INPUT(
                         w_s=find_sx[2]+" <input type=\"text\" name=\""+z_p.lower_s(find_sx[0])+"\" value=\""+get_data_s("#"+find_sx[0])+"\""
                         +" size=\""+find_sx[1]+"\" maxlength=\""+find_sx[1]+"\">";
              else if(8==func_len) //_SUBSTR,_CONCAT(,_O_INTO(,_REPEAT(
                      if(z_p.starts_with_b(name_s,"_REPEAT(")) //VER22.1
                         w_s=('O'==z_p.db_c?"RPAD("+find_sx[0]+",LENGTH("+find_sx[0]+")*"+find_sx[1]+",":
                         ('M'==z_p.db_c?"REPLICATE":"REPEAT")+z_p.DUMMY_S+"(")
                         +find_sx[0]+('O'==z_p.db_c?"":","+find_sx[1])+")";
                      else if(3==func_cnt_min)//_SUBSTR
                         w_s=z_mt_p.db_n.substr_s+"("+find_sx[0]+z_mt_p.db_n.from_s+find_sx[1]+z_mt_p.db_n.for_s+find_sx[2]+")";
                      else //_CONCAT(,//_O_INTO(
                        if(z_p.starts_with_b(name_s,"_CONCAT("))
                          {w_s=z_mt_p.db_n.cl_s+find_sx[0];
                           for(int ii=1;ii<func_cnt;ii++)w_s+=z_mt_p.db_n.c_s+find_sx[ii];
                           w_s+=z_mt_p.db_n.cr_s;
                          }
                        else //_O_INTO(  
                          {o_into_s="";w_s="";
                           for(int ii=0;ii<func_cnt;ii+=2)
                             {String add_s=z_mt_p.db_n.o_ws_s;
                              if     (z_p.starts_with_b(z_p.upper_s(find_sx[ii]),"W.")) find_sx[ii]=z_p.substring2_s(find_sx[ii],2);
                              else if(z_p.starts_with_b(z_p.upper_s(find_sx[ii]),"F.")){find_sx[ii]=z_p.substring2_s(find_sx[ii],2);add_s=z_mt_p.db_n.o_fs_s;}
                              w_s+=(z_p.e2s_b(w_s,"")?"":",")+('M'==z_p.db_c?add_s+find_sx[ii]+"=":"")
                                   +(((ii+1)>=func_cnt||z_p.e2s_b(find_sx[ii+1],""))?find_sx[ii]:find_sx[ii+1]);
                              if('M'!=z_p.db_c)o_into_s+=(z_p.e2s_b(o_into_s,"")?"INTO ":",")+add_s+find_sx[ii];
                             }
                           if('D'!=z_p.db_c&&'M'!=z_p.db_c){w_s+=" "+o_into_s;o_into_s="";};
                          } 
              else if(9==func_len) //_ROUNDUP(
                      w_s="CASE WHEN "+find_sx[1]+"<0 THEN " 
                          +z_mt_p.db_n.ceil_s+"(("+find_sx[0]+")/POWER(10,0-("+find_sx[1]+")))*POWER(10,0-("+find_sx[1]+")) ELSE "
                          +z_mt_p.db_n.ceil_s+"(("+find_sx[0]+")*POWER(10,"+find_sx[1]+"))/POWER(10,"+find_sx[1]+") END";
                       //_DAY_....(　　　　　　　　　　　　　　　　　　
              else if(10==func_len) //_DAY_....(
                         w_s=z_mt_p.db_n.day1_s+(!z_p.e3c_b(z_p.db_c,'D','M')?func_date_s(find_sx[0],func_date):find_sx[1])
                             +z_mt_p.db_n.day2_s+( z_p.e3c_b(z_p.db_c,'D','M')?func_date_s(find_sx[0],func_date):find_sx[1])
                             +z_mt_p.db_n.day3_s;
              else if(15==func_len) //_LAST_DAY_CHAR(  //VER36.1
                      if(1==func_cnt_min)  //_LAST_DAY_CHAR(
                         w_s=('O'==z_p.db_c?"TO_CHAR(":"REPLACE(CAST(")+z_p.DUMMY_S+('M'==z_p.db_c?"EOMONTH(":('P'==z_p.db_c?"":"LAST_DAY("))+"CAST("+
                            ('I'==z_p.db_c||'P'==z_p.db_c?"SUBSTR("+find_sx[0]+",1,"
                            +('I'==z_p.db_c?"4)||'-'||SUBSTR("+find_sx[0]+",5,2)||'-'||SUBSTR("+find_sx[0]+",7,2)":"6)||'01'"):find_sx[0])
                            +" AS DATE)"+('P'==z_p.db_c?"+INTERVAL '1 MONTH'-INTERVAL '1 DAY'":")")
                            +('O'==z_p.db_c?",'YYYYMMDD')":" AS CHAR(10)),'-','')");
                      else  //_DATEDIFF_CHAR(
                         w_s=(z_p.e3c_b(z_p.db_c,'M','L')?"DATEDIFF("+z_p.DUMMY_S+('M'==z_p.db_c?"DAY,":""):"")+z_p.DUMMY_S+"CAST("+('M'==z_p.db_c?find_sx[0]:
                             ('I'==z_p.db_c?"SUBSTR("+find_sx[1]+",1,4)||'-'||SUBSTR("+find_sx[1]+",5,2)||'-'||SUBSTR("+find_sx[1]+",7,2)":find_sx[1]))
                            +" AS DATE)"+(z_p.e3c_b(z_p.db_c,'M','L')?",":"-") 
                            +"CAST("+('M'==z_p.db_c?find_sx[1]:
                             ('I'==z_p.db_c?"SUBSTR("+find_sx[0]+",1,4)||'-'||SUBSTR("+find_sx[0]+",5,2)||'-'||SUBSTR("+find_sx[0]+",7,2)":find_sx[0]))
                            +" AS DATE)"+(z_p.e3c_b(z_p.db_c,'M','L')?")":"");
              else //_WEEK _
                      w_s=z_mt_p.db_n.week1_s+func_date_s(find_sx[0],func_date)+z_mt_p.db_n.week2_s; 
              sw=SET_NULL_6;break;
            }
         }
  i=1;
//================( _...&...処理 )=========================
   if(0<z_p.index2c_i(name_s,'&'))  //_構成&文字列 対応
     {String left_s="";
      r_sw=-5;//初期値(-5)
      if(i>=z_p.length(name_s)){z_p.t_v(z_p.PR,"get_data_b)15");return set_data_err_b(s2_si);}
      if(z_p.e4c_b(z_p.at_s_c(name_s,i),'L','I','E')){q_s="?";egl_s=" LIKE ";l_s=z_p.to_c_s(z_p.at_s_c(name_s,i));}//q_s="?"(L,I,E),LIKE処理 
      else if('N'==z_p.at_s_c(name_s,i))r_sw=0;//r_sw=0(N)NAME処理（REMOVE含む）。
      else if('V'==z_p.at_s_c(name_s,i))q_s="?";//q_s="?"(V)VALUE処理。
      else {z_p.t_v(z_p.PR,"get_data_b)16");return set_data_err_b(s2_si);}
      if(++i>=z_p.length(name_s))return set_data_err_b(s2_si);
      if('R'==z_p.at_s_c(name_s,i)){if(-5==r_sw){r_sw=0;i++;} else {z_p.t_v(z_p.PR,"get_data_b)17");return set_data_err_b(s2_si);}}//r_sw=0(REMOVE)
      if('C'==z_p.at_s_c(name_s,i)){r_sw=-9;i++;} //r_sw=-9(CUT)
      if(i>z_p.length(name_s)){z_p.t_v(z_p.PR,"get_data_b)18");return set_data_err_b(s2_si);}
      if(z_p.e2s_b(egl_s,""))
        {if     ('E'==z_p.at_s_c(name_s,i)){egl_s="=";i++;}
         else if('G'==z_p.at_s_c(name_s,i)){egl_s=">";if(++i<z_p.length(name_s))if('E'==z_p.at_s_c(name_s,i)){eg_s="=";i++;}} 
         else if('L'==z_p.at_s_c(name_s,i))
                {egl_s="<";
                 if(++i<z_p.length(name_s))
                   {if(     'E'==z_p.at_s_c(name_s,i)){eg_s="=";i++;}
                    else if('G'==z_p.at_s_c(name_s,i)){eg_s=">";i++;}
                   }
                } 
        }
      if(i>=z_p.length(name_s)){z_p.t_v(z_p.PR,"get_data_b)19");return set_data_err_b(s2_si);}
      if('&'!=z_p.at_s_c(name_s,i)){z_p.t_v(z_p.PR,"get_data_b)20");return set_data_err_b(s2_si);}
      i++;
      String s1_s_s=z_p.substring2_s(name_s,i);
      String s2_s_s=z_p.substring2_s(name_s,i);
      if(0==r_sw)r_sw=z_p.last_index2c_i(s1_s_s,'.');//r_sw=0は最後の"."までr_swを移動。
      int sw2=0; //プログラム制御２
      if(z_p.e2s_b(q_s,"?"))  //データ名を値に変換。
        {if(z_p.starts_with_b(s1_s_s,"$"))
            if(set_old_data_data_b(z_p.substring2_s(s1_s_s,1)))sw2=1; //VER23.1
         if(0==sw2)
           {if     (set_data_data_b(s1_s_s,da_data_a))sw2=1;
            else if(set_data_data_b(s1_s_s,da_set_a)) sw2=1;
            else if(set_data_data_b(s1_s_s,da_work_a))sw2=1;
            else if(set_old_data_data_b(s1_s_s))sw2=1; //VER23.1
            else {z_p.t_v(z_p.PR,"get_data_b)21");return set_data_err_b(s2_si);}
           } 
        }
      else s2_s_s=z_mt_p.set_alias_column_name_s(s2_s_s);//列名変換
      if(1==sw2)
        {ww_da_work_data_p=da_set_data_data_p;s2_s_s=set_data_data_s;type_c_ni.c=set_data_type_c;
         s2_s_s=z_mt_p.sql_data_s(ww_da_work_data_p,l_s);
        }
      if(-5==r_sw)s1_s_s=z_mt_p.set_alias_column_name_s(s1_s_s);//列名変換
      w_s=left_s+(-9==r_sw?"":z_p.substring2_s(s1_s_s,(-1>r_sw?0:++r_sw)))+egl_s+eg_s+s2_s_s;//VER23.1 left_s追加。
      sw=SET_OK_7;break;
     }
   if(z_p.starts_with_b(name_s,"_A_"))
     {w_s="";
      if(z_p.length(name_s)==4)
         if('A'<=z_p.at_s_c(name_s,3)&&'Z'>=z_p.at_s_c(name_s,3))                           
           {w_s=z_p.to1_i_s(z_p.to_c_i(z_p.at_s_c(name_s,3))-z_p.to_c_i('A')+1);sw=SET_PLUS_NULL_5;break;}  

      z_p.t_v(z_p.PR,"get_data_b)22");
      return set_data_err_b(s2_si);
     } 
   if(z_p.starts_with_b(name_s,"_A")&&2<z_p.length(name_s))
     {w_s="";i=z_p.to_int_check(z_p.substring2_s(name_s,2),'-',0,1);
      if(z_p.length(name_s)>2&&z_p.return_b)
        {if(0<i&&27>i){w_s=z_p.to_c_s((char )(z_p.to_c_i('A')+i-1));sw=SET_NULL_6;break;}}
     z_p.t_v(z_p.PR,"get_data_b)23"); 
     return set_data_err_b(s2_si);
     } 
   if(z_p.starts_with_b(name_s,"_NAME"))//_NAME##//VER18.1
     {if(z_p.e3s_b(name_s,"_NAME##","_NAME$$")){w_s="";sw=SET_NULL_6;break;}
      i=z_p.to_int_check(z_p.substring2_s(name_s,5),'-',0,1);
      if(z_p.length(name_s)>5&&z_p.return_b)
        {if(1>i||z_p.count_da_i(da_data_a)<=i){z_p.err_s="bad number count["+z_p.to_i_s(i)+"]";z_p.t_v(z_p.PR,"get_data_b)24");return false;}}
      else {z_p.t_v(z_p.PR,"get_data_b)25");return set_data_err_b(s2_si);}
      w_s=(z_p.at_da(da_data_a,i)).name_s;//VER18.1
      sw=SET_NULL_6;break;
     } 
   if(z_p.starts_with_b(name_s,"_SELECT"))//_SELECT##
     {if(z_p.e3s_b(name_s,"_SELECT##","_SELECT$$")){w_s="SELECT ' '";sw=SET_NULL_6;break;}
      i=z_p.to_int_check(z_p.substring2_s(name_s,7),'-',0,1);
      if(z_p.length(name_s)>7&&z_p.return_b)
       {if(1>i||z_p.count_da_i(da_data_a)<=i){z_p.err_s="bad number count["+z_p.to_i_s(i)+"]";z_p.t_v(z_p.PR,"get_data_b)26");return false;}}
      else {z_p.t_v(z_p.PR,"get_data_b)27");return set_data_err_b(s2_si);}
      w_s=(z_p.e2s_b(name_s,"_SELECT1")?"SELECT "+(z_p.e2s_b(sql_select_s,"")?"":z_mt_p.edit_s(sql_select_s)+" "):",")+select_s(z_p.at_da(da_data_a,i));//VER18.1
      sw=SET_NULL_6;break;
     } 
   if(z_p.starts_with_b(name_s,"_O_TABLE"))
     {i=z_p.to_int_check(z_p.substring2_s(name_s,8),'-',0,1)-1;
      if(0>i||z_p.count_sx_i(o_table_sx)<=i)w_s="?????";
      else w_s=o_table_sx[i];
      sw=SET_NULL_6;break;
     } 
   if(z_p.starts_with_b(name_s,"_EXE_PARAMETER"))
     {w_s="";
      i=z_p.to_int_check(z_p.substring2_s(name_s,14),'-',0,1);
      if(!z_p.return_b)                                                                                    //HP未対応
         if(0<i
//SJ           && null !=z_p.parameter_sx
               &&(i-1)<z_p.count_sx_i(z_p.parameter_sx))w_s=z_p.parameter_sx[i-1]; //HP応

      sw=SET_NULL_6;break;
     } 
   if(z_p.starts_with_b(name_s,"_ORDER_BY"))
     {w_s=(z_p.e2s_b(name_s,"_ORDER_BY1")?"ORDER BY 1":(z_p.e3s_b(name_s,"_ORDER_BY##","_ORDER_BY$$")?" ":","
      +z_p.substring2_s(name_s,9)));sw=SET_NULL_6;break;
     } 
   if(z_p.starts_with_b(name_s,"_ORDER"))
     {if(z_p.e3s_b(name_s,"_ORDER##","_ORDER$$")){w_s=" ";order_by_s="ORDER BY ";sw=SET_NULL_6;break;}
      i=z_p.to_int_check(z_p.substring2_s(name_s,6),'-',0,1);
      if(z_p.length(name_s)>6&&z_p.return_b)
        {if(z_p.e2s_b(cube_rollup_s,""))//VER22.1 
           {if(1==i)order_by_s="ORDER BY ";//VER18.1
            String desc_s="";
            if(z_p.count_da_i(da_data_a)>i)
              {if(z_p.e2s_b((z_p.at_da(da_data_a,i)).mark3_s,"C")){w_s="";sw=SET_NULL_6;break;}
               else if(z_p.e2s_b((z_p.at_da(da_data_a,i)).mark3_s,"D"))desc_s=" DESC";  
              }
            w_s=order_by_s+z_p.substring2_s(name_s,6)+desc_s;order_by_s=",";
           }
         else w_s=(1==i?cube_rollup_s:"");//VER22.1
         sw=SET_NULL_6;break;
        }
     } 
   if(z_p.starts_with_b(name_s,"_GROUP"))
     {if(z_p.e3s_b(name_s,"_GROUP##","_GROUP$$")){w_s=" ";group_by_s="GROUP BY ";sw=SET_NULL_6;break;}
      i=z_p.to_int_check(z_p.substring2_s(name_s,6),'-',0,1);
      if(z_p.length(name_s)>6&&z_p.return_b)
        {if(1==i)
            {cube_rollup_s="";  //VER18.1
             group_by_s="GROUP BY ";
               if     (1==CONTROL_IX[C_CUBE_31])
                      {group_by_s+=(z_p.e2s_b(z_mt_p.db_n.cube1_s,"")?"":z_mt_p.db_n.cube1_s+"(");cube_rollup_s=(z_p.e2s_b(z_mt_p.db_n.cube2_s,"")?")":z_mt_p.db_n.cube2_s+" ");} //VER22.1
               else if(1==CONTROL_IX[C_ROLLUP_30])
                      {group_by_s+=(z_p.e2s_b(z_mt_p.db_n.rollup1_s,"")?"":z_mt_p.db_n.rollup1_s+"(");cube_rollup_s=(z_p.e2s_b(z_mt_p.db_n.rollup2_s,"")?")":z_mt_p.db_n.rollup2_s+" ");} //VER2.1.1
            }
         if(z_p.count_da_i(da_data_a)>i)if(!z_p.e2s_b((z_p.at_da(da_data_a,i)).mark4_s,"G")){w_s="";sw=SET_NULL_6;break;}
         w_s=group_by_s+select_s(z_p.at_da(da_data_a,i));//VER18.1
         group_by_s=",";
         sw=SET_NULL_6;break;
        }
     } 
   if(z_p.starts_with_b(name_s,"_SQL_VALUE_"))
     {i=z_p.to_int_check(z_p.substring2_s(name_s,11),'-',0,1);
      if(z_p.length(name_s)>11&&z_p.return_b)
        {if(1>i){z_p.err_s="bad _SQL_VALUE_["+z_p.to_i_s(i)+"]";z_p.t_v(z_p.PR,"get_data_b)28");return false;}}
      else {z_p.t_v(z_p.PR,"get_data_b)29");return set_data_err_b(s2_si);}
      if(z_p.count_s_i(s_sql0_a)<i)w_s="";else w_s=z_p.at_s(s_sql0_a,--i);
      i=1+i%sql_column_cnt_ix[0]; 
      if(z_p.count_da_i(da_data_a)>i)type_c_ni.c=z_p.at_s_c((z_p.at_da(da_data_a,i)).type1_s,0);
      sw=SET_NULL_6;break;
     }
   if(z_p.starts_with_b(name_s,"_MP_") ||z_p.starts_with_b(name_s,"_MX_")    //_WM_...,_MX..処理
    ||z_p.starts_with_b(name_s,"_WP_") ||z_p.starts_with_b(name_s,"_WX_"))    //_WP_...,_WX_...
     {if((8)==z_p.length(name_s))//_MP_AAAA
        {w_s=_pmx_s(name_s,z_p.real_test_s,z_p.inp_out_s,z_p.substring3_s(name_s,4,4),job_part_s);sw=SET_NULL_6;break;}
      if((13)==z_p.length(name_s)&&'_'==z_p.at_s_c(name_s,8))//_MP_REAL_AAAA
        {w_s=_pmx_s(name_s,z_p.substring3_s(name_s,4,4),z_p.inp_out_s,z_p.substring3_s(name_s,9,4),job_part_s);sw=SET_NULL_6;break;}
      if('M'==z_p.at_s_c(name_s,2)){z_p.t_v(z_p.PR,"get_data_b)30");return set_data_err_b(s2_si);}
      if((10)==z_p.length(name_s)&&'_'==z_p.at_s_c(name_s,5))//_WP_O_AAAA
        {w_s=_pmx_s(name_s,z_p.real_test_s,z_p.substring3_s(name_s,4,1),z_p.substring3_s(name_s,6,4),job_part_s);sw=SET_NULL_6;break;}
      if((12)==z_p.length(name_s)&&'_'==z_p.at_s_c(name_s,7))//_WP_OUT_AAAA
        {w_s=_pmx_s(name_s,z_p.real_test_s,z_p.substring3_s(name_s,4,3),z_p.substring3_s(name_s,8,4),job_part_s);sw=SET_NULL_6;break;}
      if((15)==z_p.length(name_s)&&'_'==z_p.at_s_c(name_s,8)&&'_'==z_p.at_s_c(name_s,10))//_WP_REAL_O_AAAA
        {w_s=_pmx_s(name_s,z_p.substring3_s(name_s,4,4),z_p.substring3_s(name_s,9,1),z_p.substring3_s(name_s,11,4),job_part_s);sw=SET_NULL_6;break;}
      if((17)==z_p.length(name_s)&&'_'==z_p.at_s_c(name_s,8)&&'_'==z_p.at_s_c(name_s,12))//_WP_REAL_OUT_AAAA
        {w_s=_pmx_s(name_s,z_p.substring3_s(name_s,4,4),z_p.substring3_s(name_s,9,3),z_p.substring3_s(name_s,13,4),job_part_s);sw=SET_NULL_6;break;}
      z_p.t_v(z_p.PR,"get_data_b)31");return set_data_err_b(s2_si);
     }
   if(z_p.starts_with_b(name_s,"_MA_"))  // VER22.1 テーブル略称判定
     {rc=z_mt_p.sql_n.sql_dbo_zzzz1("SELECT SYSTEM_ETC FROM "
                 +z_mt_p.sql_n.m_real_dbo_zzzzzz_s()+"_ETC_TABLE WHERE SYSTEM_KEY1='ZZZZZZ_PART2:"+z_p.menu_permission_s+z_p.part_s+"'"
                 +" AND SYSTEM_KEY2='"+z_p.substring2_s(name_s,4)+"' AND Z_CANCEL=' '");
      if(0!=rc||0==z_p.count_s_i(z_mt_p.sql_n.s_sql_a))
        {z_p.err_s="("+name_s+") not found ZZZZZZ_ETC_TABLE/ZZZZZZ_PART2:"+z_p.menu_permission_s+z_p.part_s+"/"+z_p.substring2_s(name_s,4);
         z_p.t_v(z_p.PR,"get_data_b)32");return false;
        };
      String ss=z_p.at_s(z_mt_p.sql_n.s_sql_a,0);    
      w_s=_pmx_s("_MP",z_p.real_test_s,"",z_p.substring3_s(ss,0,4),job_part_s)+z_p.substring3_s(ss,4,2);sw=SET_NULL_6;break; 
     }
   if(z_p.starts_with_b(name_s,"_UNION_ALL"))
     {if(z_p.e4s_b(name_s,"_UNION_ALL1","_UNION_ALL##","_UNION_ALL$$"))w_s="";
      else w_s="UNION ALL";
      sw=SET_NULL_6;break;
     }
   if(z_p.starts_with_b(name_s,"_UNION"))
     {if(z_p.e4s_b(name_s,"_UNION1","_UNION##","_UNION$$"))w_s="";
      else w_s="UNION";
      sw=SET_NULL_6;break;
     }
   if(z_p.starts_with_b(name_s,"_FROM"))                       //_FROM 処理
     {if(z_p.e3s_b(name_s,"_FROM##","_FROM$$")){w_s=" ";sw=SET_NULL_6;break;}
      else
        {i=z_p.to_int_check(z_p.substring2_s(name_s,5),'-',0,1);
         if(z_p.length(name_s)>5&&z_p.return_b)
           {if(1>i||z_p.count_s_i(s_join_a)<i)
              {z_p.err_s="over (_FROM"+z_p.to_i_s(i)+" > _FROM_COUNT("+z_p.to_i_s(z_p.count_s_i(s_join_a))+"))";z_p.t_v(z_p.PR,"get_data_b)33");return false;}
            z_p.x_s=z_mt_p.alias_s(z_p.at_s(s_join_alias_my_a,i-1)); //_Xの設定
            ii_zz_l ww_s_n=new ii_zz_l();
            w_s=z_p.at_s(s_join_a,i-1);z_mt_p.edit_b(ww_s_n,w_s);w_s=ww_s_n.s;
//HP        delete ww_s_n;
            sw=SET_NULL_6;break;
           }
        }
     }
   if(z_p.starts_with_b(name_s,"_WHERE"))                       //_WHERE 処理
     {if(z_p.e3s_b(name_s,"_WHERE##","_WHERE$$")){w_s=" ";where_and_s="WHERE";sw=SET_NULL_6;break;}
      else
        {i=z_p.to_int_check(z_p.substring2_s(name_s,6),'-',0,1);
         if(z_p.length(name_s)>6&&z_p.return_b)
          {if(1>i||z_p.count_da_i(da_set_a)<=i)
             {z_p.err_s="over (_WHERE"+z_p.to_i_s(i)+" > _SET_COUNT("+z_p.to_i_s(z_p.count_da_i(da_set_a)-1)+"))";z_p.t_v(z_p.PR,"get_data_b)34");return false;}
           if(1==i)where_and_s="WHERE";//_WHERE1では_WHERE_ANDを'WHERE'にする。
           if(z_p.e2s_b(z_p.trim_s((z_p.at_da(da_set_a,i)).where_s),""))w_s="";
           else{w_s=" "+where_and_s+(z_p.e2s_b(where_and_s,"AND")?"  ":"")+"("+z_p.trim_s((z_p.at_da(da_set_a,i)).where_s)+")";
                where_and_s="AND";//_WHERE_ANDを'AND'にする。
               }
           sw=SET_NULL_6;break;  
          }
        }
     }
   if(z_p.starts_with_b(name_s,"_LEFT"))                       //_LEFT 処理
     {if(z_p.e3s_b(name_s,"_LEFT##","_LEFT$$")){w_s=" ";sw=SET_NULL_6;break;}
      else
        {i=z_p.to_int_check(z_p.substring2_s(name_s,5),'-',0,1);
         if(z_p.length(name_s)>5&&z_p.return_b)
           {if(1>i||z_p.count_da_i(da_data_a)<=i)
              {z_p.err_s="over (_LEFT"+z_p.to_i_s(i)+" > _DATA_COUNT("+z_p.to_i_s(z_p.count_da_i(da_data_a)-1)+"))";z_p.t_v(z_p.PR,"get_data_b)35");return false;}
            //ii_zz_l w_sya_n=new ii_zz_l();ii_zz_l w_at_n=new ii_zz_l();ii_zz_l w_ast_n=new ii_zz_l();ii_zz_l w_amp_n=new ii_zz_l();
            z_p.x_s=z_mt_p.alias_s(w_sya_n,w_at_n,w_ast_n,w_amp_n,(z_p.at_da(da_data_a,i))); //_Xの設定
            if(0!=w_ast_n.i||0==w_amp_n.i||0!=w_at_n.i||0!=w_sya_n.i)
              {w_s="";sw=SET_NULL_6;break;} //'別名に'&'無し、または'*','@','#'有りは空白とします。
              if(!(z_p.starts_with_b((z_p.at_da(da_data_a,i)).dictionary_check_s,"SECTION2")
                 ||z_p.starts_with_b((z_p.at_da(da_data_a,i)).dictionary_check_s,"SELECT2") //VER19.1
                 ||z_p.starts_with_b((z_p.at_da(da_data_a,i)).dictionary_check_s,"LISTBOX2")))
                {w_s="";sw=SET_NULL_6;break;} //該当ＣＨＥＣＫ以外は無処理
            w_s="LEFT OUTER JOIN "+(z_p.at_da(da_data_a,i)).dictionary_table_s+" ?_X?"+z_p.new_line_s()
               +" ON  "+z_mt_p.set_alias_s(z_p.trim_s((z_p.at_da(da_data_a,i)).name_s))+"."
               +z_p.dot_string_s((z_p.at_da(da_data_a,i)).name_s)
               +"=?_X?."+(z_p.at_da(da_data_a,i)).dictionary_left_s;
            ii_zz_l ww_s_n=new ii_zz_l();
            z_mt_p.edit_b(ww_s_n,w_s);w_s=ww_s_n.s;
//HP        delete ww_s_n;
            sw=SET_NULL_6;break;  
           }
        }
     }
   i=z_p.to_int_check(z_p.substring2_s(name_s,1),'-',0,1);
   if(z_p.length(name_s)>1&&z_p.return_b)//"_"+数値
      {if(1>i||z_p.count_da_i(da_data_a)<=i){z_p.err_s="bad (data count["+z_p.to_i_s(i)+"])";z_p.t_v(z_p.PR,"get_data_b)36");return false;}
       w_s=z_mt_p.set_alias_column_name_s((z_p.at_da(da_data_a,i)).name_s);sw=SET_NULL_6;break;
      } 
     }
   i=0;
   if(z_p.length(name_s)<2){sw=SKIP_2;break;}
   int link_sw=0;
   if(z_p.starts_with_b(name_s,"^"))
     {link_sw=1;
      int j=z_p.index2c_i(name_s,'_');
      if(2>j||j+1==z_p.length(name_s))name_s="@ZZZZZZ_LINK_"+z_p.substring2_s(name_s,1)
         +"_"+z_p.substring3_s(z_p.real_test_s,0,1)+'_'+job_permission_s;
      else name_s="@ZZZZZZ_LINK_"+z_p.substring3_s(name_s,1,j-1)+"_"+z_p.substring3_s(z_p.real_test_s,0,1)
         +'_'+z_p.substring2_s(name_s,j+1);
     }
   if(z_p.starts_with_b(name_s,"@"))
     {if('F'==z_mt_p.program_c){z_p.err_s="bad (data name file-job @..) ("+s2_si+")";z_p.t_v(z_p.PR,"get_data_b)37");return false;}
      find_name_i=i;bool b=find_name_b(z_p.substring2_s(name_s,1),z_p.da_fix_a);
      i=find_name_i;ww_da_work_data_p=da_find_name_data_p;
      if(b)
        {if(1==link_sw){w_s="I_"+z_p.system_s+"_"+ww_da_work_data_p.data_s;sw=SET_NULL_6;break;}
         sw=SET_DATA_4;break;
        }
      if(0!=CONTROL_IX[C_ERROR_5]){w_s="";sw=SET_NULL_6;break;}
      z_p.t_v(z_p.PR,"get_data_b)38");
      return set_data_err_b(s2_si);
     }
   if(z_p.starts_with_b(name_s,"&"))
     {find_name_i=i;
      bool b=find_name_b((z_p.starts_with_b(name_s,"&.")?"&"+table_alias_s+z_p.substring2_s(name_s,1):name_s),da_table_a);
      i=find_name_i;ww_da_work_data_p=da_find_name_data_p;
      if(b){sw=SET_DATA_4;break;}
      else {z_p.t_v(z_p.PR,"get_data_b)39");return set_data_err_b(s2_si);}
     }
   if(z_p.starts_with_b(name_s,"$"))
     {if('T'==z_mt_p.program_c){z_p.err_s="bad (data name time-job $..) ("+s2_si+")";z_p.t_v(z_p.PR,"get_data_b)40");return false;}
      bool b=set_old_data_data_b(z_p.substring2_s(name_s,1));
      w_s=set_data_data_s;type_c_ni.c=set_data_type_c;
      if(b){sw=SET_NULL_6;break;}
      if(z_p.e3s_b(name_s,"$_SQL_COUNT","$_SQL_COLUMN")||z_p.starts_with_b(name_s,"$_SQL_VALUE_"))
        {if(z_p.e3s_b(name_s,"$_SQL_COUNT","$_SQL_COLUMN")){w_s="0";sw=SET_PLUS_NULL_5;} //(VER9.2)//
         else {w_s="";sw=SET_NULL_6;} //(VER9.2)//
         for(int j=z_p.count_pr_i(z_mt_p.program_list_n.pr_a)-2;0<=j;j--)
           {if(z_p.e2s_b((z_p.at_pr(z_mt_p.program_list_n.pr_a,j)).program_s,"NOT"))continue;
            if(z_p.starts_with_b(name_s,"$_SQL_VALUE_"))
              {i=z_p.to_int_check(z_p.substring2_s(name_s,12),'-',0,1);
               if(z_p.length(name_s)>12&&z_p.return_b)
                 {if(1>i){z_p.t_v(z_p.PR,"get_data_b)41");return set_data_err_b(s2_si);}}
               else {z_p.t_v(z_p.PR,"get_data_b)42");return set_data_err_b(s2_si);}
               if(z_p.count_s_i((z_p.at_pr(z_mt_p.program_list_n.pr_a,j)).s_sql0_a)>=i) //HP 未対応
                  w_s=z_p.at_s((z_p.at_pr(z_mt_p.program_list_n.pr_a,j)).s_sql0_a,--i);  //HP 未対応
               i=1+i%(z_p.at_pr(z_mt_p.program_list_n.pr_a,j)).sql_column_cnt_ix[0]; 
               if((z_p.at_pr(z_mt_p.program_list_n.pr_a,j)).z_p.count_da_i(da_data_a)>i)
               type_c_ni.c=z_p.at_s_c((z_p.at_da((z_p.at_pr(z_mt_p.program_list_n.pr_a,j)).da_data_a,i)).type1_s,0);
               //sw=SET_NULL_6;break;//(VER9.2)//
               break;//(VER9.2)//
              }
         if(z_p.e2s_b(name_s,"$_SQL_COUNT"))
           {w_s=z_p.to_i_s(z_p.at_pr(z_mt_p.program_list_n.pr_a,j).sql_record_cnt_ix[0]);sw=SET_PLUS_NULL_5;break;} 
         if(z_p.e2s_b(name_s,"$_SQL_COLUMN"))
           {w_s=z_p.to_i_s(z_p.at_pr(z_mt_p.program_list_n.pr_a,j).sql_column_cnt_ix[0]);sw=SET_PLUS_NULL_5;break;} 
           }
         break;//(VER9.2)//
        }
      z_p.t_v(z_p.PR,"get_data_b)43");return set_data_err_b(s2_si);
     }
   if(z_p.starts_with_b(name_s,"#"))
     {if('T'==z_mt_p.program_c&&0==z_p.sw_cgi){z_p.err_s="bad (data name time-job #..) ("+s2_si+")";z_p.t_v(z_p.PR,"get_data_b)44");return false;}
      find_name_i=i;bool b=find_name_b(name_s,z_p.da_common_a);//VER20.1
      i=find_name_i;ww_da_work_data_p=da_find_name_data_p;
      if(b){sw=SET_DATA_4;break;}
        else
        {if(1==sw_ii){z_p.err_s="not found (data name) (#"+s2_si+")";z_p.t_v(z_p.PR,"get_data_b)45");return false;}//sw_ii =1は＃無しエラー 
         w_s="";sw=SET_NULL_6;break;
        }
     }
   if(z_p.starts_with_b(name_s,"!"))
     {if('T'==z_mt_p.program_c){z_p.err_s="bad (data name time-job !..) ("+s2_si+")";z_p.t_v(z_p.PR,"get_data_b)46");return false;}
      if(z_p.starts_with_b(now_kind_s,"STOP")){z_p.err_s="bad (data name STOP.. !..) ("+s2_si+")";z_p.t_v(z_p.PR,"get_data_b)47");return false;}
#if IMENU
      get_keep(z_p.substring2_s(name_s,1));
      if(2==z_p.count_s_i(z_mt_p.sql_n.s_sql_a)&&z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_sql_a,1),""))w_s=z_p.at_s(z_mt_p.sql_n.s_sql_a,0);
      else w_s=""; 
#endif //MENU
      sw=SET_NULL_6;break;
     }
   break;
  }//for(;;)
if(SKIP_2>=sw)
  {if     (set_data_data_b(name_s,da_data_a))sw=SET_DATA_DATA_OK_3;
   else if(set_data_data_b(name_s,da_set_a)) sw=SET_DATA_DATA_OK_3;
   else if(set_data_data_b(name_s,da_work_a))sw=SET_DATA_DATA_OK_3;
   else {z_p.t_v(z_p.PR,"get_data_b)48");return set_data_err_b(s2_si);}
  }
if(SET_DATA_DATA_OK_3>=sw){ww_da_work_data_p=da_set_data_data_p;w_s=set_data_data_s;type_c_ni.c=set_data_type_c;sw=SET_OK_7;}
if(SET_DATA_4>=sw)
  {w_s=ww_da_work_data_p.data_s;
   type_c_ni.c=(1>z_p.length(ww_da_work_data_p.type1_s)?' ':z_p.at_s_c(ww_da_work_data_p.type1_s,0));
   sw=SET_OK_7;
  }
if(SET_PLUS_NULL_5>=sw)type_c_ni.c='+';
if(SET_NULL_6>=sw)ww_da_work_data_p= null ;
if(SET_OK_7>=sw)
  {s_ni.s=w_s;
   if(0!=sw_position_length)//部分指定  //VER 36.000600003
     {if(1>position)
        {if(0==length)s_ni.s="";
         else
           {int sta=0,end=0;
            if(0==position&&0==unicode_length_sw) //物理桁数計算
              {for(sta=z_p.length(w_s)-length;sta<z_p.length(w_s);sta++)
                 {if(!z_p.low_code_b(w_s,sta))break;
                 }
              }
            else    //UNICODE桁数計算
              {end=(0==position?length:0-position);
               for(sta=z_p.length(w_s)-1;0<sta;sta--)
                 {if(z_p.low_code_b(w_s,sta))continue;
                  end--;
                  if(0==end)break; 
                 }
              }
           if(0!=length&&0!=position)
             {//z_p.console_write_v("position="+position+",length="+length+",end="+end+",sta="+sta);
              if(1<end){end--;if(length>end)length-=end;else length=0;}//左オーバー分補正
             } 
           if(0==length)s_ni.s="";
           else 
           if(0==position||-1==length)s_ni.s=z_p.substring2_s(w_s,sta);
           else
              {if(0==unicode_length_sw)
                 {for(end=sta+length-1;0<end;end--)
                    {if((end+1)<z_p.length(w_s))
                        if(z_p.low_code_b(w_s,end+1))continue;
                      break; 
                    }
                 } 
               else 
                 {int len=length;
                   for(end=sta;z_p.length(w_s)>end;end++)
                    {if(z_p.low_code_b(w_s,end+1))continue;
                     len--;
                     if(0==len)break; 
                    }
                  for(;z_p.length(w_s)>end;end++)
                    {if((end+1)<z_p.length(w_s))if(z_p.low_code_b(w_s,end+1))continue;
                     break; 
                    }
                 } 
               if(sta==end)s_ni.s="";else s_ni.s=z_p.substring3_s(w_s,sta,end-sta+1);
              }
           }
        }
         else s_ni.s=z_p.set_unicode_s(w_s,position,length,unicode_length_sw); //VER 36.000600003
     }
   if(!z_p.e2s_b(property_s,""))
     {if     (z_p.e2s_b(property_s,"@COUNT"))        {s_ni.s=z_p.to1_i_s(z_p.unicode_length(s_ni.s));type_c_ni.c='+';}
      else if(z_p.e2s_b(property_s,"@FORM_LENGTH"))  {s_ni.s=z_p.to1_i_s(z_p.form_length(s_ni.s));type_c_ni.c='+';}
      else if(z_p.e2s_b(property_s,"@LENGTH"))       {s_ni.s=z_p.to1_i_s(z_p.length(s_ni.s));type_c_ni.c='+';}
      else if(z_p.e2s_b(property_s,"@LOWER"))        {s_ni.s=z_p.lower_s(s_ni.s);type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@UPPER"))        {s_ni.s=z_p.upper_s(s_ni.s);type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@ARG"))          {s_ni.s=z_p.arg_set_s(s_ni.s);type_c_ni.c=' ';}
  //    else if(z_p.e2s_b(property_s,"@COMMAND"))      {s_ni.s=z_p.command_set_s(s_ni.s);type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@CODE"))         {s_ni.s=(z_p.e2s_b(s_ni.s,"")?"1":""+z_p.kind_code(z_p.at_s_c(s_ni.s,0)));type_c_ni.c='+';}
      else if(z_p.e2s_b(property_s,"@CODE39"))       {s_ni.s=z_p.code39_s(s_ni.s);type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@DATE_GOOD"))    {s_ni.s=z_p.date_good_s(s_ni.s,0);type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@DATETIME"))     {s_ni.s=z_p.date_time_edit_s(s_ni.s,2);type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@DATETIME_GOOD")){s_ni.s=z_p.date_time_good_s(s_ni.s);type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@DIGIT11"))      {s_ni.s=z_p.digit11_s(s_ni.s);type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@EDIT_ERROR"))   {z_mt_p.edit_b(s_ni,s_ni.s);type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@FULL_SIZE"))    {s_ni.s=z_p.full_size_s(s_ni.s);type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@JAN"))          {s_ni.s=z_p.jan_s(s_ni.s);type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@NEXT"))         {s_ni.s=z_p.next_s(s_ni.s);type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@SPACE"))        {s_ni.s="";for(i=0;i<z_p.length(s_ni.s);i++)s_ni.s+=(' '>z_p.at_s_c(s_ni.s,i)?' ':z_p.at_s_c(s_ni.s,i));}
      else if(z_p.e2s_b(property_s,"@SPACE_ERASE"))  {s_ni.s=z_p.replace_s_s(s_ni.s," ","");type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@TRIM"))         {s_ni.s=z_p.trim_s(s_ni.s);type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@URL_DECODE"))   {s_ni.s=z_p.url_decode_s(s_ni.s,url_encode_decode_s);type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@URL_ENCODE"))   {s_ni.s=z_p.url_encode_s(s_ni.s,url_encode_decode_s);type_c_ni.c=' ';}
      else if( null ==ww_da_work_data_p){z_p.t_v(z_p.PR,"get_data_b)49");return set_data_err2_b(property_s);}
      else if(z_p.e2s_b(property_s,"@LENGTH0")){s_ni.s=z_p.to1_i_s(ww_da_work_data_p.length0);type_c_ni.c='+';}
      else if(z_p.e2s_b(property_s,"@LENGTH1")){s_ni.s=z_p.to1_i_s(ww_da_work_data_p.length1);type_c_ni.c='+';}
      else if(z_p.e2s_b(property_s,"@LENGTH2")){s_ni.s=z_p.to1_i_s(ww_da_work_data_p.length2);type_c_ni.c='+';}
      else if(z_p.e2s_b(property_s,"@MARK1"))  {s_ni.s=z_p.to_c_s(ww_da_work_data_p.mark1_c);type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@MARK2"))  {s_ni.s=z_p.to_c_s(ww_da_work_data_p.mark2_c);type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@MARK3"))  {s_ni.s=ww_da_work_data_p.mark3_s;           type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@MARK4"))  {s_ni.s=ww_da_work_data_p.mark4_s;           type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@OLD"))    {s_ni.s=ww_da_work_data_p.data_save_s;type_c_ni.c=(1>z_p.length(ww_da_work_data_p.type1_s)?' ':z_p.at_s_c(ww_da_work_data_p.type1_s,0));} 
      else if(z_p.e2s_b(property_s,"@SELECT")) {s_ni.s=ww_da_work_data_p.select_s;          type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@TITLE"))  {s_ni.s=ww_da_work_data_p.title_s;           type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@TYPE1"))  {s_ni.s=ww_da_work_data_p.type1_s;           type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@TYPE2"))  {s_ni.s=z_p.to_c_s(ww_da_work_data_p.type2_c);type_c_ni.c=' ';}
      else if(z_p.e2s_b(property_s,"@WHERE"))  {s_ni.s=ww_da_work_data_p.where_s;           type_c_ni.c=' ';}
      else {z_p.t_v(z_p.PR,"get_data_b)50");return set_data_err2_b(property_s);}
     } 
  }
if(0==tokusyu_sw){z_p.t_v(z_p.PR,"get_data_b)51");return true;} 
s_ni.s=s_s+sep_s+(z_p.e2s_b(quote_s,"'")?z_mt_p.db_n.n_s:"")+quote_s+lt_s+(z_p.e2s_b(quote_s,"")&&z_p.e2s_b(s_ni.s,"")?"0":"")+s_ni.s
     +rt_s+quote_s;
z_p.t_v(z_p.PR,"get_data_b)52");
return true;
}
//====( select_s() ==
String select_s(ii_data_l i_ni)
{da_now_p=i_ni;//編集する為da_now_pを設定。
return (z_p.e2s_b(z_p.trim_s(i_ni.select_s),"")?z_mt_p.set_alias_column_name_s(i_ni.name_s):z_mt_p.edit_s(z_p.trim_s(i_ni.select_s)));//SELECT=無しはデータ名を使用,SELECT=有りはその内容を編集し使用 。
}
String o_insert_update_s(String si)
{z_p.t_v(z_p.PR,"o_insert_update_s(");
String add_s="",ss="",sss="";
for(int ii=0;ii<z_p.count_sx_i(o_insert_update_sx);ii++)
  {add_s=z_mt_p.db_n.o_ws_s;
   if     (z_p.starts_with_b(z_p.upper_s(o_insert_update_sx[ii]),"W.")) o_insert_update_sx[ii]=z_p.substring2_s(o_insert_update_sx[ii],2);
   else if(z_p.starts_with_b(z_p.upper_s(o_insert_update_sx[ii]),"F.")){o_insert_update_sx[ii]=z_p.substring2_s(o_insert_update_sx[ii],2);add_s=z_mt_p.db_n.o_fs_s;}
   if(z_p.starts_with_b(si,"_O_INSERT"))
     {ss +=(z_p.e2s_b(ss ,"")?"(":",")+o_insert_update_sx[ii];
      sss+=(z_p.e2s_b(sss,"")?" VALUES(":",")+add_s+o_insert_update_sx[ii];
     }
   else ss+=(z_p.e2s_b(ss ,"")?"SET ":",")+o_insert_update_sx[ii]+"="+add_s+o_insert_update_sx[ii];
  }
if     (z_p.e2s_b(si,"_O_UPDATE_ADD"))   ss+=","+z_mt_p.z_update_s("ADD","",""); 
else if(z_p.e2s_b(si,"_O_UPDATE_CHANGE"))ss+=","+z_mt_p.z_update_s("CHANGE","",""); 
else if(z_p.e2s_b(si,"_O_INSERT"))      {ss+=","+z_mt_p.z_insert_name_s();sss+=","+z_mt_p.z_insert_value_s();} 
z_p.t_v(z_p.PR,"o_insert_update_s)");
return ss+(z_p.starts_with_b(si,"_O_INSERT")?")"+sss+")":"");
}
bool set_data_err_b(String s_si){z_p.err_s="not found (data name) ("+s_si+") ";return false;}
bool set_data_err2_b(String property_s){z_p.err_s="not found (property name) ("+property_s+") ";return false;}

//----------------------------------------------
//-**( 0=ng（対象でない）,1=next_b(不採用),2=loop（採用）,9=error sw_check_b(i_ii) )***
int sw_check_b(int i_ii,String s1_si,String s2_si)
{int i=0;
 //i_ii文字数以内に"="が来た場合は対象外。
for(i=0;i<i_ii;i++)if(z_p.length(z_p.prog_s_n.s)<=(z_p.prog_n.i+i)||'='==z_p.at_s_c(z_p.prog_s_n.s,z_p.prog_n.i+i))return 0; 
 //文字数と次に'+'か'-'が有る場合は判定。
char c=' ';
for(i=0;(z_p.prog_n.i+i_ii+i)<z_p.length(z_p.prog_s_n.s);i++)
   if(z_p.e2c_b(z_p.at_s_c(z_p.prog_s_n.s,z_p.prog_n.i+i_ii+i),' '))continue;//空白は次を判定。
   else
   if(z_p.e3c_b(c=z_p.at_s_c(z_p.prog_s_n.s,z_p.prog_n.i+i_ii+i),'+','-'))//'+'か'-'を発見。
     {if(z_p.prog_left_b(s1_si)||(!z_p.e2s_b(s2_si,"")&&z_p.prog_left_b(s2_si)))
        {z_p.prog_n.i+=1+i;return   ('+'==c?2:1);} //s1_siかｓ2_siと文字が一致　("+"採用=2,"-"不採用=1)。
      z_p.prog_n.i+=1+i+i_ii;return ('-'==c?2:1); //s1_siかｓ2_siと文字が不一致("-"採用=2,"+"不採用=1)。
     }
   else break;//空白,'+','-'以外が有る場合は対象外と判定。
return 0;//対象外の判定
}
//---（前のプログラムを探す　)-------------------------------------------
bool set_old_data_data_b(String name_si)
{int i;
da_set_data_data_p= null ;set_data_data_s="";set_data_type_c=' ';
String name_s;
if(z_p.length(name_si)>0)
  {if(1==z_p.count_pr_i(z_mt_p.program_list_n.pr_a))return false;//VER23.1(true->false)
   for(i=z_p.count_pr_i(z_mt_p.program_list_n.pr_a)-2;0<=i;i--)
     {name_s=(z_p.starts_with_b(name_si,"&.")?"&"+(z_p.at_pr(z_mt_p.program_list_n.pr_a,i)).table_alias_s
              +z_p.substring2_s(name_si,1):name_si);
      if(set_data_data_b(name_s,(z_p.at_pr(z_mt_p.program_list_n.pr_a,i)).da_data_a))return(true);
      if(set_data_data_b(name_s,(z_p.at_pr(z_mt_p.program_list_n.pr_a,i)).da_set_a))return(true);
      if(set_data_data_b(name_s,(z_p.at_pr(z_mt_p.program_list_n.pr_a,i)).da_work_a))return(true);
      if(set_data_data_b(name_s,(z_p.at_pr(z_mt_p.program_list_n.pr_a,i)).da_table_a))return(true);
     }
  }
return(false);  
}
#if IMENU
//----------------------------------------------
public bool now_kind_b()
{return z_p.e5s_b(now_kind_s,"DATA","SET","PASSWORD","START"); 
}
//----------------------------------------------
public void display_msg_v(String s_si)
{
msg_data_n.data_s=s_si;display_msg_v(-1);
}
//----------------------------------------------
//--(sw_ii 0=空白表示,-1=sw_err無視,1=MESSAGE OR ERROR)---
public void display_msg_v(int sw_ii)
{if(z_p.e2s_b(now_kind_s,"PASSWORD"))return;
ii_zz_l ww_ss_n=new ii_zz_l();
if(0==sw_ii)
   {msg_data_n.org_Brush_n=z_p.Brush_n('N');
    msg_data_n.data_s="";
   }
else if(-1==sw_ii)msg_data_n.org_Brush_n=z_p.Brush_n(z_p.e2s_b(msg_data_n.data_s,"")?'N':'L');
else if(z_p.SW_OFF_0==z_mt_p.sw_err)
  {z_mt_p.edit_b(ww_ss_n,da_now_p.message_s);
   msg_data_n.data_s=ww_ss_n.s;
   msg_data_n.org_Brush_n=z_p.Brush_n(z_p.e2s_b(msg_data_n.data_s,"")?'N':'L');
  }
else
  {msg_data_n.org_Brush_n=z_p.Brush_n('R');
   msg_data_n.data_s=z_p.err_s;
   if(!z_p.e2s_b(z_p.db_error_s,"")){z_mt_p.trace_v(0,"*?(DB_ERROR)?*"+z_p.db_error_s);} //VER36.1
   z_mt_p.trace_v(0,"*?(ERROR)?*"+z_p.err_s); //VER36.1
  }
display_v(0,msg_data_n,2,4);
//HP delete ww_ss_n;
}
String get_sql_select_s(String s_si,int lock_ii)
{ii_zz_l ww_ss_n=new ii_zz_l();
 z_mt_p.edit_b(ww_ss_n,table_s);table_edit_s=ww_ss_n.s;
//HP delete ww_ss_n;
return "SELECT "+s_si+" FROM "+table_edit_s+(1==lock_ii?" "+z_mt_p.db_n.lock1_s:"") //VER37.6.0.17
   +" WHERE"+sql_data_all_s(" AND ",'K',1,"")+(1==lock_ii?z_mt_p.db_n.lock2_s:"");
}
//----------------------------------------------
//=******( SQL文 データ項目設定 )*****
String sql_data_s(ii_zz_l sep_s_ni,ii_data_l data_ni,String sep_si,int name_ii,String chg_si)
{String sep_s=sep_s_ni.s,eq_s;
if(z_p.e2s_b(chg_si,"CHANGE")&&z_p.e2s_b(program_s,"INPUT")) //saveデータと一致した場合更新しない。
  {if(z_p.e2s_b(data_ni.data_s,data_ni.data_save_s))return ""; 
   else if(data_ni.compare_save_b(data_ni.data_s))return "";
  }
sep_s_ni.s=sep_si;
eq_s=(z_p.e2s_b(data_ni.type1_s,"E")&&z_p.e2s_b(data_ni.data_s,"")?" IS ":"=");
return sep_s+(1==name_ii?z_p.dot_string_s(data_ni.name_s)+eq_s:"")+z_mt_p.sql_data_s(data_ni,"");
}
//----------------------------------------------
//=******( SQL文 データ項目設定 全体)*****
public String sql_data_all_s(String sep_si,char mark_ci,int name_ii,String chg_si)
{
int i;String w_s="";ii_zz_l ww_sep_s_n=new ii_zz_l();ww_sep_s_n.s=" ";
if('K'==mark_ci) //SET=のキーは更新キーとして使用。
   for(i=1;z_p.count_da_i(da_set_a)>i;i++)
      if('K'==(z_p.at_da(da_set_a,i)).mark1_c) //mark1_cが'K'のみ対象
         w_s+=sql_data_s(ww_sep_s_n,z_p.at_da(da_set_a,i),sep_si,name_ii,chg_si); 
for(i=1;z_p.count_da_i(da_data_a)>i;i++) //DATA=の項目設定。
  {if(mark_ci==(z_p.at_da(da_data_a,i)).mark1_c) //mark1_cがmark_ciの物のみ対象
      w_s+=sql_data_s(ww_sep_s_n,z_p.at_da(da_data_a,i),sep_si,name_ii,chg_si); 
  }
//HP delete ww_sep_s_n; 
return w_s;
}
#endif //MENU
//----------------------------------------------
public ii_program_l(ii_z_l z_ni,ii_z_mt_l z_mt_ni,ii_program_l program_ni)
{
z_p=z_ni;z_mt_p=z_mt_ni;
//#####(new)#####
w_name_name_n=new ii_zz_l();w_name2_name_n=new ii_zz_l();w_name_copy_s_n=new ii_zz_l();
w_s_n=new ii_zz_l();w_data_dummy_s_n=new ii_zz_l(); 
w_compute_s_n=new ii_zz_l();w_compute_type_c_n=new ii_zz_l();
w_sya_n=new ii_zz_l();w_at_n=new ii_zz_l();w_ast_n=new ii_zz_l();w_amp_n=new ii_zz_l();
#if IMENU
paint_list_n=new ii_paint_list_l(z_p,z_mt_p);
#endif 
//###############
for(int i=0;i<6;i++)
  {sql_record_cnt_ix[i]=0;sql_cnt_ix[i]=0;sql_column_cnt_ix[i]=0;sw_sql_ix[i]=0;}
da_work_section_p= null ;da_work_data_p= null ;
da_set_data_data_p= null ;da_find_name_data_p= null ;
//***(***)***
sw_sql_ix[0]=sw_sql_ix[1]=sw_sql_ix[2]=sw_sql_ix[3]=sw_sql_ix[4]=0;
z_p.err11_s="";z_p.err21_s="";
for(int i=0;2>i;i++)
  {read_nx[i]=new ii_read_l(z_p);write_nx[i]=new ii_write_l(z_p);
   serialport_nx[i]= null ;
  }

dir_n=new ii_dir_l(z_p);dir_dir_n=new ii_dir_l(z_p);
section_n=new ii_section_l(z_p,z_mt_p);
z_p.add_da(da_etc_a,new ii_data_l(" BEGIN",z_p));  
#if IMENU
keyboard_n=new ii_keyboard_l(z_p,z_mt_p);
z_p.add_da(da_data_a,new ii_data_l("_START",z_p));
(z_p.at_da(da_data_a,0)).length0=1;
(z_p.at_da(da_data_a,0)).length1=1;
(z_p.at_da(da_data_a,0)).title_s="_START";
z_p.add_da(da_etc_a,new ii_data_l(" STOP_BEFORE",z_p));//STOP_BEFORE_1 
z_p.add_da(da_etc_a,new ii_data_l(" STOP_AFTER",z_p)); //STOP_AFTER_2
z_p.add_da(da_etc_a,new ii_data_l("_END",z_p));//END_3
z_p.add_da(da_etc_a,new ii_data_l(" SQL",z_p));//SQL_4
z_p.add_da(da_etc_a,new ii_data_l(" COLOR",z_p));//COLOR_5
z_p.add_da(da_etc_a,new ii_data_l(" JUDGE","","9",2,1,1,1,0,z_p));//JUDGE_6 
(z_p.at_da(da_etc_a,JUDGE_6)).title_s=" JUDGE";
z_p.add_da(da_set_a,new ii_data_l("_DUMMY","","!",2,1,2,2,0,z_p));
msg_data_n=new ii_data_l(z_p);msg_data_n.length0=77;msg_data_n.length1=77;
if( null !=program_ni)
  {login_password_s=program_ni.login_password_s;
   login_id_s=program_ni.login_id_s;
   sw_security_b=program_ni.sw_security_b;
  }
#endif //MENU
}
//*********( パスワード判定及びジョブ判定 sw_ii(0=全て実行,1=パスワード判定迂回しジョブ判定のみ実行) )*******
public bool password_b(int sw_ii)
{
#if IMENU
int error_count=0;
#endif //MENU
String person_s="",password_s="";
if(0==z_p.sw_cgi)
  {person_s  =(z_p.at_da(z_p.da_security_a,PERSON_0)).data_s;
   password_s=(z_p.at_da(z_p.da_security_a,PASSWORD_1)).data_s; 
  }
else
  {person_s  =z_p.upper_s(z_p.person_cgi_s);
   password_s=z_p.upper_s(z_p.password_cgi_s);
  }
String password_check_s="";
String set_s="SYSTEM_USE_DATE17="+z_mt_p.db_n.now17_s+",SYSTEM_USE_COMPUTER="+z_mt_p.sql_char_s(z_p.computer_s); //VER27.1
if(1!=sw_ii)//=****( パスワード チェック )*****
  {if(0!=z_mt_p.sql_n.sql_dbo_zzzz1(
   "SELECT "
     +z_p.DUMMY_S+('D'==z_p.db_c?"CAST(":"")//VER13.0 JDBCバグ対応
     +z_p.DUMMY_S+"SYSTEM_PASSWORD"
     +z_p.DUMMY_S+('D'==z_p.db_c?" AS VARCHAR(16))":"")//VER13.0 JDBCバグ対応
     +z_p.DUMMY_S+",SYSTEM_SECURITY_MARK,SYSTEM_PERSON_NAME,"
     +z_p.DUMMY_S+('D'==z_p.db_c?"CAST(":"")//VER13.0 JDBCバグ対応
     +z_p.DUMMY_S+"SYSTEM_PERMISSION"
     +z_p.DUMMY_S+('D'==z_p.db_c?" AS VARCHAR(4))":"")//VER13.0 JDBCバグ対応
     +z_p.DUMMY_S+",CASE WHEN SYSTEM_BEGIN_DATE>"+z_mt_p.db_n.now8_s+" THEN SYSTEM_BEGIN_DATE "
     +z_p.DUMMY_S+" WHEN SYSTEM_END_DATE!=' ' AND SYSTEM_END_DATE<"+z_mt_p.db_n.now8_s+" THEN SYSTEM_END_DATE"
     +z_p.DUMMY_S+" WHEN SYSTEM_PASSWORD_LIMIT_DATE!=' ' AND SYSTEM_PASSWORD_LIMIT_DATE<"+z_mt_p.db_n.now8_s
     +z_p.DUMMY_S+" THEN 'LIMIT' ELSE ' ' END"
     +z_p.DUMMY_S+",SYSTEM_ERROR_COUNT FROM "+z_mt_p.sql_n.m_real_dbo_zzzzzz_s()
     +z_p.DUMMY_S+"_I_SECURITY_TABLE WHERE SYSTEM_PERSON="+z_mt_p.sql_char_s(person_s)//VER20.1
     +z_p.DUMMY_S+" AND SYSTEM_SECURITY_MARK IN('PERSON','ADMIN','GUEST') AND Z_CANCEL=' '"))
      return false;
   if(1!=z_p.db_record_cnt)return false;
#if IMENU
if(0==z_p.sw_cgi)
  {display_v((z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_sql_a,4),"LIMIT")?"Change Password":
      //有効日表示
      (!z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_sql_a,4),"")?"Person "+z_p.date_time_edit_s(z_p.at_s(z_mt_p.sql_n.s_sql_a,4),1):""))
      ,2,10+(z_p.at_da(z_p.da_security_a,PASSWORD_1)).column+z_mt_p.txt_password_cnt,17 //VER20.1
      ,(z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_sql_a,4),"")?'N':'R'));
      error_count=z_p.to_int_check(z_p.at_s(z_mt_p.sql_n.s_sql_a,5),'+',5,0); //エラー回数int化
   if(5==error_count||z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_sql_a,4),"LIMIT")) //パスワード入力画面表示
      z_mt_p.process_i("ZZZZ010121","ZZZZZZ_ARG_PERSON="+z_p.arg_set_s(person_s) //VER20.1
       ,"REAL");
   display_v((error_count>0?z_p.at_s(z_mt_p.sql_n.s_sql_a,5)+"/5":"") //エラー回数表示
      ,2,6+(z_p.at_da(z_p.da_security_a,PASSWORD_1)).column+z_mt_p.txt_password_cnt,3
      ,(error_count<5?'N':'R'));
   if(error_count>4)return false; //エラー回数５回に到達のためこれ以上先に進まない。
  }
#endif //MENU
   if(!z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_sql_a,4),""))return false;   //期限切れ。
   password_check_s=z_p.password_n.pwd_s(person_s,z_p.setup_s //VER20.1
      ,password_s);//VER20.1
   String pass_s=z_p.at_s(z_mt_p.sql_n.s_sql_a,0);
   for(;z_p.length(pass_s)<16;)pass_s+=" ";//最後の空白付加し１６文字で比較する。
   //z_p.console_write_v(password_check_s);
   //z_p.console_write_v(pass_s);
   if(!z_p.e2s_b(password_check_s,pass_s)) //パスワード不一致
     {
#if IMENU
      if(0==z_p.sw_cgi)
       {if(error_count<5)z_mt_p.sql_n.sql_dbo_zzzz1("UPDATE "+z_mt_p.sql_n.m_real_dbo_zzzzzz_s()
        +"_I_SECURITY_TABLE SET "+set_s+",SYSTEM_ERROR_COUNT=SYSTEM_ERROR_COUNT+1 WHERE SYSTEM_PERSON="
          +z_mt_p.sql_char_s(person_s));//VER20.1
        error_count++;
        display_v(""+z_p.to_i_s(error_count)+"/5" //エラー回数表示
         ,2,6+(z_p.at_da(z_p.da_security_a,PASSWORD_1)).column+z_mt_p.txt_password_cnt,3
         ,(error_count<5?'N':'R'));
       }
#endif //MENU
      return false; 
     }
#if IMENU
   error_count=0; 
#endif //MENU
   z_p.person_security_s=z_p.at_s(z_mt_p.sql_n.s_sql_a,1);
   z_p.person_name_s=z_p.at_s(z_mt_p.sql_n.s_sql_a,2);
   z_p.person_permission_s=z_p.at_s(z_mt_p.sql_n.s_sql_a,3);
   if(!z_p.e2s_b(z_p.person_s,person_s))//VER20.1
     {z_p.person_s=person_s;}//VER20.1
#if IMENU
if(0==z_p.sw_cgi)display_v(z_p.person_name_s,1,1,16,'N');  //名前表示
   z_mt_p.pass_date_s=z_p.substring3_s(z_p.date_time_s(z_p.date_time_now_s(),0),0,8);
#endif //MENU
  }
//=****( JOB CHECK 不要者判定 )*****
if(!security_check_b())//=****( job check )*****
  {if(0!=z_mt_p.sql_n.sql_dbo_zzzz1("SELECT CASE WHEN SYSTEM_BEGIN_DATE>"+z_mt_p.db_n.now8_s+" THEN SYSTEM_BEGIN_DATE "
      +" WHEN SYSTEM_END_DATE!=' ' AND SYSTEM_END_DATE<"+z_mt_p.db_n.now8_s+" THEN SYSTEM_END_DATE ELSE ' ' END FROM "
      +z_mt_p.sql_n.m_real_dbo_zzzzzz_s()+"_I_SECURITY_J_TABLE WHERE SYSTEM_PERSON="
      +z_mt_p.sql_char_s(person_s)+" AND SYSTEM_JOB='"+z_p.job_s+"' AND Z_CANCEL=' '"))//VER20.1
      return false;
   if(1>z_p.db_record_cnt)//=****( group check )***** 
     {if(0!=z_mt_p.sql_n.sql_dbo_zzzz1(
      "SELECT CASE WHEN SYSTEM_BEGIN_DATE>"+z_mt_p.db_n.now8_s+" THEN SYSTEM_BEGIN_DATE "
      +" WHEN SYSTEM_END_DATE!=' ' AND SYSTEM_END_DATE<"+z_mt_p.db_n.now8_s
      +" THEN SYSTEM_END_DATE ELSE ' ' END,G2.SYSTEM_GROUP FROM "
      +z_mt_p.sql_n.m_real_dbo_zzzzzz_s()+"_I_SECURITY_G_TABLE G2,"
      +z_mt_p.sql_n.m_real_dbo_zzzzzz_s()+"_I_SECURITY_G_J_TABLE G3 WHERE SYSTEM_PERSON="
       +z_mt_p.sql_char_s(person_s)+" AND SYSTEM_JOB='"+z_p.job_s //VER20.1
      +"' AND G2.SYSTEM_GROUP=G3.SYSTEM_GROUP AND G2.Z_CANCEL=' ' AND G3.Z_CANCEL=' ' ORDER BY 1"))return false;
      if(1>z_p.db_record_cnt)return false;
      
        if(!z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_sql_a,0),""))   //期限切れ。
          {
#if IMENU
           if(0==z_p.sw_cgi)display_v("Group "+z_p.date_time_edit_s(z_p.at_s(z_mt_p.sql_n.s_sql_a,0),1),2
           ,10+(z_p.at_da(z_p.da_security_a,PASSWORD_1)).column+z_mt_p.txt_password_cnt,17,'R'); //期限切れ表示
#endif
           return false;   //期限切れ。
          }
      z_mt_p.sql_n.sql_dbo_zzzz1("UPDATE "+z_mt_p.sql_n.m_real_dbo_zzzzzz_s()+"_I_SECURITY_G_TABLE SET "+set_s
        +" WHERE SYSTEM_PERSON="+z_mt_p.sql_char_s(person_s)+" AND SYSTEM_GROUP=" //VER20.1
      +z_mt_p.sql_char_s(z_p.at_s(z_mt_p.sql_n.s_sql_a,1)));
     }
   else
     { if(!z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_sql_a,0),""))   //期限切れ。
        {
#if IMENU
    if(0==z_p.sw_cgi)
            display_v("Job "+z_p.date_time_edit_s(z_p.at_s(z_mt_p.sql_n.s_sql_a,0),1),2
           ,10+(z_p.at_da(z_p.da_security_a,PASSWORD_1)).column+z_mt_p.txt_password_cnt,17,'R'); //期限切れ表示
#endif
         return false;   //期限切れ。
        }
      z_mt_p.sql_n.sql_dbo_zzzz1("UPDATE "+z_mt_p.sql_n.m_real_dbo_zzzzzz_s()+"_I_SECURITY_J_TABLE SET "+set_s
        +"  WHERE SYSTEM_PERSON="+z_mt_p.sql_char_s(person_s)+" AND SYSTEM_JOB='"//VER20.1
        +z_p.job_s+"'");
     }
  }
//=****( group check )*****
z_mt_p.sql_n.sql_dbo_zzzz1("UPDATE "+z_mt_p.sql_n.m_real_dbo_zzzzzz_s()+"_I_SECURITY_TABLE SET "+set_s+
   ",SYSTEM_ERROR_COUNT=0 WHERE SYSTEM_PERSON=" //VER27.1
     +z_mt_p.sql_char_s(person_s)); //VER20.1
#if IMENU
paint_list_n.remove_v(2);
#endif
sw_security_b=true;
return true;
}
//----------------------------------------------
//=****( JOB CHECK 不要者判定 )*****
bool security_check_b()
 //管理者またはメニューがPで使用者の場合
{if(z_p.e2s_b(z_p.person_security_s,"ADMIN")||(z_p.e2s_b(z_p.menu_security_s,"P")&&z_p.e2s_b(z_p.person_security_s,"PERSON")))
     //メニューがZZZZ又は使用者の許可と一致した場合はOK
if(z_p.e3s_b(z_p.menu_permission_s,"ZZZZ",z_p.person_permission_s))return true;
if(z_p.e2s_b(z_p.test_s,"TEST")&&!z_p.e2s_b(z_p.person_security_s,"GUEST")&& //テスト中（ゲスト以外）
   (z_p.e3s_b(z_p.person_permission_s,"ZZZZ",z_p.menu_permission_s)
   ||z_p.e3s_b(z_p.menu_permission_s,"ZZZZ",z_p.person_permission_s)))
      if(!z_p.e2s_b(z_p.menu_security_s,"A")||z_p.e2s_b(z_p.person_security_s,"ADMIN"))return true;
return false;
}
//----------------------------------------------
#if IMENU
public void display_time_v()
{z_mt_p.time_s=z_p.substring3_s(z_p.date_time_edit_s(z_mt_p.sql_n.sql_time_s(),1),0,16);
display_v(z_mt_p.time_s,1,62,16,'N');//時間表示
}
public void set_record_cnt_first_v(){set_record_cnt_v(0);}
public void set_record_cnt_v(){set_record_cnt_v(1);}
void set_record_cnt_v(int sw_ii)
{record_cnt=form_max*(page_now-1)+line_now;
if(0==sw_ii)line_cnt=column_cnt=1;
else record_cnt+=line_cnt-1+(column_cnt-1)*line_occurs; 
}
public int section_color()
{if(!z_p.e4s_b(now_kind_s,"DATA","SQL","START"))return 0;
String save_now_kind_s=now_kind_s,save_real_test_s=z_p.real_test_s,save_sw_trace_s=z_p.sw_trace_s;
int rc;now_kind_s="COLOR";
z_p.sw_trace_s="0";
rc=section_n.section("COLOR",z_p.at_da(da_etc_a,COLOR_5),0);
now_kind_s=save_now_kind_s;z_p.real_test_s=save_real_test_s;
z_p.sw_trace_s=save_sw_trace_s;
return rc;
}
//----------------------------------------------
//=*******( スクロール分位置移動 )***********************
public bool scroll_set_b(ii_zz_l x_ni,ii_zz_l y_ni)
{if(1==sw_y_scroll)//縦スクロール指示。
  {if(y_ni.i<scroll_y_line_top)return true;//scroll_y_line_topより前は移動せず。
   y_ni.i-=scroll_y_offset;//scroll_y_offset分移動。
   if(y_ni.i<scroll_y_line_top)return false;//scroll_y_line_topより前は処理不要とする。
  }
  //横スクロール指示無しまたはclick_set_bottom以前は処理せず。
if(0==sw_x_scroll||y_ni.i<=click_set_bottom)return true;
x_ni.i-=scroll_x_offset;//scroll_x_offset分移動。
if(x_ni.i>form_x_max)return false;//form_x_maxより右は処理不要。
return true;
}
//----------( !名前抜き出し )------------------------------
public int get_keep(String name_si)
{return z_mt_p.sql_n.sql_dbo_zzzz_real_test("SELECT SYSTEM_KEEP,Z_CANCEL FROM "+z_mt_p.sql_n.m_real_dbo_zzzzzz_s()
   +"_KEEP_TABLE WHERE SYSTEM_COMPUTER="
   +z_mt_p.sql_char_s(z_p.computer_s)+" AND SYSTEM_NAME="+z_mt_p.sql_nchar_s(name_si));
}
//---------( !名前キープ )------------------------------
public bool set_keep_b(String name_si,String data_si)
{if(z_p.form_length(name_si)>30){z_p.err_s="over (from length(NAME)>30) (!"+name_si+")";return false;}
 if(z_p.form_length(data_si)>80){z_p.err_s="over (from length(VALUE)>80) (!"+name_si+")";return false;}
get_keep(name_si);
if(2!=z_p.count_s_i(z_mt_p.sql_n.s_sql_a))
  {if(0!=z_mt_p.sql_n.sql_dbo_zzzz_real_test("INSERT INTO "+z_mt_p.sql_n.m_real_dbo_zzzzzz_s()
     +"_KEEP_TABLE("+z_mt_p.z_insert_name_s()+",SYSTEM_COMPUTER,SYSTEM_NAME,SYSTEM_KEEP)VALUES("
     +z_mt_p.z_insert_value_s()+","+z_mt_p.sql_char_s(z_p.computer_s)+","
     +z_mt_p.sql_nchar_s(name_si)+","+z_mt_p.sql_nchar_s(data_si)+")"))return false;
  }
else
  {if(0!=z_mt_p.sql_n.sql_dbo_zzzz_real_test("UPDATE "+z_mt_p.sql_n.m_real_dbo_zzzzzz_s()+"_KEEP_TABLE SET "
     +z_mt_p.z_update_s((z_p.e2s_b(z_p.at_s(z_mt_p.sql_n.s_sql_a,1),"")?"CHANGE":"ADD"),"","")+",SYSTEM_KEEP="
     +z_mt_p.sql_nchar_s(data_si)+" WHERE SYSTEM_COMPUTER="+z_mt_p.sql_char_s(z_p.computer_s)
     +" AND SYSTEM_NAME="+z_mt_p.sql_nchar_s(name_si)))return false;
  }
return true;
}
#endif
//----------(計算結果は i_ni.i に設定される )------------------------------------
readonly String COMP_S="+-*/%";
int compute=0; 
public bool compute_b(String s_si){return compute_b(s_si,0);}
public bool compute_b(String s_si,int i_i)
{String[] sx_x?=?{"",""};
int i=0,i1=0,i2=0;compute=0;
if(-1!=(i=z_p.index3sc_i(s_si,COMP_S,0)))//演算子発見 
  {if(-1!=z_p.index3sc_i(z_p.substring2_s(s_si,i+1),COMP_S,0))
     {z_p.err_s="only one ("+COMP_S+")";return false;}//演算子は１個まで。
   sx_x=z_p.split_sx(s_si,z_p.at_s_c(s_si,i));//発見した文字で分割。
   if(!get_data_b(w_compute_s_n,w_compute_type_c_n,sx_x[0])){z_p.err_s="not found (data name) ("+sx_x[0]+") ";return false;}
   i1=z_p.to_int_check(z_p.trim_s(w_compute_s_n.s),'-',0,0);if(!z_p.return_b){z_p.err_s="not numeric ("+z_p.trim_s(w_compute_s_n.s)+")";return false;}
   if(!get_data_b(w_compute_s_n,w_compute_type_c_n,sx_x[1])){z_p.err_s="not found (data name) ("+sx_x[1]+") ";return false;}
   i2=z_p.to_int_check(z_p.trim_s(w_compute_s_n.s),'-',0,0);if(!z_p.return_b){z_p.err_s="not numeric ("+z_p.trim_s(w_compute_s_n.s)+")";return false;}
   if     ('+'==z_p.at_s_c(s_si,i))i1+=i2;
   else if('-'==z_p.at_s_c(s_si,i))i1-=i2;
   else if('*'==z_p.at_s_c(s_si,i))i1*=i2;
   else                 i1/=i2;
  }
else
  {if(!get_data_b(w_compute_s_n,w_compute_type_c_n,s_si)){z_p.err_s="not found (data name) ("+s_si+") ";return false;}
   i1=z_p.to_int_check(z_p.trim_s(w_compute_s_n.s),'-',0,0);
   if(!z_p.return_b){z_p.err_s="not numeric ("+z_p.trim_s(w_compute_s_n.s)+")";return false;}
  }
if(i_i==0)if(0>i1){z_p.err_s="not plus ("+s_si+"="+z_p.to_i_s(i1)+")";return false;}
compute=i1;
return true;
}

public int section(String kind_si,int cnt_ii)
{
z_p.t_v(z_p.PR,"section(");
int rc=0;
save_now_kind_s=now_kind_s;
da_save_now_ap=da_now_ap;
save_now_cnt=now_cnt;
now_kind_s=kind_si;da_now_ap=da_etc_a;now_cnt=cnt_ii;
if(!z_p.e2s_b(section_nld_kind_s,now_kind_s))//前回の同じ場合はトレースせず。
  {z_mt_p.trace_v(0,"*=("+z_p.to1_i_s(z_p.count_pr_i(z_mt_p.program_list_n.pr_a))+","+now_kind_s+")=*");section_nld_kind_s=now_kind_s;}
z_p.set_s=(z_p.e2s_b(now_kind_s,"SET")?"S":"");//SET=では先頭をSに変更
rc=section_n.section(modori_prog);modori_prog=0;
if(-2==z_p.sw_program){modori_prog=z_p.prog_n.i;modori_now_kind_s=kind_si;}//SECTION_1内で設定すると設定できない場合が有るのでここで設定。
now_kind_s=save_now_kind_s;
da_now_ap=da_save_now_ap;
now_cnt=save_now_cnt;
z_p.t_v(z_p.PR,"section)");
return rc; 
}
public void set_line_column_v()
{line=line_start+line_offset*(line_cnt-1);column=column_offset*(column_cnt-1);
}
//----------------------------------------------
public bool  read_etc_b()
{
z_p.t_v(z_p.PR2,"read_etc_b(");
find_name_i=0;int j=0;
if(!z_mt_p.init_sw_b())return false;
if(!z_mt_p.init_fix_b())return false;
if(!find_name_b("ZZZZZZ_VERSION1",z_p.da_fix_a)){z_p.err_s="not found (data name) (@ZZZZZZ_VERSION1)";return false;}
j=z_p.to_int_check(da_find_name_data_p.data_s,'+',0,0);if(!z_p.return_b){z_p.err_s="not numeric (@ZZZZZZ_VERSION1)";return false;}
if(j!=z_p.version_n.VERSION1){z_p.err_s="not e (@ZZZZZZ_VERSION1("+z_p.to_i_s(j)+") != "+z_p.to_i_s(z_p.version_n.VERSION1)+")";return false;}
if(!z_p.e7s_b(z_p.job_s,"ZZZZ010511","ZZZZ010531","ZZZZ010121","ZZZZ010137","ZZZZ404040","ZZZZ010440"))
  {if(!find_name_b("ZZZZZZ_VERSION2",z_p.da_fix_a)){z_p.err_s="not found (data name) (@ZZZZZZ_VERSION2)";return false;}
   j=z_p.to_int_check(da_find_name_data_p.data_s,'+',0,0);
   if(!z_p.return_b){z_p.err_s="not numeric (@ZZZZZZ_VERSION2)";return false;}
   int k=z_p.to_int_check(z_p.version_n.VERSION2_S,'+',0,0);
   if(!z_p.return_b){z_p.err_s="not numeric (VERSION2_S) ii_version_l";return false;}
   if(j>k)
     {z_p.err_s="over (version) (@ZZZZZZ_VERSION2("+z_p.to_i_s(j)+") > "+z_p.to_i_s(k)
      +") old version ok (ZZZZ010121,ZZZZ010137,ZZZZ010511,ZZZZ010531)";return false;
     }
  }
return true;
}
//HP public ~ii_program_l()
//HP {
//HP delete w_name_name_n;delete w_name2_name_n;delete w_name_copy_s_n;delete w_s_n;delete w_data_dummy_s_n;delete w_compute_s_n;delete w_compute_type_c_n;
//HP delete w_sya_n;delete w_at_n;delete w_ast_n;delete w_amp_n;
#if IMENU
//HP paint_list_n.clear_v();delete paint_list_n;
#endif
//HP z_p.clear_da_v(da_set_a);z_p.clear_da_v(da_data_a);z_p.clear_da_v(da_work_a);z_p.clear_da_v(da_etc_a);
//HP z_p.clear_da_v(da_form_data_a);z_p.clear_da_v(da_table_a);
////HP z_p.clear_fo_v(fo_font_a);
//HP z_p.clear_i_v(i_copy_end_a);z_p.clear_i_v(i_copy_save_a);
//HP z_p.clear_i_v(i_name_start_a);z_p.clear_i_v(i_name_end_a);z_p.clear_i_v(i_msg_a);
//HP z_p.clear_s_v(s_form_a);z_p.clear_s_v(s_Font_s_name_a);
//HP z_p.clear_s_v(s_sql0_a);z_p.clear_s_v(s_sql1_a);z_p.clear_s_v(s_sql2_a);z_p.clear_s_v(s_sql3_a);
//HP z_p.clear_s_v(s_name_a);
//HP z_p.clear_s_v(s_join_alias_my_a);z_p.clear_s_v(s_join_alias_other_a);
//HP z_p.clear_s_v(s_join_key_my_a);z_p.clear_s_v(s_join_key_othor_a);z_p.clear_s_v(s_join_a);
//HP z_p.clear_s_v(s_keep_table_a);z_p.clear_s_v(s_keep_alias_a);
//HP z_p.clear_xm_v(xm_xml_a);z_p.clear_xm_v(xm_json_a);
//HP delete da_set_a;delete da_data_a;delete da_work_a;delete da_etc_a;
//HP delete da_form_data_a;delete da_table_a;
////HP delete fo_font_a;
//HP delete i_copy_end_a;delete i_copy_save_a;
//HP delete i_name_start_a;delete i_name_end_a;delete i_msg_a;
//HP delete s_form_a;delete s_Font_s_name_a;
//HP delete s_sql0_a;delete s_sql1_a;delete s_sql2_a;delete s_sql3_a;
//HP delete s_name_a;
//HP delete s_join_alias_my_a;delete s_join_alias_other_a;
//HP delete s_join_key_my_a;delete s_join_key_othor_a;delete s_join_a;
//HP delete s_keep_table_a;delete s_keep_alias_a;
//HP z_p.clear_xm_v(xm_xml_a);delete xm_xml_a;delete xm_json_a;
//HP for(int i=0;2>i;i++){delete read_nx[i];delete write_nx[i];}
//HP delete dir_n;delete dir_dir_n;delete section_n;
#if IMENU
//HP delete keyboard_n;delete msg_data_n;
#endif
//HP }
//COPY $II_WRITE
}
#endif 